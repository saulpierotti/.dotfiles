(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[22],{"348426a60b7cb4dbeb31":function(t,e,i){"use strict";i.d(e,"a",function(){return o});var n=i("11e808f62b4fe6e70870"),r=i("d200c08d057f868315fd"),a=i("5f0dbee501b8046e840c"),s=function(){function t(){var t=this;this.initialized=!1,this.eventDecoratorCallbacks=[],this.flush=function(){return t.telemetryProvider.flush()},this.telemetryProvider=Object(n.b)(),Object(r.a)(function(){t.initialized=!1,t.eventDecoratorCallbacks=[]})}return t.prototype.initialize=function(t,e,i){this.initialized||(this.consoleLogger=e,this.consoleLogger.debug("TelemetrySender initialized."),this.telemetryProvider.initialize(t,this.consoleLogger,i),this._tablePostfix=t.documentInfo.tablePostfix||"",this.initialized=!0)},t.getInstance=function(){return this.telemetrySender||(this.telemetrySender=new t),this.telemetrySender},t.prototype.registerEventDecorator=function(t){this.eventDecoratorCallbacks.push(t)},t.prototype.sendTelemetry=function(t,e,i,r){if(void 0===i&&(i={}),"start"!==i.step&&this.initialized){e=e.replace(/\-/g,"_").toLowerCase(),this.decorateEvent(e,i);var s=(""+a.a[t]+this._tablePostfix).toLowerCase(),o=this.telemetryProvider.createEvent(s,e,i,r),c=t===a.a.UserBI?n.a.userBi:n.a.default;this.telemetryProvider.logEvent(c,o)}},t.prototype.decorateEvent=function(t,e){this.eventDecoratorCallbacks.forEach(function(i){return i(t,e)})},t}();function o(t,e,i,n){s.getInstance().sendTelemetry(t,e,i,n)}},"5f0dbee501b8046e840c":function(t,e,i){"use strict";var n;i.d(e,"a",function(){return n}),function(t){t[t.Perf=0]="Perf",t[t.Scenario=1]="Scenario",t[t.Logging=2]="Logging",t[t.Tracking=3]="Tracking",t[t.Heartbeat=4]="Heartbeat",t[t.Http=5]="Http",t[t.UserBI=6]="UserBI"}(n||(n={}))},"9c02356a8a4ea0c6b9d5":function(t,e,i){"use strict";var n=i("98bae3dbabd51089d613"),r=12e4,a={"cdl-request":!0},s=i("f9a6412761c79a080418"),o=i("348426a60b7cb4dbeb31"),c=i("e4015b2ea28f962ed7da"),u=i("5f0dbee501b8046e840c"),p=i("94a755535d135f12850c"),h=function(){function t(t,e,i,n,r,a,s,o,u,p,h){var l=this;if(this._id=t,this._name=e,this._eventData=i,this.scenarioFactory=n,this.logger=r,this.timeout=a,this.callback=o,this.memoryAnalyzer=u,this.enableDiagnostics=p,this.reportActivity=h,this._sequence=0,this.getTotalPauseDuration=function(){return l.pauseInfo&&l.pauseInfo.totalTime||0},this._currentStep=c.b.Unknown,this._timestamps=[],this._isHoisted=!1,this.active=!0,this.absoluteStartTime=Date.now(),this.intervalTimestamp=this.relativeTimestamp=this.scenarioFactory.timestamp(),this.markStepsInTrace=!!s&&s.getBoolean("showScenarioStepsInPerfTrace"),this.showAllConsoleLogs=!!s&&s.getBoolean("showAllConsoleLogs"),this.memoryAnalyzer){var f=this.memoryAnalyzer.snapshotMemoryUsage();f&&(this.workingSetInitial=f.workingSetKb,this.privateBytesInitial=f.privateBytesKb)}}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"delta",{get:function(){return this.scenarioFactory.timestamp()-this.relativeTimestamp},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeoutMs",{get:function(){return this.timeout},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventData",{get:function(){return this._eventData},set:function(t){this._eventData=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timestamps",{get:function(){return this._timestamps},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPaused",{get:function(){return!!this.pauseInfo&&!!this.pauseInfo.startTime},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isHoisted",{get:function(){return this._isHoisted},set:function(t){this._isHoisted=t},enumerable:!0,configurable:!0}),t.prototype.appendEventData=function(t){this.eventData=Object(n.__assign)(Object(n.__assign)({},this.eventData),t)},t.prototype.markAggregateStart=function(t){this.active?(this.aggregateStepStartTime||(this.aggregateStepStartTime={}),this.aggregateStepStartTime[t]||(this.aggregateStepStartTime[t]=performance.now())):this.logger.debug("Scenario {0} set to inactive",this.name)},t.prototype.markAggregateStop=function(t){this.active&&this.aggregateStepStartTime[t]&&(this.aggregateStepTotalTime||(this.aggregateStepTotalTime={}),this.aggregateStepTotalTime[t]||(this.aggregateStepTotalTime[t]=0),this.aggregateStepTotalTime[t]+=performance.now()-this.aggregateStepStartTime[t],this.aggregateStepStartTime[t]=void 0)},t.prototype.pause=function(t,e){if(this.active&&!this.isPaused){this._currentStep!==c.b.Unknown&&this.mark(this._currentStep);var i=t.reason,r=Object(n.__rest)(t,["reason"]);this.mark(c.b.Pause,Object(n.__assign)({pauseReason:i},r),void 0,e),this.pauseInfo=Object(n.__assign)(Object(n.__assign)({},this.pauseInfo),{reason:i,startTime:Date.now()})}},t.prototype.resume=function(t,e){if(this.active&&this.isPaused){var i=Date.now()-this.pauseInfo.startTime;this.mark(c.b.Resume,Object(n.__assign)(Object(n.__assign)({},t),{pauseDelta:i,pauseReason:this.pauseInfo&&this.pauseInfo.reason}),void 0,e),this.pauseInfo.totalTime=(this.pauseInfo.totalTime||0)+i,delete this.pauseInfo.reason,delete this.pauseInfo.startTime}},t.prototype.stop=function(t,e,i){var n=this;void 0===e&&(e="success"),this._currentStep!==c.b.Unknown&&this.mark(this._currentStep,void 0,e,i),this.aggregateStepTotalTime&&(Object(p.each)(Object.keys(this.aggregateStepTotalTime),function(t){var e=parseInt(n.aggregateStepTotalTime[t].toString(),10);n.mark(c.b[t],{stepDelta:e},void 0,i)}),this.aggregateStepTotalTime=null,this.aggregateStepStartTime=null),this.createMark(c.b.Stop,t,e,!0,i).then(function(){n.active&&(n.active=!1,n.pauseInfo=void 0),n.callback&&n.callback(e),n.scenarioFactory.clearScenario(n)})},t.prototype.fail=function(t,e){this.stop(t,"failure",e)},t.prototype.cancel=function(t,e){this.stop(t,"abandoned",e)},t.prototype.incomplete=function(t,e){this.stop(t,"incomplete",e)},t.prototype.mark=function(t,e,i,n){void 0===i&&(i="success"),this.createMark(t,e,i,!1,n),this._currentStep===t&&(this._currentStep=c.b.Unknown)},t.prototype.startStep=function(t){this._currentStep!==c.b.Unknown&&t!==this._currentStep&&this.mark(this._currentStep),this._currentStep=t},t.prototype.prepareAndSendTelemetry=function(t,e){this.eventData&&this.eventData!==t&&(t=Object(n.__assign)(Object(n.__assign)({},this.eventData),t)),t.InstanceId=this.id,this.updateEventDataMemory(t),t=this.getEventDataWithComutedValues(t),this.enableDiagnostics&&Object(s.a)().pushTelemetryEvent(u.a[u.a.Scenario],t),Object(o.a)(u.a.Scenario,this.name,t,e),this.logScenarioPerf(t)},t.prototype.logScenarioPerf=function(t){if(this.showAllConsoleLogs){var e=t["Scenario.Step"],i="start"===e?e:"stop"===e?"[step]("+this._sequence+")"+e+" ("+t.stepDelta+"ms/"+t.delta+"ms)":"[step]("+this._sequence+")"+e+" ("+t.stepDelta+"ms)";this.logger&&this.logger.log("[Scenario]"+this.name+" "+i)}},t.prototype.updateEventDataMemory=function(t){if(this.memoryAnalyzer){var e=this.memoryAnalyzer.snapshotMemoryUsage();e&&(t.workingSet=e.workingSetKb,t.privateBytes=e.privateBytesKb,t.workingSetDelta=this.workingSetInitial?this.workingSetInitial-e.workingSetKb:void 0,t.privateBytesDelta=this.privateBytesInitial?this.privateBytesInitial-e.privateBytesKb:void 0)}},t.prototype.getEventDataWithComutedValues=function(t){var e,i=this.intervalTimestamp;Object(p.isNumber)(t.overrideTimestamp)?(e=this.relativeTimestamp+t.overrideTimestamp-this.absoluteStartTime,delete t.overrideTimestamp):(e=this.scenarioFactory.timestamp(),this._timestamps.push(e)),this.intervalTimestamp=e;var r=Object(p.isNumber)(t.stepDelta)?t.stepDelta:e-i,a=Object(p.isNumber)(t.delta)?t.delta:e-this.relativeTimestamp,s=Object(p.isNumber)(t.elapsed)?t.elapsed:e,o=Object(p.isNumber)(t.elapsedSinceCoreInit)?t.elapsedSinceCoreInit:this.scenarioFactory.timestamp({isFromCoreInit:!0}),u=!!this.scenarioFactory.findScenario(c.a.WindowLaunchTime);return Object(n.__assign)(Object(n.__assign)({},t),{isInEst:u,stepDelta:r,delta:a,elapsed:s,elapsedSinceCoreInit:o})},t.prototype.getMonitoringDataOverride=function(t){var e=t;return this.name===c.a.WindowLaunchTime&&(e=t?Object(p.cloneDeep)(t):{scenarioPriority:"P0",data:[]}).data.push({key:"App",value:this.eventData.contentSlotApp}),e},t.prototype.createMark=function(t,e,i,r,s){return void 0===e&&(e={}),Object(n.__awaiter)(this,void 0,void 0,function(){var o,c,u;return Object(n.__generator)(this,function(n){return t&&this.active?(e["Scenario.Status"]=i,e["Scenario.Step"]=t,e["Scenario.Name"]=this.name,o=this.getMonitoringDataOverride(s),performance&&performance.mark&&performance.measure&&!a.hasOwnProperty(e["Scenario.Name"])&&(c=e["Scenario.Step"]+" "+e["Scenario.Name"]+"-"+this.id,performance.mark(c),"stop"===e["Scenario.Step"]&&(u="start "+e["Scenario.Name"]+"-"+this.id,0===(performance.getEntriesByName(u,"mark")||[]).length&&(u="navigationStart"),performance.measure(e["Scenario.Name"],u,c)),this.markStepsInTrace&&(this.previousMark&&performance.measure(e["Scenario.Name"]+" ["+this.previousMark+" <=> "+e["Scenario.Step"]+"]",this.previousMark+" "+e["Scenario.Name"]+"-"+this.id,e["Scenario.Step"]+" "+e["Scenario.Name"]+"-"+this.id),this.previousMark=e["Scenario.Step"])),this.prepareAndSendTelemetry(e,o),this.active=this.active&&!r,this.reportActivity&&this.reportActivity(e),this._sequence+=1,[2]):[2]})})},t}(),l=i("3e9c7e5351d86134f5f6"),f=function(){function t(t){this._name=t}return Object.defineProperty(t.prototype,"id",{get:function(){return"noop"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"delta",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timeoutMs",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"eventData",{get:function(){return{}},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"timestamps",{get:function(){return[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPaused",{get:function(){return!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isHoisted",{get:function(){return!1},set:function(t){},enumerable:!0,configurable:!0}),t.prototype.appendEventData=function(t){},t.prototype.pause=function(t){},t.prototype.resume=function(t){},t.prototype.cancel=function(t){},t.prototype.mark=function(t,e,i){},t.prototype.startStep=function(t){},t.prototype.stop=function(t,e){},t.prototype.fail=function(t){},t.prototype.incomplete=function(t){},t.prototype.markAggregateStart=function(t){},t.prototype.markAggregateStop=function(t){},t.prototype.getTotalPauseDuration=function(){return 0},t}();i.d(e,"a",function(){return g});var g=function(){function t(t,e,i,n,a,s){var o,c,u=this;void 0===i&&(i=0),void 0===n&&(n=!1),this.settingsService=e,this.appStartTimestamp=i,this.enableDiagnostics=n,this.memoryAnalyzer=s,this.activeScenarios=[],this.scenarioTimeoutMs=r,this.markStep=function(t,e,i){var n=u.findScenario(t);n&&n.mark(e,i&&i.eventData,i&&i.status,i&&i.monitoringData)},this.startStep=function(t,e){var i=u.findScenario(t);i&&i.startStep(e)},this.timestamp=function(){return Date.now()-u.appStartTimestamp},this.setTimeoutCallback=(null===(o=a)||void 0===o?void 0:o.setTimeout)||setTimeout,this.clearTimeoutCallback=(null===(c=a)||void 0===c?void 0:c.clearTimeout)||clearTimeout,this.logger=t.newLogger("Telemetry"),this.logger.debug("Initialized ScenarioFactory")}return t.prototype.newScenario=function(t,e){var i=this.createScenarioWithoutStarting(t,e);return i.mark("start",void 0,void 0,e&&e.monitoringData),i},t.prototype.createScenarioWithoutStarting=function(t,e){if(void 0===e&&(e={}),0===this.appStartTimestamp)return new f(t);var i=void 0===e.captureMemoryUsage||e.captureMemoryUsage,n=Object(l.v4)(),r=new h(n,t,{},this,this.logger,e.timeoutMs||this.scenarioTimeoutMs,this.settingsService,e.callback,i?this.memoryAnalyzer:void 0,this.enableDiagnostics);void 0===e.startTime||isNaN(e.startTime)||(r.absoluteStartTime=e.startTime);var a=this.setupScenarioTimeout(r);return this.activeScenarios.push({scenario:r,timeoutId:a}),r},t.prototype.cancelExistingAndCreateScenario=function(t,e,i,n,r){var a=this.findScenario(t);if(a){var s=[{reason:e}];a.cancel({errors:JSON.stringify(s)})}return a=this.newScenario(t,{timeoutMs:i,callback:n,monitoringData:r})},t.prototype.stopScenarioIfActive=function(t,e,i,n){var r=this.findScenario(t);r&&r.stop(e,i,n)},t.prototype.findScenario=function(t){if(!t)return null;var e=Object(p.findLast)(this.activeScenarios,function(e){return e&&e.scenario.name===t||e.scenario.clientId===t})||null;return e?e.scenario:null},t.prototype.findScenarioByNameAndId=function(t,e){var i=Object(p.findLast)(this.activeScenarios,function(i){return i.scenario.name===t&&i.scenario.clientId===e})||null;return i?i.scenario:null},t.prototype.clearScenario=function(t){var e=Object(p.findIndex)(this.activeScenarios,function(e){return e.scenario===t});if(e>-1){var i=this.activeScenarios.splice(e,1)[0];this.clearTimeoutCallback(i.timeoutId)}},t.prototype.setContext=function(){},t.prototype.setupScenarioTimeout=function(t,e){var i=t.timeoutMs;return this.setTimeoutCallback(function(){t.stop(t.eventData,"timeout",e)},i)},t}()},e0ae79cd8630f9b39623:function(t,e,i){"use strict";i.d(e,"a",function(){return r}),i.d(e,"b",function(){return o});var n=i("94a755535d135f12850c");function r(t,e,i){return t=s(t,e,i=i||a),1===e.length&&"object"==typeof e[0]&&(t=s(t,e[0],i)),t}function a(t){if(null===t)return"null";if(void 0===t)return"undefined";var e=typeof t;if("string"===e)return t;if("number"===e||"boolean"===e)return String(t);if("function"===e)return"";if(Object(n.isDate)(t))return t.toISOString();try{return JSON.stringify(t)}catch(e){return function(t){var e=[];return JSON.stringify(t,function(t,i){if("object"==typeof i){if(-1!==e.indexOf(i))return;e.push(i)}return i})}(t)}}function s(t,e,i){for(var n in e)e.hasOwnProperty(n)&&(t=t.replace("{"+n+"}",i(e[n])));return o(t)}function o(t){return null==t||0===t.length?t:(" "+t).substr(1)}},f9a6412761c79a080418:function(t,e,i){"use strict";var n,r=i("98bae3dbabd51089d613"),a=i("e88a8106e72c3f2e7fd4"),s=i("2a5dd11255f151c25fd3"),o=i("e4015b2ea28f962ed7da"),c=function(){function t(e){this.maxQueueLength=e,this.diagnosticEvents=[],this.queueCapacity=this.maxQueueLength?this.maxQueueLength:t.QUEUE_CAPACITY}return t.prototype.getEvents=function(){return this.diagnosticEvents},t.prototype.enqueueEvent=function(t){this.diagnosticEvents.length<this.queueCapacity?this.diagnosticEvents.push(t):(this.dequeueEvent(),this.diagnosticEvents.push(t))},t.prototype.enqueueEvents=function(t){var e=this;t&&t.length>0&&t.forEach(function(t){e.enqueueEvent(t)})},t.prototype.flush=function(){this.diagnosticEvents=[]},t.prototype.dequeueEvent=function(){return this.diagnosticEvents.shift()},t.QUEUE_CAPACITY=1e3,t}(),u=i("4044e44e608d1baef794"),p=i("e0ae79cd8630f9b39623");i.d(e,"a",function(){return l});var h=function(){function t(t){this.diagnosticsInstances=new Map,this.telemetryEvents=new Map,this.diagnosticsEvents=new c,this.scriptStepWhiteList=new Set([o.b.DownloadScripts,o.b.DownloadMainJs]),this.eventWhiteList=new Set([o.a.SyncChatData,o.a.AppStart,o.a.RenderProviders,o.a.ChatSendMessage,o.a.ExperienceStartTime,o.a.RenderBaseApp,o.a.RenderChatPane,o.a.RenderChatList,o.a.RenderComposeChat,o.a.RenderShareForm,o.a.SubmitShareForm]),this.environmentDependencies=t,this.storageKey="persistedDiagnostics",this.loadPersistedDiagnostics(!0)}return t.prototype.pushTelemetryEvent=function(e,i){if(this.eventWhiteList.has(i.name)){var n=i&&i.step||"",r=i&&i.elapsed||0;if(this.scriptStepWhiteList.has(n)){var a=t.extractTimeValue(i.stepDelta);this.telemetryEvents.set(n,{delta:a,name:n,telemetryType:e,step:n,elapsed:r})}else{a=t.extractTimeValue(i&&i.delta);this.telemetryEvents.set(i.name,{delta:a,name:i.name,step:n,telemetryType:e,elapsed:r})}}},t.prototype.getTelemetryEvents=function(){return Array.from(this.telemetryEvents.values())},t.prototype.pushDiagnosticsEvent=function(e,i){i.length>t.MAX_MESSAGE_SIZE&&(i=i.substring(0,t.MAX_MESSAGE_SIZE)+t.longMessageEndingPattern);var n={message:i=Object(p.b)(i),level:e,levelName:a.d[e],timeStamp:new Date};this.diagnosticsEvents.enqueueEvent(n)},t.prototype.getDiagnosticsEvents=function(){var t=[];try{t=this.getDiagnosticsInstancesEvents()||[]}catch(t){this.pushDiagnosticsEvent(a.d.Error,"Failed to fetch logs from diagnostic instances: "+t)}var e=[];try{e=this.diagnosticsEvents.getEvents()||[]}catch(t){this.pushDiagnosticsEvent(a.d.Error,"Failed to fetch diagnostic logs: "+t)}return Object(r.__spreadArrays)(e,t)},t.prototype.flush=function(){this.diagnosticsEvents.flush()},t.prototype.persistDiagnostics=function(){this.pushDiagnosticsEvent(a.d.Warn,"Persisting diagnostic events for next load"),this.environmentDependencies.localStorage.setItem(this.storageKey,JSON.stringify(this.getDiagnosticsEvents()))},t.prototype.loadPersistedDiagnostics=function(t){void 0===t&&(t=!0);var e=this.environmentDependencies.localStorage,i=e.getItem(this.storageKey);if(i){var n=void 0;try{n=JSON.parse(i),Array.isArray(n)&&n.length>0&&this.diagnosticsEvents.enqueueEvents(n),t&&e.removeItem(this.storageKey)}catch(t){this.pushDiagnosticsEvent(a.d.Error,"Failed to load persisted logs from store with error: "+t),e.removeItem(this.storageKey)}}},t.prototype.registerDiagnosticsInstance=function(t,e){this.diagnosticsInstances.set(t,e)},t.prototype.unregisterDiagnosticsInstance=function(t){this.diagnosticsInstances.delete(t)},t.prototype.getDiagnosticsInstancesEvents=function(){var t,e=this,i=Array.from(this.diagnosticsInstances.keys());return!i||i.length<1?[]:i.reduce(function(i,n){if(!(t=e.diagnosticsInstances.get(n)))return i;try{var s=t.getDiagnosticsEvents()||[];return Object(r.__spreadArrays)(i,s)}catch(t){return e.pushDiagnosticsEvent(a.d.Error,"Error in collecting diagnostics events from "+n+": "+t),i}},[])},t.extractTimeValue=function(t){return Math.round(parseFloat(t||"0"))},t.MAX_MESSAGE_SIZE=512,t.longMessageEndingPattern="...",t}(),l=function(){if(!n){var t=void 0;try{t=Object(u.a)()}catch(i){t={getHostedWindowContext:function(){return{panelContext:s.a.worker,startReason:s.b.userInitiated}},localStorage:{getItem:function(t){var i=e.get(t);return void 0===i?null:i},clear:function(){return e.clear()},key:function(t){return Array.from(e.keys())[t]},length:(e=new Map).size,removeItem:function(t){return e.delete(t)},setItem:function(t,i){return e.set(t,i)}}}}n=new h(t)}var e;return n}}}]);
//# sourceMappingURL=precompiled-default~calendar-app~calendar-dialog~channel-files.min.4a302f66d538e5167db9.js.map