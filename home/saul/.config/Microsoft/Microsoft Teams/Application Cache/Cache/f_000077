function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}(this.webpackJsonp=this.webpackJsonp||[]).push([[6],{1028:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1029),i=function(){function e(){}return e.initKillSwitches=function(t){e._killSwitches=t||{};},e.isActivated=function(t,r,i){var o=window._spPageContextInfo;return!e._killSwitches&&o&&o.killSwitches&&e.initKillSwitches(o.killSwitches),!(!t||!e._killSwitches)&&e._killSwitches[n.default.normalizeUpper(t,!1)];},e;}();t.Killswitch=i,t.getKillSwitch=function(e){var t=e&&e.killSwitches;return{isActivated:function isActivated(e,r,i){return!!t&&!!t[n.default.normalizeUpper(e,!1)];}};};},1029:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1030);t.default=n;},1030:function _(e,t,r){"use strict";function n(e){for(var t="";t.length<e;){var r=16*Math.random();t+=(r|=0).toString(16);}return t;}function i(e,t){var r=e.match(/^\{(.*)\}$/);return r?t?r[0]:r[1]:t?"{"+e+"}":e;}Object.defineProperty(t,"__esModule",{value:!0}),t.Empty="00000000-0000-0000-0000-000000000000",t.generate=function(){var e=[];e.push(n(8)),e.push(n(4));var t="4"+n(3);e.push(t);var r=n(4),i=parseInt(r[0],16);return i&=3,r=(i|=8).toString(16)+r.substr(1),e.push(r),e.push(n(12)),e.join("-");},t.normalizeLower=function(e,t){return void 0===t&&(t=!1),e?i(e.toLowerCase(),t):"";},t.normalizeUpper=function(e,t){return void 0===t&&(t=!1),e?i(e.toUpperCase(),t):"";},t.normalizeDashes=function(e,t){if(void 0===t&&(t=!1),e){var r=e.replace(/[^A-Fa-f0-9]/g,"");if(32===r.length)return i(r.slice(0,8)+"-"+r.slice(8,12)+"-"+r.slice(12,16)+"-"+r.slice(16,20)+"-"+r.slice(20),t);}return"";};},1031:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(955);t.default=n;},1032:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1229);var o=function(){function e(){this._handlers=[],this._buffer=[],this._validationLoggers=[],this._featureEnablers=[];}return Object.defineProperty(e.prototype,"startDate",{get:function get(){return window.performance&&window.performance.timing&&window.performance.timing.navigationStart?new Date(window.performance.timing.navigationStart):new Date();},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startTime",{get:function get(){return this.startDate.getTime();},enumerable:!0,configurable:!0}),e.prototype.getTime=function(){return new Date().getTime();},e.prototype.cleanString=function(e){return e;},e.prototype.addLogHandler=function(e){var t=this._handlers,r=this._buffer;return t.push(e),r.slice();},e.prototype.removeLogHandler=function(e){for(var t=this._handlers,r=0;r<t.length;r++){if(t[r]===e){t.splice(r,1);break;}}},e.prototype.logEvent=function(e,t){var r=this._buffer,o=this._handlers,a=Object.freeze({data:i.deepCopy(e.data),context:n.__assign({},e.context),id:e.id,enabled:e.enabled,critical:e.critical,endTime:e.endTime,eventName:e.eventName,shortEventName:e.shortEventName,parentId:e.parentId,startTime:e.startTime,eventType:t,metadata:e.metadata,vector:e.vector,validationErrors:e.validationErrors,isEventTypePrefixingDisabled:e.isEventTypePrefixingDisabled});r.push(a),r.length>100&&(r.splice(1,1/0),0===o.length&&new Error("Logging buffer overflow hit before any logging handler was registered"));for(var s=0;s<o.length;s++){try{o[s](a);}catch(e){}}},e.prototype.addValidationErrorLogger=function(e){this._validationLoggers.push(e);},e.prototype.removeValidationErrorLogger=function(e){var t=this._validationLoggers,r=t.indexOf(e);r>-1&&t.splice(r,1);},e.prototype.logValidationError=function(e,t){for(var r=0,n=this._validationLoggers;r<n.length;r++){var i=n[r];try{i(e,t);}catch(e){}}},e.prototype.isFeatureEnabled=function(e){for(var t=0,r=this._featureEnablers;t<r.length;t++){if((0,r[t])(e))return!0;}return!1;},e.prototype.addFeatureEnabler=function(e){this._featureEnablers.push(e);},e.prototype.removeFeatureEnabler=function(e){var t=this._featureEnablers,r=t.indexOf(e);r>-1&&t.splice(r,1);},e.prototype.getStack=function(){var e;try{var t=window;t.______ExpectedError______&&t.______ExpectedError______();}catch(t){e=t;}return e&&e.stack||void 0;},e;}();function a(){return new o();}t.createManager=a,t.Manager="undefined"!=typeof window?window.ODSP_TELEMETRY_MANAGER=window.ODSP_TELEMETRY_MANAGER||a():"undefined"!=typeof self?self.ODSP_TELEMETRY_MANAGER=self.ODSP_TELEMETRY_MANAGER||a():a();},1033:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.safeSerialize=function(e){var t;try{var r=[];t=JSON.stringify(e,function(e,t){return t===window?"[window]":t instanceof HTMLElement?"[HTMLElement]":"function"==typeof t?"[function]":"object"==_typeof(t)?null===t?t:-1===r.indexOf(t)?(r.push(t),t):"[circular]":t;});}catch(e){t=JSON.stringify("[object]");}return t;};},1034:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.encodeURIComponent=function(e,t,r,n){var i="",o=0;if(!e)return"";var a=e.length;for(o=0;o<a;o++){var s=e.charCodeAt(o),u=e.charAt(o);if(t&&("#"===u||"?"===u)){i+=e.substr(o);break;}if(r&&"&"===u)i+=u;else if(s<=127)n?i+=u:s>=97&&s<=122||s>=65&&s<=90||s>=48&&s<=57||t&&s>=32&&s<=95&&" \"%<>'&".indexOf(u)<0?i+=u:s<=15?i+="%0"+s.toString(16).toUpperCase():s<=127&&(i+="%"+s.toString(16).toUpperCase());else if(s<=2047)i+="%"+(192|s>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase();else if(55296!=(64512&s))i+="%"+(224|s>>12).toString(16).toUpperCase(),i+="%"+(128|(4032&s)>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase();else if(o<e.length-1){s=(1023&s)<<10,o++,s|=1023&e.charCodeAt(o),i+="%"+(240|(s+=65536)>>18).toString(16).toUpperCase(),i+="%"+(128|(258048&s)>>12).toString(16).toUpperCase(),i+="%"+(128|(4032&s)>>6).toString(16).toUpperCase(),i+="%"+(128|63&s).toString(16).toUpperCase();}}return i;},e.escapeUrlForCallback=function(t){var r=t.indexOf("#"),n=t.indexOf("?");if(r>0&&(-1===n||r<n)){var i=t.substr(0,r);n>0&&(i+=t.substr(n)),t=i;}return e.encodeURIComponent(t,!0,!1,!0);},e.encodeRestUriStringToken=function(t){return t&&(t=(t=t.replace(/'/g,"''")).replace(/%27/g,"%27%27"),t=e.encodeURIComponent(t)),t;},e;}();t.default=n;},1035:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2618),i=r(1234),o=r(2619);t.ResultTypeEnum=o.ResultTypeEnum,t.Api=n.createPairedEvent({eventName:"Api,Qos,",shortEventName:"Api"},{url:1},i.Qos),t.default=t.Api;},1036:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1233),i=r(957);t.ResultTypeEnum=i.ResultTypeEnum,t.Qos=n.createPairedEvent({eventName:"Qos,",shortEventName:"Qos"},{name:{isKey:!0,isPrefixingDisabled:!0,type:1},startTimeOverride:{isPrefixingDisabled:!0,type:2},resultCode:{isPrefixingDisabled:!0,type:1},resultType:{typeRef:i.ResultTypeEnum,isPrefixingDisabled:!0,type:6},error:{isPrefixingDisabled:!0,type:1},extraData:4,extraMetrics:{isPrefixingDisabled:!0,type:4}});},1037:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(1232),o=r(958);!function(e){e[e.scheme=0]="scheme",e[e.authority=1]="authority",e[e.path=2]="path",e[e.query=3]="query";}(n=t.UriPartial||(t.UriPartial={}));var a=/[;\/?:@&=$,]/,s=/[\/?]/;function u(e){var t={};for(var r in e){e.hasOwnProperty(r)&&(t[r.toLowerCase()]=e[r].toLowerCase());}return t;}var l=function(){function e(e,t){this._scheme="",this._user="",this._host="",this._port="",this._path="",this._pathSegments=[],this._pathEncoded="",this._query={},this._fragment="",t&&(this._queryCaseInsensitive=!!t.queryCaseInsensitive,this._pathCaseInsensitive=!!t.pathCaseInsensitive),this._parseURI(e);}return e.concatenate=function(){for(var t=[],r=0;r<arguments.length;r++){t[r]=arguments[r];}for(var n="",i=0;i<t.length;i++){var o=t[i];i>0&&(o=e.ensureNoPrecedingSlash(o)),i<t.length-1&&(o=e.ensureTrailingSlash(o)),n+=o;}return n;},e.ensureNoPrecedingSlash=function(e){return"/"===e[0]?e.substr(1):e;},e.ensureTrailingSlash=function(e){return"/"!==e[e.length-1]?e+"/":e;},e.prototype.getScheme=function(){return this._scheme;},e.prototype.setScheme=function(e){this._scheme=e;},e.prototype.getAuthority=function(){return this._getAuthority(!1);},e.prototype.setAuthority=function(e){this._parseAuthority(e);},e.prototype.getUser=function(){return this._user;},e.prototype.getHost=function(){return this._host;},e.prototype.getPort=function(){return this._port;},e.prototype.getPath=function(e){var t=this._path;return Boolean(e)&&null!==t&&t.lastIndexOf("/")===t.length-1&&(t=t.slice(0,-1)),t;},e.prototype.getLeftPart=function(e){var t=this._scheme+"://";return e===n.authority&&(t+=this.getAuthority()),e===n.path&&(t+=this.getPath()),e===n.query&&(t+=this.getQuery()),t;},e.prototype.setPath=function(e){e&&"/"!==e[0]&&(e="/"+e),this._parsePath(e);},e.prototype.getPathSegments=function(){return this._pathSegments;},e.prototype.getLastPathSegment=function(){var e=this._pathSegments;return e[e.length-1]||"";},e.prototype.getQuery=function(e){return this._serializeQuery(e);},e.prototype.setQuery=function(e){this.setQueryFromObject(this._deserializeQuery(e));},e.prototype.getQueryAsObject=function(){return this._query;},e.prototype.setQueryFromObject=function(e){for(var t in this._query={},e){e.hasOwnProperty(t)&&this.setQueryParameter(t,e[t]);}},e.prototype.getQueryParameter=function(e){var t=null,r=this._query;if(this._queryCaseInsensitive)for(var n in e=e.toLowerCase(),r){r.hasOwnProperty(n)&&n.toLowerCase()===e&&(t=r[n]);}else t=r[e];return t||null;},e.prototype.setQueryParameter=function(e,t,r){void 0===r&&(r=!0);var n=this._decodeQueryString(t);(n||r)&&(this._query[this._decodeQueryString(e)]=n);},e.prototype.removeQueryParameter=function(e){delete this._query[this._decodeQueryString(e)];},e.prototype.getFragment=function(){return this._fragment;},e.prototype.setFragment=function(e){"#"===e[0]&&(e=e.substring(1)),this._fragment=this._decodeQueryString(e);},e.prototype.equals=function(e){return o.equalsCaseInsensitive(this._scheme,e.getScheme())&&this._user===e.getUser()&&o.equalsCaseInsensitive(this._host,e.getHost())&&this._port===e.getPort()&&this._fragment===e.getFragment()&&this._equalsCaseAppropriate(this.getPath(!0),e.getPath(!0),this._pathCaseInsensitive)&&this._equalsCaseAppropriate(this.getQuery(),e.getQuery(),this._queryCaseInsensitive);},e.prototype.equivalent=function(e){return o.equalsCaseInsensitive(this._scheme,e.getScheme())&&o.equalsCaseInsensitive(this._user,e.getUser())&&o.equalsCaseInsensitive(this._host,e.getHost())&&o.equalsCaseInsensitive(this._port,e.getPort())&&o.equalsCaseInsensitive(this.getPath(!0),e.getPath(!0))&&i.deepCompare(u(this.getQueryAsObject()),u(e.getQueryAsObject()))&&o.equalsCaseInsensitive(this._fragment,e.getFragment());},e.prototype.toString=function(e){return this._getStringInternal(!0,e);},e.prototype.getDecodedStringForDisplay=function(){return this._getStringInternal(!1);},e.prototype.getStringWithoutQueryAndFragment=function(){return this._getStringWithoutQueryAndFragmentInternal(!0);},e.prototype._equalsCaseAppropriate=function(e,t,r){return r?o.equalsCaseInsensitive(e,t):e===t;},e.prototype._getStringInternal=function(e,t){var r=this._getStringWithoutQueryAndFragmentInternal(e,t),n=this.getQuery(e);return n&&(r+="?"+n),this._fragment&&(r+="#"+(e?encodeURIComponent(this._fragment):this._fragment)),r;},e.prototype._getStringWithoutQueryAndFragmentInternal=function(e,t){var r="";this._scheme&&(r+=(e?encodeURIComponent(this._scheme):this._scheme)+":");var n=this._getAuthority(e,t);return n&&(r+="//"+n),this._pathEncoded&&(r+=e?this._pathEncoded:this._path),r;},e.prototype._deserializeQuery=function(e){var t={};0===e.indexOf("?")&&(e=e.substring(1));for(var r=0,n=e.split(/[;&]+/);r<n.length;r++){var i=n[r],o=i.indexOf("=");o<0&&(o=i.length),o>0&&(t[i.substr(0,o)]=i.substr(o+1));}return t;},e.prototype._serializeQuery=function(e){var t="";for(var r in this._query){if(this._query.hasOwnProperty(r)){var n=r,i=this._query[r];e&&(n=encodeURIComponent(n),i=encodeURIComponent(i)),t+=null===i||""===i?n+"=&":n+"="+i+"&";}}return""!==t&&(t=t.slice(0,-1)),t;},e.prototype._parseURI=function(e){var t=e,r=t.indexOf("#");if(r>=0){var n=t.substring(r+1);this.setFragment(n),t=t.substring(0,r);}var i=t.search(a);if(i>=0){":"===t[i]&&(this.setScheme(t.substring(0,i)),t=t.substring(i+1));var o="";if(0===t.indexOf("//")){var u=(t=t.substring(2)).search(s);if(u>=0?(o=t.substring(0,u),t=t.substring(u)):(o=t,t=""),this.setAuthority(o),!t)return void this.setPath("");}var l=t.indexOf("?");l>=0&&(this.setQuery(t.substring(l+1)),t=t.substring(0,l)),this.setPath(t);}else this.setPath(t);},e.prototype._parseAuthority=function(e){this._host=e;var t=e.lastIndexOf("@");t>=0&&(this._host=this._host.substring(t+1));var r=this._host.indexOf(":");if(!(t<0&&r<0)){var n=e;t<0?this._host=n:(this._user=n.substring(0,t),this._host=n.substring(t+1)),r>=0&&(this._port=this._host.substring(r+1),this._host=this._host.substring(0,r)),this._user=decodeURIComponent(this._user),this._host=decodeURIComponent(this._host);}},e.prototype._parsePath=function(e){this._path=decodeURIComponent(e);var t=this._pathSegments=[];this._pathEncoded=e;for(var r=e.split("/"),n=0;n<r.length;++n){t[n]=decodeURIComponent(r[n]);}""===t[0]&&t.shift(),""===t[t.length-1]&&t.pop();},e.prototype._getAuthority=function(e,t){void 0===t&&(t={});var r,n,i,o=t&&t.doNotPercentEncodeHost,a="";return e?(r=encodeURIComponent(this._user).replace("%3A",":"),n=o?this._host:encodeURIComponent(this._host),i=encodeURIComponent(this._port)):(r=this._user,n=this._host,i=this._port),""!==r&&(a=r+"@"),""!==this._host&&(a+=n),""!==this._port&&(a+=":"+i),a;},e.prototype._decodeQueryString=function(e){var t=e;try{t=decodeURIComponent(e.replace(/\+/g," "));}catch(e){}return t;},e;}();t.default=l;},1038:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(846),i=function(){function e(e){this._promise=new n.SignalPromise(e);}return e.prototype.getPromise=function(){return this._promise;},e.prototype.cancel=function(){this._promise.cancel();},e.prototype.complete=function(e){this._promise._completed(e);},e.prototype.error=function(e){this._promise._error(e);},e;}();t.default=i;},1039:function _(e,t,r){"use strict";r.r(t),r.d(t,"strings",function(){return n;});var n=r(723)["_JHOkSBhvwnD5wTu/rquXQg"];t.default=n;},1040:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2672);t.SimpleUri=n.SPResourcePath,t.UriFormat=n.SPResourcePathFormat,t.default=n.SPResourcePath;},1041:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(1227),o=r(2643),a=r(2644),s=r(2645),u=r(2646);!function(e){e[e.Incomplete=1]="Incomplete",e[e.ReadyToUpload=2]="ReadyToUpload",e[e.Uploaded=3]="Uploaded",e[e.TimeOut=4]="TimeOut",e[e.Skipped=5]="Skipped";}(n||(n={}));var l=function l(e,t,r,n,i,o,a){this.url=e,this.duration=t,this.correlationId=r,this.status=n,this.startTime=i,this.endTime=o,this.name=a;};t.APICallPerformanceData=l;var c=["EUPL","ScenarioId"],d=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,p=function p(e,t,r,n,i,o,a){this.controlId=e,this.startTime=t,this.endTime=r,this.renderTimeCalculator=n,this.renderTimeRequiredDataChecker=i,this.ignoreForEUPL=void 0===o||o,this.needFlatten=void 0!==a&&a;};function h(e){return null==e;}t.ControlPerformanceData=p;var f={checkInterval:100,error_timeout:3e4,max_markers:100},m=function(){function e(e,t,r){void 0===r&&(r=f),this._keyMetrics=c,this.async=new i.default(this),this.dataStartTime=Number(new Date().getTime()),this._rumoneData={},this.dataState=n.Incomplete,this.controls=[],this.apis=[],this._loggingFunctions=[],this.euplBreakDown={},this.serverMetrics={},this.isW3cTimingCollected=!1,this.isW3cResourceTimingCollected=!1,this.tempData={},this._emergencyUpdateFunc=this._emergencyUpload.bind(this),this._name=e,this.registerLoggingFunc(t),this._config=r,this.setPerfDataTimer(),this._platformDetection=new s.default(),this._hookUnloadEvent();}return e.getRUMOneLogger=function(t,r,n){void 0===t&&(t="__default_rumone__"),void 0===n&&(n=f);var i=r||function(e,t){a.RUMOneDataUpload.logData({streamName:e,dictionary:t});};if(!e.Loggers[t])try{var o=new e(t,i,n);"__default_rumone__"===t&&(e.rumOneLogger=o),e.Loggers[t]=o;}catch(e){}return e.Loggers[t];},e.prototype.registerLoggingFunc=function(e){var t=this,r=this._loggingFunctions.indexOf(e);return r<0&&this._loggingFunctions.push(e),function(){r>=0&&t._loggingFunctions.splice(r,1);};},Object.defineProperty(e.prototype,"KeyMetrics",{get:function get(){return this._keyMetrics;},enumerable:!0,configurable:!0}),e.prototype.getPerformanceData=function(){return this._rumoneData;},e.prototype.resetLogger=function(){this._emergencyUpload(),this.dataStartTime=new Date().getTime(),this.dataState=n.Incomplete,this.isW3cTimingCollected=!1,this.isW3cResourceTimingCollected=!1,this.controls=[],this.apis=[],this.tempData={},this._rumoneData={},this._excludePageData=!1,this._waitOnAddingExpectedControl=!1,this._keyMetrics=c,this.clearPerfDataTimer(),this.setPerfDataTimer(),this.euplBreakDown={},this.serverMetrics={},this.clearResourceTimings(),u.clearMarks(this._getOwnMakers().map(function(e){return e.name;})),e._markers[this._name]=[],this._unhookUnloadEvent(),this._hookUnloadEvent(),this.logMessageInConsole("Reset performance Logger Done");},e.prototype.excludePageForPerfData=function(){this._excludePageData=!0;},e.prototype.getPerformanceDataPropertyValue=function(e){return e&&this._rumoneData[e];},e.prototype.setPerformanceDataPropertyValue=function(e,t){return e&&d.test(e)?(this._rumoneData[e]=t,!0):(console.error("key "+e+" does not confrim to the Regex "+d),!1);},e.prototype.addExpectedControl=function(e){var t=this._normalizeControl(e);this.expectingControl(e)?this.controls.filter(function(e){return e.controlId===t.controlId;})[0].ignoreForEUPL=t.ignoreForEUPL:this.controls.push(t);},e.prototype.expectingControl=function(e){var t=this._normalizeControl(e);return this.controls.filter(function(e){return e.controlId===t.controlId;}).length>0;},e.prototype.writeServerCorrelationId=function(e){this._rumoneData.ServerCorrelationId=this._rumoneData.ServerCorrelationId||e;},e.prototype.writeServerUrl=function(e){this._rumoneData.ServerUrl||(this._rumoneData.ServerUrl=e||window.location&&window.location.href);},e.prototype.writeServerSideLatency=function(e,t){this.isCollected("ServerRequestDuration")||(this._rumoneData.ServerRequestDuration=e,this._rumoneData.IISLatency=t);},e.prototype.writeControlPerformanceData=function(e){if(e){var t=this.controls.filter(function(t){return t.controlId===e.controlId;})[0];if(t)t.data||(t.data=e);else{var r={controlId:e.controlId,data:e,ignoreForEUPL:e.ignoreForEUPL};this.controls.push(r);}}},e.prototype.writeAPICallPerformanceData=function(e){e&&this.apis.push(e);},e.prototype.readAPICallPerformanceData=function(){return this.apis;},e.prototype.writeAppCache=function(e){this.isCollected("AppCache")||(this._rumoneData.AppCache=e);},e.prototype.writePageTransitionType=function(e,t){this.isCollected("PageTransitionType")&&!t||e!==o.default.fullPageLoad&&e!==o.default.none&&e!==o.default.onePageAppNavigation||(this._rumoneData.PageTransitionType=e);},e.prototype.writeScenarioId=function(e,t){this.isCollected("ScenarioId")&&!t||(this._rumoneData.ScenarioId=e);},e.prototype.collectW3CPerfTimings=function(){if(!this.isW3cTimingCollected){var e=["navigationStart","unloadEventStart","unloadEventEnd","fetchStart","redirectStart","redirectEnd","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","responseEnd","domLoading","domComplete","loadEventStart","loadEventEnd"],t=performance&&performance.timing;if(t){for(var r=0;r<e.length;r++){var n=t[e[r]];n&&this._logRUMOneData(this.getW3cTimingName(e[r]),Number(n));}this.isW3cTimingCollected=!0;}}},e.prototype.collectW3cResourceTimings=function(){if(window.document&&!this.isW3cResourceTimingCollected&&performance&&performance.getEntriesByType){for(var e=performance.getEntriesByType("resource"),t=document.getElementsByTagName("iframe"),r=0;r<t.length;r++){var n=null;try{n=t[r].contentWindow.performance;}catch(e){}n&&n.getEntriesByType&&e.concat(n.getEntriesByType("resource"));}var i={SharePoint:function SharePoint(e){return /\.sharepoint\.com|\.spoppe\.com/i.test(e.name);},CDN:function CDN(e){return /(cdn(ppe)?|static(ppe)?)\.sharepointonline\.com|\.akamaihd\.net/i.test(e.name);},ThirdParty:function ThirdParty(e){return!i.SharePoint(e)&&!i.CDN(e);}},o={ASPX:function ASPX(e){return /\.aspx/i.test(e.name);},JS:function JS(e){return /script/i.test(e.initiatorType);},CSS:function CSS(e){return /link|css/i.test(e.initiatorType);},IMG:function IMG(e){return /img/i.test(e.initiatorType);}},a=Object.keys(i);for(r=0;r<a.length;r++){var s=a[r],u=this.categorizeResourceRequests(e,{from:i[s],requestType:null});this._logRUMOneData(s+"RequestCountTotal",u.length);for(var l=Object.keys(o),c=0;c<l.length;c++){var d=l[c];this._logRUMOneData(s+"RequestCount"+d,this.categorizeResourceRequests(u,{from:null,requestType:o[d]}).length);}if(u.length>0){this._logRUMOneData(s+"RequestDownloadTime",Math.round(u.reduce(function(e,t){return e+t.duration;},0)/u.length));var p=JSON.stringify(u.map(function(e){return{name:e.name.split("/").map(function(e){return e.split("?")[0];}).filter(function(e){return e&&e.length>0;}).slice(-1)[0].replace(/\(.*?\)/g,"()"),startTime:Math.round(e.startTime),duration:Math.round(e.duration),transferSize:e.transferSize||0};}));this._logRUMOneData(s+"RequestNames",p);}}this.isW3cResourceTimingCollected=!0;}},e.prototype.saveTempData=function(e,t){this.tempData[e]=t;},e.prototype.readTempData=function(e){return this.tempData[e];},e.prototype.writeRenderTime=function(e,t){this.isCollected("RenderTime")&&!t||(this._rumoneData.RenderTime=e);},e.prototype.writePreRenderTime=function(e){this.isCollected("PreRender")||(this._rumoneData.PreRender=e);},e.prototype.writePostRenderTime=function(e){this.isCollected("PostRender")||(this._rumoneData.PostRender=e);},e.prototype.writeDataFetchTime=function(e,t){this.isCollected("DataFetch")&&!t||(this._rumoneData.DataFetch=e);},e.prototype.writeAppInfo=function(e,t){this.isCollected("AppInfo")&&!t||(this._rumoneData.AppInfo=e);},e.prototype.isRunning=function(){return!(this.dataState===n.Uploaded||this.dataState===n.TimeOut||this.dataState===n.Skipped);},e.prototype.writeEUPLBreakdown=function(e,t){if(e)try{var r=JSON.parse(e);for(var n in r){r.hasOwnProperty(n)&&this.addEUPLBreakdown(n,r[n],t);}}catch(e){this.logMessageInConsole("Failed to write EUPL breakdown data:"+e.toString());}},e.prototype.addEUPLBreakdown=function(e,t,r){if(e&&!h(t)){if(h(this.euplBreakDown[e])||r){var n=this._isBreakdownValue(t)?t.data:t;this.euplBreakDown[e]=n;}this._isBreakdownValue(t)&&t.needFlatten&&this._logRUMOneData(e,t.data);}},e.prototype.readEUPLBreakdown=function(e){return e?this.euplBreakDown[e]:this.euplBreakDown;},e.prototype.addFlights=function(e){if(e&&e.length>0){for(var t=JSON.parse(this.getPerformanceDataPropertyValue("Flights")||"[]"),r=0;r<e.length;r++){var n=e[r];n&&-1===t.indexOf(n)&&t.push(n);}this._rumoneData.Flights=JSON.stringify(t);}},e.prototype.addServerMetrics=function(e,t){if(e)for(var r in e){r&&!h(e[r])&&(h(this.serverMetrics[r])||t)&&(this.serverMetrics[r]=e[r]);}},e.prototype.writeServerVersion=function(e){this._rumoneData.SharePointServerVersion=e;},e.prototype.readControlPerformanceData=function(){return this.controls.filter(function(e){return!!e.data;}).map(function(e){return e.data;});},e.prototype.mark=function(t){(e._markers[this._name]=e._markers[this._name]||[]).push(t),u.mark(t);},e.prototype.now=function(){return performance&&performance.now?Math.round(performance.now()):NaN;},e.prototype.registerEUPLComputedHandler=function(e){this._EUPLComputedHandler=e;},e.prototype.registerErrorHandler=function(e){},e.prototype.getMarkerTime=function(e){return u.getMarkerTime(e);},e.prototype.addExpectedKeyMetric=function(e){this._keyMetrics&&this._keyMetrics.indexOf(e)<=-1&&this._keyMetrics.push(e);},Object.defineProperty(e.prototype,"waitOnAddingExpectedControl",{set:function set(e){this._waitOnAddingExpectedControl=e;},enumerable:!0,configurable:!0}),e.prototype._logRUMOneData=function(e,t){e&&(this._rumoneData[e]=t);},e.prototype.clearResourceTimings=function(){performance&&performance.clearResourceTimings&&performance.clearResourceTimings();},e.prototype._isBreakdownValue=function(e){return void 0!==e.needFlatten;},e.prototype.collectMarks=function(){var e=this,t={},r=0;this._getOwnMakers().forEach(function(n){if(r<e._config.max_markers){var i=n.name.substr(u.MARKER_PREFIX.length)+".mark"+r++;t[i]=Math.round(n.startTime);}}),this.writeEUPLBreakdown(JSON.stringify(t));},e.prototype._getOwnMakers=function(){var t=this,r=e._markers,n=[].concat.apply([],Object.keys(r).filter(function(e){return r.hasOwnProperty(e)&&e!==t._name;}).map(function(e){return r[e];}));return u.getAllMarks().filter(function(e){return-1===n.indexOf(e.name);});},e.prototype.logMessageInConsole=function(e){this.isRUMOneDebuggingEnabled&&console.log(e);},Object.defineProperty(e.prototype,"isRUMOneDebuggingEnabled",{get:function get(){try{if("sessionStorage"in window&&window.sessionStorage){var e=window.sessionStorage.enableRUMOneDebugging;return e&&"true"===e.toLowerCase()&&"undefined"!=typeof console&&!!console;}}catch(e){}return!1;},enumerable:!0,configurable:!0}),e.prototype.logObjectForDebugging=function(e,t){if(this.isRUMOneDebuggingEnabled){var r=this._name+" "+e+" : "+JSON.stringify(t);console.log(r);}},e.prototype.isCollected=function(e){return!h(this.getPerformanceDataPropertyValue(e));},e.prototype._normalizeControl=function(e){return"string"==typeof e?{controlId:e,ignoreForEUPL:!1}:e;},e.prototype.setPerfDataTimer=function(){this.perfDataTimer=this.async.setTimeout(this.loopForDataCompleteness,this._config.checkInterval);},e.prototype.clearPerfDataTimer=function(){h(this.perfDataTimer)||(this.async.clearTimeout(this.perfDataTimer),this.perfDataTimer=null);},e.prototype._hookUnloadEvent=function(){window.addEventListener&&window.addEventListener("beforeunload",this._emergencyUpdateFunc);},e.prototype._unhookUnloadEvent=function(){window.removeEventListener&&window.removeEventListener("beforeunload",this._emergencyUpdateFunc);},e.prototype.categorizeResourceRequests=function(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n];t.from&&!t.from(i)||t.requestType&&!t.requestType(i)||r.push(i);}return r;},e.prototype.collectSupplementaryData=function(){this.setAPIDataToRUMOne(),this.collectMarks(),this.writeServerUrl(null),this.setBrowseInfo(),this.setReferrer(),this._collectMemoryData(),this._setAppInfo(),this._rumoneData.ServerMetrics=JSON.stringify(this.serverMetrics),this._rumoneData.EUPLBreakdown=JSON.stringify(this.euplBreakDown);},e.prototype.loopForDataCompleteness=function(){if(this.clearPerfDataTimer(),!this._waitOnAddingExpectedControl){if(this.isRUMOneDebuggingEnabled&&(this.logMessageInConsole("===================================================================="),this.logObjectForDebugging("RUMONE: ",this._rumoneData),this.logObjectForDebugging("RUMOne DataState: ",String(this.getReadableDataState(this.dataState))),this.logObjectForDebugging("Controls: ",this.controls),this.logObjectForDebugging("API Performance Data: ",this.apis),this.logObjectForDebugging("Temp Data: ",this.tempData),this.logObjectForDebugging("EUPLBreakdown: ",this.euplBreakDown),this.logObjectForDebugging("ServerMetrics: ",this.serverMetrics),this.logMessageInConsole("====================================================================\n\n")),!this.isRunning())return;if(this._updateState(),this.dataState===n.ReadyToUpload)return void this.finishPerfDataUpload();this.processControlRenderTime(),this.readyToComputeEUPL()&&(this.setEUPL(),this._updateState());}this._checkTimeout(),this.isRunning()&&this.setPerfDataTimer();},e.prototype._checkTimeout=function(){if(this.isRunning()&&this.dataState!==n.ReadyToUpload&&!(Number(new Date().getTime())-Number(this.dataStartTime)<=this._config.error_timeout)){this.dataState=n.TimeOut;var e={reason:"TimeOut",details:{MissingMetrics:this._getMissedKeyMetrics(),MissingControls:this._getMissedControls()}};this._rumoneData.RUMOneError=JSON.stringify(e),this.finishPerfDataUpload();}},e.prototype._updateState=function(){this.dataState=0===this._getMissedKeyMetrics().length&&0===this._getMissedControls().length?n.ReadyToUpload:n.Incomplete;},e.prototype._getMissedKeyMetrics=function(){for(var e=[],t=0;t<this._keyMetrics.length;t++){h(this.getPerformanceDataPropertyValue(this._keyMetrics[t]))&&e.push(this._keyMetrics[t]);}return e;},e.prototype._getMissedControls=function(){return this.controls.filter(function(e){return!e.data||!e.data.renderTime;});},e.prototype._emergencyUpload=function(){this.isRunning()&&0===this._getMissedKeyMetrics().length&&this.finishPerfDataUpload(!0);},e.prototype.finishPerfDataUpload=function(e){this.writeControlDataToRUMOne(),this.collectSupplementaryData();try{this.uploadPerfData(e),this.isRUMOneDebuggingEnabled&&(this.logMessageInConsole("Final Data uploaded"),this.logObjectForDebugging("RUMONE: ",this._rumoneData),this.logObjectForDebugging("RUMOne DataState: ",this.getReadableDataState(this.dataState)));}catch(e){t="PerformanceLogger error writing RUMOne data: "+e,"undefined"!=typeof console&&Boolean(console)&&console.error(t);}finally{this._unhookUnloadEvent();}var t;},e.prototype.getReadableDataState=function(e){for(var t in n){if(e===Number(n[t]))return t;}return"NaN";},e.prototype.writeControlDataToRUMOne=function(){if(this.controls&&this.controls.length){var e=this.controls.slice(0).filter(function(e){return!!e.data&&!!e.data.renderTime&&!e.ignoreForEUPL;});e.sort(function(e,t){return t.data.renderTime-e.data.renderTime;});for(var t=0;t<10&&t<e.length;t++){this._logRUMOneData("Control"+(t+1)+"Id",e[t].controlId),this._logRUMOneData("Control"+(t+1)+"RenderTime",e[t].data.renderTime);}var r={};this.controls.slice(0).filter(function(e){return!!e.data&&!!e.data.renderTime&&!!e.ignoreForEUPL;}).forEach(function(e){r[e.controlId]={data:e.data.renderTime,needFlatten:e.data.needFlatten};}),Object.keys(r).length>0&&this.writeEUPLBreakdown(JSON.stringify(r),!0);}},e.prototype.processControlRenderTime=function(){for(var e=0,t=this.controls;e<t.length;e++){var r=t[e];r.data&&!r.data.renderTime&&r.data.renderTimeRequiredDataChecker(this,r.data)&&(r.data.renderTime=r.data.renderTimeCalculator(this,r.data));}},e.prototype.readyToComputeEUPL=function(){for(var e=this.controls.filter(function(e){return!e.ignoreForEUPL;}),t=e.length>0,r=0,n=e;r<n.length;r++){var i=n[r];if(!i.data||!i.data.renderTime){t=!1;break;}}return t;},e.prototype.setEUPL=function(){if(!this.isCollected("EUPL")){for(var e=0,t=0,r=this.controls;t<r.length;t++){var n=r[t];!n.ignoreForEUPL&&n.data&&n.data.renderTime&&e<n.data.renderTime&&(e=n.data.renderTime);}this._rumoneData.EUPL=e,"function"==typeof this._EUPLComputedHandler&&this._EUPLComputedHandler(e);}},e.prototype.setBrowseInfo=function(){this._rumoneData.Browser=this._platformDetection.browserName+this._platformDetection.browserMajor,this._rumoneData.BrowserIsMobile=this._platformDetection.isMobile;},e.prototype._collectMemoryData=function(){this.isCollected("UsedJSHeapSize")||"undefined"==typeof performance||void 0===performance.memory||(this._rumoneData.UsedJSHeapSize=performance.memory.usedJSHeapSize,this._rumoneData.TotalJSHeapSize=performance.memory.totalJSHeapSize);},e.prototype.setAPIDataToRUMOne=function(){for(var e=0,t=0,r=0;r<this.apis.length;r++){var n=this.apis[r];n&&(e++,t+=n.duration,n.url=n.url.split("/").map(function(e){return e.split("?")[0];}).slice(-1)[0].replace(/\(.*?\)/g,"()"));}this._rumoneData.APICallCount=e,this._rumoneData.APICallDurationSum=t,this._rumoneData.APICalls=JSON.stringify(this.apis);},e.prototype.setReferrer=function(){this._rumoneData.Referrer=window.document&&document.referrer;},e.prototype._setAppInfo=function(){if(!this._rumoneData.AppInfo){var e=window._spModuleLink;if(e){var t=e.buildNumber,r=e.manifestName,n=e.scenarioName,i=JSON.stringify({buildNumber:t,manifestName:r,scenarioName:n});this._rumoneData.AppInfo=i;}}},e.prototype.getW3cTimingName=function(e){return"secureConnectionStart"!==e?"W3c"+e.charAt(0).toUpperCase()+e.slice(1):"W3cSecureConnectStart";},e.prototype.uploadPerfData=function(e){var t=this;this._excludePageData?(this.dataState=n.Skipped,this.logMessageInConsole("Uploading perf data skipped as requested by the consumer")):e||this.dataState===n.ReadyToUpload||this.dataState===n.TimeOut?this._loggingFunctions&&this._loggingFunctions.length>0?this._rumoneData?(this._loggingFunctions.forEach(function(e){e("RUMOne",t.getPerformanceData());}),this.dataState=n.Uploaded):console.error("Error: Uploading perf data called but perf data is not available"):console.error("Uploading perf data skipped as loggingFunc is not defined"):console.error("Error: Uploading perf data called with wrong data state "+this.dataState);},e.rumOneLogger=void 0,e.Loggers={},e._markers={},e;}();t.RUMOneLogger=m,t.default=m;},1042:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function n(e){e||("undefined"!=typeof window?e=window&&window.navigator&&navigator.userAgent:"undefined"!=typeof self&&(e=self&&self.navigator&&navigator.userAgent),e=e||"");var t,r,n,i,o,a,s,u,l=e,c=e.toLowerCase();function d(e){return t=RegExp(e+"(\\d+)([\\d.]*)").exec(c);}d("msie ")?(r=!0,n=!!t&&"9"===t[1]):d("trident.*rv:")?r=!0:d("edge/")?i=!0:d("fxios|firefox/")?o=!0:d("(?:chrome|crios)/")?a=!0:/safari\/(\d+)/.test(c)&&(s=!0,d("version/")),RegExp("electron/(\\d+)([\\d.]*)").exec(c)&&(u=!0);var p=t&&parseInt(t[1],10)||0,h=t&&t[2]&&t[2].substr(1)||"0",f=/windows phone|wpdesktop/.test(c),m=f||/ipad|iphone|ipod|android/.exec(c),_=m&&m[0],g="android"===_,v="ipad"===_,y=!!_&&!g,S=!m&&c.indexOf("macintosh")>-1,I=!m&&c.indexOf("windows nt")>-1,T=c.indexOf("sharepointdesktop")>-1||c.indexOf("magellan")>-1,E=!1,b=!1,w=!1,R=!1;if("undefined"!=typeof window&&window.document||"undefined"!=typeof self&&self.document){var D=document.createElement("style");D.type="text/css",E=!D.styleSheet,b="addBehavior"in document.createElement("div");var P=document.createElement("input");P.type="file";var C=window.File,A=C&&C.prototype;R=!(!A||!(A.slice||A.mozSlice||A.webkitSlice)),w="webkitdirectory"in P&&!u;}var U=/[\s\(](os|os x|windows (?:phone|nt)|android) ([\d._]+)/.exec(c);return{isMagellan:!!T,isChrome:!!a,isEdge:!!i,isFirefox:!!o,isIE:!!r,isIE9:!!n,isSafari:!!s,isElectron:!!u,browserName:r?"IE":i?"Edge":a?"Chrome":o?"Firefox":s?"Safari":"NA",browserMajor:p,browserMinor:h,isAndroid:g,isIOS:y,isMac:S,isWindows:I,isWinPhone:f,osVersion:U?U[2]:"NA",osName:I?"Windows":f?"Windows Phone":S?"OSX":y?"IOS":g?"Android":"NA",isWindows81:!m&&/windows (?:8\.1|nt 6\.3)/.test(c),isWindows10:!m&&c.indexOf("windows nt 10")>-1,isWindows7:!m&&c.indexOf("windows nt 6.1")>-1,isMobile:!!m,isIPad:v,areCSS3TransitionsSupported:!r||p>9,areTouchEventsSupported:"undefined"!=typeof window?"ontouchstart"in window:"undefined"!=typeof self&&"ontouchstart"in self,isFolderUploadSupported:w,isHtml5FileUploadSupported:R,isRetinaSupported:"undefined"!=typeof window?window.devicePixelRatio>1:!("undefined"==typeof self||!self.devicePixelRatio)&&self.devicePixelRatio>1,isUnlimitedStyleSheetsSupported:E,isWebDavSupported:b,userAgent:l};};t.PlatformDetection=n;},1226:function _(e,t,r){"use strict";function n(e){return!!e&&"function"==typeof e.addEventListener;}function i(e){return!!e&&!!e.__events__;}Object.defineProperty(t,"__esModule",{value:!0}),t.isDOMEventTarget=n,t.isEventTarget=i,t.declare=function(e,t){var r=e,n=r.__declaredEvents=r.__declaredEvents||{};if("string"==typeof t)n[t]=!0;else for(var i=0;i<t.length;i++){n[t[i]]=!0;}},t.raise=function(e,t,r,o){var a;if(n(e)){if(document.createEvent){var s=document.createEvent("HTMLEvents");s.initEvent(t,o,!0),s.args=r,a=e.dispatchEvent(s);}}else for(;e&&!1!==a;){if(i(e)){var u=e.__events__[t];for(var l in u){for(var c=u[l],d=0;!1!==a&&d<c.length;d++){var p=c[d];p.objectCallback&&(a=p.objectCallback.call(p.parent,r));}}e=o?e.parent:null;}else e=null;}return a;};},1227:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1031);function i(){}function o(e){n.default.log(e);}var a=function(){function e(e,t){void 0===t&&(t=o),this._isDisposed=!1,this._parent=e||null,this._onErrorHandler=t,this._timeoutIds=null,this._immediateIds=null,this._animationFrameIds=null,this._intervalIds=null;}return e.prototype.dispose=function(){if(!this._isDisposed){if(this._isDisposed=!0,this._parent=null,this._timeoutIds){for(var e=0,t=Object.keys(this._timeoutIds);e<t.length;e++){var r=t[e];this.clearTimeout(Number(r));}this._timeoutIds=null;}if(this._immediateIds){for(var n=0,i=Object.keys(this._immediateIds);n<i.length;n++){r=i[n];this.clearImmediate(Number(r));}this._immediateIds=null;}if(this._intervalIds){for(var o=0,a=Object.keys(this._intervalIds);o<a.length;o++){r=a[o];this.clearInterval(Number(r));}this._intervalIds=null;}if(this._animationFrameIds){for(var s=0,u=Object.keys(this._animationFrameIds);s<u.length;s++){r=u[s];this.cancelAnimationFrame(Number(r));}this._animationFrameIds=null;}}},e.prototype.setTimeout=function(e,t){var r=this,n=0;if(!this._isDisposed){var i=this._timeoutIds||(this._timeoutIds={}),o=this._parent;n=setTimeout(function(){try{delete i[n],e.apply(o);}catch(e){r._logError(e);}},t),i[n]=!0;}return n;},e.prototype.clearTimeout=function(e){var t=this._timeoutIds;t&&t[e]&&(clearTimeout(e),delete t[e]);},e.prototype.setImmediate=function(e){var t=this,r=0;if(!this._isDisposed){var n=this._immediateIds||(this._immediateIds={}),i=this._parent,o=function o(){try{delete n[r],e.apply(i);}catch(e){t._logError(e);}};r=window.setImmediate?window.setImmediate(o):window.setTimeout(o,0),n[r]=!0;}return r;},e.prototype.clearImmediate=function(e){var t=this._immediateIds;t&&t[e]&&(window.clearImmediate?window.clearImmediate(e):window.clearTimeout(e),delete t[e]);},e.prototype.setInterval=function(e,t){var r=this,n=0;if(!this._isDisposed){this._intervalIds||(this._intervalIds={});var i=this._parent;n=setInterval(function(){try{e.apply(i);}catch(e){r._logError(e);}},t),this._intervalIds[n]=!0;}return n;},e.prototype.clearInterval=function(e){this._intervalIds&&this._intervalIds[e]&&(clearInterval(e),delete this._intervalIds[e]);},e.prototype.throttle=function(e,t,r){var n=this;if(void 0===r&&(r={}),this._isDisposed)return i;var o,a,s=t||0,u=r.leading,l=void 0===u||u,c=r.trailing,d=void 0===c||c,p=0,h=null,f=this._parent,m=function m(t){var r=new Date().getTime(),i=r-p,u=l?s-i:s;return i>=s&&(!t||l)?(p=r,h&&(n.clearTimeout(h),h=null),o=e.apply(f,a)):null===h&&d&&(h=n.setTimeout(m,u)),o;};return function(){for(var e=[],t=0;t<arguments.length;t++){e[t]=arguments[t];}return a=e,m(!0);};},e.prototype.debounce=function(e,t,r){var n=this;if(void 0===r&&(r={}),this._isDisposed)return i;var o,a,s=t||0,u=r.leading,l=void 0!==u&&u,c=r.trailing,d=void 0===c||c,p=r.maxWait,h=void 0===p?NaN:p,f=0,m=new Date().getTime(),_=null,g=this._parent,v=function v(t){var r=new Date().getTime(),i=!1;t&&(l&&r-f>=s&&(i=!0),f=r);var u=r-f,c=s-u,p=r-m,y=!1;return isNaN(h)||(p>=h&&_?y=!0:c=Math.min(c,h-p)),u>=s||y||i?(_&&(n.clearTimeout(_),_=null),m=r,o=e.apply(g,a)):null!==_&&t||!d||(_=n.setTimeout(v,c)),o;};return function(){for(var e=[],t=0;t<arguments.length;t++){e[t]=arguments[t];}return a=e,v(!0);};},e.prototype.requestAnimationFrame=function(e){var t=this,r=0;if(!this._isDisposed){var n=this._animationFrameIds||(this._animationFrameIds={}),i=this._parent,o=function o(){try{delete n[r],e.apply(i);}catch(e){t._logError(e);}};r=window.requestAnimationFrame?window.requestAnimationFrame(o):window.setTimeout(o,0),n[r]=!0;}return r;},e.prototype.cancelAnimationFrame=function(e){var t=this._animationFrameIds;t&&t[e]&&(window.cancelAnimationFrame?window.cancelAnimationFrame(e):window.clearTimeout(e),delete t[e]);},e.prototype._logError=function(e){this._onErrorHandler&&this._onErrorHandler(e);},e;}();t.default=a;},1228:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(903),i=r(1231);t.CaughtError=n.createSingleEvent({eventName:"CaughtError,Trace,",shortEventName:"CaughtError",critical:!0,requiresParent:!1},{stack:1,extraData:4},i.Trace);},1229:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deepCopy=function(e){var t=[];return function e(r){var n=null;return r&&(n=Array.isArray(r)?[]:Object.create(Object.getPrototypeOf(r)),Object.keys(r).forEach(function(i){var o=r[i];if("object"==_typeof(o)){if(-1!==t.indexOf(o))throw new Error("Cannot perform DeepCopy() because a circular reference was encountered, object: "+r+", property: "+i);t.push(o),n[i]=e(o),t.pop();}else n[i]=o;})),n;}(e);};},1230:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.assign=function(e,t){return n.__assign(e,t);};},1231:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(903);t.Trace=n.createSingleEvent({eventName:"Trace,",shortEventName:"Trace",requiresParent:!1},{message:1});},1232:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1034),i=r(1229);t.deepCopy=i.deepCopy;var o=r(2617);t.deepCompare=o.deepCompare;var a=r(1033);t.safeSerialize=a.safeSerialize;var s=r(1230);t.extend=s.assign,t.DEFAULT_DELIMITER="&",t.KEYVALUE_DELIMITER="=",t.serialize=function(e,r,i){return r=r||t.DEFAULT_DELIMITER,Object.keys(e).map(function(r){var o=e[r];return o=o?o.toString():"",i||(o=n.default.encodeURIComponent(o)),r+t.KEYVALUE_DELIMITER+o;}).join(r);};},1233:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(956),o=r(1032),a=r(957),s=r(955),u=r(1033);function l(e,t,r){var n={resultType:e};return t&&(n.resultCode=t),r&&(n.error=r),n;}var c=function(e){function t(t,r){return e.call(this,t,i.ClonedEventType.Start,r)||this;}return n.__extends(t,e),t.instrumentPromise=function(e,t,r,n,i,o,s){var c,d=new this(e,s);i&&d.setTimeout(i,o);try{c=t();}catch(e){throw d.end(l(a.ResultTypeEnum.Failure,"PromiseCreationFailed",e.toString())),e;}return c.then(function(e){var t;if(r)try{t=r(e);}catch(e){t=l(a.ResultTypeEnum.Failure,"GetSchemaException",e.toString());}else t=l(a.ResultTypeEnum.Success);d.end(t);},function(e){var t;if(n)try{t=n(e);}catch(e){t=l(a.ResultTypeEnum.Failure,"GetSchemaException",e.toString());}else if(e){t=l(e instanceof Error&&"Canceled"===e.name?a.ResultTypeEnum.ExpectedFailure:a.ResultTypeEnum.Failure,void 0,u.safeSerialize(e));}else t=l(a.ResultTypeEnum.Failure);d.end(t);}),c;},t.prototype.setTimeout=function(e,t){this._clearTimeout(),t||(t=l(a.ResultTypeEnum.Failure,"Timeout")),this.timeoutId=window.setTimeout(this.end.bind(this,t),e);},t.prototype.verbose=function(e){if(!this.endTime&&this._isQosEvent()){var t=this.data;s.verbose(e,t.name);}},t.prototype.end=function(e){if(!this.endTime){if(e&&this._setData(e),this.endTime=o.Manager.getTime(),this._logEvent(i.ClonedEventType.End),this._isQosEvent()){var t=this.data;t.error&&s.log(t.error,t.name,t.resultCode,t.resultType);}this._clearTimeout();}},t.prototype._clearTimeout=function(){this.timeoutId&&(window.clearTimeout(this.timeoutId),this.timeoutId=void 0);},t.prototype._isQosEvent=function(){return this.eventName.indexOf("Qos,")>=0;},t;}(i.EventBase);t.createPairedEvent=function(e,t,r){var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this;}return n.__extends(t,e),t;}(c);return i.addEventProps(o.prototype,e,t,r),o;};},1234:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(0).__exportStar(r(1036),t);var n=r(1036);t.default=n.Qos;},1235:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.invalidate=function(t){"undefined"!=typeof window&&(e.isRightToLeft=window.document&&"rtl"===document.documentElement.getAttribute("dir"),e.safeLeft=e.isRightToLeft?"right":"left",e.safeRight=e.isRightToLeft?"left":"right",t=t||window._spPageContextInfo&&window._spPageContextInfo.currentUICultureName,e.language=t||window.document&&(document.documentElement.getAttribute("lang")||document.documentElement.getAttribute("xml:lang"))||"en-us");},e;}();n.invalidate(),t.default=n;},1236:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e){function t(t,r){var i=this,o=r.response,a=(void 0===o?{}:o).error,s=(void 0===a?{}:a).innerError,u=(void 0===s?{}:s).stackTrace,l=void 0===u?"":u,c=r.response,d=r.request,p=r.status,h=r.code,f=void 0===h?m(c,p,function(e){return""+e;})||"unhandled":h,_=n.__assign({innerError:t,code:f},r);return(i=e.call(this,_)||this).name="GraphError",i.response=c,i.status=p,i.serverStack=l,i.request=d,i.error=t,i;}return n.__extends(t,e),t;}(r(959).ApiError);t.GraphError=i;var o="errorMessage",a="vroomStatus",s="vroomErrorCode",u="vroomErrorMessage",l="vroomErrorInnerCode",c="vroomErrorInnerMessage",d="vroomErrorInnerDebugMessage",p="vroomErrorInnerStack";function h(e){return e instanceof i;}function f(e,t){if(h(e))return m(e.response,e.status,function(r){return t(r,e);});}function m(e,t,r){if(e){for(var n=[],i=e.error;i;){n.push(i),i=i.innerError||i.innererror;}for(;i=n.pop();){if(void 0!==i.code){var o=r(i.code);if(void 0!==o)return o;}}}return r(t);}t.getQosExtraDataFromError=function(e){var t={};if(t[o]=e.message,h(e)){t[a]=e.status;var r=e.response;if(r&&r.error){var n=r.error;t[s]=n.code,t[u]=n.message;var i=n.innerError||n.innererror;i&&(t[l]=i.code,t[c]=i.message,t[d]=i.debugMessage,t[p]=i.stackTrace);}}return t;},t.isGraphError=h,t.getErrorResolution=f,t.getResultCodeFromError=function(e){return f(e,function(e){return""+e;})||"unhandled";},t.getErrorResolutionFromResponse=m;},1237:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2621);t.UpdatePermissionsRole=n.UpdatePermissionsRole;var i=r(2622);t.SharingLinkKind=i.SharingLinkKind;var o=r(2623);t.SharingLinkType=o.SharingLinkType;var a=r(2624);t.SharingInfoType=a.SharingInfoType;var s=r(2625);t.SharingRole=s.SharingRole;var u=r(2626);t.AccessStatus=u.AccessStatus;var l=r(2627);t.ClientId=l.default;var c=r(2628);t.Error=c.default,t.Category=c.Category;var d=r(2629);t.Mode=d.default;var p=r(2630);t.SharePermission=p.default;var h=r(2631);t.SharingAudience=h.default;var f=r(2632);t.SharingAudienceTemplates=f.SharingAudienceTemplates;var m=r(2633);t.SharingRoleV3=m.SharingRoleV3;},1238:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(2634),o=r(1244),a=r(2639),s=r(2640),u=r(2641),l=r(2654),c=r(1237),d=r(2656),p=r(2657),h=r(2658),f=r(2660);t.EDIT_ROLE="role:1073741827",t.VIEW_ROLE="role:1073741826",t.UseShareLinkTemplates={ODB:1205};var m=function(e){function r(t,r){void 0===r&&(r={pageContext:t.pageContext});var n=e.call(this,{dataSourceName:"SharingDataSource"},r)||this;n._getParentListId=t.getParentListId,n._itemUrlHelper=t.itemUrlHelper||new o.ItemUrlHelper({},{pageContext:t.pageContext}),n._apiUrlHelper=t.apiUrlHelper||new s.ApiUrlHelper({},{pageContext:t.pageContext,itemUrlHelper:n._itemUrlHelper}),n._sharingContextInformation=t.sharingContextInformation||void 0,n._sharingDataSourceHelper=new h.default({itemUrlHelper:n._itemUrlHelper,sharingContextInformation:n._sharingContextInformation,isItemUrlEncoded:t.isItemUrlEncoded});var i=d.getSafeWebServerRelativeUrl(n._pageContext);return n._shareUrl=i+"/_api/SP.Web.ShareObject",n;}return n.__extends(r,e),r.parsePeople=function(e){return e.map(function(e){var t={role:r.parseSharingRole(e.CurrentRole),statusCode:Number(!e.Status),errorMessage:e.Message||null};return{name:e.DisplayName,email:e.Email,userId:e.UserId,sharingInfo:t};});},r.parseSharingRole=function(e){switch(e){case 0:return 5;case 1:return 1;case 2:return 2;case 6:return 6;default:return 1;}},r.prototype.getSharingInformation=function(e,r,n,i){var o,a=this,s=(i=i||this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e,this._getParentListId(e))).segment("GetSharingInformation");if(l.default.isFeatureEnabled(t.UseShareLinkTemplates)){var u="pickerSettings";r&&(u+=",permissionsInformation"),n&&(u+=",sharingLinkTemplates"),o=s.oDataParameter("$Expand",u).toString();}else o=r?s.oDataParameter("$Expand","permissionsInformation,pickerSettings").toString():s.oDataParameter("$Expand","pickerSettings").toString();return this.getData(function(){return o;},function(t){var r=JSON.parse(t);return a._parseGetSharingInformationResponse(r,e);},"GetSharingInformation",null,"POST",null,null,null,!0,void 0,void 0,void 0,this._getExtraData());},r.prototype.emailWithoutPermissioning=function(e,t,n,i){var o=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("ForwardObjectLink").toString();return this.getData(function(){return o;},function(e){var n=JSON.parse(e).d,i=[];n.UniquelyPermissionedUsers&&n.UniquelyPermissionedUsers.results&&(i=n.UniquelyPermissionedUsers.results);var o=[];n.InvitedUsers&&n.InvitedUsers.results&&(o=n.InvitedUsers.results);var a={};if(a.statusCode=n.StatusCode,a.errorMessage=n.ErrorMessage,a.people=r.parsePeople(i),a.invitedUsers=r.parsePeople(o),a.itemId=t&&t.id,o.length>0&&(a.invitationLink=o[0].InvitationLink),a.invalidEmails=[],n.UsersWithInvalidEmails&&n.UsersWithInvalidEmails.results)for(var s=0,u=n.UsersWithInvalidEmails.results;s<u.length;s++){var l=u[s];a.invalidEmails.push(l.User);}return a;},"ForwardObjectLink",function(){for(var t=[],r=0,o=e;r<o.length;r++){var a=o[r];t.push(a.rawPersonData);}var s={peoplePickerInput:JSON.stringify(t),emailBody:n,emailSubject:i};return JSON.stringify(s);});},r.prototype.checkPermissions=function(e,t){var r=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("CheckPermissions").toString();return this.getData(function(){return r;},function(e){var t=JSON.parse(e);return t.d?t.d.CheckPermissions.results:null;},"CheckPermissions",function(){var t={recipients:e};return JSON.stringify(t);});},r.prototype.share=function(e,n){var i,o=this,a=!!this._sharingContextInformation||this._sharingDataSourceHelper.canUseSecurable(n.items[0]);if(9===n.linkType||6===n.linkType||5===n.linkType)return this._shareLink(e,n);if(a){var s=n.items[0],u=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,s,this._getParentListId(s));i=u.segment("ShareObject").toString();}else i=this._shareUrl;return this.getData(function(){return i;},function(e){var t=JSON.parse(e).d,i=[];t.UniquelyPermissionedUsers&&t.UniquelyPermissionedUsers.results&&(i=t.UniquelyPermissionedUsers.results);var o=[];t.InvitedUsers&&t.InvitedUsers.results&&(o=t.InvitedUsers.results);var a={};if(a.statusCode=t.StatusCode,a.errorMessage=t.ErrorMessage,a.people=r.parsePeople(i),a.invitedUsers=r.parsePeople(o),a.itemId=n.items[0]&&n.items[0].id,o.length>0&&(a.invitationLink=o[0].InvitationLink),a.invalidEmails=[],t.UsersWithInvalidEmails&&t.UsersWithInvalidEmails.results)for(var s=0,u=t.UsersWithInvalidEmails.results;s<u.length;s++){var l=u[s];a.invalidEmails.push(l.User);}return a;},"Share",function(){for(var r=[],i=0;i<e.length;i++){var s=e[i];r.push(s.rawPersonData);}n.roleValue===2..toString()?n.roleValue=t.EDIT_ROLE:n.roleValue===1..toString()&&(n.roleValue=t.VIEW_ROLE);var u={peoplePickerInput:JSON.stringify(r),roleValue:n.roleValue,sendEmail:n.sendEmail,emailBody:n.message,emailSubject:n.subject,includeAnonymousLinkInEmail:!n.requireSignIn,propagateAcl:n.propagateSharing,useSimplifiedRoles:!0};return a||(u.url=o._sharingDataSourceHelper.getFileUrl(n.items[0])),JSON.stringify(u);});},r.prototype.updatePermissions2=function(e,t,r){var n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return n;},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole}:null;},"UpdatePermissions2",function(){var t;switch(r){case 0:t=0;break;case 1:t=1;break;case 6:t=6;break;case 2:t=2;break;default:t=1;}var n={userRoleAssignments:[{UserId:e.loginName,Role:t}],validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(n);});},r.prototype.updatePermissionsMultiple=function(e,t,r,n,i){var o=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,t,this._getParentListId(t)).segment("UpdateDocumentSharingInfo").toString();return this.getData(function(){return o;},function(e){var t=JSON.parse(e).d;return t?{role:t.UpdateDocumentSharingInfo.results[0].CurrentRole,success:t.UpdateDocumentSharingInfo.results.map(function(e){return e.Status;}).reduce(function(e,t){return e&&t;},!0)}:null;},"UpdatePermissionsMultiple",function(){var t;switch(r){case 0:t=0;break;case 1:t=1;break;case 6:t=6;break;case 2:t=2;break;default:t=1;}var o={userRoleAssignments:e.map(function(e){return{UserId:e.userId,Role:t};}),validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:n,customMessage:i,includeAnonymousLinksInNotification:!1,propagateAcl:!0};return JSON.stringify(o);});},r.prototype.parseRawSharingInformation=function(e){return this._parseGetSharingInformationResponse(e,void 0);},r.prototype.unshareLink=function(e){var t=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.item,this._getParentListId(e.item)).segment("UnshareLink").toString();return this.getData(function(){return t;},function(e){return!!JSON.parse(e).d;},"UnshareLink",function(){var t={linkKind:e.kind,shareId:e.shareId};return JSON.stringify(t);});},r.prototype.shareLink=function(e){var t=e.settings,r=e.items[0],n=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,e.items[0],this._getParentListId(r)).segment("ShareLink").toString();return this.getData(function(){return n;},function(e){var t=JSON.parse(e);return t.d?_(t):t.error?{error:5,errorMessage:t.error.message}:void 0;},"ShareLink",function(){var r=null;t.expiration&&(r=i.convertDateToISOString(t.expiration.toString()));var n=null;if(e.recipients&&e.recipients.length>0){n=[];for(var o=0,a=e.recipients;o<a.length;o++){var s=a[o];s.rawPersonData&&n.push(s.rawPersonData);}}var u=null;if(t.inviteesToRemove&&t.inviteesToRemove.length>0){u=[];for(var l=0,c=t.inviteesToRemove;l<c.length;l++){var d=c[l];u.push({id:d.id,loginName:d.loginName,name:d.primaryText,isExternal:d.isExternal,principalType:d.type,email:d.email});}}var p={request:{createLink:!0,settings:{allowAnonymousAccess:t.allowAnonymousAccess,linkKind:t.sharingLinkKind,expiration:r,role:t.role,restrictShareMembership:t.restrictShareMembership,updatePassword:t.updatePassword,password:t.password,shareId:t.shareId}}};if(u&&(p.request.settings.inviteesToRemove={results:u}),n&&n.length>0){p.request.peoplePickerInput=JSON.stringify(n);var h=e.emailData,f=e.emailSubject;void 0!==h&&void 0===f&&(p.request.emailData={body:e.emailData,subject:""}),void 0===h&&void 0!==f&&(p.request.emailData={body:"",subject:e.emailSubject}),void 0!==h&&void 0!==f&&(p.request.emailData={body:e.emailData,subject:e.emailSubject});}var m=e.settings.shareId;return m&&(p.request.settings.shareId=m,p.request.emailData={body:""}),JSON.stringify(p);},"POST",null,null,null,!0,void 0,void 0,void 0,this._getExtraData()).catch(function(e){var t="";try{t=JSON.stringify(e);}catch(e){}return{error:5,debugErrorMessage:t};});},r.prototype.getClientId=function(){switch(Number(this._pageContext.webTemplate)){case f.default.teamSite:case f.default.group:case f.default.subgroup:case f.default.sitePagePublishing:return c.ClientId.sharePoint;case f.default.mySite:return c.ClientId.odb;default:return c.ClientId.unknown;}},r.prototype._shareLink=function(e,t){var r=this,n=t.items[0],o=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,n,this._getParentListId(n)).segment("ShareLink").toString();return this.getData(function(){return o;},function(r){return{statusCode:0,errorMessage:"",people:e,itemId:t.items[0].id};},"ShareLink",function(){for(var n=[],o=0,a=e;o<a.length;o++){var s=a[o];n.push(s.rawPersonData);}var u=null;t.expiration&&(u=i.convertDateToISOString(t.expiration));var l={request:{peoplePickerInput:JSON.stringify(n),emailData:{body:t.message,subject:t.subject},linkKind:r._getSharingLinkKind(t.linkType,t.roleValue),createLink:!0,expiration:u}};return JSON.stringify(l);});},r.prototype._getSharingLinkKind=function(e,t){var r=1;return 6===e?r=5:5===e?r=4:9===e&&(r=t===2..toString()?3:2),r;},r.prototype._parseGetSharingInformationResponse=function(e,t){if(e.error)return{error:5,anonymousLinkExpirationRestrictionDays:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,isShared:void 0,item:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,userRole:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0};var r=e.d,n=!!r.permissionsInformation,i=!!r.sharingLinkTemplates,o=n?this._parseSharingLinks(r.permissionsInformation.links.results,r.directUrl):[],a=i?this._parseSharingLinkTemplates(r.sharingLinkTemplates.templates.results):[],s=n?r.permissionsInformation.siteAdmins.results.concat(r.permissionsInformation.principals.results):[],u=this._parseSharingPrincipals(s),l=this._getDefaultSharingLink(r.defaultLinkKind,o,r.sharingAbilities),d={name:this._sharingContextInformation?this._sharingContextInformation.itemName:void 0,childCount:this._sharingContextInformation?this._sharingContextInformation.itemCount:void 0,hasDlpPolicy:this._sharingContextInformation?this._sharingContextInformation.hasDlpPolicy:void 0,appmap:this._sharingContextInformation?this._sharingContextInformation.itemAppmap:void 0};if(t){var h=t.properties,f=h.ItemChildCount?parseInt(h.ItemChildCount,10):0,m=h.FolderChildCount?parseInt(h.FolderChildCount,10):0,_=t.type===p.default.OneNote?0:f+m,g=this._isPolicyTipFlagSet(t.policyTip,4);d={name:t.name,childCount:_,hasDlpPolicy:g,appmap:t.appMap};}var v=r.canRequestAccessForGrantAccess||r.canAddInternalPrincipal||o.length>1;return{anonymousLinkExpirationRestrictionDays:0===r.anonymousLinkExpirationRestrictionDays?-1:r.anonymousLinkExpirationRestrictionDays,canAddExternalPrincipal:r.canAddExternalPrincipal,canAddInternalPrincipal:r.canAddInternalPrincipal,canManagePermissions:v,defaultSharingLink:l,isShared:this._computeIsShared(o,u),item:d,sharingLinks:o,sharingPrincipals:u,peoplePickerSettings:r.pickerSettings,userDisplayName:this._pageContext.userDisplayName,blockPeoplePickerAndSharing:r.blockPeoplePickerAndSharing,requiresAccessApproval:!r.canAddInternalPrincipal&&r.canRequestAccessForGrantAccess,userRole:r.currentRole,defaultShareLinkPermission:r.defaultShareLinkPermission,sharingAbilities:r.sharingAbilities,defaultLinkKind:r.defaultLinkKind,directLink:{allowsAnonymousAccess:!1,audience:c.SharingAudience.existing,expiration:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:1,url:r.directUrl,updatePassword:!1,password:"",passwordLastModifiedBy:null},hasPermissionsInformation:!!r.permissionsInformation,sharingLinkTemplates:a,webTemplateId:r.webTemplateId,itemUniqueId:r.itemUniqueId,customizedExternalSharingServiceUrl:r.customizedExternalSharingServiceUrl||""};},r.prototype._computeIsShared=function(e,t){for(var r=!1,n=0,i=e;n<i.length;n++){var o=i[n];o.isActive&&1!==o.sharingLinkKind&&(r=!0);}return r||(r=t.length>0),r;},r.prototype._parseSharingLinks=function(e,t){var r=this,n=(e=e.filter(function(e){return!e.isInherited;})).map(function(e){var t=e.linkDetails;return{allowsAnonymousAccess:t.AllowsAnonymousAccess,hasPassword:t.RequiresPassword,blockDownload:t.BlocksDownload,audience:g(t.LinkKind,t.AllowsAnonymousAccess,t.RestrictedShareMembership),expiration:t.Expiration?new Date(t.Expiration):null,isActive:t.IsActive,isEdit:v(t.LinkKind)||t.IsEditLink,isReview:t.IsReviewLink,principals:r._parseSharingPrincipals(e.linkMembers.results,t.LinkKind),invitees:r._parseLinkInvitees(t),shareId:t.ShareId,sharingLinkKind:t.LinkKind,url:t.Url,updatePassword:t.UpdatePassword,password:t.Password,passwordLastModifiedBy:r._parseSharingPrincipal(t.PasswordLastModifiedBy),isCreateOnlyLink:t.IsCreateOnlyLink};});return n.push({allowsAnonymousAccess:!1,audience:c.SharingAudience.specificPeople,expiration:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:1,url:t,updatePassword:!1,password:"",passwordLastModifiedBy:null}),n;},r.prototype._parseSharingLinkTemplates=function(e){var t=this;return e.map(function(e){var r,n=e.linkDetails;return null!==n&&(r={allowsAnonymousAccess:n.AllowsAnonymousAccess,hasPassword:n.RequiresPassword,blockDownload:n.BlocksDownload,audience:g(n.LinkKind,n.AllowsAnonymousAccess,n.RestrictedShareMembership),expiration:n.Expiration?new Date(n.Expiration):null,isActive:n.IsActive,isEdit:v(n.LinkKind)||n.IsEditLink,isReview:n.IsReviewLink,principals:void 0,invitees:t._parseLinkInvitees(n),shareId:n.ShareId,sharingLinkKind:n.LinkKind,url:n.Url,updatePassword:n.UpdatePassword,password:n.Password,passwordLastModifiedBy:t._parseSharingPrincipal(n.PasswordLastModifiedBy)}),{linkDetails:r,passwordProtected:e.passwordProtected,role:e.role,scope:e.scope,shareKind:e.shareKind};});},r.prototype._parseLinkInvitees=function(e){var t=this,r=e.Invitations;if(!r)return[];for(var n=[],i=0,o=r.results;i<o.length;i++){var a=o[i];a&&a.invitee&&n.push(a.invitee);}return n.map(function(e){return{id:e.id,email:e.email,primaryText:e.name,isExternal:e.isExternal,loginName:e.loginName,role:null,secondaryText:e.jobTitle,type:e.principalType,imageUrl:t._getImageUrl(e.email)};});},r.prototype._parseSharingPrincipals=function(e,t){var r=this;return e.map(function(e){var n=e.principal;n||(n=e);var i={id:n.id,isExternal:n.isExternal,loginName:n.loginName,primaryText:n.name,role:e.role,secondaryText:n.jobTitle,type:n.principalType,imageUrl:r._getImageUrl(n.email),email:n.email};return t&&(i.sharingLinkKind=t),i;});},r.prototype._getExtraData=function(){var e;return this._sharingContextInformation&&(e={clientId:this._sharingContextInformation.clientId,mode:c.Mode[this._sharingContextInformation.mode]}),e;},r.prototype._parseSharingPrincipal=function(e){if(e){var t=e.principal;return t||(t=e),{id:t.id,isExternal:t.isExternal,loginName:t.loginName,primaryText:t.name,role:e.role,secondaryText:t.jobTitle,type:t.principalType,imageUrl:this._getImageUrl(t.email),email:t.email};}return null;},r.prototype._getDefaultSharingLink=function(e,t,r){(r.peopleSharingLinkAbilities.canManageEditLink.enabled||r.peopleSharingLinkAbilities.canManageReadLink.enabled)&&1===e&&(e=6);var n=e;return 5!==n||r.anonymousLinkAbilities.canManageEditLink.enabled||(n=4),4!==n||r.anonymousLinkAbilities.canManageReadLink.enabled||(n=3),3!==n||r.organizationLinkAbilities.canManageEditLink.enabled||(n=2),2!==n||r.organizationLinkAbilities.canManageReadLink.enabled||(n=1),{allowsAnonymousAccess:void 0,audience:void 0,expiration:void 0,isActive:!0,isEdit:void 0,principals:void 0,shareId:void 0,sharingLinkKind:n,url:void 0,invitees:void 0,updatePassword:!1,password:"",passwordLastModifiedBy:void 0};},r.prototype._getImageUrl=function(e){if(e&&this._sharingContextInformation){var t=this._sharingContextInformation&&this._sharingContextInformation.clientId;return"word"===t||"powerpoint"===t||"excel"===t?null:e&&this._sharingContextInformation?this._sharingContextInformation.webAbsoluteUrl+a.getUserPhotoUrl({userLoginName:e}):null;}return e&&this._pageContext?d.getSafeWebServerRelativeUrl(this._pageContext)+a.getUserPhotoUrl({userLoginName:e}):null;},r.prototype._isPolicyTipFlagSet=function(e,t){return e&&(e&t)===t;},r;}(u.default);function _(e){if(e.d){var t=e.d.ShareLink.sharingLinkInfo,r=t.Expiration?new Date(t.Expiration):void 0;return{link:{allowsAnonymousAccess:t.AllowsAnonymousAccess,audience:g(t.LinkKind,t.AllowsAnonymousAccess,t.RestrictedShareMembership),expiration:r,isActive:t.IsActive,isEdit:v(t.LinkKind)||t.IsEditLink,principals:null,invitees:null,shareId:t.ShareId,sharingLinkKind:t.LinkKind,url:t.Url,updatePassword:t.UpdatePassword,password:t.Password,passwordLastModifiedBy:t.PasswordLastModifiedBy}};}}function g(e,t,r){return 5===e||4===e?c.SharingAudience.anyone:3===e||2===e?c.SharingAudience.organization:1===e?c.SharingAudience.specificPeople:6===e?t?c.SharingAudience.anyone:!1===r?c.SharingAudience.organization:c.SharingAudience.specificPeopleFlex:void 0;}function v(e){return 5===e||3===e||4!==e&&2!==e&&null;}t.SharingDataSource=m,t.parseSharingLinkInfo=_;},1239:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i,o,a,s=r(1240),u=!1;function l(){n=window.PageContext;var e=window.Flight;i=e&&e.Ramps,o=window.FilesConfig;var t=window.Flighting,r=window._spPageContextInfo;!a&&r&&(!r.ExpFeatures&&t&&t.ExpFeatures&&(r.ExpFeatures=t.ExpFeatures),c.initSPExpFeatures(r.ExpFeatures)),u=!0;}var c=function(){function e(){}return e.initSPExpFeatures=function(e){a=e;},e.isFeatureEnabled=function(e){u||l();var t=!!e.Fallback,r=e.ODB,c=e.ODC,d=e.OneDrive;return void 0!==r&&a&&(t=s.isSPFeatureEnabled(e,a)),void 0!==c&&o&&("boolean"==typeof c?t=c:i&&i[c]?t=!0:o&&o[c]&&(t=!0)),d&&n&&(t=d),t;},e.On={Fallback:!0},e.Off={},e;}();t.default=c;},1240:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSPFeatureEnabled=function(e,t){var r=!!e.Fallback,n=e.ODB;if("boolean"==typeof n)r=n;else if(n>0){var i=Math.floor(n/32),o=1<<n%32;r=i<t.length&&0!=(t[i]&o);}return r;};},1241:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(2636),t),n.__exportStar(r(1242),t),n.__exportStar(r(1243),t),n.__exportStar(r(2637),t),n.__exportStar(r(2638),t);},1242:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(865),i=r(1243),o=r(1039);function a(e,t,r){void 0===r&&(r=!1);var n=Date.now()-e.getTime();if(n<-5*i.ONE_MINUTE)return e.toLocaleDateString(t);if(n<i.ONE_MINUTE)return s("LessThanAMinute",r);if(n<i.TWO_MINUTES)return s("AboutAMinute",r);if(n<i.ONE_HOUR)return u(Math.floor(n/i.ONE_MINUTE),"XMinutes");if(n<i.TWO_HOURS)return s("AboutAnHour",r);if(n<i.ONE_DAY)return u(Math.floor(n/i.ONE_HOUR),"XHours");if(n<i.TWO_DAYS){var o=e.toLocaleTimeString(t);return s("YesterdayAndTime",r).replace("{0}",o);}return n<i.ONE_MONTH?u(Math.floor(n/i.ONE_DAY),"XDays"):e.toLocaleDateString(t);}function s(e,t,r,n){return o.default[["RelativeDateTime_",e,r?"Future":"",n?"Intervals":"",t?"_StartWithLowerCase":""].join("")];}function u(e,t,r,i){var o=s(t,!!i&&r,i),a=s(t,!1,i,!0);return(n.getLocalizedCountValue(o,a,e)||"").replace("{0}",e+"");}t.getRelativeDateTimeStringPast=a,t.getRelativeDateTimeStringPastWithHourMinute=function(e,t){var r=Date.now()-e.getTime(),s=e.toLocaleDateString(t),u=e.toLocaleTimeString(t,{hour:"numeric",minute:"2-digit"});return r<i.ONE_DAY?a(e,t):r<i.TWO_DAYS?n.format(o.default.RelativeDateTime_YesterdayAndTime,u):n.format(o.default.DateTime_DateAndTime,s,u);},t.getRelativeDateTimeResx=s,t.getRelativeDateTimeIntervalString=u;},1243:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_SECOND=1e3,t.ONE_MINUTE=60*t.ONE_SECOND,t.TWO_MINUTES=2*t.ONE_MINUTE,t.ONE_HOUR=60*t.ONE_MINUTE,t.TWO_HOURS=2*t.ONE_HOUR,t.ONE_DAY=24*t.ONE_HOUR,t.TWO_DAYS=2*t.ONE_DAY,t.ONE_WEEK=7*t.ONE_DAY,t.ONE_MONTH=32*t.ONE_DAY,t.isSameDay=function(e,r){return e.getDate()===r.getDate()&&Math.abs(r.getTime()-e.getTime())<t.ONE_DAY;},t.isSameMonth=function(e,t){return e.getFullYear()===t.getFullYear()&&t.getMonth()===e.getMonth();},t.isSameYear=function(e,t){return e.getFullYear()===t.getFullYear();},t.isThisWeek=function(e,r){r=r||new Date();var n=new Date(r.getTime()-r.getDay()*t.ONE_DAY),i=new Date(n.getTime()+t.ONE_WEEK-t.ONE_DAY);return n.getTime()<=e.getTime()&&e.getTime()<=i.getTime();},t.isLastWeek=function(e,r){r=r||new Date();var n=new Date(r.getTime()-r.getDay()*t.ONE_DAY-t.ONE_WEEK),i=new Date(n.getTime()+t.ONE_WEEK-t.ONE_DAY);return n.getTime()<=e.getTime()&&e.getTime()<=i.getTime();},t.getLastDayOfMonth=function(e){var t=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),1,0,0,0,0));return t.setUTCMonth(t.getUTCMonth()+1),t.setUTCDate(t.getUTCDate()-1),t.setUTCHours(23,59,59,999),t;},t.toLocaleDateString=function(e,t,r){if(e)try{return e.toLocaleDateString(t,r);}catch(t){return e.toLocaleDateString([],r);}},t.toLocaleTimeString=function(e,t,r){if(e)try{return e.toLocaleTimeString(t,r);}catch(t){return e.toLocaleTimeString([],r);}};},1244:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1040),o=r(958),a=r(1245),s=r(1246);n.__exportStar(r(1245),t);var u;!function(e){e[e.sameSite=0]="sameSite",e[e.crossSite=1]="crossSite",e[e.unknown=2]="unknown";}(u=t.SiteRelation||(t.SiteRelation={}));var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this;}return n.__extends(t,e),Object.defineProperty(t.prototype,"isCrossDomain",{get:function get(){return this._getIsCrossDomain();},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isCrossList",{get:function get(){return this._getIsCrossList();},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"siteRelation",{get:function get(){return this._getSiteRelation();},enumerable:!0,configurable:!0}),t.prototype._getIsCrossDomain=function(){var e=this._getCurrentAuthority(),t=!o.equalsCaseInsensitive(new i.default(this._getServerUrl()).authority,e);return this._getIsCrossDomain=function(){return t;},t;},t.prototype._getIsCrossList=function(){var e=this._getFullListUrl(),t=this._getDefaultListUrl(),r=!o.equalsCaseInsensitive(e,t);return this._getIsCrossList=function(){return r;},r;},t.prototype._getSiteRelation=function(){var e=u.unknown;if(this._getIsCrossDomain())e=u.crossSite;else if(void 0!==this.webUrl)e=o.equalsCaseInsensitive(a.removeDelimiter(this.defaultFullWebUrl),a.removeDelimiter(this._getFullWebUrl()))?u.sameSite:u.crossSite;else{var t=new i.default(this.defaultFullWebUrl).path,r=this._getServerRelativeListUrl()||this._getServerRelativePath();if(void 0!==r)if(a.startsWith(a.appendDelimiter(r),a.appendDelimiter(t))){var n=new i.default(a.removeDelimiter(r)),s=new i.default(a.removeDelimiter(t));e=n.segments.length-1===s.segments.length||n.segments.length-2===s.segments.length&&"Lists"===n.segments[n.segments.length-2]?u.sameSite:u.unknown;}else e=u.crossSite;}return this._getSiteRelation=function(){return e;},e;},t.prototype._getFullWebUrl=function(){var e,t=this._getServerUrl(),r=this._getServerRelativeWebUrl();return void 0!==r&&(e=""+t+r),this._getFullWebUrl=function(){return e;},e;},t;}(a.ItemUrlPartsBasic);t.ItemUrlParts=l;var c=function(e){function t(t,r){var n=r.itemUrlPartsType,i=void 0===n?l:n;return e.call(this,{context:r.pageContext,itemUrlPartsType:i})||this;}return n.__extends(t,e),t.prototype.getUrlParts=function(t){return e.prototype.getUrlParts.call(this,t);},t.prototype.getItemUrlParts=function(e){var t=s.deserializeQuery(e);return this.getUrlParts({path:t.id,listUrl:t.listurl});},t;}(a.ItemUrlHelperBasic);t.ItemUrlHelper=c;},1245:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1040),i=r(958),o=function(){function e(e){var t=e.defaultFullWebUrl,r=e.defaultListUrl,n=e.options,i=void 0===n?{}:n,o=i.path,a=void 0===o?void 0:o,u=i.listUrl,l=void 0===u?void 0:u,c=i.webUrl,d=void 0===c?void 0:c,p=i.mayInferListUrl,h=void 0!==p&&p;this.defaultFullWebUrl=s(t),this.defaultListUrl=s(r),this.path=s(a),this.listUrl=s(l),this.webUrl=s(d),this.mayInferListUrl=h;}return Object.defineProperty(e.prototype,"serverRelativeItemUrl",{get:function get(){return a(this._getServerRelativeItemUrl());},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serverRelativeListUrl",{get:function get(){return a(this._getServerRelativeListUrl());},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullListUrl",{get:function get(){return this._getFullListUrl();},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"normalizedListUrl",{get:function get(){return a(this._getNormalizedListUrl());},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullItemUrl",{get:function get(){return this._getFullItemUrl();},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"normalizedItemUrl",{get:function get(){return a(this._getNormalizedItemUrl());},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"listRelativeItemUrl",{get:function get(){return this._getListRelativeItemUrl();},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"webRelativeItemUrl",{get:function get(){return this._getWebRelativeItemUrl();},enumerable:!0,configurable:!0}),e.prototype._getCurrentAuthority=function(){var e=new n.default(this.defaultFullWebUrl).authority;return this._getCurrentAuthority=function(){return e;},e;},e.prototype._getNormalizedItemUrl=function(){var e,t=this._getFullItemUrl();if(void 0!==t){var r=new n.default(t);e=i.equalsCaseInsensitive(r.authority,this._getCurrentAuthority())?r.path:t;}return this._getNormalizedItemUrl=function(){return e;},e;},e.prototype._getNormalizedListUrl=function(){var e,t=this._getFullListUrl(),r=this._getDefaultListUrl();return void 0===t||i.equalsCaseInsensitive(t,r)||(e=i.equalsCaseInsensitive(new n.default(t).authority,this._getCurrentAuthority())?this._getServerRelativeListUrl():t),this._getNormalizedListUrl=function(){return e;},e;},e.prototype._getServerUrl=function(){var e=this.path&&new n.default(this.path).authority||this.listUrl&&new n.default(this.listUrl).authority||this.webUrl&&new n.default(this.webUrl).authority||this.defaultListUrl&&new n.default(this.defaultListUrl).authority||new n.default(this.defaultFullWebUrl).authority;return this._getServerUrl=function(){return e;},e;},e.prototype._getServerRelativeListUrl=function(){var e;if(void 0!==this.listUrl)e=new n.default(this.listUrl).path;else{var t=this._getDefaultListUrl(),r=this.mayInferListUrl;if(void 0!==t||r){var i=this._getServerRelativePath(),o=new n.default(t).path;if(void 0===i&&(void 0===this.webUrl||o&&l(u(o),u(this._getServerRelativeWebUrl())))||o&&l(u(i),u(o)))e=o;else if(void 0!==i&&(""===this.defaultListUrl||r)){var a=this._getServerRelativeWebUrl();if(l(u(i),u(a))){var s=new n.default(i).segments[new n.default(a).segments.length];e=""+u(a)+s;}}}}return this._getServerRelativeListUrl=function(){return e;},e;},e.prototype._getFullListUrl=function(){var e,t=this._getServerUrl(),r=this._getServerRelativeListUrl();return void 0!==r&&(e=""+t+r),e;},e.prototype._getFullItemUrl=function(){var e,t=this._getServerUrl(),r=this._getServerRelativeItemUrl();return void 0!==r&&(e=""+t+r),this._getFullItemUrl=function(){return e;},e;},e.prototype._getServerRelativeWebUrl=function(){var e,t;if(void 0!==this.webUrl)e=new n.default(this.webUrl).path;else if(!this.defaultListUrl&&!this.listUrl||this.mayInferListUrl||void 0===(t=this._getServerRelativeListUrl()))this.defaultFullWebUrl&&(e=new n.default(this.defaultFullWebUrl).path);else{var r=new n.default(t);e=""+r.segments.slice(0,-1).join("/");}return this._getServerRelativeWebUrl=function(){return e;},e;},e.prototype._getServerRelativePath=function(){var e;return void 0!==this.path&&(e=new n.default(this.path).path),this._getServerRelativePath=function(){return e;},e;},e.prototype._getServerRelativeItemUrl=function(){var e;return this.path?e=this._getServerRelativePath():this.listUrl?e=this._getServerRelativeListUrl():this.webUrl?e=this._getServerRelativeWebUrl():this.defaultListUrl?e=this._getServerRelativeListUrl():this.defaultFullWebUrl&&(e=this._getServerRelativeWebUrl()),this._getServerRelativeItemUrl=function(){return e;},e;},e.prototype._getListRelativeItemUrl=function(){var e,t,r=this._getServerRelativePath(),n=this._getServerRelativeListUrl();return void 0!==this.path&&void 0!==n&&l(u(r),t=u(n))&&(e=r&&r.substring(t.length)),this._getListRelativeItemUrl=function(){return e;},e;},e.prototype._getWebRelativeItemUrl=function(){var e,t,r=this._getServerRelativePath(),n=this._getServerRelativeWebUrl();return void 0!==this.path&&void 0!==n&&l(u(r),t=u(n))&&(e=r&&r.substring(t.length)),this._getWebRelativeItemUrl=function(){return e;},e;},e.prototype._getDefaultListUrl=function(){var e;return void 0!==this.defaultListUrl&&(e=new n.default(this.defaultListUrl).authority?this.defaultListUrl:""+this._getCurrentAuthority()+this.defaultListUrl),this._getDefaultListUrl=function(){return e;},e;},e;}();function a(e){return""===e?"/":e;}function s(e){return"/"===e?"/":e;}function u(e){return void 0===e&&(e=""),"/"===e[e.length-1]?e:e+"/";}function l(e,t){var r=e.toUpperCase(),n=t&&t.toUpperCase();return r.substring(0,n&&n.length||0)===n;}t.ItemUrlPartsBasic=o,t.removeDelimiter=function(e){return void 0===e&&(e=""),"/"===e[e.length-1]?e.substring(0,e.length-1):e;},t.appendDelimiter=u,t.startsWith=l;var c=function(){function e(e){var t=e.context,r=e.itemUrlPartsType,n=void 0===r?o:r;this.itemUrlPartsType=n,this.itemUrlContext=t;}return e.prototype.getUrlParts=function(e){var t=this.itemUrlContext,r=t.webAbsoluteUrl,n=t.listUrl;return new this.itemUrlPartsType({defaultFullWebUrl:r,defaultListUrl:n,options:e});},e;}();t.ItemUrlHelperBasic=c;},1246:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deserializeQuery=function(e){var t={};if(e)for(var r=e.split("&"),n=0;n<r.length;n++){var i=r[n].split("=");void 0!==i[1]&&(i[1]=i[1].replace(/\+/g," "),t[i[0]]=decodeURIComponent(i[1]));}return t;},t.getQueryStringFromUrl=function(e){return e.substring(e.indexOf("?")+1);},t.getUrlWithoutQueryString=function(e){return e.substring(0,e.indexOf("?"));};},1247:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1034),o=function(){function e(e){this._webAbsoluteUrl=e.webAbsoluteUrl,this._encodeWebAbsoluteUrl=e.encodeWebAbsoluteUrl,this._segments=[],this._parameters=[],this._rawParameters=[],this._lastParameterId=0;}return e.prototype.toString=function(){var e,t=[];this._parameters.length&&t.push(this._parameters.map(function(e){return e.name+"="+e.serializedValue;}).join("&")),t.push.apply(t,this._rawParameters),e=t.length?"?"+t.join("&"):"";var r=this._webUrl,n=void 0===r?this._webAbsoluteUrl:r;return""+[this._encodeWebAbsoluteUrl?encodeURI(n):n,"_api"].concat(this._segments).join("/")+e;},e.prototype.segment=function(e){return this._extend({segments:[e]});},e.prototype.segments=function(){for(var e=[],t=0;t<arguments.length;t++){e[t]=arguments[t];}return this._extend({segments:e});},e.prototype.methodWithAliases=function(e,t){for(var r=this,n=[],i=0,o=Object.keys(t);i<o.length;i++){var a=o[i],s=t[a],u=r._autoParameter(s);r=u.apiUrl,n.push(a+"="+u.name);}return r.segment(e+"("+n.join(",")+")");},e.prototype.method=function(e){for(var t=[],r=1;r<arguments.length;r++){t[r-1]=arguments[r];}for(var n=this,i=[],o=0,a=t;o<a.length;o++){var s=a[o],u=n._autoParameter(s);n=u.apiUrl,i.push(u.name);}return n.segment(e+"("+i.join(",")+")");},e.prototype.parameter=function(e,t){return this._parameter(e,t);},e.prototype.parameters=function(e){for(var t=this,r=0,n=Object.keys(e);r<n.length;r++){var i=n[r],o=e[i];t=t.parameter(i,o);}return t;},e.prototype.oDataParameter=function(e,t){return this.parameter(e,{raw:t});},e.prototype.rawParameter=function(e){return this._extend({rawParameters:[e]});},e.prototype._autoParameter=function(e){var t=this._lastParameterId+1,r="@a"+t;return{name:r,apiUrl:this._extend({lastParameterId:t})._parameter(r,e)};},e.prototype._parameter=function(e,t){var r;return r=function(e){return!!e&&"object"==_typeof(e)&&"json"in e;}(t)?i.default.encodeRestUriStringToken(JSON.stringify(t.json)):function(e){return!!e&&"object"==_typeof(e)&&"guid"in e;}(t)?"guid'"+t.guid+"'":function(e){return!!e&&"object"==_typeof(e)&&"raw"in e;}(t)?t.raw:"number"==typeof t?""+t:"boolean"==typeof t?""+t:"'"+i.default.encodeRestUriStringToken(t)+"'",this._extend({parameters:[{name:e,serializedValue:r}]});},e.prototype.clone=function(){return new e({webAbsoluteUrl:this._webAbsoluteUrl,encodeWebAbsoluteUrl:this._encodeWebAbsoluteUrl});},e.prototype._extend=function(e){var t,r,n,i,o,a;void 0===e&&(e={});var s=this.clone();return s._webUrl=this._webUrl,s._lastParameterId=this._lastParameterId,(t=s._parameters).push.apply(t,this._parameters),(r=s._segments).push.apply(r,this._segments),(n=s._rawParameters).push.apply(n,this._rawParameters),"webUrl"in e&&(s._webUrl=e.webUrl),"lastParameterId"in e&&(s._lastParameterId=e.lastParameterId),"parameters"in e&&(i=s._parameters).push.apply(i,e.parameters),"rawParameters"in e&&(o=s._rawParameters).push.apply(o,e.rawParameters),"segments"in e&&(a=s._segments).push.apply(a,e.segments),s;},e;}();t.ApiUrlBasic=o;var a=function(){function e(e){this._apiUrlType=function(t){function r(){return t.call(this,{webAbsoluteUrl:e.webAbsoluteUrl,encodeWebAbsoluteUrl:e.encodeWebAbsoluteUrl})||this;}return n.__extends(r,t),r;}(o);}return e.prototype.build=function(){return new this._apiUrlType();},e.prototype.contextInfoUrl=function(e){var t,r=e.indexOf("/_layouts/");if(r>-1)t=e.substring(0,r);else{var n=e.lastIndexOf("/"),i=e.lastIndexOf(".");t=i>n?e.substring(0,i)+"_"+e.substring(i+1):e;}return t+"/_api/contextinfo";},e;}();t.ApiUrlHelperBasic=a;},1248:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(846),o=r(2642),a=r(1234),s=r(1035),u=r(1041),l=r(959),c=r(1040),d=r(2647),p=r(2653),h="undefined"!=typeof window?window:void 0;function f(e){return"object"==_typeof(e);}t.isQosEndSchemaOverride=f;var m=function(){function e(e,t){this._pageContext=t?t.pageContext:e.pageContext,this._qosName=e.qosName,this._apiEvent=t&&t.apiEvent||s.default,this._normalizeErrors=!!e.normalizeErrors;}return e.parseJSON=function(e){return e&&JSON.parse(e)||void 0;},e.prototype.getData=function(t){var r=this,s=t.url,m=t.parseResponse,_=void 0===m?e.parseJSON:m,g=t.qosExtraData,v=t.qosHandler,y=t.successQosHandler,S=t.customQosLogger,I=t.additionalPostData,T=void 0===I?"":I,E=t.contentType,b=t.method,w=void 0===b?"POST":b,R=t.maxRetries,D=void 0===R?0:R,P=t.responseType,C=t.onUploadProgress,A=t.timeout,U=t.authToken,O=t.noTimeoutInLastRetry,k=void 0!==O&&O,N=t.additionalHeaders,x=t.crossSiteCollectionCall,L=void 0!==x&&x,M=t.noRedirect,F=void 0!==M&&M,B=t.needsRequestDigest,W=void 0===B||B,V=!0,q=this._pageContext;return i.default.resolve(U||q&&(q.getAuthToken&&q.getAuthToken()||q.authToken)).then(function(e){if(e){var m="Bearer "+e;if(N){var I=!1;for(var b in N){b&&"authorization"===b.toLowerCase()&&(I=!0);}I||(N.Authorization=m);}else N={Authorization:m};L=!0,W=!1,F=!0;}var R=new d.default(n.__assign({},q?{webServerRelativeUrl:q.webServerRelativeUrl,webAbsoluteUrl:L?q.webAbsoluteUrl:void 0,formDigest:{serverTime:q.serverTime,updateFormDigestPageLoaded:q.updateFormDigestPageLoaded,formDigestValue:q.formDigestValue,formDigestTimeoutSeconds:q.formDigestTimeoutSeconds}}:{},{needsRequestDigest:W})),U=[];r._qosName&&U.push(r._qosName),t.qosName&&U.push(t.qosName);var O,x,M,B=U.join("."),j=function j(e){S&&S(e);},G=h&&h.location&&new c.SimpleUri(h.location.href).authority,z=new c.SimpleUri(s).authority,H=u.RUMOneLogger.getRUMOneLogger(),K=Date.now();return H&&(Boolean(H.readTempData("appDataFetchStart"))||H.saveTempData("appDataFetchStart",K)),function(e){var t,r=e.onExecute,n=e.onCancel,a=e.timeout,s=e.canRetry,u=e.noTimeoutInLastRetry,l=0,c=Math.max(e.maxRetries,0),d=function d(){var e=new i.default(r,function(){n(l>=c||!s());});return a&&(!u||l<c)?i.default.timeout(a,e):e;};t=l<c?o.default({canRetry:s,retries:c,callback:d,beforeRetry:function beforeRetry(){l++;}}):d();return t;}({timeout:A,onExecute:function onExecute(t,i){var o=function o(r){return function(o){var s,u=o.getResponseText();M=o.getServiceWorkerDataSourceHeader();var l=n.__assign({},g||{},{needsRequestDigest:W,hasAuthToken:!!e,isCrossOrigin:!!G&&G!==z,CorrelationId:o.getCorrelationId(),HttpStatus:o.getStatus(),serviceWorkerDataSource:M||void 0}),c=!1;try{var d=void 0;if(function(e,t){return"blob"===e&&t&&"object"==_typeof(t);}(P,u))s=u;else if(s=_(u,o),y){var p=y(s);d="string"==typeof p?{resultCode:p}:p;}c=!0;var h=n.__assign({resultType:a.ResultTypeEnum.Success,extraData:l},d||{});r.end(h),j(h);}catch(e){h={resultType:a.ResultTypeEnum.Failure,resultCode:"InvalidJSON",error:"object"==_typeof(e)?JSON.stringify(e):e,extraData:l};r.end(h),j(h),i();}if(c)try{t(s);}catch(e){}R=void 0;};},u=function u(t){return function(o,s){var u=n.__assign({},g||{},{needsRequestDigest:W,hasAuthToken:!!e,isCrossOrigin:!!G&&G!==z});if(!o){var c=void 0;if(O)c={resultType:a.ResultTypeEnum.ExpectedFailure,resultCode:"RequestAborted",extraData:u};else{var d="Unknown",h=!0,m=0;s&&s instanceof l.ApiError&&(d=s.code,h=s.isExpected,m=-1);var _={status:m,code:d};c={resultType:h?a.ResultTypeEnum.ExpectedFailure:a.ResultTypeEnum.Failure,resultCode:d,extraData:u},i(r._normalizeErrors?new p.GetDataError({errorData:_,innerError:s}):_);}return t.end(c),void j(c);}var y=o.getCorrelationId(),S=o.getGroupThrottle(),I=o.getMSCorrelationVector(),T=o.getStatus();u=n.__assign({},u,{CorrelationId:y,HttpStatus:T,GroupThrottle:S,MSCorrelationVector:I});var E=a.ResultTypeEnum.Failure,b="undefined"!=typeof navigator&&!1===navigator.onLine;(403===T||404===T||429===T||503===T||-1===T||0===T&&b)&&(V=!1,E=a.ResultTypeEnum.ExpectedFailure);var w=function w(e){var s=void 0;if("object"==_typeof(e)&&"number"==typeof e.status)s=e;else if("string"==typeof e){var l=void 0;try{l=JSON.parse(e);}catch(e){}l&&(s="string"==typeof l.error?l.error_description?{code:"-1,"+l.error,message:l.error_description}:{message:l.error}:l.error||l["odata.error"]||{responseData:l});}(s=s||{}).status=T;var c=s["@error.redirectUrl"],d=o.getRedirectUrl()||c;d&&(E=a.ResultTypeEnum.ExpectedFailure),s.redirectUrl=d,y&&(s.correlationId=y),S&&(s.groupThrottle=S);var h,m="["+T.toString()+"] "+(s.code||"Unknown");if(v){var _=v(s);f(_)?h=_:m=_,500!==T||"DefaultDoclibNotFound"!==m&&"PrefetchWebMismatch"!==m||(V=!1,E=a.ResultTypeEnum.ExpectedFailure);}var g=JSON.stringify(s),I=n.__assign({resultType:E,error:g,resultCode:m,extraData:u},h||{});t.end(I),j(I),i(r._normalizeErrors?new p.GetDataError(n.__assign({errorData:s},E===a.ResultTypeEnum.ExpectedFailure?{isExpected:!0}:{})):s);},R=o.getResponseType();R&&"text"!==R?o.parseError().then(w):w(o.getResponseText());};};(function(){var t=x=new r._apiEvent({url:s,name:B});R.getServerDataFromUrl({url:s,successCallback:o(t),failureCallback:u(t),uploadProgressCallback:C,additionalPostData:T,method:w,additionalHeaders:N,contentType:E,withCredentials:!e&&void 0,noRedirect:F,responseType:P,needsRequestDigest:W});})();},maxRetries:D,noTimeoutInLastRetry:k,canRetry:function canRetry(){return V;},onCancel:function onCancel(e){O=!0,R&&(R.abort(),e&&R.dispose());}}).then(function(e){return R&&R.dispose(),e;},function(e){return R&&R.dispose(),!x.endTime&&i.default.isCanceled(e)&&x.end({resultCode:"PromiseCanceled",resultType:a.ResultTypeEnum.ExpectedFailure}),i.default.reject(e);});});},e;}();t.DataRequestor=m,t.default=m;},1249:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(903);t.RUMOneDataUpload=n.createSingleEvent({eventName:"RUMOneDataUpload,",shortEventName:"RUMOneDataUpload"},{streamName:1,dictionary:4});},1250:function _(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.none=0]="none",e[e.session=1]="session",e[e.local=2]="local",e[e.sharedMemory=3]="sharedMemory";}(n||(n={})),t.default=n;},1251:function _(e,t,r){"use strict";function n(e,t){void 0===t&&(t=!1);var r="";if(e){var n=e.lastIndexOf(".");n>=0&&(r=t?e.substr(n+1):e.substr(n));}return r;}Object.defineProperty(t,"__esModule",{value:!0}),t.splitFileName=function(e){var t=n(e);return{name:t?e.substring(0,e.length-t.length):e,extension:t};},t.getFileExtension=n,t.encodePath=function(e,t){return void 0===t&&(t=!0),e=encodeURI(e),t&&e&&(e=e.replace(/#/g,"%23")),e;};},1252:function _(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.invalid=-1]="invalid",e[e.teamSite=1]="teamSite",e[e.meetings=2]="meetings",e[e.centralAdmin=3]="centralAdmin",e[e.wiki=4]="wiki",e[e.documentCenter=7]="documentCenter",e[e.blog=9]="blog",e[e.tenantAdmin=16]="tenantAdmin",e[e.app=17]="app",e[e.appCatalog=18]="appCatalog",e[e.mySite=21]="mySite",e[e.subgroup=39]="subgroup",e[e.publishingPortal=52]="publishingPortal",e[e.mySiteHost=54]="mySiteHost",e[e.enterpriseWiki=56]="enterpriseWiki",e[e.group=64]="group",e[e.pointPublishingPersonal=66]="pointPublishingPersonal",e[e.sitePagePublishing=68]="sitePagePublishing",e[e.teamChannel=69]="teamChannel",e[e.projectWebAppSite=6221]="projectWebAppSite",e[e.contentCenter=6001]="contentCenter";}(n=t.WebTemplateType||(t.WebTemplateType={})),t.isTeamSiteLike=function(e){var t=Number(e);return t!==n.mySite&&t!==n.group;},t.default=n;},2607:function _(e,t){var r={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authenticationToken"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"resource"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},directives:[]}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authenticationToken"},arguments:[{kind:"Argument",name:{kind:"Name",value:"resource"},value:{kind:"Variable",name:{kind:"Name",value:"resource"}}}],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"token"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:109}};r.loc.source={body:"query authenticationToken($resource: String!) {\n  authenticationToken(resource: $resource) {\n    token\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var n={};function i(e,t){return e.definitions.find(function(e){return!!e.name&&e.name.value==t;});}r.definitions.forEach(function(e){if(e.name){var t=new Set();!function e(t,r){if("FragmentSpread"===t.kind)r.add(t.name.value);else if("VariableDefinition"===t.kind){var n=t.type;"NamedType"===n.kind&&r.add(n.name.value);}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,r);}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,r);}),t.definitions&&t.definitions.forEach(function(t){e(t,r);});}(e,t),n[e.name.value]=t;}}),e.exports=r,e.exports.authenticationToken=function(e,t){var r=Object.assign({},e),o=i(e,t);r.definitions=[o];for(var a=n[t]||new Set(),s=new Set(),u=new Set(a);u.size>0;){var l=u;u=new Set(),l.forEach(function(e){s.has(e)||(s.add(e),(n[e]||new Set()).forEach(function(e){u.add(e);}));});}return s.forEach(function(t){var n=i(e,t);n&&r.definitions.push(n);}),r;}(r,"authenticationToken");},2608:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(2609),o=r(2610),a=r(846),s=r(1038),u=r(1237),l=r(1238),c=r(2661),d=r(2662),p=r(1032),h=r(1035),f=r(1248),m=r(1236),_=r(1036),g=function(){function e(e){if(this._iframe=document.createElement("iframe"),this._signal=new s.default(),this._context=e.context,this._iframeWidth=0,this._iframeHeight=0,this._timeoutId=-1,this._isShareReady=!1,this._iframeUrl="",this._iframeBaseUrl="",this._messagesReceived={},this._props=e,this._receiveMessageBound=this._receiveMessage.bind(this),this._elementWindow=this._props.elementWindow||window,this._manager=p.createManager(),this._sessionQos=new(_.Qos.withManager(this._manager))({name:"SharingSession."+u.Mode[e.context.mode||u.Mode.share]}),!this._context.authToken)throw new Error("An access token is required for SharePrefetch optimization");switch(new d.WebSharedAriaTelemetryHandler({clientName:this._context.clientId,userAuthToken:this._context.authToken}).attach(this._manager),e.environment){case"pathfinder":this._iframeBaseUrl="https://od.apps.mil";break;case"trailblazer":this._iframeBaseUrl="https://admin.onedrive.us";break;case"test":this._iframeBaseUrl="https://www.onedrive-tst.com",this._iframeUrl=e.testEnvironmentUrl||"";break;default:this._iframeBaseUrl="https://www.odwebp.svc.ms";}this._iframeUrl||(this._iframeUrl=this._iframeBaseUrl+"/share?smkt="+e.locale),this._iframeStartTime=new Date(),this._initializeIframe(),e.element.appendChild(this._iframe);}return e.prototype.initializeUI=function(){return n.__awaiter(this,void 0,void 0,function(){var e,t,r,i,o=this;return n.__generator(this,function(s){return e=this._context.mode===u.Mode.copy&&"teams"===this._context.clientId&&!this._context.shareId,t=e?this._getDefaultLink():Promise.resolve(void 0),r=this._getSharingInformation(),this._isShareReady=!1,Promise.all([this._toTuple(t),this._toTuple(this._getSharingInformation()),this._toTuple(this._signal.getPromise())]).then(function(e){var t=e[0],r=e[1];e[2];try{var i=!1,s=o._props.options.onError;if(o._isError(t)&&(i=!0,s&&s({name:"SharePrefetchError",message:"",error:t.error,resultCode:a.default.isCanceled(t.error)?"Canceled":m.getResultCodeFromError(t.error)})),o._isError(r)){i=!0;var u=r.error,l={code:u.code,status:u.status};s&&s({name:"SharePrefetchError",message:"",error:u,resultCode:a.default.isCanceled(r.error)?"Canceled":"["+l.status.toString()+"] "+(l.code||"Unknown")});}var c=n.__assign({},o._context,{rawInvite:t.value,sharingInformation:r.value}),d=o._iframe.contentWindow;d?d.postMessage(c,o._iframeUrl):i||o._sessionQos.end({resultType:_.ResultTypeEnum.Failure,extraData:{error:"contentWindow not defined to postMessage context",iframeInBody:o._elementWindow.document.body.contains(o._iframe),messagesReceived:Object.keys(o._messagesReceived).join(","),mode:o._context.mode}});}catch(e){o._sessionQos.end({resultType:_.ResultTypeEnum.Failure,extraData:{unhandledError:e.toString()}});}}),this._props.disableIframeDomainCheck||setTimeout(function(){if(!o._scriptsLoadedTime){var e=new Image();e.onerror=function(){var e="ShareDomainNotReachable"+(window.navigator&&window.navigator.onLine?"Online":"Offline"),t=o._props.options&&o._props.options.onError;t&&t({name:"SharePrefetchError",message:e,error:new Error(e),debugErrorMessage:"Unable to reach "+o._iframeBaseUrl+" domain. Refer to https://docs.microsoft.com/en-us/office365/enterprise/urls-and-ip-address-ranges",resultCode:e}),o._sessionQos.end({resultType:_.ResultTypeEnum.ExpectedFailure,resultCode:e,extraData:{mode:o._context.mode,iframeBaseUrl:o._iframeBaseUrl}}),clearTimeout(o._timeoutId);},e.src=o._iframeUrl+"/favicon.ico?"+Math.random();}},8e3),i=this._props.timeout||45e3,this._timeoutId=setTimeout(function(){return n.__awaiter(o,void 0,void 0,function(){var e,o,a,s,u,l,c,d,p,h;return n.__generator(this,function(n){switch(n.label){case 0:o=!1,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,r];case 2:return a=n.sent(),o=a&&!!a,[3,4];case 3:return s=n.sent(),e=s,[3,4];case 4:l=!1,n.label=5;case 5:return n.trys.push([5,7,,8]),[4,t];case 6:return c=n.sent(),l=!(!c||!c),[3,8];case 7:return d=n.sent(),u=d,[3,8];case 8:return p={isTimeout:!0,iframeInBody:this._elementWindow.document.body.contains(this._iframe),messagesReceived:Object.keys(this._messagesReceived).join(","),getSharingHasData:o,getSharingError:e,inviteHasData:l,inviteError:u,timeout:i,mode:this._context.mode,isOnline:window.navigator&&window.navigator.onLine,scriptsLoadedTime:this._scriptsLoadedTime?this._scriptsLoadedTime.getTime()-this._iframeStartTime.getTime():-1,iframeLoadedTime:this._iframeLoadedTime},this._showShareUX(),(h=this._props.options&&this._props.options.onTimeout)&&h(),this._sessionQos.end({resultType:_.ResultTypeEnum.Failure,resultCode:"timeout",extraData:p}),[2];}});});},i),[2];});});},e.prototype.dispose=function(){this._messagesReceived.sharePrefetch_dispose=!0,this._elementWindow.removeEventListener("message",this._receiveMessageBound),this._props.element.removeChild(this._iframe),this._sessionQos.end({resultType:_.ResultTypeEnum.ExpectedFailure,resultCode:"disposed",extraData:{isDisposed:!0,iframeInBody:this._elementWindow.document.body.contains(this._iframe),messagesReceived:Object.keys(this._messagesReceived).join(","),mode:this._context.mode,isOnline:window.navigator&&window.navigator.onLine,iframeLoadedTime:this._iframeLoadedTime}});},e.prototype._getDefaultLink=function(){return n.__awaiter(this,void 0,void 0,function(){var e,t,r,s=this;return n.__generator(this,function(n){switch(n.label){case 0:return e=new o.default({},{urlDataSource:{getApiBaseUrl:function getApiBaseUrl(){return s._context.webAbsoluteUrl+"/_api/v2.0";}},sessionManagementProvider:{getToken:function getToken(){return a.default.resolve({accessToken:s._context.authToken});}},apiEvent:h.Api.withManager(this._manager)}),t=new i.default({},{dataRequestor:e}),r=[],this._context.defaultRecipients&&this._context.defaultRecipients.length>0&&(r=this._context.defaultRecipients.map(function(e){return{email:e};})),[4,this._context.uniqueId?t.getDefaultLinkByUniqueId(this._context.uniqueId||"",r,!this._props.disableUseMultiPart):t.getDefaultLink(this._context.itemUrl||"",r,!this._props.disableUseMultiPart)];case 1:return[2,{value:n.sent()}];}});});},e.prototype._getSharingInformation=function(){var e={authToken:this._context.authToken,webAbsoluteUrl:this._context.webAbsoluteUrl,webTemplate:this._context.isODB?"21":"1",env:"prod"},t=this._manager,r=new l.SharingDataSource({pageContext:e,getParentListId:this._getParentListId,sharingContextInformation:this._context},{pageContext:e,dataRequestorType:function(r){function i(n){return r.call(this,n,{pageContext:e,apiEvent:h.Api.withManager(t)})||this;}return n.__extends(i,r),i;}(f.DataRequestor)}),i=new c.SharingProvider({pageContext:e,getParentListId:this._getParentListId,itemProvider:{invalidateItem:function invalidateItem(){}},sharingDataSource:r}),o=this._context.mode===u.Mode.copy||this._context.mode===u.Mode.linkSettings;return i.getSharingInformation({key:"",name:this._context.itemName,properties:{}},o);},e.prototype._initializeIframe=function(){var e=this;this._elementWindow.addEventListener("message",this._receiveMessageBound,!1),this._iframe.onload=function(){e._iframeLoadedTime=new Date().getTime()-e._iframeStartTime.getTime();},this._iframe.src=this._iframeUrl,this._iframe.style.width="0px",this._iframe.style.height="0px",this._iframe.style.visibility="hidden";var t=this._props.styles;t&&t.border?this._iframe.style.border=t.border:this._iframe.style.border="0",t&&(t.margin&&(this._iframe.style.margin=t.margin),t.minWidth&&(this._iframe.style.minWidth=t.minWidth),t.minHeight&&(this._iframe.style.minHeight=t.minHeight));},e.prototype._showShareUX=function(){this._isShareReady=!0,this._iframe.style.visibility="visible",this._iframe.style.height=(this._iframeHeight||400)+"px",this._iframe.style.width=(this._iframeWidth||320)+"px",clearTimeout(this._timeoutId);},e.prototype._receiveMessage=function(e){var t;try{t=e&&e.data&&JSON.parse(e.data);}catch(e){return;}try{if(!this._elementWindow.document.body.contains(this._props.element))return this._messagesReceived.sharePrefetch_selfDispose=!0,void this.dispose();}catch(e){}var r=t.name;switch(this._messagesReceived[r||""]=!0,r){case"share_scriptsLoaded":this._scriptsLoadedTime=new Date(),this._signal.complete();break;case"share_resize":var n=this._props.options&&this._props.options.onResize;n&&t.width&&t.height&&n(t.width,t.height),this._iframeWidth=t.width||320,this._iframeHeight=t.height||400,this._isShareReady&&(this._iframe.style.height=this._iframeHeight+"px",this._iframe.style.width=this._iframeWidth+"px");break;case"share_started":var i=this._props.options&&this._props.options.onStarted;i&&i();break;case"share_ready":this._showShareUX();var o={scriptsLoadedTime:this._scriptsLoadedTime?this._scriptsLoadedTime.getTime()-this._iframeStartTime.getTime():-1,iframeLoadedTime:this._iframeLoadedTime,mode:this._context.mode,recipientsCount:this._context.defaultRecipients&&this._context.defaultRecipients.length||0,shareId:this._context.shareId};this._sessionQos.end({resultType:_.ResultTypeEnum.Success,extraData:o});var a=this._props.options&&this._props.options.onReady;a&&a();break;case"share_error":this._showShareUX();var s=this._props.options&&this._props.options.onError,u=JSON.parse(t.debugErrorMessage||"{}"),l=u.code||u.status||"ShareError: ["+t.error+"]";this._sessionQos.end({resultType:_.ResultTypeEnum.Failure,resultCode:l}),s&&s({name:"SharePrefetchError",message:t.errorMessage||"",error:t.error,debugErrorMessage:t.debugErrorMessage,errorMessage:t.errorMessage,resultCode:l});case"share_completed":var c=this._props.options&&this._props.options.onCompleted;c&&c({scope:t.scope||""});break;case"share_dismiss":var d=this._props.options&&this._props.options.onDismiss;d&&d();break;case"share_manageAccessClicked":var p=this._props.options&&this._props.options.openManageAccess;p&&p();case"share_linkSettingsCompleted":var h=this._props.options&&this._props.options.onLinkSettingsComplete;h&&h(t);}},e.prototype._getParentListId=function(e){return"";},e.prototype._toTuple=function(e){return n.__awaiter(this,void 0,void 0,function(){var t;return n.__generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),t={},[4,e];case 1:return[2,(t.value=r.sent(),t)];case 2:return[2,{error:r.sent()}];case 3:return[2];}});});},e.prototype._isError=function(e){return!!e.error;},e;}();t.SharePrefetch=g;},2609:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(846),i=r(1028),o=r(1029),a=function(){function e(e,t){this._dataRequestor=t.dataRequestor;}return e.prototype.createBundle=function(e){return this._dataRequestor.send({path:"/drive/bundles",apiName:"bundles",requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify({name:o.default.generate().toString(),children:e.map(function(e){return{id:e};}),bundle:{}})}).then(function(e){return e;});},e.prototype.isUserPremium=function(){return this._dataRequestor.send({path:"/me/drive",apiName:"drive",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0}).then(function(e){return!!e.quota.storagePlanInformation&&!e.quota.storagePlanInformation.upgradeAvailable;});},e.prototype.createLink=function(e,t,r,n,i,o){var a=this;return 1===e.length?this.createLinkSingleItem({itemUrl:this.getDrivesPathFromItemId(e[0]),type:t,scope:r,preventDownload:n,password:i,expiration:o}):this.createBundle(e).then(function(e){return a.createLinkSingleItem({itemUrl:a.getDrivesPathFromItemId(e.id),type:t,scope:r,preventDownload:n,password:i,expiration:o});});},e.prototype.createLinkFromItemUrl=function(e,t,r,n,i,o){return this.createLinkSingleItem({itemUrl:this.getSharesPathFromItemUrl(e),type:t,scope:r,preventDownload:n,password:i,expiration:o});},e.prototype.getCurrentUserId=function(){return this._dataRequestor.send({path:"/me",apiName:"me",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0}).then(function(e){return e.id;});},e.prototype.getItemInfo=function(e){var t=""+this.getDrivesPathFromItemId(e);return this._dataRequestor.send({path:t,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0}).then(function(e){return e;});},e.prototype.getItemInfoFromItemUrl=function(e){var t=""+this.getSharesPathFromItemUrl(e);return this._dataRequestor.send({path:t,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0}).then(function(e){return e;});},e.prototype.getPermissions=function(e){var t=this.getDrivesPathFromItemId(e)+"/permissions";return this._dataRequestor.send({path:t,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0}).then(function(e){return e.value;});},e.prototype.getPermissionsFromItemUrl=function(e){var t=this.getSharesPathFromItemUrl(e)+"/permissions";return this._dataRequestor.send({path:t,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0}).then(function(e){return e.value;});},e.prototype.invite=function(e,t,r,n,i,o,a,s){var u=this;return 1===e.length?this.inviteSingleItem(this.getDrivesPathFromItemId(e[0]),t,r,n,i,o,a,s,{prefer:"rich-error-as-message"}):this.createBundle(e).then(function(e){return u.inviteSingleItem(u.getDrivesPathFromItemId(e.id),t,r,n,i,o,a,s,{prefer:"rich-error-as-message"});});},e.prototype.inviteFromItemUrl=function(e,t,r,n,i,o,a,s){return this.inviteSingleItem(this.getSharesPathFromItemUrl(e),t,r,n,i,o,a,s,{prefer:"rich-error-as-message"});},e.prototype.getDefaultLink=function(e,t,r){var o={prefer:"getDefaultLink"};return i.Killswitch.isActivated("c95677d4-d350-4951-a5a2-9d9f3b856dfc","06/22/2020","Also add ReturnSpecificErrorCode to Prefer header list")||(o.prefer+=",ReturnSpecificErrorCode"),t.length>0?this.inviteSingleItem(this.getSharesPathFromItemUrl(e),t,"",!0,!1,[],"",void 0,o,r):this.createLinkSingleItem({itemUrl:this.getSharesPathFromItemUrl(e),useMultiPart:r}).then(function(e){return n.default.wrap([e]);});},e.prototype.getDefaultLinkByUniqueId=function(e,t,r){var o={prefer:"getDefaultLink"};return i.Killswitch.isActivated("c95677d4-d350-4951-a5a2-9d9f3b856dfc","06/22/2020","Also add ReturnSpecificErrorCode to Prefer header list")||(o.prefer+=",ReturnSpecificErrorCode"),t.length>0?this.inviteSingleItem(this.getPathFromUniqueId(e),t,"",!0,!1,[],"",void 0,o,r):this.createLinkSingleItem({itemUrl:this.getPathFromUniqueId(e),useMultiPart:r}).then(function(e){return n.default.wrap([e]);});},e.prototype.updatePermissions=function(e,t,r){var n=this.getDrivesPathFromItemId(e)+"/permissions/"+t,i={roles:[r]};return this._dataRequestor.send({path:n,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(i)}).then(function(e){return e.value;});},e.prototype.updatePermissionsFromItemUrl=function(e,t,r){var n=this.getSharesPathFromItemUrl(e)+"/permissions/"+t,i={roles:[r]};return this._dataRequestor.send({path:n,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify(i)}).then(function(e){return e.value;});},e.prototype.unshareLink=function(e,t){var r=this.getDrivesPathFromItemId(e)+"/permissions/"+t;return this._dataRequestor.send({path:r,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0}).then(function(){return!0;});},e.prototype.unshareLinkFromItemUrl=function(e,t){var r=this.getSharesPathFromItemUrl(e)+"/permissions/"+t;return this._dataRequestor.send({path:r,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0}).then(function(){return!0;});},e.prototype.createLinkSingleItem=function(e){var t=e.type,r=e.itemUrl,n=e.scope,i=e.preventDownload,o=e.password,a=e.useMultiPart,s=e.expiration,u=r+"/createLink",l=t&&n?{type:t,scope:n,preventDownload:i}:void 0;return(o||""===o)&&(l.password=o),s&&(l.expirationDateTime=s),this._dataRequestor.send({path:u,apiName:"createLink",requestType:"POST",useMultiPart:a,useAuthorizationHeaders:!0,postData:JSON.stringify(l||{})}).then(function(e){return e;});},e.prototype.getSharesPathFromItemUrl=function(e){return"/shares/u!"+btoa(unescape(encodeURIComponent(e))).replace(/=+$/,"").replace("/","_").replace("+","-")+"/driveItem";},e.prototype.getPathFromUniqueId=function(e){return"/sites/root/items/"+e+"/driveItem";},e.prototype.getDrivesPathFromItemId=function(e){var t=e.split("!");return t.length>1?"/drives/"+t[0]+"/items/"+e:"/drive/items/"+e;},e.prototype.inviteSingleItem=function(e,t,r,n,i,o,a,s,u,l){var c=e+"/invite",d={recipients:t,message:r,requireSignIn:n,sendInvitation:i,roles:o};return a&&(d.password=a),s&&(d.expirationDateTime=s),this._dataRequestor.send({path:c,apiName:"invite",requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(d),useMultiPart:l,headers:u}).then(function(e){return e.value;});},e;}();t.default=a;},2610:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(846),o=r(2611),a=r(1035),s=r(1037),u=r(1236),l=r(1029),c={activityLimitReached:!0,malwareDetected:!0,nameAlreadyExists:!0,resourceModified:!0,resyncRequired:!0,quotaLimitReached:!0,accessRestricted:!0,childItemCountExceeded:!0,entityTagDoesNotMatch:!0,fragmentOutOfOrder:!0,fragmentOverlap:!0,hipCheckRequired:!0,insufficientVaultQuota:!0,lockMismatch:!0,lockNotFoundOrAlreadyExpired:!0,lockOwnerMismatch:!0,maxDocumentCountExceeded:!0,maxFileSizeExceeded:!0,maxFolderCountExceeded:!0,maxItemCountExceeded:!0,nameContainsInvalidCharacters:!0,pathIsTooLong:!0,pathTooDeep:!0,pathIsTooDeep:!0,propertyNotUpdateable:!0,resyncApplyDifferences:!0,resyncUploadDifferences:!0,serviceReadOnly:!0,throttledRequest:!0,unlockRequired:!0,versionNumberDoesNotMatch:!0,virusSuspicious:!0,authFailure:!1},d=function(){function e(e,t){var r=e.alwaysSendContentType,n=void 0!==r&&r,i=t.sessionManagementProvider,o=t.urlDataSource,s=t.apiEvent,u=void 0===s?a.Api:s,l=t.cookieOrigin,c=t.isOffline;this._sessionManagementProvider=i,this._alwaysSendContentType=n,this._apiEvent=u,this._apiName=o&&"function"==typeof o.getApiName?o.getApiName():"Vroom",this._apiBaseUrl=o?"function"==typeof o.getApiBaseUrl?o.getApiBaseUrl():o.getVroomApiBaseUrl():void 0,this._cookieOrigin=l,this._isOffline=c;}return e.prototype.send=function(e){var t=this,r=e.headers,d=void 0===r?{}:r,p=e.path,h=e.apiName,f=e.requestType,m=void 0===f?"GET":f,_=e.disableLogging,g=void 0!==_&&_,v=e.timeout,y=e.onProgress,S=e.onUploadProgress,I=e.qosExtraData,T=e.apiVersion,E=void 0===T?"v2.0":T,b=e.needsAuthorization,w=void 0===b||b,R=e.useAuthorizationHeaders,D=void 0!==R&&R,P=e.accessToken,C=e.postProcessQos,A=e.breakCache,U=e.allowCookies,O=e.hasContentType,k=void 0===O||O,N=e.useMultiPart,x=void 0!==N&&N,L=n.__assign({},c,e.expectedErrorCodes||{}),M=this._apiBaseUrl,F=this._cookieOrigin,B=U&&F&&w&&!P&&"GET"===m&&new s.default("/"===p[0]?M:p).getLeftPart(s.UriPartial.authority)===F,W=this._sessionManagementProvider,V=w&&!B&&(P||W&&W.getToken(E).catch(function(e){return i.default.reject(new u.GraphError(e,{status:0,response:{error:{code:"authFailure"}}}));}))||void 0;return i.default.resolve(V).then(function(r){var c,f="",_={};_=x?{"Content-Type":"multipart/form-data;boundary="+(f=l.default.generate())}:n.__assign({Accept:"application/json"},(e.postData||t._alwaysSendContentType)&&k?{"Content-Type":"application/json"}:{},d),r&&r.tokenUrl&&0===p.indexOf("/drive/")?c=new s.default(r.tokenUrl+"/"+p.substring(7)):(c=new s.default(p),M&&!c.getScheme()&&(c=new s.default(M+p))),x&&c.setQueryParameter("ump","1");var T,E=c.toString();if(!x&&r){var b=r.accessToken,w=r.proofToken,R=r.wlidToken,P=r.isBadger;R?_=n.__assign({},_,{Authorization:"wlid1.1 "+R}):D?(b&&(_=P?n.__assign({},_,{Authorization:"badger "+b}):n.__assign({},_,{Authorization:"bearer "+b})),w&&(_=n.__assign({},_,{"X-PROOF_TOKEN":w}))):(b&&c.setQueryParameter("access_token",b),w&&c.setQueryParameter("prooftoken",w));}if(x){var U="";if(U+="--"+f+"\r\n",U+="Content-Disposition: form-data;name=data\r\n",d)for(var O=0,N=Object.keys(d);O<N.length;O++){var F=N[O];U+=F+": "+d[F]+"\r\n";}U+="Content-Type: application/json\r\n",U+="Authorization: bearer "+r.accessToken+"\r\n",U+="\r\n",U+=e.postData+"\r\n",U+="--"+f+"--";}if(A&&c.setQueryParameter("r",Math.random().toFixed(8)),!g){var W={url:E=(E=E.replace(/(?:(?:access_|proof)token|tempauth|authkey)=[^&]+/gi,"")).replace(/(?:eyJ[A-Za-z0-9_-]+(?:\.|%2E|%252E)){2}(?:[A-Za-z0-9_-]+)/gi,"$REDACTED$"),name:t._apiName+"DataRequest."+h,extraData:I};T=new t._apiEvent(W);}return o.default.start({url:c.toString(),headers:_,method:m,json:U||e.postData||"",requestTimeoutInMS:v,withCredentials:B,onProgress:y,onUploadProgress:S}).then(function(t){if(T){var r={resultType:a.ResultTypeEnum.Success};T.end(r);}return e.parseResponse?e.parseResponse(t):0===t.responseText.length?null:JSON.parse(t.responseText);},function(e){var o,s=function s(e,t){return C&&(e=C(e,t)),T&&T.end(e),i.default.reject(t);};if(e instanceof Error){var l=i.default.isCanceled(e),d=l?a.ResultTypeEnum.ExpectedFailure:a.ResultTypeEnum.Failure,p={error:e.message,resultCode:l?"Canceled":"",resultType:d};return s(p,e);}if(e.responseText)try{o=JSON.parse(e.responseText);}catch(e){}var h=e.status,f=e.statusText,m=(o||{}).error,_=void 0===m?{}:m,g=_.message,v=void 0===g?"":g,y=_.innerError,S=void 0===y?{}:y,E=S.stackTrace,b=void 0===E?"":E,w=S.debugMessage,R=void 0===w?"":w;return(h||!t._isOffline?i.default.resolve(!1):t._isOffline()).then(function(t){var i=t?"Offline":"",l=e.getResponseHeader("request-id")||e.getResponseHeader("sprequestguid"),d=!!u.getErrorResolutionFromResponse(o,h,function(e){return L[e];}),p=new u.GraphError(new Error(v||i),{response:o,status:h,request:e,correlationId:l,isExpected:d}),m={resultType:d?a.ResultTypeEnum.ExpectedFailure:a.ResultTypeEnum.Failure,error:v,resultCode:p.code,extraData:n.__assign({},I||{},u.getQosExtraDataFromError(p),{stack:b,httpStatus:h,httpStatusText:f,requestId:l,MSCorrelationVector:e.getResponseHeader("MS-CV"),debugMessage:R,accessTokenLength:r&&r.accessToken?r.accessToken.length:-1,urlLength:c.toString().length,useCookies:!!B,isOffline:t})};return s(m,p);});});});},e;}();t.DataRequestor=d,t.default=d;},2611:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2612),i=r(846),o=function(){function e(){}return e.start=function(e){var t=new n.default(e);return new i.default(function(e,r){t.start(e,r);},function(){t.abort(!0);});},e.startAndPostProcess=function(e,t){var r=new n.default(e);return new i.default(function(e,n){r.start(function(r,n){e(t(r,n));},n);},function(){r.abort(!0);});},e;}();t.default=o;},2612:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1227),i=r(1031),o=r(1232);!function(e){e[e.blocked=0]="blocked",e[e.exception=-1]="exception",e[e.timeout=-2]="timeout",e[e.abort=-3]="abort";}(t.XHRStatus||(t.XHRStatus={}));var a=function(){function e(t){this._async=new n.default(this);var r=t.url,i=t.requestTimeoutInMS,o=void 0===i?e.DEFAULT_TIMEOUT_MS:i,a=t.json,s=t.responseType,u=void 0===s?"":s,l=t.headers,c=void 0===l?{}:l,d=t.withCredentials,p=void 0!==d&&d,h=t.needsCors,f=void 0!==h&&h,m=t.onProgress,_=t.onUploadProgress,g=t.method,v=void 0===g?a?"POST":"GET":g;this._url=r,this._requestTimeoutInMS=o,this._postData=a,this._headers=c,this._method=v,this._withCredentials=p,this._needsCors=f,this._responseType=u,this._progressCallback=m,this._uploadProgressCallback=_;}return e.prototype.abort=function(e){this._abortRequest()&&!e&&this._callFailureCallback(this._request,-3,!1);},e.prototype.start=function(e,t){var r=this;this._successCallback=e,this._failureCallback=t;var n=this._method,a=this._headers;try{this._request=this._getRequest();var s=this._progressCallback,u=this._uploadProgressCallback,l=this._request,c=this._responseType;for(var d in s&&(l.onprogress=function(e){try{s(e);}catch(e){i.default.logError(e);}}),u&&(l.upload.onprogress=function(e){try{u(e);}catch(e){i.default.logError(e);}}),this._async.setTimeout(function(){r._completed||r._timeoutCallback();},this._requestTimeoutInMS),l.onreadystatechange=function(){if(!r._completed){var e=4;try{e=l.DONE||4;}catch(e){}l.readyState===e&&r._requestEndCallback();}},l.open(n,this._url,!0),"withCredentials"in l&&(l.withCredentials=this._withCredentials),l.responseType=c,a){l.setRequestHeader(d,a[d]);}l.send(this._postData);}catch(e){i.default.logError(e,{origin:location?location.origin:"unknown",withCredentials:this._withCredentials,requestUrl:this._url,headers:o.safeSerialize(a),method:n}),this._abortRequest(),this._callFailureCallback(this._request,-1,!1);}},e.prototype._getRequest=function(){var e=this;if(!this._needsCors||!window.XDomainRequest)return new XMLHttpRequest();var t=new XDomainRequest();return t.setRequestHeader=function(){},t.onprogress=function(){},t.ontimeout=function(){},t.onload=function(){e._requestEndCallback();},t;},e.prototype._abortRequest=function(){var e=!1;if(!this._completed){this._completed=!0,this._async.dispose();try{this._request&&this._request.abort();}catch(e){}e=!0;}return e;},e.prototype._timeoutCallback=function(){this._completed||(this._abortRequest(),this._callFailureCallback(this._request,-2,!0));},e.prototype._callSuccessCallback=function(e,t){try{this._successCallback&&this._successCallback(e,t);}catch(e){i.default.log(e);}},e.prototype._callFailureCallback=function(e,t,r){try{this._failureCallback&&this._failureCallback(e,t,r);}catch(e){i.default.log(e);}},e.prototype._requestEndCallback=function(){if(!this._completed){this._completed=!0;var e=-1;try{this._async.dispose();try{e=this._request.status;}catch(e){}}catch(t){e=-1,i.default.log(t);}e<400&&e>0?this._callSuccessCallback(this._request,e):this._callFailureCallback(this._request,e,!1);}},e.DEFAULT_TIMEOUT_MS=3e4,e;}();t.default=a;},2613:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1030),i=function(){function e(e,t){e?(this.root=e.root,this.parent=e.current):this.root=this.parent=n.Empty,this.current=t||n.generate();}return e._getCorrelationVector=function(){var t;return"undefined"!=typeof window?t=window.rootVector:"undefined"!=typeof self&&(t=self.rootVector),t||new e();},e.prototype.toString=function(){return this.root+"#"+this.parent+"#"+this.current;},e.RootVector=e._getCorrelationVector(),e;}();t.CorrelationVector=i;},2614:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(903),i=r(1228),o=r(957);t.ResultTypeEnum=o.ResultTypeEnum,t.QosError=n.createSingleEvent({eventName:"QosError,CaughtError,Trace,",shortEventName:"QosError",critical:!0},{name:{isKey:!0,type:1},resultCode:1,resultType:{typeRef:o.ResultTypeEnum,type:6}},i.CaughtError);},2615:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(903),i=r(1231);t.Verbose=n.createSingleEvent({eventName:"Verbose,Trace,",shortEventName:"Verbose",requiresParent:!1},{name:{isKey:!0,type:1}},i.Trace);},2616:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){if(e<=0)throw new Error("Size must be positive");this._size=e,this._buffer=new Array(e),this._length=0,this._head=-1;}return e.prototype.push=function(e){this._length<this._size&&this._length++,this._head++,this._head===this._size&&(this._head=0),this._buffer[this._head]=e;},e.prototype.popOldest=function(){if(0===this._length)return null;var e=(this._head-this._length+1+this._size)%this._size;return this._length--,this._buffer[e];},e;}();t.CircularBuffer=n;},2617:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deepCompare=function(e,t,r){var n=[],i=[],o=r||function(e,t){return e===t;};return function e(t,r){if(t===r)return!0;if(null===t||null===r)return!1;if("object"!=_typeof(t)||"object"!=_typeof(r))return!1;var a=Object.keys(t).sort(),s=Object.keys(r).sort();return a.length===s.length&&!!a.every(function(a,u){if(a!==s[u])return!1;if("function"==typeof t[a]||"function"==typeof r[a])return!0;if(o(t[a],r[a]))return!0;if("object"==_typeof(t[a])){if(-1!==n.indexOf(t[a]))throw new Error("Cannot perform DeepCompare() because a circular reference was encountered, object: "+t+", property: "+a);if(n.push(t[a]),-1!==i.indexOf(r[a]))throw new Error("Cannot perform DeepCompare() because a circular reference was encountered, object: "+r+", property: "+a);return i.push(r[a]),e(t[a],r[a])?(n.pop(),i.pop(),!0):!1;}return!1;});}(e,t);};},2618:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(0).__exportStar(r(1233),t);},2619:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(0).__exportStar(r(957),t);},2620:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function n(e){void 0===e&&(e={});var t=new Error(e.message||e.innerError&&e.innerError.message);for(var r in this.message=t.message,this.innerError=e.innerError,this){Object.prototype.hasOwnProperty.call(this,r)&&(t[r]=this[r]);}var n=Object.getPrototypeOf(this);if(Error.captureStackTrace&&Error.captureStackTrace(t,n),Object.setPrototypeOf)return Object.setPrototypeOf(t,n),t;};t.CustomError=n,Object.setPrototypeOf&&(n.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(n,Error));},2621:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NONE=0]="NONE",e[e.VIEW=1]="VIEW",e[e.EDIT=2]="EDIT";}(t.UpdatePermissionsRole||(t.UpdatePermissionsRole={}));},2622:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.uninitialized=0]="uninitialized",e[e.direct=1]="direct",e[e.organizationView=2]="organizationView",e[e.organizationEdit=3]="organizationEdit",e[e.anonymousView=4]="anonymousView",e[e.anonymousEdit=5]="anonymousEdit",e[e.flexible=6]="flexible";}(t.SharingLinkKind||(t.SharingLinkKind={}));},2623:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Network=1]="Network",e[e.Embed=3]="Embed",e[e.App=4]="App",e[e.View=5]="View",e[e.Edit=6]="Edit",e[e.Form=7]="Form",e[e.Direct=8]="Direct",e[e.Organization=9]="Organization",e[e.AppAccess=10]="AppAccess";}(t.SharingLinkType||(t.SharingLinkType={}));},2624:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Email=0]="Email",e[e.User=1]="User",e[e.Group=2]="Group",e[e.Link=3]="Link",e[e.Public=4]="Public",e[e.Friends=5]="Friends",e[e.Facebook=6]="Facebook",e[e.Application=7]="Application",e[e.GroupOwned=99]="GroupOwned";}(t.SharingInfoType||(t.SharingInfoType={}));},2625:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Owner=0]="Owner",e[e.View=1]="View",e[e.Edit=2]="Edit",e[e.Submitter=3]="Submitter",e[e.CoOwner=4]="CoOwner",e[e.None=5]="None",e[e.Review=6]="Review",e[e.Custom=7]="Custom";}(t.SharingRole||(t.SharingRole={}));},2626:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.none=1]="none",e[e.pending=2]="pending",e[e.hasAccess=3]="hasAccess";}(t.AccessStatus||(t.AccessStatus={}));},2627:function _(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.unknown=1]="unknown",e[e.odb=2]="odb",e[e.sharePoint=3]="sharePoint",e[e.ngsc=4]="ngsc",e[e.word=5]="word",e[e.powerpoint=6]="powerpoint",e[e.excel=7]="excel",e[e.onenoteWeb=8]="onenoteWeb",e[e.wac=9]="wac",e[e.visio=10]="visio",e[e.officecom=11]="officecom",e[e.listPart=12]="listPart",e[e.outlookWeb=13]="outlookWeb",e[e.odIos=14]="odIos",e[e.odAndroid=15]="odAndroid",e[e.teams=16]="teams",e[e.sample=17]="sample",e[e.odc=18]="odc",e[e.wordAndroid=19]="wordAndroid",e[e.excelAndroid=20]="excelAndroid",e[e.powerpointAndroid=21]="powerpointAndroid",e[e.wordIos=22]="wordIos",e[e.excelIos=23]="excelIos",e[e.powerpointIos=24]="powerpointIos",e[e.onenote=25]="onenote",e[e.teamsIos=26]="teamsIos",e[e.teamsAndroid=27]="teamsAndroid",e[e.onenoteIos=28]="onenoteIos",e[e.visioIos=29]="visioIos",e[e.onenoteAndroid=30]="onenoteAndroid",e[e.visioAndroid=31]="visioAndroid",e[e.outlookWindows=32]="outlookWindows",e[e.outlookMac=33]="outlookMac",e[e.onenoteUWP=34]="onenoteUWP",e[e.officemobileIos=35]="officemobileIos",e[e.officemobileAndroid=36]="officemobileAndroid";}(n||(n={})),t.getClientId=function(e){switch(e?e.toLowerCase():""){case"odb":return n.odb;case"sharepoint":return n.sharePoint;case"ngsc":return n.ngsc;case"word":return n.word;case"powerpoint":return n.powerpoint;case"excel":return n.excel;case"onenoteweb":return n.onenoteWeb;case"wac":return n.wac;case"visio":return n.visio;case"officecom":return n.officecom;case"listpart":return n.listPart;case"outlookweb":return n.outlookWeb;case"odios":return n.odIos;case"odandroid":return n.odAndroid;case"teams":return n.teams;case"sample":return n.sample;case"odc":return n.odc;case"wordandroid":return n.wordAndroid;case"excelandroid":return n.excelAndroid;case"powerpointandroid":return n.powerpointAndroid;case"wordios":return n.wordIos;case"excelios":return n.excelIos;case"powerpointios":return n.powerpointIos;case"onenote":return n.onenote;case"teamsios":return n.teamsIos;case"teamsandroid":return n.teamsAndroid;case"onenoteios":return n.onenoteIos;case"visioios":return n.visioIos;case"onenoteandroid":return n.onenoteAndroid;case"visioandroid":return n.visioAndroid;case"outlookwindows":return n.outlookWindows;case"outlookmac":return n.outlookMac;case"onenoteuwp":return n.onenoteUWP;case"officemobileios":return n.officemobileIos;case"officemobileandroid":return n.officemobileAndroid;default:return n.unknown;}},t.default=n;},2628:function _(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.authFailure=1]="authFailure",e[e.serverFailure=2]="serverFailure",e[e.invalidItem=3]="invalidItem",e[e.invalidWebAbsoluteUrl=4]="invalidWebAbsoluteUrl",e[e.generic=5]="generic",e[e.objectNotSupported=6]="objectNotSupported",e[e.invalidEmail=7]="invalidEmail",e[e.linkNoLongerAvailable=8]="linkNoLongerAvailable";}(n||(n={})),function(e){e[e.getSharingInformation=1]="getSharingInformation",e[e.shareLink=2]="shareLink",e[e.shareObject=3]="shareObject",e[e.permissions=4]="permissions",e[e.item=5]="item",e[e.me=6]="me",e[e.drive=7]="drive",e[e.invite=8]="invite";}(t.Category||(t.Category={})),t.default=n;},2629:function _(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.share=1]="share",e[e.copy=2]="copy",e[e.atMention=3]="atMention",e[e.linkSettings=4]="linkSettings",e[e.manageAccess=5]="manageAccess",e[e.notify=6]="notify",e[e.addPeople=7]="addPeople";}(n||(n={})),t.default=n;},2630:function _(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.view=1]="view",e[e.edit=2]="edit";}(n||(n={})),t.default=n;},2631:function _(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.specificPeople=0]="specificPeople",e[e.organization=1]="organization",e[e.anyone=2]="anyone",e[e.existing=3]="existing",e[e.specificPeopleFlex=4]="specificPeopleFlex",e[e.customLabeledSpecificPeople=5]="customLabeledSpecificPeople";}(n||(n={})),t.default=n;},2632:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.anyone=0]="anyone",e[e.organization=1]="organization",e[e.specificPeople=2]="specificPeople";}(t.SharingAudienceTemplates||(t.SharingAudienceTemplates={}));},2633:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.none=0]="none",e[e.view=1]="view",e[e.edit=2]="edit",e[e.owner=3]="owner",e[e.review=6]="review",e[e.restrictedview=7]="restrictedview";}(t.SharingRoleV3||(t.SharingRoleV3={}));},2634:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _n,i,o,a,s,u,l,c,d,p,h=r(0),f=r(1039),m=r(2635),_=r(1235),g=r(958),v=r(1239),y=r(1241);h.__exportStar(r(1241),t);var S=void 0,I={ODB:1469,ODC:"ChromiumDateFix"};function T(){var e=_n(),t=b();if(window.Intl&&window.Intl.DateTimeFormat){var r={},i={hour:"2-digit",minute:"2-digit"};o=new Intl.DateTimeFormat(e,r),a=new Intl.DateTimeFormat(e,i),t&&(r.timeZone="UTC",i.timeZone="UTC"),s=new Intl.DateTimeFormat(e,r),u=new Intl.DateTimeFormat(e,i),l=o.format,c=a.format,d=s.format,p=u.format;}else l=d=function d(t){return t.toLocaleDateString(e);},c=p=function p(t){return t.toLocaleTimeString(e);};}function E(e){if(void 0===S)try{S=v.default.isFeatureEnabled(I);}catch(e){S=!1;}return S&&function(e){void 0===R&&function(){R={};var e=new Date(1900,0,1);try{for(var t={month:"long"},r=0,n=w;r<n.length;r++){var i=n[r];e.toLocaleDateString(i,t).match("M[0-9][0-9]")&&(R[i]=!0);}}catch(e){}}();if(e)return e=e.toLowerCase(),R[e];return;}(e)?"en":e;}function b(){if(void 0===i)try{var e=_n();new Date().toLocaleDateString(e,{timeZone:"UTC"}),i=!0;}catch(e){i=!1;}return i;}t.getRelativeDateTimeStringPast=function(e,t){return void 0===t&&(t=!1),y.getRelativeDateTimeStringPast(e,E(_.default.language),t);},t.getFriendlyDateTimeStringPast=function(e,t,r,n){void 0===t&&(t=!1),void 0===r&&(r=!1),void 0===n&&(n=!1);var i,o=Date.now()-e.getTime(),a=((i=new Date()).setHours(0,0,0,0),i),s=D(a,-1),u=D(a,-6),l=E(_.default.language);if(o<-5*y.ONE_MINUTE)return e.toLocaleDateString(l,C({month:"short",day:"numeric"},n));if(o<y.TWO_MINUTES)return r?m.default.FriendlyDateTime_JustNow_withinSentence:m.default.FriendlyDateTime_JustNow_asSentence;if(o<y.ONE_HOUR)return P(o,m.default.FriendlyDateTime_minutesShort,y.ONE_MINUTE);if(y.isSameDay(a,e))return P(o,m.default.FriendlyDateTime_hoursShort,y.ONE_HOUR);if(e>=s)return t?y.getRelativeDateTimeResx("Yesterday",r):y.getRelativeDateTimeResx("YesterdayAndTime",r).replace("{0}",e.toLocaleTimeString(l,C({hour:"numeric",minute:"2-digit"},n)));if(e>=u){var c=e.toLocaleDateString(l,C({weekday:"short"},n));return t?c:f.default.RelativeDateTime_DayAndTime.replace("{0}",c).replace("{1}",e.toLocaleTimeString(l,C({hour:"numeric",minute:"2-digit"},n)));}return y.isSameYear(a,e)?l.match(/(^ja$)|(^ja-{1})/i)?e.toLocaleDateString(l,C({month:"long",day:"numeric"},n)):e.toLocaleDateString(l,C({month:"short",day:"numeric"},n)):e.toLocaleDateString(l,C({month:"short",day:"numeric",year:"numeric"},n));},t.getRelativeDateTimeStringPastWithHourMinute=function(e){return y.getRelativeDateTimeStringPastWithHourMinute(e,E(_.default.language));},t.getShortDisplayDate=function(e,t){if(!e)return"";l||T();var r=y.isSameDay(new Date(),e);return(t?r?p:d:r?c:l)(e);},t.getFileSafeShortDate=function(e,t){return e?(l||T(),(t?d:l)(e).replace(/[:\/\\]/g,"-")):"";},t.getFullDisplayDate=function(e,t){l||T();var r=t?d(e):l(e),n=t?p(e):c(e);return g.format(m.default.DateAndTime,r,n);},t.toLocaleDateString=function(e,t){return y.toLocaleDateString(e,E(_.default.language),t);},t.toLocaleTimeString=function(e,t){return y.toLocaleTimeString(e,E(_.default.language),t);},t.getBrowserSafeLocale=E,_n=function n(){for(var e,t=0,r=[window.$Config&&window.$Config.mkt,_.default.language,navigator.language,"en"].filter(function(e){return!!e;});t<r.length;t++){var i=r[t];try{new Date().toLocaleDateString(i),e=i;break;}catch(e){}}return e=E(e),_n=function n(){return e;},e;};var w=["eu-es","af-za","az-latn-az","bs-latn-ba","cy-gb","ga-ie","gl-es","ha-latn-ng","hy-am","ig-ng","is-is","ka-ge","kk-kz","km-kh","ky-kg","mk-mk","mn-mn","mt-mt","ne-np","nn-no","or-in","pa-in","si-lk","sq-al","ur-pk","uz-latn-uz","yo-ng","zu-za","pa-arab-pk","ku-arab-iq","be-by","rw-rw","ti-et","tg-cyrl-tj","eu","af","az","bs","cy","ga","gl","ha","hy","ig","is","ka","kk","km","ky","mk","mn","mt","ne","nn","or","pa","si","sq","ur","uz","yo","zu","pa","ku","be","rw","ti"],R=void 0;function D(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());}function P(e,t,r){var n=Math.round(e/r);return t.replace("{0}",String(n));}function C(e,t){return b()&&t&&e?h.__assign({},e,{timeZone:"UTC"}):e;}},2635:function _(e,t,r){"use strict";r.r(t),r.d(t,"strings",function(){return n;});var n=r(723)["_U794z/V4Yk4dK01T0aO4lQ"];t.default=n;},2636:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=621355968e5;t.getDateFromDotNetTicks=function(e){return new Date(e/1e4-n);};},2637:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(865);t.iso8601DateTimeToJsDate=function(e){return new Date(e);},t.convertDateToISOString=function(e,t){void 0===t&&(t=!1);var r=new Date(e),i=r.getTimezoneOffset()<0,o=r.getFullYear()+"",a=n.leftPad(r.getMonth()+1+"",2),s=n.leftPad(r.getDate()+"",2),u=n.leftPad(r.getHours()+"",2),l=n.leftPad(r.getMinutes()+"",2),c=n.leftPad(r.getSeconds()+"",2),d=(i?"+":"-")+n.leftPad(i?(Math.ceil(r.getTimezoneOffset()/60)+"").replace("-",""):Math.floor(r.getTimezoneOffset()/60)+"",2)+n.leftPad((r.getTimezoneOffset()%60).toString().replace("-",""),2);return t?o+"-"+a+"-"+s+"T"+u+":"+l+":"+c+d:o+a+s+"T"+u+l+c+d;};},2638:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(865),i=r(1242),o=r(1039);t.getRelativeDateTimeStringForLists=function(e,t){void 0===t&&(t=!1);var r=e.split("|");if("0"===r[0])return e.substring(2);var a="1"===r[1],s=r[2],u=r[3]||"",l=r[4]||"";switch(s){case"1":return i.getRelativeDateTimeResx("AFewSeconds",t,a);case"2":return i.getRelativeDateTimeResx("AboutAMinute",t,a);case"3":return i.getRelativeDateTimeIntervalString(Number(u),"XMinutes",t,a);case"4":return i.getRelativeDateTimeResx("AboutAnHour",t,a);case"5":return u?n.format(i.getRelativeDateTimeResx(a?"TomorrowAndTime":"YesterdayAndTime",t),u):i.getRelativeDateTimeResx(a?"Tomorrow":"Yesterday",t);case"6":return i.getRelativeDateTimeIntervalString(Number(u),"XHours",t,a);case"7":return l?n.format(o.default.RelativeDateTime_DayAndTime,u,l):u;case"8":return i.getRelativeDateTimeIntervalString(Number(u),"XDays",t,a);case"9":return i.getRelativeDateTimeResx("Today",t);}return null;};},2639:function _(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Small="S",e.Medium="M",e.Large="L";}(n=t.UserPhotoSize||(t.UserPhotoSize={})),t.getUserPhotoUrl=function(e){var t=e.webUrl||"",r=e.size||n.Small;return t+"/_layouts/15/userphoto.aspx?accountname="+e.userLoginName+"&size="+r;};},2640:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1244),o=r(1247);n.__exportStar(r(1247),t);var a=function(e){function t(t,r){var n=e.call(this,{webAbsoluteUrl:r.pageContext.webAbsoluteUrl,encodeWebAbsoluteUrl:r.encodeWebAbsoluteUrl})||this;return n._pageContext=r.pageContext,n._shouldEncodeWebAbsoluteUrl=r.encodeWebAbsoluteUrl,n._itemUrlHelper=r.itemUrlHelper,n;}return n.__extends(t,e),t.prototype.webByUrl=function(e){return this.webByItemUrl(this._itemUrlHelper.getUrlParts(e));},t.prototype.webByItemUrl=function(e){var t=e.siteRelation,r=e.isCrossDomain,n=e.fullItemUrl,o=this;return(r||t===i.SiteRelation.crossSite)&&(o=o.method("SP.RemoteWeb",n)),o.segment("web");},t.prototype.listById=function(e,t){return this.webByItemUrl(e).segment("lists").method("GetById",t);},t.prototype.clone=function(){return new t({webAbsoluteUrl:this._pageContext.webAbsoluteUrl},{pageContext:this._pageContext,itemUrlHelper:this._itemUrlHelper,encodeWebAbsoluteUrl:this._shouldEncodeWebAbsoluteUrl});},t;}(o.ApiUrlBasic);t.ApiUrl=a;var s=function(e){function t(t,r){var i=e.call(this,{webAbsoluteUrl:r&&r.pageContext?r.pageContext.webAbsoluteUrl:"",encodeWebAbsoluteUrl:r.encodeWebAbsoluteUrl})||this,o=r.itemUrlHelper,s=r.pageContext,u=r.encodeWebAbsoluteUrl,l=r.apiUrlType,c=void 0===l?function(e){function t(){return e.call(this,{},{itemUrlHelper:o,pageContext:s,encodeWebAbsoluteUrl:u})||this;}return n.__extends(t,e),t;}(a):l;return i._apiUrlType=c,i;}return n.__extends(t,e),t.prototype.build=function(){return new this._apiUrlType();},t;}(o.ApiUrlHelperBasic);t.ApiUrlHelper=s;},2641:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1248),o=function(){function e(e,t){var r=this._pageContext=t.pageContext,o=t.dataRequestorType,a=void 0===o?function(e){function t(t){return e.call(this,t,{pageContext:r})||this;}return n.__extends(t,e),t;}(i.default):o,s=e.dataSourceName,u=void 0===s?"DataSource":s;this.dataSourceName=u,this.dataRequestor=new a({qosName:u});}return e.prototype.needsRequestDigest=function(e){return!0;},e.prototype.getData=function(e,t,r,n,i,o,a,s,u,l,c,d,p){void 0===i&&(i="POST");var h=e();return this.dataRequestor.getData({url:h,parseResponse:t,qosName:r,qosHandler:c,customQosLogger:d,additionalPostData:n&&n(),method:i,additionalHeaders:o,contentType:a,maxRetries:s,noRedirect:u,qosExtraData:p,crossSiteCollectionCall:l,needsRequestDigest:this.needsRequestDigest(h)});},e;}();t.DataSource=o,t.default=o;},2642:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1038);t.default=function(e){var t,r=e.adjustRetries,i=e.async,o=e.beforeRetry,a=e.callback,s=e.canRetry,u=void 0===s?function(){return!0;}:s,l=e.delay,c=e.resetAttemptsOnRestart,d=e.retries,p=e.shouldRestart,h=0,f=new n.default(function(){t.cancel();});function m(e){p&&p()?(c&&(h=0),g()):f.complete(e);}function _(e){r&&(d=r(e)),h<d&&u(e)?(h++,o&&o(),"number"==typeof l&&i?i.setTimeout(g,l):g()):f.error(e);}function g(){(t=a()).then(m,_);}return g(),f.getPromise();};},2643:function _(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.none=0]="none",e[e.fullPageLoad=4]="fullPageLoad",e[e.onePageAppNavigation=5]="onePageAppNavigation";}(n||(n={})),t.default=n;},2644:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(0).__exportStar(r(1249),t);var n=r(1249);t.default=n.RUMOneDataUpload;},2645:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1042);t.default=n.PlatformDetection;},2646:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=window.performance,i=!!n&&"function"==typeof n.mark&&"function"==typeof n.clearMarks&&"function"==typeof n.now;t.HighResolutionTimingSupported=i,t.MARKER_PREFIX="EUPL.";var o=0,a=window._perfMarks=window._perfMarks||[];function s(e){var t=u(e);if(i){var r=n.getEntriesByName(t);return r&&r.length>0?Math.round(r[0].startTime):NaN;}var o=a.filter(function(e){return e.name===t;})[0];return o&&o.startTime;}function u(e){return 0===e.lastIndexOf(t.MARKER_PREFIX,0)?e:t.MARKER_PREFIX+e;}t.mark=function(e,t){var r=u(e);(null==t||o<t)&&(i?n.mark(r):a.push({name:r,startTime:Date.now()}),o++);},t.measure=function(e,t,r){if(i&&s(t)>0&&s(r)>0)try{n.measure(u(e),u(t),u(r));}catch(e){}},t.getMarkerTime=s,t.clearMarks=function(e){var r=[];e&&(r=e.map(u)),i?n.getEntriesByType("mark").filter(function(e){return r.length>0?r.indexOf(e.name)>=0:0===e.name.lastIndexOf(t.MARKER_PREFIX,0);}).forEach(function(e){n.clearMarks(e.name);}):a=[];},t.getAllMarks=function(){return i?n.getEntriesByType("mark").filter(function(e){return 0===e.name.lastIndexOf(t.MARKER_PREFIX,0);}):a;};},2647:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2648),i=r(1037),o=r(2649),a=r(2651),s=r(1041),u=r(2652),l=r(846),c=r(1028),d=r(1042),p=r(959),h=function(){function e(e){void 0===e&&(e={}),this._scope=new o.default(),this._events=this._scope.attach(new u.default(this));var t=e.webAbsoluteUrl||e.webUrl;this._webServerRelativeUrl=e.webServerRelativeUrl||t&&new i.default(t).getPath(),"/"===this._webServerRelativeUrl&&(this._webServerRelativeUrl=""),t?(this._webAbsoluteUrl=t,this._alwaysGetDigest=!0):this._alwaysGetDigest=!1,this._needsRequestDigest=!1!==e.needsRequestDigest,this._needsRequestDigest&&this._tryLoadDigest(e.formDigest),this._requestCanaryForAuth=!1;}return e._useNewFormDigestExpirationCheck=function(){var e=new d.PlatformDetection().isMagellan;return!c.Killswitch.isActivated("962F4C55-E822-4A91-AC89-601FA33A965F","3/23/2019","Use New Form Digest Expiration")&&e;},e._isXhrAborted=function(e){try{if(4===e.readyState&&(void 0===e.status||0===e.status))return!0;if(e.isCancelled)return!0;}catch(e){return!0;}return!1;},e._isValidFormDigest=function(t){return e._useNewFormDigestExpirationCheck()?t&&t.serverTime&&Date.now()-new Date(t.serverTime).getTime()<1e3*t.formDigestTimeoutSeconds-1e3:t&&t.updateFormDigestPageLoaded&&Date.now()-t.updateFormDigestPageLoaded.getTime()<1e3*t.formDigestTimeoutSeconds;},e.prototype.dispose=function(){this._scope.dispose();},e.prototype.abort=function(){if(this._currentRequest){var e=this._currentRequest;e.isCancelled=!0,e.abort(),this._currentRequest=void 0;}},e.prototype.isRequestActive=function(){return!!this._currentRequest;},e.prototype.getServerDataFromUrl=function(e){var t=this,r=e.url,n=e.successCallback,i=e.failureCallback,o=e.uploadProgressCallback,a=e.additionalPostData,s=e.isRest,u=void 0===s||s,l=e.method,c=void 0===l?"POST":l,d=e.withCredentials,p=e.additionalHeaders,h=e.contentType,f=e.noRedirect,m=e.responseType,_=e.needsRequestDigest,g=void 0===_?this._needsRequestDigest:_,v=new Date().toISOString(),y=new XMLHttpRequest();y.open(c,r,!0),"boolean"==typeof d&&(y.withCredentials=d),m&&(y.responseType=m),h?y.setRequestHeader("Content-Type",h):u?y.setRequestHeader("Content-Type","application/json;odata=verbose"):y.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var S=!1;if(p)for(var I in p){I&&(y.setRequestHeader(I,p[I]),"accept"===I.toLowerCase()&&(S=!0));}S||y.setRequestHeader("accept","application/json;odata=verbose"),this._currentRequest=y;var T=function T(e){g&&e&&y.setRequestHeader("x-requestdigest",e),t._events.on(y,"readystatechange",function(){t._onReadyStateChange(y,r,n,i,f,v);}),o&&y.upload&&t._events.on(y.upload,"progress",function(e){o(e);}),y.send(a);};g?this._ensureRequestDigest(T,i):T();},e.prototype.ensureRequestDigest=function(e,t){this._ensureRequestDigest(e,t);},e.prototype._ensureRequestDigest=function(t,r){var n=e._formDigests[this._webServerRelativeUrl];!this._alwaysGetDigest&&e._isValidFormDigest(n)?t(n.formDigestValue):this._ensureRequestDigestWorker(t,r);},e.prototype._ensureRequestDigestWorker=function(t,r){var n=this,o=new Date(),a=new e({needsRequestDigest:!1,webServerRelativeUrl:this._webServerRelativeUrl,webUrl:void 0});t||(a._requestCanaryForAuth=!0);var s=this._webAbsoluteUrl||this._webServerRelativeUrl;"string"==typeof s?(e._requestDigestPromise||(e._requestDigestPromise=new l.default(function(u,l){a.getServerDataFromUrl({url:i.default.concatenate(s,"/_api/contextinfo"),successCallback:function successCallback(t){var r=t.getResponseText(),i=JSON.parse(r).d.GetContextWebInformation;e._formDigests[n._webServerRelativeUrl]={serverTime:o.toISOString(),formDigestValue:i.FormDigestValue,formDigestTimeoutSeconds:i.FormDigestTimeoutSeconds-e.INTERVAL_ADJUST,updateFormDigestPageLoaded:new Date()},u(e._formDigests[n._webServerRelativeUrl].formDigestValue),e._requestDigestPromise=void 0;},failureCallback:function failureCallback(n){t?t(void 0):r&&r(n),l(void 0),e._requestDigestPromise=void 0;},method:"POST",noRedirect:!!r});})),e._requestDigestPromise.then(function(e){return t&&t(e),e;})):r&&r(void 0,new p.ApiError({code:"MissingWebForDigestAuth",isExpected:!1}));},e.prototype._onReadyStateChange=function(t,r,i,o,u,l){if(4===t.readyState)if(this._currentRequest=void 0,this._events.off(t),t.upload&&this._events.off(t.upload),e._isXhrAborted(t))o(void 0,new p.ApiError({code:"RequestAborted",isExpected:!0}));else{var c=new n.default(t,r,{webAbsoluteUrl:this._webAbsoluteUrl||this._webServerRelativeUrl,isCanaryRequest:this._requestCanaryForAuth}),d=c.getStatus(),h=s.RUMOneLogger.getRUMOneLogger(),f=Date.now();if(h){var m=new a.default(r,Number(t.getResponseHeader("SPClientServiceRequestDuration")),t.getResponseHeader("SPRequestGuid"),d,l,new Date().toISOString());h.writeAPICallPerformanceData(m),h.saveTempData("appDataFetchEnd",f);}var _=!u&&c.shouldRedirectToErrorCustomPromptLocation();if(this._requestCanaryForAuth){if(this._requestCanaryForAuth=!1,403===d){var g=c.getRedirectLoginPageUrl();try{_?window.location.href=c.getRedirectToErrorCustomPromptLocation():o(c);}catch(e){}g&&!u&&(window.location.href=g);}else{g=c.getAccessDeniedRedirectUrl();try{o(c);}catch(e){}g&&!u&&(window.location.href=g);}return;}if(200===d||201===d||204===d)return void i(c);if(403===d)return e._requestDigestPromise=void 0,void(u?this._ensureRequestDigestWorker(void 0,function(){return o(c);}):_?window.location.href=c.getRedirectToErrorCustomPromptLocation():this._ensureRequestDigestWorker(void 0));401===d&&_&&(window.location.href=c.getRedirectToErrorCustomPromptLocation()),o(c);}},e.prototype._tryLoadDigest=function(t){var r=e._formDigests[this._webServerRelativeUrl];!e._isValidFormDigest(t)||e._isValidFormDigest(r)&&!(e._useNewFormDigestExpirationCheck()?new Date(r.serverTime).getTime()<new Date(t.serverTime).getTime():r.updateFormDigestPageLoaded.getTime()<t.updateFormDigestPageLoaded.getTime())||(e._formDigests[this._webServerRelativeUrl]=t);},e.INTERVAL_ADJUST=10,e._formDigests={},e._requestDigestPromise=void 0,e;}();t.default=h;},2648:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1038),i=r(1037),o=r(1034);t.SERVICEWORKER_DATASOURCE_HEADER_KEY="X-SERVICEWORKER-DATA-SOURCE";var a=function(){function e(e,t,r){this._request=e,this._url=t,this._webAbsoluteUrl=r&&r.webAbsoluteUrl,this._isCanaryRequest=r&&r.isCanaryRequest;}return e.prototype.getSourceUrl=function(){return this._url;},e.prototype.getCorrelationId=function(){return this._request.getResponseHeader("SPRequestGuid");},e.prototype.getGroupThrottle=function(){return this._request.getResponseHeader("SPGroupThrottle");},e.prototype.getMSCorrelationVector=function(){return this._request.getResponseHeader("MS-CV");},e.prototype.getServiceWorkerDataSourceHeader=function(){return this._request.getResponseHeader(t.SERVICEWORKER_DATASOURCE_HEADER_KEY);},e.prototype.getStatus=function(){try{return this._request.status;}catch(e){}},e.prototype.getAuthenticationRedirect=function(){return this._request.getResponseHeader("X-Forms_Based_Auth_Required");},e.prototype.getResponseType=function(){return this._request.responseType;},e.prototype.getResponseText=function(){return this._request.responseType&&"text"!==this._request.responseType?this._request.response:this._request.responseText;},e.prototype.getErrorResponseText=function(){if("blob"===this._request.responseType){var e={status:this._request.status,statusText:this._request.statusText,infected:void 0};return this._request.getResponseHeader("x-virus-infected")&&(e.infected=!0),e;}return this.getResponseText();},e.prototype.parseError=function(){var e=this,t=new n.default();return this._request.responseType&&"text"!==this._request.responseType?"blob"===this._request.responseType?function(e){var t,r=new n.default(),i=function i(){if(t.result){var e=void 0;try{e=JSON.parse(t.result),r.complete(e);}catch(e){r.complete({message:"Unable to parse blob result."});}}},o=function o(){r.complete({message:"Unable to read blob error response."});};try{(t=new FileReader()).addEventListener("load",i),t.addEventListener("error",o),t.readAsText(e);}catch(e){o();}return r.getPromise().then(function(e){return t&&(t.removeEventListener("load",i),t.removeEventListener("error",o)),e;});}(this._request.response).then(function(r){var n={data:r,status:e.getStatus(),statusText:e._request.statusText,infected:!!e._request.getResponseHeader("x-virus-infected")};t.complete(n);}):t.complete(this._request.response):t.complete(this._request.responseText),t.getPromise();},e.prototype.getValue=function(t){var r;switch(t){case e.DataValueKeys.SourceURL:r=this.getSourceUrl();break;case e.DataValueKeys.CorrelationId:r=this.getCorrelationId();break;case e.DataValueKeys.Status:r=this.getStatus();break;case e.DataValueKeys.AuthenticationRedirect:r=this.getAuthenticationRedirect();break;case e.DataValueKeys.ResponseText:r=this.getResponseText();break;case e.DataValueKeys.ErrorResponseText:r=this.getErrorResponseText();}return r;},e.prototype.getRedirectUrl=function(){if(this._isCanaryRequest)return 403===this.getStatus()?this.shouldRedirectToErrorCustomPromptLocation()?this.getRedirectToErrorCustomPromptLocation():this.getRedirectLoginPageUrl():this.getAccessDeniedRedirectUrl();if(403===this.getStatus()){if(this.shouldRedirectToErrorCustomPromptLocation())return this.getRedirectToErrorCustomPromptLocation();}else if(401===this.getStatus()&&this.shouldRedirectToErrorCustomPromptLocation())return this.getRedirectToErrorCustomPromptLocation();},e.prototype.getRedirectLoginPageUrl=function(){var e,t=this.getAuthenticationRedirect();if(t){var r=new i.default(t);r.setQueryParameter("ReturnUrl",o.default.encodeURIComponent(window.location.href)),e=r.toString();}return e;},e.prototype.getAccessDeniedRedirectUrl=function(){var e;if(this._webAbsoluteUrl){var t=this._webAbsoluteUrl+"/_layouts/15/AccessDenied.aspx";if(t){var r=new i.default(t);r.setQueryParameter("Source",o.default.encodeURIComponent(window.location.href)),r.setQueryParameter("Type","list"),r.setQueryParameter("correlation",o.default.encodeURIComponent(this.getCorrelationId())),e=r.toString();}}return e;},e.prototype.getRedirectToErrorCustomPromptLocation=function(){var e=new i.default(this._request.getResponseHeader("X-SPO-ErrorCustomPromptLocation"));return e.setQueryParameter("ReturnUrl",window.location.href),e.toString();},e.prototype.shouldRedirectToErrorCustomPromptLocation=function(){var e=this._request.getResponseHeader("X-SPO-ErrorCode"),t=this._request.getResponseHeader("sharepointerror");return"9.3"===e||"-2130575129"===t;},e.DataValueKeys={SourceURL:"SourceUrl",CorrelationId:"CorrelationId",Status:"Status",AuthenticationRedirect:"AuthenticationRedirect",ResponseText:"ResponseText",ErrorResponseText:"ErrorResponseText",GroupThrottle:"GroupThrottle"},e;}();t.default=a;},2649:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2650),i=function(){function e(){this._disposables={},this._lastDisposableId=0;}return e.prototype.attached=function(e){var t=this,r=function r(){for(var r=[],n=0;n<arguments.length;n++){r[n]=arguments[n];}return t.attach(e.apply(this,r)||this);};if("undefined"!=typeof DEBUG&&DEBUG){var n=r;r=function r(){for(var t=[],r=0;r<arguments.length;r++){t[r]=arguments[r];}return n.apply(Object.create(e.prototype),t);};}return r.prototype=e.prototype,r;},e.prototype.attach=function(e){var t=this,r=""+ ++this._lastDisposableId,i=n.hook(e,function(){delete t._disposables[r];});return this._disposables[r]=i,i;},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0);for(var e=this._disposables,t=0,r=Object.keys(e);t<r.length;t++){var i=r[t],o=e[i];o&&n.isDisposable(o)&&o.dispose(),delete e[i];}},e;}();t.default=i;},2650:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this._callbacks=[],this._owner=e;}return e.prototype.addCallback=function(e){this._callbacks.push(e);},e.prototype.dispose=function(){for(;this._callbacks.length;){this._callbacks.pop().call(this._owner);}},e;}();t.isDisposable=function(e){return"function"==typeof e.dispose;},t.hook=function(e,t){var r=e,i=r.dispose,o="function"==typeof i&&i.disposalChain;if(!o){o=new n(r);var a=function a(){o.dispose(),i&&(r.dispose=i,r.dispose());};r.dispose=a,a.disposalChain=o;}return o.addCallback(t),r;};},2651:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1041);t.default=n.APICallPerformanceData;},2652:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1031),i=r(1226);function o(e){n.default.log(e);}var a=function(){function e(t,r){void 0===r&&(r=o),this._id=e._uniqueId++,this._parent=t,this._onError=r,this._eventRecords=[];}return e.raise=function(e,t,r,n){return i.raise(e,t,r,n);},e.isObserved=function(e,t){var r=e&&e.__events__;return!!r&&!!r[t];},e.isDeclared=function(e,t){var r=e&&e.__declaredEvents;return!!r&&!!r[t];},e.stopPropagation=function(e){e.stopPropagation&&e.stopPropagation();},e.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this.off(),this._parent=null);},e.prototype.onAll=function(e,t,r){for(var n in t){this.on(e,n,t[n],r);}},e.prototype.on=function(t,r,n,o){var a=this;if(r.indexOf(",")>-1)for(var s=r.split(/[ ,]+/),u=0;u<s.length;u++){this.on(t,s[u],n,o);}else{var l=this._parent,c={target:t,eventName:r,parent:l,callback:n,objectCallback:null,elementCallback:null,useCapture:o},d=t.__events__=t.__events__||{};if(d[r]=d[r]||{count:0},d[r][this._id]=d[r][this._id]||[],d[r][this._id].push(c),d[r].count++,i.isDOMEventTarget(t)){var p=function p(){for(var t=[],r=0;r<arguments.length;r++){t[r]=arguments[r];}if(!a._isDisposed){try{var i=n.apply(l,t);if(!1===i&&t[0]&&t[0].preventDefault){var o=t[0];o.preventDefault(),e.stopPropagation(o);}}catch(o){a._onError(o);}return i;}};c.elementCallback=p,t.addEventListener(r,p,o);}else{c.objectCallback=function(){for(var e=[],t=0;t<arguments.length;t++){e[t]=arguments[t];}if(!a._isDisposed)return n.apply(l,e);};}this._eventRecords.push(c);}},e.prototype.off=function(e,t,r,n){for(var i=0;i<this._eventRecords.length;i++){var o=this._eventRecords[i];if(!(e&&e!==o.target||t&&t!==o.eventName||r&&r!==o.callback||"boolean"==typeof n&&n!==o.useCapture)){var a=o.target.__events__,s=a[o.eventName],u=s?s[this._id]:null;u&&(1!==u.length&&r?(s.count--,u.splice(u.indexOf(o),1)):(s.count-=u.length,delete a[o.eventName][this._id]),s.count||delete a[o.eventName]),o.elementCallback&&o.target.removeEventListener&&o.target.removeEventListener(o.eventName,o.elementCallback,o.useCapture),this._eventRecords.splice(i--,1);}}},e.prototype.raise=function(t,r,n){return e.raise(this._parent,t,r,n);},e.prototype.declare=function(e){var t=this._parent.__declaredEvents=this._parent.__declaredEvents||{};if("string"==typeof e)t[e]=!0;else for(var r=0;r<e.length;r++){t[e[r]]=!0;}},e._uniqueId=0,e;}();t.EventGroup=a,t.default=a;},2653:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e){function t(t){var r=this,i=t.errorData,o=void 0===i?{status:0,code:""}:i,a=o.message,s=void 0===a?void 0:a,u=o.correlationId,l=void 0===u?void 0:u,c=o.code,d=void 0===c?void 0:c,p=n.__rest(o,["message","correlationId","code"]),h="object"==_typeof(s)?s?"string"==typeof s.value?s.value:JSON.stringify(s):""+s:s,f=n.__assign({correlationId:l,code:d,message:h},t,{extraData:n.__assign({},t.extraData||{},{status:p.status,infected:p.infected,groupThrottle:p.groupThrottle,statusText:p.statusText})});(r=e.call(this,f)||this).name="GetDataError",r.errorData=t.errorData;for(var m=0,_=Object.keys(p);m<_.length;m++){var g=_[m];r[g]=p[g];}return r;}return n.__extends(t,e),t;}(r(959).ApiError);t.GetDataError=i;},2654:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1239),i=r(1240),o=r(1246),a=r(2655),s=r(1250),u=r(1028);t.ENABLE_PARAM_KEY="enableFeatures",t.DISABLE_PARAM_KEY="disableFeatures";var l="Store",c={ODB:587,ODC:"AllowFeatureOverrides",Fallback:!1},d={ODB:357,ODC:null,Fallback:!1},p={ODB:342,ODC:null,Fallback:!1},h={},f=new a.default("FeatureOverrides",s.default.session),m="FeatureOverrides_"+t.ENABLE_PARAM_KEY,_="FeatureOverrides_"+t.DISABLE_PARAM_KEY;function g(e){var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():"";}!function(){var e=u.Killswitch.isActivated("CA76C674-5DEE-4C8A-9EDF-82C275E0CF01","11/27/2018","Don't save enable/disable features query params to session storage");if(e){var r=f.getValue(l);h=r||{};}else h=function(){var e={},t=g(m);if(t)for(var r=0,n=t.split(",");r<n.length;r++){e[n[r]]=!0;}var i=g(_);if(i)for(var o=0,a=i.split(",");o<a.length;o++){e[a[o]]=!1;}return e;}();var n=location.search?location.search.substring(1):"",i=o.deserializeQuery(n),a=i[t.ENABLE_PARAM_KEY];if(a)for(var s=0,c=a.split(",");s<c.length;s++){var d=c[s];h[d]=!0;}var p=i[t.DISABLE_PARAM_KEY];if(p)for(var v=0,y=p.split(",");v<y.length;v++){d=y[v];h[d]=!1;}e?f.setValue(l,h):function(e){var t=[],r=[];for(var n in e){(e[n]?t:r).push(n);}document.cookie=m+"="+t.join(",")+";path=/",document.cookie=_+"="+r.join(",")+";path=/";}(h);}();var v=function(){function e(){}return Object.defineProperty(e,"Overrides",{get:function get(){return h;},enumerable:!0,configurable:!0}),e.evaluateCanOverride=function(){"undefined"!=typeof DEBUG&&DEBUG?e.CanOverride=!0:e.CanOverride=n.default.isFeatureEnabled(c)||n.default.isFeatureEnabled(d)||n.default.isFeatureEnabled(p);},e.isFeatureEnabled=function(t,r){if(e.CanOverride){if(t.ODB in h)return h[t.ODB];if(t.ODC in h)return h[t.ODC];}return r?i.isSPFeatureEnabled(t,r):n.default.isFeatureEnabled(t);},e.AllowFeatureOverrides=c,e.SPODebugOnlyCookieRedirect=d,e;}();t.default=v,v.evaluateCanOverride();},2655:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1250),i=function(){function e(t,r){(void 0===r&&(r=n.default.none),e.init(),this.dataStoreKey=t,this.defaultCachingType=r,r===n.default.none)?this.dataStore={}:(void 0===e._dataStore[this.dataStoreKey]&&(e._dataStore[this.dataStoreKey]={}),this.dataStore=e._dataStore[this.dataStoreKey]);}return e.hasStorageType=function(t){switch(e.init(),t){case n.default.none:case n.default.sharedMemory:return!0;case n.default.session:return!!e._sessionStorage;case n.default.local:return!!e._localStorage;}return!1;},e.init=function(){if(!e._initialized){try{"localStorage"in window&&window.localStorage&&e.testStorage(window.localStorage)&&(e._localStorage=window.localStorage);}catch(e){}try{"sessionStorage"in window&&window.sessionStorage&&e.testStorage(window.sessionStorage)&&(e._sessionStorage=window.sessionStorage);}catch(e){}null==e._localStorage&&(e._localStorage=e._sessionStorage),e._initialized=!0;}},e.testStorage=function(e){var t="BrowserStorageTest",r=!1;try{e.setItem(t,"1"),"1"===e.getItem(t)&&(r=!0),e.removeItem(t);}catch(e){}return r;},e.prototype.setValue=function(e,t,r,n){void 0===n&&(n=!0),e=n?this.normalizeKey(e):e,this.dataStore[e]=t;var i=this.getStorage(r);if(i)try{var o=[],a=JSON.stringify(t,function(e,t){if("object"==_typeof(t)&&null!==t){if(-1!==o.indexOf(t))return;o.push(t);}return t;});o=null,i.setItem(this.dataStoreKey+e,a);}catch(e){}},e.prototype.getValue=function(e,t,r){void 0===r&&(r=!0),e=r?this.normalizeKey(e):e;var n=this.dataStore[e],i=this.getStorage(t);if(void 0===n&&i){var o=i.getItem(this.dataStoreKey+e);if(o)try{n=JSON.parse(o),this.dataStore[e]=n;}catch(e){n=void 0;}}return n;},e.prototype.remove=function(e,t,r){void 0===r&&(r=!0),e=r?this.normalizeKey(e):e;var n=this.getStorage(t);n&&n.removeItem(this.dataStoreKey+e),delete this.dataStore[e];},e.prototype.getStorage=function(t){switch(t||this.defaultCachingType){case n.default.none:case n.default.sharedMemory:return null;case n.default.session:return e._sessionStorage;case n.default.local:return e._localStorage;}return null;},e.prototype.normalizeKey=function(e){return e&&e.toLowerCase()||"";},e._sessionStorage=null,e._localStorage=null,e._dataStore={},e._initialized=!1,e;}();t.default=i;},2656:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Default=0]="Default",e[e.Tenant=1]="Tenant",e[e.Hub=2]="Hub",e[e.Site=3]="Site";}(t.SearchScopeType||(t.SearchScopeType={})),function(e){e[e.FooterEnabled=2]="FooterEnabled",e[e.MegaMenuEnabled=128]="MegaMenuEnabled",e[e.FooterEmphasis0=256]="FooterEmphasis0",e[e.FooterEmphasis1=512]="FooterEmphasis1",e[e.FooterLayout0=1024]="FooterLayout0",e[e.FooterLayout1=2048]="FooterLayout1";}(t.SPWebPropertyFlags2||(t.SPWebPropertyFlags2={})),t.DEFAULT_LOGO_URL="_layouts/15/images/siteicon.png",t.getServerUrl=function(e){var t=e.webAbsoluteUrl,r=e.webServerRelativeUrl;return"/"===r||""===r?t:t.substring(0,t.lastIndexOf(r));},t.getSafeWebServerRelativeUrl=function(e){return"/"===e.webServerRelativeUrl?"":e.webServerRelativeUrl;},t.isGroupWebContext=function(e){return e&&!!e.groupId&&e.webAbsoluteUrl===e.siteAbsoluteUrl;},t.isModernTemplate=function(e){return-1!==["STS#3","GROUP#0","SITEPAGEPUBLISHING#0"].indexOf(e.webTemplateConfiguration);};},2657:function _(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Media=2]="Media",e[e.OneNote=3]="OneNote",e[e.Unknown=4]="Unknown",e[e.Error=5]="Error",e[e.App=6]="App",e[e.Subsite=7]="Subsite",e[e.Shortcut=8]="Shortcut";}(n=t.ItemType||(t.ItemType={})),t.default=n;},2658:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2659),i=function(){function e(e){this._itemUrlHelper=e.itemUrlHelper,this._sharingContextInformation=e.sharingContextInformation;}return e.prototype.getApiRoot=function(e,t,r){if(this._sharingContextInformation){if(this._sharingContextInformation.uniqueId){var i=this._sharingContextInformation.isFolder?"GetFolderById":"GetFileById",o={guid:this._sharingContextInformation.uniqueId};return e.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method(i,o).segment("ListItemAllFields");}return this._sharingContextInformation.listUrl?e.build().webByUrl({listUrl:this._sharingContextInformation.listUrl}).method("GetListItem",this._sharingContextInformation.serverRelativeItemUrl):this._sharingContextInformation.itemUrl?e.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("GetFileByUrl",n.canonicalizeUrl(this._sharingContextInformation.itemUrl)).segment("ListItemAllFields"):this._sharingContextInformation.listId&&this._sharingContextInformation.listItemId?e.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("Lists",this._sharingContextInformation.listId).method("GetItemById",this._sharingContextInformation.listItemId):e.build().webByUrl({webUrl:this._sharingContextInformation.webAbsoluteUrl}).method("GetListItemByResourceId",this._sharingContextInformation.resourceId);}var a;a=t.properties.path?this._itemUrlHelper.getUrlParts({path:t.properties.path}):this._itemUrlHelper.getItemUrlParts(t.key);var s=e.build().webByItemUrl(a).method("Lists",r);return s=t.properties.ID?s.method("GetItemById",t.properties.ID):s.method("GetItemByUniqueId",t.properties.uniqueId);},e.prototype.getFileUrl=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).fullItemUrl;},e.prototype.canUseSecurable=function(e){var t=e.properties;return!!t&&(!!t.ID||!!t.uniqueId);},e;}();t.default=i;},2659:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1251);n.__exportStar(r(1251),t),t.getFolderNameFromPath=function(e){var t=e.lastIndexOf("/");return t>=0?e.substring(t+1):e;},t.getSharePointPath=function(e){return decodeURI(e);},t.canonicalizeUrl=function(e){var t;try{t=decodeURI(e);}catch(r){t=e;}return e=t===e?i.encodePath(e,!0):e.replace("#","%23");},t.canonicalizeDecodedUrl=function(e){return e&&e.indexOf("?")<0&&(e=(e=encodeURI(e)).replace(/#/g,"%23")),e;},t.getDecodedUrl=function(e){var t=e.split("/");if(t.length>3){for(var r=3;r<t.length;r++){t[r]=decodeURIComponent(t[r]);}return t.join("/");}return e;};},2660:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(0).__exportStar(r(1252),t);var n=r(1252);t.default=n.default;},2661:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1238),i=function(){function e(e){this._dataSource=e.sharingDataSource||new n.SharingDataSource({getParentListId:e.getParentListId,pageContext:e.pageContext}),this._itemProvider=e.itemProvider;}return e.prototype.getSharingInformation=function(e,t,r,n){return this._dataSource.getSharingInformation(e,t,r,n);},e.prototype.shareLink=function(e){var t=this;return this._dataSource.shareLink(e).then(function(r){return t._invalidateItem(e.items[0]),r;});},e.prototype.unshareLink=function(e){var t=this;return this._dataSource.unshareLink(e).then(function(r){return t._invalidateItem(e.item),r;});},e.prototype.updatePermissions2=function(e,t,r){var n=this;return this._dataSource.updatePermissions2(e,t,r).then(function(e){return n._invalidateItem(t),e;});},e.prototype.updatePermissionsMultiple=function(e,t,r,n,i){var o=this;return this._dataSource.updatePermissionsMultiple(e,t,r,n,i).then(function(e){return o._invalidateItem(t),e;});},e.prototype.getClientId=function(){return this._dataSource.getClientId();},e.prototype.parseRawSharingInformation=function(e){return this._dataSource.parseRawSharingInformation(e);},e.prototype.emailWithoutPermissioning=function(e,t,r,n){return this._dataSource.emailWithoutPermissioning(e,t,r,n).then(function(e){return e;});},e.prototype.checkPermissions=function(e,t){return this._dataSource.checkPermissions(e,t);},e.prototype.share=function(e,t,r){return this._dataSource.share(e,t).then(function(e){return e;});},e.prototype._invalidateItem=function(e){this._itemProvider&&e&&e.parent&&e.parent.key&&this._itemProvider.invalidateItem(e.parent.key);},e;}();t.SharingProvider=i;},2662:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(2663),o=r(1042),a=function(e){function t(t){var r=new o.PlatformDetection(),i=t.context,a=void 0===i?{}:i;return e.call(this,n.__assign({language:window.navigator.language},t,{context:n.__assign({BrowserIsMobile:r.isMobile,BrowserMajVer:r.browserMajor,BrowserMinVer:r.browserMinor,BrowserName:r.browserName,BrowserUserAgent:r.userAgent,OSName:r.osName,OSVersion:r.osVersion},a)}))||this;}return n.__extends(t,e),t;}(i.SharedAriaTelemetryHandler);t.WebSharedAriaTelemetryHandler=a;},2663:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(2664),o=r(2666),a="eeddb977348d43ebaaae45e759ea6e96-42528e91-0556-4879-9b8d-af7b3b8417e4-6984",s=function(e){function t(t){var i=this,s=t.userAuthToken,u=s&&function(e){try{var t=e.split(".")[1];if(t)return JSON.parse(atob(t.replace(/-/g,"+").replace(/_/g,"/")));}catch(e){return;}}(s),l=t.context,c=void 0===l?{}:l,d=t.clientName,p=t.correlationId,h=t.environment,f=void 0===h?t.ariaEnvironment||"prod":h,m=t.language,_=void 0===m?c.Market:m,g=t.scenario,v=void 0===g?"Unknown":g,y=t.version,S=void 0===y?"Unknown":y,I=t.ariaLoader,T=void 0===I?function(){return n.__awaiter(i,void 0,void 0,function(){return n.__generator(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(function(){return r(2667);})];case 1:return[2,e.sent().aria];}});});}:I,E=u&&u.puid?"Business":"Unknown",b=u&&u.app_displayname||"Unknown",w=u&&u.appid||"Unknown",R=u&&u.puid||"Unknown",D=R?1:0,P=u&&u.tid||"Unknown";return i=e.call(this,{ariaLoader:T,context:n.__assign({AccountType:E,AppName:b,AppId:w,ClientName:d,CorrelationId:p,Environment:f,IsAuthenticated:D,Market:_,Scenario:v,Session:o.generate(),SiteSubscriptionId:P,UserId:R,Version:S,Workload:"SharedControls"},c),tenantToken:a})||this;}return n.__extends(t,e),t;}(i.AriaTelemetryHandler);t.SharedAriaTelemetryHandler=s;},2664:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(956),o=r(2665),a=r(955),s=r(865),u=function(){function e(e){var t=e.logStartEvents,r=void 0===t||t,n=e.context,i=void 0===n?{}:n;this._ariaLoader=e.ariaLoader,this._logStartEvents=r,this._disableCookies=e.disableCookies,this._tenantToken=e.tenantToken,this._ariaQosParams=e.ariaQos,this._ariaOfflineCacheParams=e.offlineCache,this._context=i,this._logConfiguration=e.ariaLogConfiguration;}return e.prototype.attach=function(e){var t,r=this,n=!1;return this._getAria().then(function(i){n||(t=r._createLogHandler(i),e.addLogHandler(t).forEach(t));}),function(){n=!0,t&&e.removeLogHandler(t);};},e.prototype._getAria=function(){var e=this,t=this._ariaLoader().then(function(t){return e._initializeLogManager(t),t;});return this._getAria=function(){return t;},t;},e.prototype._createLogHandler=function(e){var t=this,r=this._createLogger(e),n=this._ariaQosParams;return function(s){try{if(s.enabled&&(s.eventType!==i.ClonedEventType.Start||t._logStartEvents)&&(!n||!n.isQosEvent(s))){var u=o.buildAriaEvent(e,s);r.logEvent(u);}}catch(t){var l=void 0;t instanceof e.Exception&&(l=new Error("Aria error: "+t.toString())),t&&t.handled||a.log(l||t);}};},e.prototype._initializeLogManager=function(e){var t=this,r=this._ariaOfflineCacheParams;e.LogManager.isInitialized()||(e.LogManager.initialize(this._tenantToken,n.__assign({disableCookies:this._disableCookies},r?{browserOverrides:{onGetData:r.getData,onSaveData:r.saveData}}:{},this._logConfiguration||{})),"undefined"!=typeof window&&"function"==typeof window.addEventListener&&window.addEventListener("beforeunload",function(t){e.LogManager.flush();}));var i=this._ariaQosParams;i&&e.LogManager.addCallbackListener(function(e,r,n,o){n===t._tenantToken&&i.reportQos({result:e,statusCode:r,events:o});});},e.prototype._createLogger=function(e){var t=new e.Logger(this._tenantToken),r=this._context,i=r.Session,o=r.Version,a=r.OSName,u=r.OSVersion,l=r.Market,c=r.UserId,d=r.Manifest,p=n.__rest(r,["Session","Version","OSName","OSVersion","Market","UserId","Manifest"]),h=t.getSemanticContext();for(var f in i&&t.setContext("AppInfo.Session",i),d&&t.setContext("AppInfo.Manifest",d),o&&h.setAppVersion(o),h.setUserLanguage(l||""),c&&h.setUserId(c),a&&h.setDeviceOsName(a),u&&h.setDeviceOsVersion(u),p){if(Object.prototype.hasOwnProperty.call(p,f)){var m=p[f];if(null==m)continue;var _=s.capitalize(f);t.setContext(_,p[f]);}}return t;},e;}();t.AriaTelemetryHandler=u;},2665:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(956),i=r(865),o=r(955);function a(e){var t={CorrelationVector:e.vector.toString(),ValidationErrors:e.validationErrors,WebLog_FullName:e.eventName,WebLog_EventType:n.ClonedEventType[e.eventType]};e.eventType===n.ClonedEventType.End&&(t.Duration=e.endTime-e.startTime);for(var r=e.eventName.split(","),o=0,a=r;o<a.length;o++){var s=a[o];s&&(t["WebLog_Type_"+s]=1);}var u=e.data,l=e.context;if(l)for(var c in l){if(Object.prototype.hasOwnProperty.call(l,c)){if(null==(p=l[c]))continue;t[f=i.capitalize(c)]=p;}}if(u)for(var d in u){if(Object.prototype.hasOwnProperty.call(u,d)){var p;if(null==(p=u[d]))continue;var h=e.metadata[d];if(h){var f=h.isPrefixingDisabled?i.capitalize(d):i.capitalize(h.definedInName)+"_"+d,m=h.type;if(4===m){for(var _ in p){if(Object.prototype.hasOwnProperty.call(p,_)){var g=p[_];null!=g&&""!==g&&(t[f+"_"+_.replace(".","_")]=g);}}}else t[f]=6===m?h.typeRef[p]:p;}}}return{name:e.isEventTypePrefixingDisabled?r[r.length-2]:"ev_"+r[r.length-2],values:t};}t.getAriaEventInfo=a,t.buildAriaEvent=function(e,t){var r=a(t),n=r.name,i=r.values,s=new e.EventProperties();return s.name=n,function(e,t,r){var n;try{for(var i in r){Object.prototype.hasOwnProperty.call(r,i)&&(n=i,t.setProperty(i,r[i]));}}catch(t){var a=void 0,s=void 0;throw t instanceof e.Exception&&(a=t.ErrorCode(),s=new Error("Aria error: "+t.toString())),s&&(t.handled=!0,o.logError(s,{errorCode:a,propertyKey:n})),t;}}(e,s,i),s;};},2666:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(0).__exportStar(r(1030),t);},2667:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.aria=r(2668);},2668:function _(e,t,r){var n,i,o,a;(n||(n={})).version="2.9.0",function(e){!function(e){!function(e){e[e.BT_STOP=0]="BT_STOP",e[e.BT_STOP_BASE=1]="BT_STOP_BASE",e[e.BT_BOOL=2]="BT_BOOL",e[e.BT_UINT8=3]="BT_UINT8",e[e.BT_UINT16=4]="BT_UINT16",e[e.BT_UINT32=5]="BT_UINT32",e[e.BT_UINT64=6]="BT_UINT64",e[e.BT_FLOAT=7]="BT_FLOAT",e[e.BT_DOUBLE=8]="BT_DOUBLE",e[e.BT_STRING=9]="BT_STRING",e[e.BT_STRUCT=10]="BT_STRUCT",e[e.BT_LIST=11]="BT_LIST",e[e.BT_SET=12]="BT_SET",e[e.BT_MAP=13]="BT_MAP",e[e.BT_INT8=14]="BT_INT8",e[e.BT_INT16=15]="BT_INT16",e[e.BT_INT32=16]="BT_INT32",e[e.BT_INT64=17]="BT_INT64",e[e.BT_WSTRING=18]="BT_WSTRING",e[e.BT_UNAVAILABLE=127]="BT_UNAVAILABLE";}(e.BondDataType||(e.BondDataType={})),function(e){e[e.MARSHALED_PROTOCOL=0]="MARSHALED_PROTOCOL",e[e.MAFIA_PROTOCOL=17997]="MAFIA_PROTOCOL",e[e.COMPACT_PROTOCOL=16963]="COMPACT_PROTOCOL",e[e.JSON_PROTOCOL=21322]="JSON_PROTOCOL",e[e.PRETTY_JSON_PROTOCOL=20554]="PRETTY_JSON_PROTOCOL",e[e.SIMPLE_PROTOCOL=20563]="SIMPLE_PROTOCOL";}(e.ProtocolType||(e.ProtocolType={}));}(e.Bond||(e.Bond={}));}(i||(i={})),function(e){!function(e){!function(e){var t=function(){function e(){this._buffer=[];}return e.prototype.Add=function(e){for(var t=0;t<this._buffer.length&&this._buffer[t]!=e;++t){;}t==this._buffer.length&&this._buffer.push(e);},e.prototype.Count=function(){return this._buffer.length;},e.prototype.GetBuffer=function(){return this._buffer;},e;}();e.Set=t;var r=function(){function e(){this._buffer=[];}return e.prototype.Add=function(e,t){-1==this._getIndex(e)&&this._buffer.push({Key:e,Value:t});},e.prototype.AddOrReplace=function(e,t){var r=this._getIndex(e);r>=0?this._buffer[r]={Key:e,Value:t}:this._buffer.push({Key:e,Value:t});},e.prototype.Remove=function(e){var t=this._getIndex(e);t>=0&&this._buffer.splice(t,1);},e.prototype.Count=function(){return this._buffer.length;},e.prototype.GetBuffer=function(){return this._buffer;},e.prototype.ContainsKey=function(e){return this._getIndex(e)>=0;},e.prototype.Get=function(e){var t=this._getIndex(e);return t>=0?this._buffer[t].Value:null;},e.prototype._getIndex=function(e){for(var t=0,r=-1;t<this._buffer.length;++t){if(this._buffer[t].Key==e){r=t;break;}}return r;},e;}();e.Map=r;}(e.Collections||(e.Collections={}));}(e.Bond||(e.Bond={}));}(i||(i={})),function(e){!function(t){!function(e){var n=function(){function e(){}return e.GetBytes=function(e){for(var t=[],r=0;r<e.length;++r){var n=e.charCodeAt(r);n<128?t.push(n):n<2048?t.push(192|n>>6,128|63&n):n<55296||n>=57344?t.push(224|n>>12,128|n>>6&63,128|63&n):(n=65536+((1023&n)<<10|1023&e.charCodeAt(++r)),t.push(240|n>>18,128|n>>12&63,128|n>>6&63,128|63&n));}return t;},e;}();e.Utf8=n;var i=function(){function e(){}return e.GetString=function(e){var t,r,n,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=[],a=e.length%3,s=function s(e){return[i.charAt(e>>18&63),i.charAt(e>>12&63),i.charAt(e>>6&63),i.charAt(63&e)].join("");};for(t=0,n=e.length-a;t<n;t+=3){r=(e[t]<<16)+(e[t+1]<<8)+e[t+2],o.push(s(r));}switch(a){case 1:r=e[e.length-1],o.push(i.charAt(r>>2)),o.push(i.charAt(r<<4&63)),o.push("==");break;case 2:r=(e[e.length-2]<<8)+e[e.length-1],o.push(i.charAt(r>>10)),o.push(i.charAt(r>>4&63)),o.push(i.charAt(r<<2&63)),o.push("=");}return o.join("");},e;}();e.Base64=i;var o=function(){function e(){}return e.GetBytes=function(e){for(var t=[];4294967168&e;){t.push(127&e|128),e>>>=7;}return t.push(127&e),t;},e;}();e.Varint=o;var a=function(){function e(){}return e.GetBytes=function(e){for(var t=e.low,r=e.high,n=[];r||4294967168&t;){n.push(127&t|128),t=(127&r)<<25|t>>>7,r>>>=7;}return n.push(127&t),n;},e;}();e.Varint64=a;var s=function(){function e(){}return e.GetBytes=function(e){if(t.BrowserChecker.IsDataViewSupport()){var n=new DataView(new ArrayBuffer(4));n.setFloat32(0,e,!0);for(var i=[],o=0;o<4;++o){i.push(n.getUint8(o));}return i;}return r.ConvertNumberToArray(e,!1);},e;}();e.Float=s;var u=function(){function e(){}return e.GetBytes=function(e){if(t.BrowserChecker.IsDataViewSupport()){var n=new DataView(new ArrayBuffer(8));n.setFloat64(0,e,!0);for(var i=[],o=0;o<8;++o){i.push(n.getUint8(o));}return i;}return r.ConvertNumberToArray(e,!0);},e;}();e.Double=u;var l=function(){function e(){}return e.EncodeZigzag16=function(e){return(e=t.Number.ToInt16(e))<<1^e>>15;},e.EncodeZigzag32=function(e){return(e=t.Number.ToInt32(e))<<1^e>>31;},e.EncodeZigzag64=function(e){var r=e.low,n=e.high,i=n<<1|r>>>31,o=r<<1;2147483648&n&&(i=~i,o=~o);var a=new t.UInt64("0");return a.low=o,a.high=i,a;},e;}();e.Zigzag=l;}(t.Encoding||(t.Encoding={})),function(n){var i=function(){function e(){}return e.GetString=function(e){for(var t=[],r=0;r<e.length;++r){var n=e[r];if(n<=191)t.push(String.fromCharCode(n));else if(n<=223){var i=e[++r];t.push(String.fromCharCode((31&n)<<6|63&i));}else if(n<=239){i=e[++r];var o=e[++r];t.push(String.fromCharCode((15&n)<<12|(63&i)<<6|63&o));}else{n=(7&n)<<18|(63&(i=e[++r]))<<12|(63&(o=e[++r]))<<6|63&e[++r],n-=65536,t.push(String.fromCharCode(55296|n>>10&1023)),t.push(String.fromCharCode(56320|1023&n));}}return t.join("");},e;}();n.Utf8=i;var o=function(){function e(){}return e.GetBytes=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=[],n=0;n<e.length;++n){var i=t.indexOf(e.charAt(n++)),o=t.indexOf(e.charAt(n++)),a=t.indexOf(e.charAt(n++)),s=t.indexOf(e.charAt(n));r.push(i<<2|o>>4),a>=0&&(r.push(o<<4&240|a>>2),s>=0&&r.push(a<<6&192|s));}return r;},e;}();n.Base64=o;var a=function(){function t(){}return t.GetInt64=function(t){var r=new e.Bond.Int64("0"),n=this._Read(t);return r.low=n[0],n.length>1&&(r.high=n[1]),r;},t.GetNumber=function(e){return this._Read(e)[0];},t._Read=function(e){for(var t=[],r=0,n=!0,i=0;n;){if(n=0!=(128&(o=e.shift())),o&=127,!(i<28)){r|=o<<i,t.push(r),r=o>>4,i=3;break;}r|=o<<i,i+=7;}for(;n;){var o;if(n=0!=(128&(o=e.shift())),r|=(o&=127)<<i,(i+=7)>=32)break;}return t.push(r),t;},t;}();n.Varint=a;var s=function(){function e(){}return e.GetNumber=function(e){if(t.BrowserChecker.IsDataViewSupport()){for(var n=new DataView(new ArrayBuffer(4)),i=0;i<4;++i){n.setUint8(i,e[i]);}return n.getFloat32(0,!0);}return r.ConvertArrayToNumber(e,!1);},e;}();n.Float=s;var u=function(){function e(){}return e.GetNumber=function(e){if(t.BrowserChecker.IsDataViewSupport()){for(var n=new DataView(new ArrayBuffer(8)),i=0;i<8;++i){n.setUint8(i,e[i]);}return n.getFloat64(0,!0);}return r.ConvertArrayToNumber(e,!0);},e;}();n.Double=u;var l=function(){function t(){}return t.DecodeZigzag16=function(e){return((65535&e)>>>1^-(1&e))<<16>>16;},t.DecodeZigzag32=function(e){return e>>>1^-(1&e);},t.DecodeZigzag64=function(t){var r=1&t.high,n=t.high>>>1,i=1&t.low,o=t.low>>>1;o|=r<<31,i&&(o^=4294967295,n^=4294967295);var a=new e.Bond.UInt64("0");return a.low=o,a.high=n,a;},t;}();n.Zigzag=l;}(t.Decoding||(t.Decoding={}));var r=function(){function e(){}return e.ConvertNumberToArray=function(e,t){if(!e)return t?this._doubleZero:this._floatZero;var r=t?52:23,n=(1<<(t?11:8)-1)-1,i=1-n,o=n,a=e<0?1:0;e=Math.abs(e);for(var s=Math.floor(e),u=e-s,l=2*(n+2)+r,c=new Array(l),d=0;d<l;){c[d++]=0;}for(d=n+2;d&&s;){c[--d]=s%2,s=Math.floor(s/2);}for(d=n+1;d<l-1&&u>0;){(u*=2)>=1?(c[++d]=1,--u):c[++d]=0;}for(var p=0;p<l&&!c[p];++p){;}var h=n+1-p,f=p+r;if(c[f+1]){for(d=f;d>p&&!(c[d]=1-c[d]);--d){;}d==p&&++h;}if(h>o||s)return a?t?this._doubleNegInifinity:this._floatNegInifinity:t?this._doubleInifinity:this._floatInifinity;if(h<i)return t?this._doubleZero:this._floatZero;if(t){var m=0;for(d=0;d<20;++d){m=m<<1|c[++p];}for(var _=0;d<52;++d){_=_<<1|c[++p];}return[255&_,_>>8&255,_>>16&255,_>>>24,255&(m=a<<31|2147483647&(m|=h+n<<20)),m>>8&255,m>>16&255,m>>>24];}var g=0;for(d=0;d<23;++d){g=g<<1|c[++p];}return[255&(g=a<<31|2147483647&(g|=h+n<<23)),g>>8&255,g>>16&255,g>>>24];},e.ConvertArrayToNumber=function(e,r){var n=(1<<(r?11:8)-1)-1,i=0!=(128&e[r?7:3]),o=r?(127&e[7])<<4|(240&e[6])>>4:(127&e[3])<<1|(128&e[2])>>7;if(255==o)throw new t.Exception("Not a valid float/double buffer.");var a=1,s=1;if(r){var u=(15&e[6])<<28|(255&e[5])<<20|(255&e[4])<<12,l=e[3]<<24|(255&e[2])<<16|(255&e[1])<<8|255&e[0];if(!o&&!u&&!l)return 0;for(var c=0;c<20;++c){s/=2,u<0&&(a+=s),u<<=1;}for(c=0;c<32;++c){s/=2,l<0&&(a+=s),l<<=1;}}else{var d=(127&e[2])<<25|(255&e[1])<<17|(255&e[0])<<9;if(!o&&!d)return 0;for(c=0;c<23;++c){s/=2,d<0&&(a+=s),d<<=1;}}return a*=Math.pow(2,o-n),i?0-a:a;},e;}();r._floatZero=[0,0,0,0],r._doubleZero=[0,0,0,0,0,0,0,0],r._floatInifinity=[0,0,128,127],r._floatNegInifinity=[0,0,128,255],r._doubleInifinity=[0,0,0,0,0,0,240,127],r._doubleNegInifinity=[0,0,0,0,0,0,240,255];}(e.Bond||(e.Bond={}));}(i||(i={})),function(e){!function(e){!function(t){var r=function(){function t(){this._buffer=[];}return t.prototype.WriteByte=function(t){this._buffer.push(e.Number.ToByte(t));},t.prototype.Write=function(e,t,r){for(;r--;){this.WriteByte(e[t++]);}},t.prototype.GetBuffer=function(){return this._buffer;},t;}();t.MemoryStream=r;}(e.IO||(e.IO={}));}(e.Bond||(e.Bond={}));}(i||(i={})),function(e){!function(e){var t=function t(e,_t){this.Type=e,this.Id=_t;};e.FieldTag=t;var r=function r(e,t){this.ElementType=e,this.Size=t;};e.ContainerTag=r;var n=function n(e,t,r){this.KeyType=e,this.ValueType=t,this.Size=r;};e.KeyValueContainerTag=n;var i=function i(){};e.Bonded=i;var o=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e),this.low<0&&(this.high=-1);}return e.prototype.Equals=function(t){var r=new e(t);return this.low==r.low&&this.high==r.high;},e;}();e.Int64=o;var a=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e);}return e.prototype.Equals=function(t){var r=new e(t);return this.low==r.low&&this.high==r.high;},e;}();e.UInt64=a;var s=function(){function e(){}return e.ToByte=function(e){return this.ToUInt8(e);},e.ToInt8=function(e){return 127&e|(128&e)<<24>>24;},e.ToInt16=function(e){return 32767&e|(32768&e)<<16>>16;},e.ToInt32=function(e){return 2147483647&e|2147483648&e;},e.ToUInt8=function(e){return 255&e;},e.ToUInt16=function(e){return 65535&e;},e.ToUInt32=function(e){return 4294967295&e;},e;}();e.Number=s;var u=function u(e){this.Message=e;};e.Exception=u;var l=function l(){};e.KeyValuePair=l;var c=function(){function e(){}return e.IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView;},e;}();e.BrowserChecker=c;}(e.Bond||(e.Bond={}));}(i||(i={})),function(e){!function(e){var t=function(){function t(e){this._stream=e;}return t.prototype.WriteBlob=function(e){this._stream.Write(e,0,e.length);},t.prototype.WriteBool=function(e){this._stream.WriteByte(e?1:0);},t.prototype.WriteContainerBegin=function(e,t){this.WriteUInt8(t),this.WriteUInt32(e);},t.prototype.WriteMapContainerBegin=function(e,t,r){this.WriteUInt8(t),this.WriteUInt8(r),this.WriteUInt32(e);},t.prototype.WriteContainerEnd=function(){},t.prototype.WriteDouble=function(t){var r=e.Encoding.Double.GetBytes(t);this._stream.Write(r,0,r.length);},t.prototype.WriteFloat=function(t){var r=e.Encoding.Float.GetBytes(t);this._stream.Write(r,0,r.length);},t.prototype.WriteFieldBegin=function(e,t,r){t<=5?this._stream.WriteByte(e|t<<5):t<=255?(this._stream.WriteByte(192|e),this._stream.WriteByte(t)):(this._stream.WriteByte(224|e),this._stream.WriteByte(t),this._stream.WriteByte(t>>8));},t.prototype.WriteFieldEnd=function(){},t.prototype.WriteFieldOmitted=function(e,t,r){},t.prototype.WriteInt16=function(t){t=e.Encoding.Zigzag.EncodeZigzag16(t),this.WriteUInt16(t);},t.prototype.WriteInt32=function(t){t=e.Encoding.Zigzag.EncodeZigzag32(t),this.WriteUInt32(t);},t.prototype.WriteInt64=function(t){this.WriteUInt64(e.Encoding.Zigzag.EncodeZigzag64(t));},t.prototype.WriteInt8=function(t){this._stream.WriteByte(e.Number.ToInt8(t));},t.prototype.WriteString=function(t){if(""==t)this.WriteUInt32(0);else{var r=e.Encoding.Utf8.GetBytes(t);this.WriteUInt32(r.length),this._stream.Write(r,0,r.length);}},t.prototype.WriteStructBegin=function(e,t){},t.prototype.WriteStructEnd=function(t){this.WriteUInt8(t?e.BondDataType.BT_STOP_BASE:e.BondDataType.BT_STOP);},t.prototype.WriteUInt16=function(t){var r=e.Encoding.Varint.GetBytes(e.Number.ToUInt16(t));this._stream.Write(r,0,r.length);},t.prototype.WriteUInt32=function(t){var r=e.Encoding.Varint.GetBytes(e.Number.ToUInt32(t));this._stream.Write(r,0,r.length);},t.prototype.WriteUInt64=function(t){var r=e.Encoding.Varint64.GetBytes(t);this._stream.Write(r,0,r.length);},t.prototype.WriteUInt8=function(t){this._stream.WriteByte(e.Number.ToUInt8(t));},t.prototype.WriteWString=function(e){this.WriteUInt32(e.length);for(var t=0;t<e.length;++t){var r=e.charCodeAt(t);this._stream.WriteByte(r),this._stream.WriteByte(r>>>8);}},t;}();e.CompactBinaryProtocolWriter=t;var r=function r(){};e.CompactBinaryProtocolReader=r;}(e.Bond||(e.Bond={}));}(i||(i={})),function(e){var t=function(){function t(){}return t.IsSafari=function(){if(null===t._isSafari)if("undefined"!=typeof navigator&&navigator.userAgent){var e=navigator.userAgent.toLowerCase();e.indexOf("safari")>=0&&e.indexOf("chrome")<0?t._isSafari=!0:t._isSafari=!1;}else t._isSafari=!1;return t._isSafari;},t.IsReactNative=function(){return null===t._isReactNative&&("undefined"!=typeof navigator&&navigator.product?t._isReactNative="ReactNative"===navigator.product:t._isReactNative=!1),t._isReactNative;},t.IsUint8ArrSupported=function(){return!e.Utils.IsSafari()&&"undefined"!=typeof Uint8Array&&!e.Utils.IsReactNative();},t.ajax=function(e,r){var n=t._createConnection();if(e.headers){var i="qsp=true";for(var o in e.headers){i+="&",i+=encodeURIComponent(o),i+="=",i+=encodeURIComponent(e.headers[o]);}e.url.indexOf("?")<0?e.url+="?":e.url+="&",e.url+=i;}n.open(e.type,e.url,!r),e.complete&&(n.onload=function(){e.complete(n);},n.ontimeout=function(){e.complete(n);},n.onerror=function(){e.complete(n);},n.onabort=function(){e.complete(n);}),n.send(e.data);},t.keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var r in e){e.hasOwnProperty(r)&&t.push(r);}return t;},t.IsUsingXDomainRequest=function(){null==t._usingXDomainRequest&&(void 0===new XMLHttpRequest().withCredentials&&"undefined"!=typeof XDomainRequest?t._usingXDomainRequest=!0:t._usingXDomainRequest=!1);return t._usingXDomainRequest;},t._createConnection=function(){var e=new XMLHttpRequest();return t.IsUsingXDomainRequest()?new XDomainRequest():e;},t;}();t._isSafari=null,t._isReactNative=null,t._usingXDomainRequest=null,e.Utils=t;}(o||(o={})),function(e){!function(e){!function(e){!function(t){var r=function(){function e(){}return e.GetGuid=function(){var e=function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1,5);};return[e(),e(),"-",e(),"-",e(),"-",e(),"-",e(),e(),e()].join("");},e.GetTimeStamp=function(){var e=new Date().getTime(),t=new i.Bond.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t;},e.GetTimeStampWithValue=function(e){var t=new i.Bond.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t;},e;}();t.utils=r,function(e){e[e.NotSet=0]="NotSet",e[e.Event=1]="Event",e[e.PerformanceCounter=2]="PerformanceCounter",e[e.Anomaly=3]="Anomaly",e[e.Prediction=4]="Prediction",e[e.TraceLog=5]="TraceLog",e[e.EventSourceLog=6]="EventSourceLog",e[e.HttpLog=7]="HttpLog",e[e.PerformanceCounterAzure=8]="PerformanceCounterAzure",e[e.PerformanceCounterGfs=9]="PerformanceCounterGfs";}(t.RecordType||(t.RecordType={})),function(e){e[e.NotSet=0]="NotSet",e[e.O365=1]="O365",e[e.SkypeBI=2]="SkypeBI",e[e.SkypeData=3]="SkypeData";}(t.PIIScrubber||(t.PIIScrubber={})),function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy";}(t.PIIKind||(t.PIIKind={})),function(e){e[e.Unknown=0]="Unknown",e[e.MSACID=1]="MSACID",e[e.MSAPUID=2]="MSAPUID",e[e.ANID=3]="ANID",e[e.OrgIdCID=4]="OrgIdCID",e[e.OrgIdPUID=5]="OrgIdPUID",e[e.UserObjectId=6]="UserObjectId",e[e.Skype=7]="Skype",e[e.Yammer=8]="Yammer",e[e.EmailAddress=9]="EmailAddress",e[e.PhoneNumber=10]="PhoneNumber",e[e.SipAddress=11]="SipAddress",e[e.MUID=12]="MUID";}(t.UserIdType||(t.UserIdType={}));var n=function(){function t(){this.ScrubType=e.datamodels.PIIScrubber.NotSet,this.Kind=e.datamodels.PIIKind.NotSet,this.RawContent="";}return t.prototype.Write=function(e){this.WriteImpl(e,!1);},t.prototype.WriteImpl=function(t,r){t.WriteStructBegin(null,r),this.ScrubType!=e.datamodels.PIIScrubber.NotSet?(t.WriteFieldBegin(i.Bond.BondDataType.BT_INT32,1,null),t.WriteInt32(this.ScrubType),t.WriteFieldEnd()):t.WriteFieldOmitted(i.Bond.BondDataType.BT_INT32,1,null),this.Kind!=e.datamodels.PIIKind.NotSet?(t.WriteFieldBegin(i.Bond.BondDataType.BT_INT32,2,null),t.WriteInt32(this.Kind),t.WriteFieldEnd()):t.WriteFieldOmitted(i.Bond.BondDataType.BT_INT32,2,null),""!=this.RawContent?(t.WriteFieldBegin(i.Bond.BondDataType.BT_STRING,3,null),t.WriteString(this.RawContent),t.WriteFieldEnd()):t.WriteFieldOmitted(i.Bond.BondDataType.BT_STRING,3,null),t.WriteStructEnd(r);},t.prototype.Read=function(e){this.ReadImpl(e,!1);},t.prototype.ReadImpl=function(e,t){},t;}();t.PII=n;var o=function(){function t(){this.Id=r.GetGuid(),this.Timestamp=r.GetTimeStamp(),this.Type="",this.EventType="",this.Extension=new i.Bond.Collections.Map(),this.RecordType=e.datamodels.RecordType.NotSet,this.PIIExtensions=new i.Bond.Collections.Map();}return t.prototype.AddOrReplacePII=function(t,r,n){var i=new e.datamodels.PII();i.RawContent=r,i.Kind=n,i.ScrubType=e.datamodels.PIIScrubber.O365,this.PIIExtensions.AddOrReplace(t,i);},t.prototype.Write=function(e){this.WriteImpl(e,!1);},t.prototype.WriteImpl=function(t,r){if(t.WriteStructBegin(null,r),""!=this.Id?(t.WriteFieldBegin(i.Bond.BondDataType.BT_STRING,1,null),t.WriteString(this.Id),t.WriteFieldEnd()):t.WriteFieldOmitted(i.Bond.BondDataType.BT_STRING,1,null),this.Timestamp.Equals("0")?t.WriteFieldOmitted(i.Bond.BondDataType.BT_INT64,3,null):(t.WriteFieldBegin(i.Bond.BondDataType.BT_INT64,3,null),t.WriteInt64(this.Timestamp),t.WriteFieldEnd()),""!=this.Type?(t.WriteFieldBegin(i.Bond.BondDataType.BT_STRING,5,null),t.WriteString(this.Type),t.WriteFieldEnd()):t.WriteFieldOmitted(i.Bond.BondDataType.BT_STRING,5,null),""!=this.EventType?(t.WriteFieldBegin(i.Bond.BondDataType.BT_STRING,6,null),t.WriteString(this.EventType),t.WriteFieldEnd()):t.WriteFieldOmitted(i.Bond.BondDataType.BT_STRING,6,null),this.Extension.Count()){t.WriteFieldBegin(i.Bond.BondDataType.BT_MAP,13,null),t.WriteMapContainerBegin(this.Extension.Count(),i.Bond.BondDataType.BT_STRING,i.Bond.BondDataType.BT_STRING);for(var n=0;n<this.Extension.GetBuffer().length;++n){t.WriteString(this.Extension.GetBuffer()[n].Key),t.WriteString(this.Extension.GetBuffer()[n].Value);}t.WriteContainerEnd(),t.WriteFieldEnd();}else t.WriteFieldOmitted(i.Bond.BondDataType.BT_MAP,13,null);if(this.RecordType!=e.datamodels.RecordType.NotSet?(t.WriteFieldBegin(i.Bond.BondDataType.BT_INT32,24,null),t.WriteInt32(this.RecordType),t.WriteFieldEnd()):t.WriteFieldOmitted(i.Bond.BondDataType.BT_INT32,24,null),this.PIIExtensions.Count()){t.WriteFieldBegin(i.Bond.BondDataType.BT_MAP,30,null),t.WriteMapContainerBegin(this.PIIExtensions.Count(),i.Bond.BondDataType.BT_STRING,i.Bond.BondDataType.BT_STRUCT);for(var o=0;o<this.PIIExtensions.GetBuffer().length;++o){t.WriteString(this.PIIExtensions.GetBuffer()[o].Key),this.PIIExtensions.GetBuffer()[o].Value.WriteImpl(t,!1);}t.WriteContainerEnd(),t.WriteFieldEnd();}else t.WriteFieldOmitted(i.Bond.BondDataType.BT_MAP,30,null);t.WriteStructEnd(r);},t.prototype.Read=function(e){this.ReadImpl(e,!1);},t.prototype.ReadImpl=function(e,t){},t;}();t.Record=o;var a=function(){function e(){this.Source="",this.DataPackageId="",this.Timestamp=new i.Bond.Int64("0"),this.Records=[];}return e.prototype.Write=function(e){this.WriteImpl(e,!1);},e.prototype.WriteImpl=function(e,t){if(e.WriteStructBegin(null,t),""!=this.Source?(e.WriteFieldBegin(i.Bond.BondDataType.BT_STRING,2,null),e.WriteString(this.Source),e.WriteFieldEnd()):e.WriteFieldOmitted(i.Bond.BondDataType.BT_STRING,2,null),""!=this.DataPackageId?(e.WriteFieldBegin(i.Bond.BondDataType.BT_STRING,5,null),e.WriteString(this.DataPackageId),e.WriteFieldEnd()):e.WriteFieldOmitted(i.Bond.BondDataType.BT_STRING,5,null),this.Timestamp.Equals("0")?e.WriteFieldOmitted(i.Bond.BondDataType.BT_INT64,6,null):(e.WriteFieldBegin(i.Bond.BondDataType.BT_INT64,6,null),e.WriteInt64(this.Timestamp),e.WriteFieldEnd()),this.Records.length){e.WriteFieldBegin(i.Bond.BondDataType.BT_LIST,8,null),e.WriteContainerBegin(this.Records.length,i.Bond.BondDataType.BT_STRUCT);for(var r=0;r<this.Records.length;++r){this.Records[r].WriteImpl(e,!1);}e.WriteContainerEnd(),e.WriteFieldEnd();}else e.WriteFieldOmitted(i.Bond.BondDataType.BT_LIST,8,null);e.WriteStructEnd(t);},e.prototype.Read=function(e){this.ReadImpl(e,!1);},e.prototype.ReadImpl=function(e,t){},e;}();t.DataPackage=a;var s=function(){function e(){this.DataPackages=[],this.RequestRetryCount=0;}return e.prototype.Write=function(e){this.WriteImpl(e,!1);},e.prototype.WriteImpl=function(e,t){if(e.WriteStructBegin(null,t),this.DataPackages.length){e.WriteFieldBegin(i.Bond.BondDataType.BT_LIST,1,null),e.WriteContainerBegin(this.DataPackages.length,i.Bond.BondDataType.BT_STRUCT);for(var r=0;r<this.DataPackages.length;++r){this.DataPackages[r].WriteImpl(e,!1);}e.WriteContainerEnd(),e.WriteFieldEnd();}else e.WriteFieldOmitted(i.Bond.BondDataType.BT_LIST,1,null);0!=this.RequestRetryCount?(e.WriteFieldBegin(i.Bond.BondDataType.BT_INT32,2,null),e.WriteInt32(this.RequestRetryCount),e.WriteFieldEnd()):e.WriteFieldOmitted(i.Bond.BondDataType.BT_INT32,2,null),e.WriteStructEnd(t);},e.prototype.Read=function(e){this.ReadImpl(e,!1);},e.prototype.ReadImpl=function(e,t){},e;}();t.ClientToCollectorRequest=s;}(e.datamodels||(e.datamodels={}));}(e.telemetry||(e.telemetry={}));}(e.applications||(e.applications={}));}(a||(a={})),function(e){!function(e){!function(e){!function(t){var r,a;!function(e){e[e.SENT=0]="SENT",e[e.SEND_FAILED=1]="SEND_FAILED";}(r=t.CallbackEventType||(t.CallbackEventType={})),function(e){e[e.DATARV_ERROR_OK=0]="DATARV_ERROR_OK",e[e.DATARV_ERROR_INVALID_EVENT=1]="DATARV_ERROR_INVALID_EVENT",e[e.DATARV_ERROR_INVALID_CONFIG=2]="DATARV_ERROR_INVALID_CONFIG",e[e.DATARV_ERROR_INVALID_DEPENDENCIES=3]="DATARV_ERROR_INVALID_DEPENDENCIES",e[e.DATARV_ERROR_INVALID_STATUS=4]="DATARV_ERROR_INVALID_STATUS",e[e.DATARV_ERROR_INVALID_ARG=5]="DATARV_ERROR_INVALID_ARG";}(a=t.DATARV_ERROR||(t.DATARV_ERROR={}));var s=function(){function e(e){this._errorCode=a.DATARV_ERROR_OK,this._errorCode=e;}return e.prototype.ErrorCode=function(){return this._errorCode;},e.prototype.toString=function(){switch(this._errorCode){case a.DATARV_ERROR_OK:return"DATARV_ERROR_OK";case a.DATARV_ERROR_INVALID_EVENT:return"Event is invalid. Either event.Id is empty, or event.Timestamp is empty, or event.EventType is empty.";case a.DATARV_ERROR_INVALID_CONFIG:return"Invalid configuration. CollectorUrl is missing.";case a.DATARV_ERROR_INVALID_DEPENDENCIES:return"DATARV_ERROR_INVALID_DEPENDENCIES";case a.DATARV_ERROR_INVALID_STATUS:return"Telemetry Manager is not initialized.";case a.DATARV_ERROR_INVALID_ARG:return"TenantToken is null or empty, or events is null.";default:return"Unknown error";}},e;}();t.Exception=s;var u=function u(){};t.TelemetryConfig=u;var l=function(){function e(){}return e.CreateTelemetryManager=function(){return new p();},e;}();t.TelemetryManagerFactory=l;var c,d=function(){function e(){}return e.MaxPackageSizeInBytes=function(){return 3e6;},e.TimeIntervalForNextSendInMS=function(){return 1e3;},e;}();!function(e){e[e.Created=0]="Created",e[e.Initialized=1]="Initialized",e[e.Started=2]="Started";}(c||(c={}));var p=function(){function t(){this._MaxPackageSizeInBytes=d.MaxPackageSizeInBytes(),this._listeners=[],this._status=c.Created,this._etag=null,this._testServerResponseHook=null,this._isPaused=!1;}return t.prototype.Initialize=function(e){if(this._status!=c.Created)throw new s(a.DATARV_ERROR_INVALID_STATUS);if(!e||!e.collectorUrl)throw new s(a.DATARV_ERROR_INVALID_CONFIG);this._config=e,this._Reset(),this._status=c.Initialized,this._Verbose("Initialize() done");},t.prototype.AddListener=function(e){if(this._status<c.Initialized)throw new s(a.DATARV_ERROR_INVALID_STATUS);this._Verbose(["AddListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t){if(this._listeners[t]==e)return void this._Verbose("the listener has been added already, index: "+t);}this._listeners.push(e),this._Verbose("AddListener() done, the new length: "+this._listeners.length);},t.prototype.RemoveListener=function(e){if(this._status<c.Initialized)throw new s(a.DATARV_ERROR_INVALID_STATUS);this._Verbose(["RemoveListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t){if(this._listeners[t]==e)return 1==this._listeners.length?this._listeners=[]:t==this._listeners.length-1?this._listeners.pop():this._listeners[t]=this._listeners.pop(),void this._Verbose(["this listener has been found, index: ",t,"new length: ",this._listeners.length].join(""));}this._Verbose("listener isn't been found, new length"+this._listeners.length);},t.prototype.Start=function(){if(this._status<c.Initialized)throw new s(a.DATARV_ERROR_INVALID_STATUS);this._Verbose(["Start(), status:",this._status,"tag:",t._tag].join(" ")),this._status>=c.Started&&this._Verbose("Start() already, ignore"),++t._tag,this._status=c.Started,this._Verbose(["Start() done, status: ",this._status,"tag: ",t._tag].join(""));},t.prototype.Stop=function(){if(this._status<c.Initialized)throw new s(a.DATARV_ERROR_INVALID_STATUS);return this._Verbose("Stop(), status: "+this._status),this._status==c.Initialized?void this._Verbose("Stop() already, ignore"):(this._Reset(),this._status=c.Initialized,void this._Verbose("Stop() done, status: "+this._status));},t.prototype.Pause=function(){this._isPaused=!0,this._CleanTimer();},t.prototype.Resume=function(){this._isPaused=!1,this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1);},t.prototype.Flush=function(e){this._eventsCache.IsEmpty()||this._WorkThread(e,!0);},t.prototype.SendAsync=function(e,r){if(this._status<c.Initialized)throw new s(a.DATARV_ERROR_INVALID_STATUS);if(this._Verbose(["SendAsync(), status:",this._status,"tenantToken:",e,"count:",r.length].join(" ")),this._status<c.Started)return this._Info("SendAsync(), not started, ignore, return false"),!1;if(!e||!r)throw this._Error("SendAsync(), tenantToken or events is null or empty"),new s(a.DATARV_ERROR_INVALID_ARG);for(var n=0;n<r.length;++n){if(!r[n].Id||!t._eventTypeRegex.test(r[n].EventType)||r[n].Timestamp.Equals("0"))throw this._Error(["eventId:",r[n].Id,"eventType:",r[n].EventType,"timestamp high:",r[n].Timestamp.high,"timestamp low:",r[n].Timestamp.low].join("")),new s(a.DATARV_ERROR_INVALID_EVENT);}return this._eventsCache.AddEvents(e,r),this._Verbose(["SendAsync(), currentTimer: ",this._timer,"eventsCacheIsEmpty",this._eventsCache.IsEmpty()].join(" ")),this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1),this._Verbose("SendAsync() done"),!0;},t.prototype._WorkThread=function(e,r){var a=this;try{if(this._Verbose("_WorkThread, status: "+this._status),this._status<c.Started)return void this._Verbose("_WorkThread, status is not started, return");var s=this._eventsCache.DequeuEvents();if(null==s)return this._Verbose("_WorkThread, No events found, return"),void this._CleanTimer();var u=this._PackEvents(s.tenantToken,s.events);if(this._eventsCache.AddEvents(s.tenantToken,u.remainedEvents),null==u.buffer||0==u.buffer.length)return void(this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1)));if(this._testServerResponseHook){var l=this._testServerResponseHook();return void setTimeout(this._SendCallback(p,s.tenantToken,u.sendEvents,l,!1,null),100);}var d={type:"POST",url:this._config.collectorUrl,processData:!1,headers:{"content-type":"application/bond-compact-binary","client-id":"NO_AUTH","sdk-version":"ACT-Web-JS-"+n.version},complete:function complete(t){return a._SendCallback(p,s.tenantToken,u.sendEvents,t,r,e);}};o.Utils.IsUint8ArrSupported()?(this._Verbose("Uint8Array is defined, send with binary format directly."),d.data=new Uint8Array(u.buffer)):(this._Verbose("Uint8Array is undefined, send with base64 encode."),d.data=i.Bond.Encoding.Base64.GetString(u.buffer),d.headers["content-encoding"]="base64"),s.tenantToken&&(d.headers["x-apikey"]=s.tenantToken);var p=t._tag;this._lastActiveTime=new Date().getTime(),o.Utils.ajax(d,r),this._Verbose("_Workthread, send via jquery, tag: "+p);}catch(e){this._Error("_WorkThread, exception: "+e);}},t.prototype._PackEvents=function(t,r){this._Verbose("_PackageEvents, total Count: "+r.length);var n=new e.datamodels.ClientToCollectorRequest(),i=new e.datamodels.DataPackage();i.Source="JS_default_source",i.DataPackageId=e.datamodels.utils.GetGuid(),i.Timestamp=e.datamodels.utils.GetTimeStamp();var o,a=r;for(r=[];i.Records=[],i.Records.push.apply(i.Records,a),n.DataPackages=[],n.DataPackages.push(i),o=this._Serialize(n),this._Verbose(["_PackageEvents, sendEvents.length:",a.length,"buffer.length:",o.length,"MaxPackageSize:",this._MaxPackageSizeInBytes].join("")),!(o.length<this._MaxPackageSizeInBytes);){if(1==a.length){a=[],o=null;break;}var s=a.splice(0,Math.floor(a.length/2));this._Verbose("_PackageEvents, too large, package again"),r.push.apply(r,a),a=s;}return this._Verbose(["_PakcageEvents done, sendEventsCount:",a.length,"buffer.length:",null==o?0:o.length,"remained events:",r.length].join("")),{buffer:o,sendEvents:a,remainedEvents:r};},t.prototype._Serialize=function(e){var t=new i.Bond.IO.MemoryStream(),r=new i.Bond.CompactBinaryProtocolWriter(t);return e.Write(r),t.GetBuffer();},t.prototype._SendCallback=function(e,n,i,o,a,s){if(this._Verbose(["_SendCallback","tag:",e,"current tag:",t._tag,"tenantToken:",n,"events count:",i.length,"jqXHR:",o].join("")),s&&s(o?o.status:0,n,i),!a){var u=o&&void 0!==o.status&&200===o.status;if(this._status<c.Started||e<t._tag)return void this._Verbose("_SendCallback, is not started, or tag is not the same, return");if(!u)if(o&&void 0!==o.status&&501!==o.status&&505!==o.status&&(o.status<300||o.status>=500||408===o.status)||!o||void 0===o.status)return this._Verbose("retry statusCode: "+(o?o.status:0)),this._eventsCache.AddEvents(n,i),void this._ScheduleTimer(!0);for(var l=0;l<this._listeners.length;++l){this._listeners[l](u?r.SENT:r.SEND_FAILED,o?o.status:0,n,i);}this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1));}},t.prototype._CleanTimer=function(){this._Verbose("_CleanTimer(), timer: "+this._timer),this._timer&&(clearTimeout(this._timer),this._timer=null);},t.prototype._ScheduleTimer=function(e){var t=this;if(!this._isPaused)if(this._Verbose("_ScheduleTimer: isRetry: "+e),this._CleanTimer(),e){this._Verbose("_ScheduleTimer, current factor: "+this._rescheduleFactor);var r=Math.floor(5*this._rescheduleFactor*(1+Math.random()));this._timer=setTimeout(function(){return t._WorkThread(null,!1);},1e3*r),this._Verbose("_ScheduleTimer, next try (s): "+r),this._rescheduleFactor<<=1,this._rescheduleFactor>64&&(this._rescheduleFactor=1);}else{r=0;var n=new Date().getTime()-this._lastActiveTime;r=n>d.TimeIntervalForNextSendInMS()?0:d.TimeIntervalForNextSendInMS()-n,this._timer=setTimeout(function(){return t._WorkThread(null,!1);},r),this._Verbose("_ScheduleTimer, next try: "+r),this._rescheduleFactor=1;}},t.prototype._Verbose=function(e){this._config.log&&this._config.log.Verbose("[TelemetryManagerImpl]: "+e);},t.prototype._Info=function(e){this._config.log&&this._config.log.Info("[TelemetryManagerImpl]: "+e);},t.prototype._Error=function(e){this._config.log&&this._config.log.Error("[TelemetryManagerImpl]: "+e);},t.prototype._Reset=function(){this._Verbose("Reset()"),this._CleanTimer(),this._lastActiveTime=0,this._rescheduleFactor=1,this._sendingEvents=[],this._eventsCache=new h();},t.prototype.__GetListenerArray=function(){return this._listeners;},t.prototype.__GetTotalEventsCount=function(){return this._eventsCache.GetTotalEventsCount();},t.prototype.__IsScheduled=function(){return null!=this._timer;},t.prototype.__ChageMaxPackageSizeInKB=function(e){this._MaxPackageSizeInBytes=1024*e;},t.prototype.__SetTestServerResponseHook=function(e){this._testServerResponseHook=e;},t;}();p._eventTypeRegex=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,p._tag=0;var h=function(){function e(){this._events={},this._tokens=[];}return e.prototype.AddEvents=function(e,t){t.length&&(this._events[e]||(this._events[e]=[],this._tokens.push(e)),this._events[e].push.apply(this._events[e],t));},e.prototype.IsEmpty=function(){return 0==this._tokens.length;},e.prototype.DequeuEvents=function(){if(0==this._tokens.length)return null;var e=this._tokens.shift(),t=this._events[e];return delete this._events[e],{tenantToken:e,events:t};},e.prototype.GetTotalEventsCount=function(){var e=0;for(var t in this._events){e+=this._events[t].length;}return e;},e;}();}(e._sender||(e._sender={}));}(e.telemetry||(e.telemetry={}));}(e.applications||(e.applications={}));}(a||(a={})),function(e){!function(t){!function(t){var r=t._sender.TelemetryManagerFactory.CreateTelemetryManager(),i=function i(){this.collectorUrl=null,this.enableAutoUserSession=!1,this.browserOverrides=null,this.disableCookies=!1;};i.COLLECTOR_URL_UNITED_STATES="https://us.pipe.aria.microsoft.com/Collector/3.0/",i.COLLECTOR_URL_GERMANY="https://de.pipe.aria.microsoft.com/Collector/3.0/",i.COLLECTOR_URL_AUSTRALIA="https://au.pipe.aria.microsoft.com/Collector/3.0/",i.COLLECTOR_URL_JAPAN="https://jp.pipe.aria.microsoft.com/Collector/3.0/",i.COLLECTOR_URL_EUROPE="https://eu.pipe.aria.microsoft.com/Collector/3.0/",t.LogConfiguration=i;var o=function o(){this.onSaveData=null,this.onGetData=null;};t.LogConfigurationBrowserOverrides=o;var a,s=function(){function e(){this.value=null,this.pii=null;}return e._isPii=function(e){return null!=e&&e!==t.datamodels.PIIKind.NotSet&&!isNaN(e)&&void 0!==t.datamodels.PIIKind[e];},e;}(),u=function(){function e(){this.name=null,this.timestamp=null,this.properties={},this.eventType=null;}return e.prototype.setProperty=function(r,n,i){if(!r||!e._propertyNameRegex.test(r))throw new l(a.INVALID_PROPERTY_NAME);this.properties[r]=i?{value:n,pii:i!=t.datamodels.PIIKind.NotSet?i:null}:{value:n,pii:null};},e;}();u._propertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,t.EventProperties=u,function(e){e[e.INVALID_TENANT_TOKEN=1]="INVALID_TENANT_TOKEN",e[e.MISSING_EVENT_PROPERTIES_NAME=2]="MISSING_EVENT_PROPERTIES_NAME",e[e.INVALID_PROPERTY_NAME=3]="INVALID_PROPERTY_NAME",e[e.MISSING_FAILURE_SIGNATURE=5]="MISSING_FAILURE_SIGNATURE",e[e.MISSING_FAILURE_DETAIL=6]="MISSING_FAILURE_DETAIL",e[e.MISSING_PAGEVIEW_ID=7]="MISSING_PAGEVIEW_ID",e[e.MISSING_PAGEVIEW_NAME=8]="MISSING_PAGEVIEW_NAME",e[e.INVALID_SESSION_STATE=9]="INVALID_SESSION_STATE",e[e.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET=10]="INVALID_CONFIGURATION_USE_CUSTOM_GET_SET";}(a=t.TelemetryError||(t.TelemetryError={}));var l=function(){function e(e){this.errorCode=null,this.errorCode=e;}return e.prototype.ErrorCode=function(){return this.errorCode;},e.prototype.toString=function(){switch(this.errorCode){case a.INVALID_TENANT_TOKEN:return"Invalid tenant token";case a.MISSING_EVENT_PROPERTIES_NAME:return"Eventproperties.name can not be null or empty";case a.INVALID_PROPERTY_NAME:return"Invalid Key. Key does not conform to regular expression ^[a-zA-Z0-9](([a-zA-Z0-9|_|.]){0,98}[a-zA-Z0-9])?$";case a.MISSING_FAILURE_SIGNATURE:return"Failure signature can't be null or empty.";case a.MISSING_FAILURE_DETAIL:return"Failure detail can't be null or empty.";case a.MISSING_PAGEVIEW_ID:return"Pageview id can't be null or empty.";case a.MISSING_PAGEVIEW_NAME:return"Pageview name can't be null or empty.";case a.INVALID_SESSION_STATE:return"Session state has to be a value from the SessionState enum.";case a.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET:return"Invalid configuration provided during initialization. Both onGetConfigData and onSaveConfigData must be provided together.  These are manditory when running in a non-brower enviornment";default:return"Unknown error";}},e;}();t.Exception=l;var c=function(){function r(e){this.contextMap={},this.piiKind=t.datamodels.PIIKind.NotSet,this._allowDeviceInfoFields=!1,this._allowDeviceInfoFields=e;}return r.prototype.setAppId=function(e){e&&(this.contextMap["AppInfo.Id"]=e);},r.prototype.setAppVersion=function(e){e&&(this.contextMap["AppInfo.Version"]=e);},r.prototype.setAppLanguage=function(e){e&&(this.contextMap["AppInfo.Language"]=e);},r.prototype.setDeviceId=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.Id"]=e,p.checkAndUpdateDeviceId(e));},r.prototype.setDeviceOsName=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.OsName"]=e);},r.prototype.setDeviceOsVersion=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.OsVersion"]=e);},r.prototype.setDeviceBrowserName=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.BrowserName"]=e);},r.prototype.setDeviceBrowserVersion=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.BrowserVersion"]=e);},r.prototype.setUserId=function(t,r,n){if(t&&(this.contextMap["UserInfo.Id"]=t),n)this.contextMap["UserInfo.IdType"]=n;else{var i;switch(r){case e.applications.telemetry.datamodels.PIIKind.SipAddress:i=e.applications.telemetry.datamodels.UserIdType.SipAddress;break;case e.applications.telemetry.datamodels.PIIKind.PhoneNumber:i=e.applications.telemetry.datamodels.UserIdType.PhoneNumber;break;case e.applications.telemetry.datamodels.PIIKind.SmtpAddress:i=e.applications.telemetry.datamodels.UserIdType.EmailAddress;break;default:i=e.applications.telemetry.datamodels.UserIdType.Unknown;}this.contextMap["UserInfo.IdType"]=i;}if(r)s._isPii(r)&&(this.piiKind=r);else{var o;switch(n){case e.applications.telemetry.datamodels.UserIdType.Skype:o=e.applications.telemetry.datamodels.PIIKind.Identity;break;case e.applications.telemetry.datamodels.UserIdType.EmailAddress:o=e.applications.telemetry.datamodels.PIIKind.SmtpAddress;break;case e.applications.telemetry.datamodels.UserIdType.PhoneNumber:o=e.applications.telemetry.datamodels.PIIKind.PhoneNumber;break;case e.applications.telemetry.datamodels.UserIdType.SipAddress:o=e.applications.telemetry.datamodels.PIIKind.SipAddress;break;default:o=e.applications.telemetry.datamodels.PIIKind.NotSet;}s._isPii(o)&&(this.piiKind=o);}},r.prototype.setUserMsaId=function(e){e&&(this.contextMap["UserInfo.MsaId"]=e);},r.prototype.setUserANID=function(e){e&&(this.contextMap["UserInfo.ANID"]=e);},r.prototype.setUserAdvertisingId=function(e){e&&(this.contextMap["UserInfo.AdvertisingId"]=e);},r.prototype.setUserTimeZone=function(e){e&&(this.contextMap["UserInfo.TimeZone"]=e);},r.prototype.setUserLanguage=function(e){e&&(this.contextMap["UserInfo.Language"]=e);},r;}();t.SemanticContext=c;var d,p=function(){function e(){}return e.initialize=function(r,n){this._overrides=r,this._disableCookies=n;var i=e._getAppLanguage();i&&e.semanticContext.setAppLanguage(i);var o=e._getUserLanguage();o&&e.semanticContext.setUserLanguage(o);var a=new Date().getTimezoneOffset(),s=a%60,u=(a-s)/60,l="+";if(u>0&&(l="-"),e.semanticContext.setUserTimeZone(l+(u<10?"0"+u:u.toString())+":"+(s<10?"0"+s:s.toString())),e._getUserAgent()&&(e.semanticContext.setDeviceBrowserName(e._getBrowserName()),e.semanticContext.setDeviceBrowserVersion(e._getBrowserVersion()),e.semanticContext.setDeviceOsName(e._getOsName()),e.semanticContext.setDeviceOsVersion(e._getOsVersion())),this._disableCookies&&!this._overrides)return e._deleteCookie(e.DEVICE_ID_COOKIE),void e._deleteCookie(e.FIRST_LAUNCH_TIME_COOKIE);var c=e._getData(e.DEVICE_ID_COOKIE);c&&""!=c||(c=t.datamodels.utils.GetGuid()),e.semanticContext.setDeviceId(c);},e.checkAndUpdateDeviceId=function(t){var r=e._getData(e.DEVICE_ID_COOKIE),n=e._getData(e.FIRST_LAUNCH_TIME_COOKIE);r!==t&&(n=new Date().getTime().toString()),e.firstLaunchTime=parseInt(n),e._saveData(e.DEVICE_ID_COOKIE,t),e._saveData(e.FIRST_LAUNCH_TIME_COOKIE,n);},e._saveData=function(t,r){if(this._overrides)this._overrides.onSaveData(t,r);else if("undefined"!=typeof document&&void 0!==document.cookie&&!e._disableCookies){var n=new Date();n.setTime(n.getTime()+31536e6);var i="expires="+n.toUTCString();document.cookie=t+"="+r+"; "+i;}},e._getData=function(t){if(this._overrides)return this._overrides.onGetData(t)||"";if("undefined"!=typeof document&&void 0!==document.cookie&&!e._disableCookies)for(var r=t+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var o=n[i],a=0;" "==o.charAt(a);){a++;}if(0==(o=o.substring(a)).indexOf(r))return o.substring(r.length,o.length);}return"";},e._getUserAgent=function(){return"undefined"!=typeof navigator&&navigator.userAgent||"";},e._getAppLanguage=function(){return"undefined"!=typeof document&&document.documentElement?document.documentElement.lang:null;},e._getUserLanguage=function(){return"undefined"!=typeof navigator?navigator.userLanguage||navigator.language:null;},e._userAgentContainsString=function(t){return e._getUserAgent().indexOf(t)>-1;},e._isIe=function(){return e._userAgentContainsString("Trident");},e._isEdge=function(){return e._userAgentContainsString(e.BROWSERS.EDGE);},e._isOpera=function(){return e._userAgentContainsString("OPR/");},e._getBrowserName=function(){return e._isOpera()?e.BROWSERS.UNKNOWN:e._userAgentContainsString(e.BROWSERS.PHANTOMJS)?e.BROWSERS.PHANTOMJS:e._isIe()?e.BROWSERS.MSIE:e._isEdge()?e.BROWSERS.EDGE:e._userAgentContainsString(e.BROWSERS.ELECTRON)?e.BROWSERS.ELECTRON:e._userAgentContainsString(e.BROWSERS.CHROME)?e.BROWSERS.CHROME:e._userAgentContainsString(e.BROWSERS.FIREFOX)?e.BROWSERS.FIREFOX:e._userAgentContainsString(e.BROWSERS.SAFARI)?e.BROWSERS.SAFARI:e._userAgentContainsString(e.BROWSERS.SKYPE_SHELL)?e.BROWSERS.SKYPE_SHELL:e.BROWSERS.UNKNOWN;},e._getBrowserVersion=function(){return e._isIe()?function(){var t,r=e._getUserAgent(),n=r.match(new RegExp(e.BROWSERS.MSIE+" "+e.REGEX_VERSION));return n?n[1]:(t=r.match(new RegExp("rv:"+e.REGEX_VERSION)))?t[1]:void 0;}():function(t){var r;return t===e.BROWSERS.SAFARI&&(t="Version"),(r=e._getUserAgent().match(new RegExp(t+"/"+e.REGEX_VERSION)))?r[1]:e.UNKNOWN_VERSION;}(e._getBrowserName());},e._getOsName=function(){return e._getUserAgent().match(/windows\sphone\s\d+\.\d+/i)?e.OPERATING_SYSTEMS.WINDOWS_PHONE:e._getUserAgent().match(/ arm;/i)?e.OPERATING_SYSTEMS.WINDOWS_RT:e._getUserAgent().match(/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i)?e.OPERATING_SYSTEMS.IOS:e._getUserAgent().match(/android/i)?e.OPERATING_SYSTEMS.ANDROID:e._getUserAgent().match(/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i)?e.OPERATING_SYSTEMS.LINUX:e._getUserAgent().match(/(macintosh|mac os x)/i)?e.OPERATING_SYSTEMS.MACOSX:e._getUserAgent().match(/(windows|win32)/i)?e.OPERATING_SYSTEMS.WINDOWS:e.OPERATING_SYSTEMS.UNKNOWN;},e._getOsVersion=function(){return e._getOsName()===e.OPERATING_SYSTEMS.WINDOWS?function(){var t=e._getUserAgent().match(new RegExp("Windows NT "+e.REGEX_VERSION));return t&&e.VERSION_MAPPINGS[t[1]]?e.VERSION_MAPPINGS[t[1]]:e.UNKNOWN_VERSION;}():e._getOsName()===e.OPERATING_SYSTEMS.MACOSX?function(){var t=e._getUserAgent().match(new RegExp(e.OPERATING_SYSTEMS.MACOSX+" "+e.REGEX_VERSION_MAC));if(t){var r=t[1].replace(/_/g,".");if(r){var n=function(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null;}(r);return n?r.split(n)[0]:r;}}return e.UNKNOWN_VERSION;}():e.UNKNOWN_VERSION;},e;}();p.semanticContext=new c(!0),p.firstLaunchTime=-1,p.BROWSERS={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",UNKNOWN:"Unknown"},p.OPERATING_SYSTEMS={WINDOWS:"Windows",MACOSX:"Mac OS X",WINDOWS_PHONE:"Windows Phone",WINDOWS_RT:"Windows RT",IOS:"iOS",ANDROID:"Android",LINUX:"Linux",UNKNOWN:"Unknown"},p.VERSION_MAPPINGS={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},p.REGEX_VERSION="([\\d,.]+)",p.REGEX_VERSION_MAC="([\\d,_,.]+)",p.UNKNOWN_VERSION="Unknown",p.DEVICE_ID_COOKIE="MicrosoftApplicationsTelemetryDeviceId",p.FIRST_LAUNCH_TIME_COOKIE="MicrosoftApplicationsTelemetryFirstLaunchTime",p._deleteCookie=function(e){"undefined"!=typeof document&&void 0!==document.cookie&&(document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;");},p._disableCookies=!1,function(e){e[e.STARTED=0]="STARTED",e[e.ENDED=1]="ENDED";}(d=t.SessionState||(t.SessionState={}));var h=function(){function e(){}return e.initialize=function(t,n){if(!e._initialized){if(!t)throw new l(a.INVALID_TENANT_TOKEN);if(e._defaultToken=t,e._tmConfig.collectorUrl="https://browser.pipe.aria.microsoft.com/Collector/3.0/",e._configuration=n,!("undefined"!=typeof window||n&&n.browserOverrides&&n.browserOverrides.onGetData))throw new l(a.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET);var i=null;if(n)if(n.collectorUrl&&(e._tmConfig.collectorUrl=n.collectorUrl),n.browserOverrides){if(i=new o(),n.browserOverrides.onGetData?!n.browserOverrides.onSaveData:n.browserOverrides.onSaveData)throw new l(a.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET);i.onGetData=n.browserOverrides.onGetData,i.onSaveData=n.browserOverrides.onSaveData;}else n.disableCookies&&(e._sessionEnabled=!1);r.Initialize(e._tmConfig),r.Start(),p.initialize(i,n.disableCookies),e._initialized=!0,"undefined"!=typeof window&&window.addEventListener&&(n&&n.enableAutoUserSession&&(e._logger=new f(),e._logger.logSession(d.STARTED)),window.addEventListener("beforeunload",e._teardown));}},e.pauseTransmission=function(){r.Pause();},e.resumeTransmission=function(){r.Resume();},e.flush=function(e){r.Flush(e);},e.addCallbackListener=function(t){e._initialized&&r.AddListener(t);},e.setContext=function(t,r,n){e._contextProperties.setProperty(t,r,n);},e.isInitialized=function(){return e._initialized;},e.getDefaultToken=function(){return e._defaultToken;},e.getSemanticContext=function(){return e._semanticContext;},e._getInitIdForToken=function(r){return e._initIdMap[r]||(e._initIdMap[r]=t.datamodels.utils.GetGuid()),e._initIdMap[r];},e._getSequenceForToken=function(t){return e._sequenceMap[t]||(e._sequenceMap[t]=0),e._sequenceMap[t]++,e._sequenceMap[t];},e._teardown=function(){e._logger&&e._logger.logSession(d.ENDED),e.flush();},e.__backToUninitialized=function(){e._tmConfig=new t._sender.TelemetryConfig(),e._semanticContext=new c(!0),e._contextProperties=new u(),e._configuration=null,r=t._sender.TelemetryManagerFactory.CreateTelemetryManager(),e._initialized=!1,e._initIdMap={},e._sequenceMap={};},e;}();h._initialized=!1,h._defaultToken=null,h._tmConfig=new t._sender.TelemetryConfig(),h._logger=null,h._initIdMap={},h._sequenceMap={},h._configuration=null,h._contextProperties=new u(),h._semanticContext=new c(!0),h._sessionEnabled=!0,t.LogManager=h;var f=function(){function e(e){this._initId=null,this._tenantToken=null,this._contextProperties=new u(),this._semanticContext=new c(!1),this._sessionStartTime=0,this._sessionId=null,this._tenantToken=e||h.getDefaultToken(),this._initId=h._getInitIdForToken(this._tenantToken);}return e.prototype.logEvent=function(e){if(!e.name)throw new l(a.MISSING_EVENT_PROPERTIES_NAME);var t=this._createEventRecord(e.name,e.eventType);this._addPropertiesAndSendEvent(t,e);},e.prototype.logFailure=function(e,t,r,n,i){if(!e)throw new l(a.MISSING_FAILURE_SIGNATURE);if(!t)throw new l(a.MISSING_FAILURE_DETAIL);var o=this._createEventRecord("failure","failure");o.Extension.Add("Failure.Signature",e),o.Extension.Add("Failure.Detail",t),r&&o.Extension.Add("Failure.Category",r),n&&o.Extension.Add("Failure.Id",n),this._addPropertiesAndSendEvent(o,i);},e.prototype.logPageView=function(e,t,r,n,i,o){if(!e)throw new l(a.MISSING_PAGEVIEW_ID);if(!t)throw new l(a.MISSING_PAGEVIEW_NAME);var s=this._createEventRecord("pageview","pageview");s.Extension.Add("PageView.Id",e),s.Extension.Add("PageView.Name",t),r&&s.Extension.Add("PageView.Category",r),n&&s.Extension.Add("PageView.Uri",n),i&&s.Extension.Add("PageView.ReferrerUri",i),this._addPropertiesAndSendEvent(s,o);},e.prototype.logSession=function(e,r){if(h._sessionEnabled){if(e!==d.STARTED&&e!==d.ENDED)throw new l(a.INVALID_SESSION_STATE);var n=this._createEventRecord("session","session");if(e===d.STARTED){if(this._sessionStartTime>0)return;this._sessionStartTime=new Date().getTime(),this._sessionId=t.datamodels.utils.GetGuid(),n.Extension.Add("Session.Id",this._sessionId),n.Extension.Add("Session.State","Started");}else if(e===d.ENDED){if(0==this._sessionStartTime)return;var i=Math.floor((new Date().getTime()-this._sessionStartTime)/1e3);n.Extension.Add("Session.Duration",i.toString()),n.Extension.Add("Session.DurationBucket",this._getSessionDurationFromTime(i)),n.Extension.Add("Session.Id",this._sessionId),n.Extension.Add("Session.State","Ended"),this._sessionId=null,this._sessionStartTime=0;}n.Extension.Add("Session.FirstLaunchTime",this._getISOString(new Date(p.firstLaunchTime))),this._addPropertiesAndSendEvent(n,r);}},e.prototype.getSessionId=function(){return this._sessionId;},e.prototype.setContext=function(e,t,r){this._contextProperties.setProperty(e,t,r);},e.prototype.getSemanticContext=function(){return this._semanticContext;},e.prototype._getSessionDurationFromTime=function(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min";},e.prototype._createEventRecord=function(e,r){var i=new t.datamodels.Record();r||(r="custom"),i.EventType=e.toLowerCase(),i.Type=r.toLowerCase(),i.Extension.Add("EventInfo.Source","JS_default_source"),i.Extension.Add("EventInfo.InitId",this._initId),i.Extension.Add("EventInfo.Sequence",h._getSequenceForToken(this._tenantToken).toString()),i.Extension.Add("EventInfo.Name",e.toLowerCase());var o=new Date();return i.Timestamp=t.datamodels.utils.GetTimeStampWithValue(o.getTime()),i.Extension.Add("EventInfo.Time",this._getISOString(o)),i.Extension.Add("EventInfo.SdkVersion","ACT-Web-JS-"+n.version),i;},e.prototype._getISOString=function(e){function t(e){return e<10?"0"+e:e.toString();}return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+function(e){return e<10?"00"+e:e<100?"0"+e:e.toString();}(e.getUTCMilliseconds())+"Z";},e.prototype._addCustomPropertiesToEvent=function(e,t){this._addSemanticContext(e,p.semanticContext),this._addSemanticContext(e,h._semanticContext),this._addSemanticContext(e,this._semanticContext),this._sessionId&&e.Extension.Add("Session.Id",this._sessionId),this._addEventPropertiesToEvent(e,h._contextProperties),this._addEventPropertiesToEvent(e,this._contextProperties),this._addEventPropertiesToEvent(e,t);},e.prototype._addSemanticContext=function(e,r){if(r&&r.contextMap){var n=r.contextMap;for(var i in r.contextMap){"UserInfo.Id"==i&&r.piiKind!=t.datamodels.PIIKind.NotSet?e.AddOrReplacePII(i,n[i],r.piiKind):e.Extension.AddOrReplace(i,n[i]);}}},e.prototype._addEventPropertiesToEvent=function(e,r){if(r){r.timestamp&&r.timestamp>=new Date("1/1/2000").getTime()&&(e.Timestamp=t.datamodels.utils.GetTimeStampWithValue(r.timestamp),e.Extension.AddOrReplace("EventInfo.Time",this._getISOString(new Date(r.timestamp)))),r.name&&(e.EventType=r.name.toLowerCase(),e.Extension.AddOrReplace("EventInfo.Name",r.name.toLowerCase()));var n=r.properties;if(n)for(var i in n){i&&(n[i].value||!1===n[i].value||0==n[i].value||""==n[i].value)&&(s._isPii(n[i].pii)?(e.AddOrReplacePII(i,n[i].value.toString(),n[i].pii),e.Extension.Remove(i)):(e.Extension.AddOrReplace(i,n[i].value.toString()),e.PIIExtensions.Remove(i)));}}},e.prototype._addPropertiesAndSendEvent=function(e,t){this._addCustomPropertiesToEvent(e,t),h.isInitialized()&&(this._sanitizeName(e),r.SendAsync(this._tenantToken,[e]));},e.prototype._sanitizeName=function(e){var t=e.EventType.replace(/\./g,"_");e.EventType=t,e.Extension.AddOrReplace("EventInfo.Name",t);},e;}();t.Logger=f;}(t.telemetry||(t.telemetry={}));}(e.applications||(e.applications={}));}(a||(a={})),e.exports=a.applications.telemetry;},2672:function _(e,t,r){"use strict";var n;r.r(t),function(e){e[e.absolute=0]="absolute",e[e.relative=1]="relative",e[e.serverRelative=2]="serverRelative";}(n||(n={}));var i=function i(e){void 0===e&&(e="");var t=e.indexOf("//"),r=e.indexOf("/"),i=t>-1&&t<=r?t+"//".length:-1,o=function(e,t){if(t>-1){var r=e.indexOf("/",t);return r>-1?e.slice(0,r):e;}return"";}(e,i),a=o&&o.slice(i),s=e.slice(o.length),u=o?n.absolute:"/"===s[0]?n.serverRelative:n.relative,l=s.split("/");this.authority=o,this.domain=a,this.format=u,this.path=s,this.segments=l,this.value=e;};r.d(t,"SPResourcePath",function(){return i;}),r.d(t,"SPResourcePathFormat",function(){return n;});},2721:function _(e,t,r){"use strict";r.r(t);var n,i=r(0),o=r(3),a=r(2607),s=r(165),u=r(887),l=r(873),c=r(1535);!function(e){e.loading="LOADING",e.ready="READY",e.error="ERROR";}(n||(n={}));var d=function d(e){var t=e.dialogState,r=e.loadingText,i=e.shareDialogIframeParentRef,a=e.errorStrings,s=e.dismissDialog,d=e.isCopyLinkDialog;return o.createElement(u.a,{fill:!0},t===n.loading&&o.createElement(u.a,{fill:!0,hAlign:"center",vAlign:"center"},o.createElement(l.a,{label:r})),t!==n.error&&o.createElement("div",{ref:i}),t===n.error&&o.createElement(c.a,{errorStrings:a,dismissDialog:s,isCopyLinkDialog:d}));};d.displayName="FileSharingDialogRenderer";var p,h=r(2714),f=r(2712),m=r(2608),_=r(2670),g=r(1461),v=r(776),y=r(100);!function(e){e.loading="LOADING",e.ready="READY",e.error="ERROR";}(p||(p={}));var S=function S(e){var t=o.useState(p.loading),r=t[0],n=t[1],i=o.useState(!1),a=i[0],s=i[1],u=o.useRef(null),l=o.useContext(_.c),c=Object(v.c)(),f=c.host,m=c.scenarioFactory,y=e.shareDialogInput,S=e.dismissDialog,T=e.client,E=Object(h.a)(y),b=Object(g.b)().siteVariables,w=o.useMemo(function(){return Object(h.b)(l,E,a);},[l,E,a]),R=Object(h.c)(l);return I(m,T,e,b,u,n,l,f,s),o.createElement(d,{dialogState:r,loadingText:R,shareDialogIframeParentRef:u,dismissDialog:S,errorStrings:w,isCopyLinkDialog:E});},I=function I(e,t,r,n,a,s,u,l,c){o.useEffect(function(){var o,d=r.shareDialogInput,p=Object(h.a)(d)?y.a.FileSharingCopyLinkDialog:y.a.FileSharingPermissionDialog,f=E(p,e);return Object(i.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),[4,b(t,r,n)];case 1:return e=i.sent(),o=R(e,a,s,u,r,l,f,c),[3,3];case 2:return i.sent(),T(f,s),[3,3];case 3:return[2];}});}),function(){o&&o.dispose(),f&&f.cancel();};},[]);},T=function T(e,t){e&&e.fail({errors:f.a.telemetry.errorReasons.internalClientCodeError}),w(t);},E=function E(e,t){return t.findScenario(e)||t.newScenario(e);},b=function b(e,t,r){return Object(i.__awaiter)(void 0,void 0,Promise,function(){var n,o,s,u,l,c,d;return Object(i.__generator)(this,function(i){switch(i.label){case 0:n=t.shareDialogInput,o=t.chatMembers,s=n.mode,u="teams",l=function(e){return e.map(function(e){return e.email;});}(o),c=r.odspShareDialogThemePalette,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,e.query({query:a,variables:{resource:new URL(n.absoluteUrl).origin},fetchPolicy:"network-only"})];case 2:return d=i.sent(),[2,{authToken:d.data.authenticationToken&&d.data.authenticationToken.token,webAbsoluteUrl:n.absoluteUrl,itemName:n.fileName,defaultRecipients:l,customLabeledAudienceConfig:{audienceType:"chat",entityName:""},clientId:u,itemUrl:n.objectUrl,shareId:n.shareId,uniqueId:n.fileId,isFolder:!1,theme:c,mode:s}];case 3:throw i.sent();case 4:return[2];}});});},w=function w(e){e(p.error);},R=function R(e,t,r,n,i,o,a,s){var u=t.current,l=i.dismissDialog,c=i.onShareInfoReceived;if(u){var d=o.setTimeout(function(){return P(f.a.timeoutSource.client,a);},6e4);try{var p=D(u,e,l,a,s,r,c,n,o,d);return p.initializeUI(),p;}catch(e){return w(r),C(e&&e.message,a),void o.clearTimeout(d);}}else w(r);},D=function D(e,t,r,n,i,o,a,s,u,l){return new m.SharePrefetch({element:e,environment:"prod",context:t,options:{onDismiss:function onDismiss(){r();},onError:function onError(e){u.clearTimeout(l),A(e,n,i),w(o);},onReady:function onReady(){u.clearTimeout(l),O(o,n);},onLinkSettingsComplete:function onLinkSettingsComplete(e){k(e,a,r);},onTimeout:function onTimeout(){N(o,u,l,n);}},locale:s.locale,timeout:45e3,elementWindow:u});},P=function P(e,t){A({resultCode:"initializeSharePrefetchFailedDueToTimeOut on "+e},t);},C=function C(e,t){A({resultCode:e,error:{errorCode:"initializeSharePrefetchFailed"}},t);},A=function A(e,t,r){var n=e||{error:void 0,resultCode:void 0},i=n.error,o=(void 0===i?{status:void 0}:i).status,a=n.resultCode;switch(o){case f.a.statusCode.forbidden:case f.a.statusCode.notFound:case f.a.statusCode.unauthorized:r&&r(!0),t.incomplete({errorCode:o,errors:JSON.stringify([a])});break;default:U(a,o,t);}},U=function U(e,t,r){e===f.a.telemetry.errorReasons.shareDomainNotReachableOnline?r.incomplete({errorCode:t,errors:JSON.stringify([e])}):r.fail({errorCode:t,errors:JSON.stringify([e])});},O=function O(e,t){e(p.ready),t.stop();},k=function k(e,t,r){var n={shareUrl:e.linkUrl,shareId:e.shareId,defaultLink:e.linkDescription,scope:e.scope};t&&t(n),r();},N=function N(e,t,r,n){w(e),t.clearTimeout(r),P(f.a.timeoutSource.server,n);},x=Object(s.withApollo)(S);S.displayName="FileSharingDialogContainerInternal",r.d(t,"default",function(){return x;});},846:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1226);function o(e){window.setTimeout(function(){i.raise(q,_,{error:e});},0);}var a,s,u,l,c,d,p,h,f,m,_="error",g="Canceled",v=1;function y(){}function S(e,t){e._value=t,e._setState(q.isPromise(t)?u:p);}function I(e,t,r,n,i,o){return{exception:e,error:t,promise:r,handler:o,id:n,parent:i};}function T(e,t,r,n){var i=r._isException;return I(i?t:null,i?null:t,e,r._errorId,r,n);}function E(e,t,r){var n=r._isException,i=r._errorId;return O(e,i,n),I(n?t:null,n?null:t,e,i,r);}function b(e,t){var r=++v;return O(e,r),I(null,t,e,r);}function w(e,t){var r=++v;return O(e,r,!0),I(t,null,e,r);}function R(e,t,r){U(e,{c:t,e:r});}function D(e,t,r,n){e._value=t,A(e,t,r,n),e._setState(f);}function P(e,t){var r,n,i=e._value,o=e._listeners;if(o)for(e._listeners=null,r=0,n=o.length;r<n;r++){var a=o[r],s=a.c,l=a.promise;if(l){try{l._setCompleteValue(s?s(i):i);}catch(e){l._setExceptionValue(e);}l._state!==u&&l._listeners&&t.push(l);}else B.prototype.done.call(e,s);}}function C(e,t){var r,n,i=e._value,o=e._listeners;if(o)for(e._listeners=null,r=0,n=o.length;r<n;r++){var a=o[r],s=a.e,l=a.promise;if(l){try{s?(s.handlesOnError||A(l,i,T,e,s),l._setCompleteValue(s(i))):l._setChainedErrorValue(i,e);}catch(e){l._setExceptionValue(e);}l._state!==u&&l._listeners&&t.push(l);}else M.prototype.done.call(e,null,s);}}function A(e,t,r,n,o){t instanceof Error&&t.message===g||i.raise(q,_,r(e,t,n,o));}function U(e,t){var r=e._listeners;r?r.push(t):r=[t],e._listeners=r;}function O(e,t,r){e._isException=r||!1,e._errorId=t;}function k(e,t,r,n){e._value=t,A(e,t,r,n),e._setState(m);}function N(e,t){var r;r=q.isPromise(t)?u:h,e._value=t,e._setState(r);}function x(e,t,r){var n=new j(e);return U(e,{promise:n,c:t,e:r}),n;}a={name:"created",enter:function enter(e){e._setState(s);},cancel:y,done:y,then:y,_completed:y,_error:y,_notify:y,_setCompleteValue:y,_setErrorValue:y},s={name:"working",enter:y,cancel:function cancel(e){e._setState(c);},done:R,then:x,_completed:S,_error:D,_notify:y,_setCompleteValue:N,_setErrorValue:k},u={name:"waiting",enter:function enter(e){var t=e._value;if(t instanceof j&&t._state!==m&&t._state!==h)U(t,{promise:e});else{var r=function r(n){t._errorId?e._chainedError(n,t):(A(e,n,T,t,r),e._error(n));};r.handlesOnError=!0,t.then(e._completed.bind(e),r);}},cancel:function cancel(e){e._setState(l);},done:R,then:x,_completed:S,_error:D,_notify:y,_setCompleteValue:N,_setErrorValue:k},l={name:"waiting_canceled",enter:function enter(e){e._setState(d);var t=e._value;q.is(t)&&t.cancel();},cancel:y,done:R,then:x,_completed:S,_error:D,_notify:y,_setCompleteValue:N,_setErrorValue:k},c={name:"canceled",enter:function enter(e){e._setState(d),e._cancelAction();},cancel:y,done:R,then:x,_completed:S,_error:D,_notify:y,_setCompleteValue:N,_setErrorValue:k},d={name:"canceling",enter:function enter(e){var t=new Error(g);t.name=t.message,t._handled=!0,e._value=t,e._setState(f);},cancel:y,done:y,then:y,_completed:y,_error:y,_notify:y,_setCompleteValue:y,_setErrorValue:y},p={name:"complete_notify",enter:function enter(e){if(e._listeners)for(var t=[e],r=void 0;t.length;){(r=t.shift())._state._notify(r,t);}e._setState(h);},cancel:y,done:function done(e,t,r){return B.prototype.done.call(e,t,r);},then:function then(e,t,r){return B.prototype.then.call(e,t,r);},_completed:y,_error:y,_notify:P,_setCompleteValue:y,_setErrorValue:y},h={name:"success",enter:function enter(e){e._cleanupAction();},cancel:y,done:function done(e,t,r){return B.prototype.done.call(e,t,r);},then:function then(e,t,r){return B.prototype.then.call(e,t,r);},_completed:y,_error:y,_notify:P,_setCompleteValue:y,_setErrorValue:y},f={name:"error_notify",enter:function enter(e){if(e._listeners)for(var t=[e],r=void 0;t.length;){(r=t.shift())._state._notify(r,t);}e._setState(m);},cancel:y,done:function done(e,t,r){return M.prototype.done.call(e,t,r);},then:function then(e,t,r){return M.prototype.then.call(e,t,r);},_completed:y,_error:y,_notify:C,_setCompleteValue:y,_setErrorValue:y},m={name:"error",enter:function enter(e){e._cleanupAction();},cancel:y,done:function done(e,t,r){return M.prototype.done.call(e,t,r);},then:function then(e,t,r){return M.prototype.then.call(e,t,r);},_completed:y,_error:y,_notify:C,_setCompleteValue:y,_setErrorValue:y};var L,M=function(){function e(e,t){void 0===t&&(t=b),this._value=e,A(this,e,t);}return e.prototype.cancel=function(){},e.prototype.done=function(e,t){var r=this._value;if(t)try{t.handlesOnError||A(null,r,T,this,t);var n=t(r);return void(q.is(n)&&n.done());}catch(e){r=e;}r instanceof Error&&r.message===g||o(r);},e.prototype.then=function(e,t){if(!t)return this;var r,n=this._value;try{t.handlesOnError||A(null,n,T,this,t),r=new B(t(n));}catch(e){r=e===n?this:new F(e);}return r;},e.prototype.catch=function(e){return this.then(void 0,e);},e;}(),F=function(e){function t(t){return e.call(this,t,w)||this;}return n.__extends(t,e),t;}(M),B=function(){function e(e){if(q.isPromise(e)){var t=new j(void 0);return t._setCompleteValue(e),t;}this._value=e;}return e.prototype.cancel=function(){},e.prototype.done=function(e){if(e)try{var t=e(this._value);q.is(t)&&t.done();}catch(e){o(e);}},e.prototype.then=function(t){var r;try{var n=t?t(this._value):this._value;r=this._isSameValue(n)?this:new e(n);}catch(e){r=new F(e);}return r;},e.prototype.catch=function(e){return this.then(void 0);},e.prototype._isSameValue=function(e){return e===this._value;},e;}();function W(e){var t;return new q(function(r){t=window.setTimeout(r,e);},function(){t&&window.clearTimeout(t);});}function V(e){return function(){for(var t=0,r=Object.keys(e);t<r.length;t++){var n=r[t];q.as(e[n]).cancel();}};}var q=function(){function e(e,t){this._init(e,t);}return Object.defineProperty(e,"cancel",{get:function get(){return L||(L=new M(new Error(g)));},enumerable:!0,configurable:!0}),e.any=function(t){return new e(function(r,n){var i=Object.keys(t),o=i.length;0===o&&r();for(var a=function a(i){e.as(t[i]).then(function(){r({key:i,value:t[i]});},function(a){a instanceof Error&&a.name===g?0==--o&&r(e.cancel):n({key:i,value:t[i]});});},s=0,u=i;s<u.length;s++){a(u[s]);}},V(t));},e.race=function(t){return new e(function(r,n){var i=Object.keys(t),o=i.length;0===o&&r();for(var a=0,s=i;a<s.length;a++){var u=s[a];e.as(t[u]).then(r,function(t){t instanceof Error&&t.name===g?0==--o&&r(e.cancel):n(t);});}},V(t));},e.as=function(t){return e.is(t)?t:new B(t);},e.is=function(t){return e.isPromise(t)&&"function"==typeof t.cancel;},e.isPromise=function(e){return e&&"object"==_typeof(e)&&"function"==typeof e.then;},e.isCanceled=function(e){return e instanceof Error&&e.name===g;},e.all=function(t){return new e(function(r,n){for(var i=Object.keys(t),o=Array.isArray(t)?[]:{},a=Array.isArray(t)?[]:{},s=i.length,u=function u(){if(0==--s){var t=Object.keys(o);0===t.length?r(a):t.every(function(t){return e.isCanceled(o[t]);})?r(e.cancel):n(o);}},l=function l(r){var n=t[r];void 0===n?s--:e.then(n,function(e){a[r]=e,u();},function(e){o[r]=e,u();});},c=0,d=i;c<d.length;c++){l(d[c]);}0===s&&r(a);},V(t));},e.then=function(t,r,n){return e.as(t).then(r,n);},e.thenEach=function(t,r,n){for(var i=Array.isArray(t)?[]:{},o=0,a=Object.keys(t);o<a.length;o++){var s=a[o];i[s]=e.then(t[s],r,n);}return e.all(i);},e.serial=function(t){return t.reduce(function(e,t){return e.then(t);},e.wrap());},e.timeout=function(e,t){var r=W(e);return t?function(e,t){var r=function r(){e.cancel();};return e.then(function(){t.cancel();}),t.then(r,r),t;}(r,t):r;},e.wrap=function(e){return new B(e);},e.resolve=function(t){return e.wrap(t);},e.wrapError=function(e){return new M(e);},e.reject=function(t){return e.wrapError(t);},e.prototype.cancel=function(){this._state.cancel(this),this._run();},e.prototype.done=function(e,t){this._state.done(this,e,t);},e.prototype.then=function(e,t){return this._state.then(this,e,t);},e.prototype.catch=function(e){return this.then(void 0,e);},e.prototype._init=function(e,t){this._oncancel=t,this._setState(a),this._run();try{e(this._completed.bind(this),this._error.bind(this));}catch(e){this._setExceptionValue(e);}},e.prototype._cancelAction=function(){if(this._oncancel)try{this._oncancel();}catch(e){}},e.prototype._cleanupAction=function(){this._oncancel=null;},e.prototype._chainedError=function(e,t){var r=this._state._error(this,e,E,t);return this._run(),r;},e.prototype._completed=function(e){var t=this._state._completed(this,e);return this._run(),t;},e.prototype._error=function(e){var t=this._state._error(this,e,b);return this._run(),t;},e.prototype._setState=function(e){this._nextState=e;},e.prototype._setCompleteValue=function(e){this._state._setCompleteValue(this,e),this._run();},e.prototype._setChainedErrorValue=function(e,t){var r=this._state._setErrorValue(this,e,E,t);return this._run(),r;},e.prototype._setExceptionValue=function(e){var t=this._state._setErrorValue(this,e,w);return this._run(),t;},e.prototype._run=function(){for(;this._nextState;){this._state=this._nextState,this._nextState=null,this._state.enter(this);}},e.prototype._isSameValue=function(e){return e===this._value;},e;}();i.declare(q,_);var j=function(e){function t(t){var r=e.call(this)||this;return r._creator=t,r._initThen(),r;}return n.__extends(t,e),t.prototype._init=function(){},t.prototype._cancelAction=function(){this._creator&&this._creator.cancel();},t.prototype._cleanupAction=function(){this._creator=null;},t.prototype._initThen=function(){this._setState(a),this._run();},t;}(q),G=function(e){function t(t){var r=e.call(this)||this;return r._oncancel=t,r._initSignal(),r;}return n.__extends(t,e),t.prototype._init=function(){},t.prototype._cancelAction=function(){this._oncancel&&this._oncancel();},t.prototype._cleanupAction=function(){this._oncancel=null;},t.prototype._initSignal=function(){this._setState(a),this._run();},t;}(q);t.SignalPromise=G,t.CancelablePromise=q,t.default=t.CancelablePromise;},865:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=/\{(\d+)\}/g;function i(e){for(var t=[],r=1;r<arguments.length;r++){t[r-1]=arguments[r];}return e.replace(n,function(e,r){var n=t[Number(r)];return null===n?"":""+n;});}function o(e,t,r){if(r=Number(r),void 0===e||void 0===t||void 0===r)return"";for(var n="",i=-1,o=t.split("||"),a=0,s=o.length;a<s;a++){var u=o[a];if(u){for(var l=0,c=u.split(",");l<c.length;l++){var d=c[l];if(d)if(isNaN(Number(d))){if(-1!==d.indexOf("-")){var p=d.split("-");if(2!==p.length)continue;var h=void 0;if(""===p[0])h=0;else{if(isNaN(Number(p[0])))continue;h=parseInt(p[0],10);}if(r>=h){if(""===p[1]){i=a;break;}if(isNaN(Number(p[1])))continue;if(r<=parseInt(p[1],10)){i=a;break;}}}else if(-1!==d.indexOf("*")){var f=d.trim().replace(/\*/g,"[0-9]*");if(new RegExp("^"+f+"$").test(r.toString())){i=a;break;}}}else if(r===parseInt(d,10)){i=a;break;}}if(-1!==i)break;}}if(-1!==i){var m=e.split("||");m[i]&&(n=m[i]);}return n;}t.format=i,t.formatToArray=function(e){for(var t=[],r=1;r<arguments.length;r++){t[r-1]=arguments[r];}for(var i,o=[],a=0;i=n.exec(e);){var s=i[0],u=t[parseInt(s.replace(/\{|\}+/g,""),10)];i.index>a&&o.push(e.substring(a,i.index)),a=n.lastIndex,o.push(u);}return a!==e.length&&o.push(e.substring(a,e.length)),o;},t.doesStringEndWith=function(e,t){return e.substr(e.length-t.length)===t;},t.doesStringStartWith=function(e,t){return e.substr(0,t.length)===t;},t.rightPad=function(e,t){for(var r=e.toString();r.length<t;){r+="0";}return r;},t.leftPad=function(e,t){for(var r=e.toString();r.length<t;){r="0"+r;}return r;},t.findOneOf=function(e,t){for(var r=0;r<e.length;r++){if(t.indexOf(e[r])>=0)return r;}return-1;},t.equalsCaseInsensitive=function(e,t){return e&&t?e.toUpperCase()===t.toUpperCase():e===t;},t.capitalize=function(e){return e?e[0].toUpperCase()+e.substr(1):e;},t.decapitalize=function(e){return e?e[0].toLowerCase()+e.substr(1):e;},t.pluralSelect=function(e,t,r){return 1===e?t:r;},t.getLocalizedCountValue=o,t.formatWithLocalizedCountValue=function(e,t,r){return i(o(e,t,r)||"",r.toString());};},903:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(956);function o(e,t){return new this(e,i.ClonedEventType.Single,t);}function a(e){return new this(null,i.ClonedEventType.Single,e);}t.createSingleEvent=function(e,t,r){var s=function(e){function r(){return null!==e&&e.apply(this,arguments)||this;}return n.__extends(r,e),r.logData=t?o:a,r;}(i.EventBase);return i.addEventProps(s.prototype,e,t||{},r),s;};},955:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1228),i=r(2614),o=r(2615),a=r(2616),s=r(1033),u="Canceled",l=new a.CircularBuffer(50);function c(e,t,r){if(e&&!function(e){return e===u||!!e&&"object"==_typeof(e)&&"name"in e&&e.name===u||!!e&&"object"==_typeof(e)&&"message"in e&&e.message===u;}(e)){for(var a,s=d(e),c=e&&"object"==_typeof(e)&&("stack"in e)&&e.stack?e.stack:"";a=l.popOldest();){o.Verbose.logData(a);}r&&r.eventName?i.QosError.logData({name:r.eventName,resultCode:r.resultCode,resultType:r.resultType,extraData:t||{},message:s,stack:c}):n.CaughtError.logData({extraData:t||{},message:s,stack:c});}}function d(e){var t="";return e&&("object"==_typeof(e)&&"message"in e?t=e.message:"object"==_typeof(e)&&"description"in e?t=e.description:"object"==_typeof(e)?t=s.safeSerialize(e):e.toString&&(t=e.toString())),t;}t.verbose=function(e,t){l.push({name:t,message:e});},t.logError=c,t.log=function(e,t,r,n){c(e,void 0,{eventName:t,resultCode:r,resultType:n});},t.getErrorMessage=d;},956:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,i=r(0),o=r(1032),a=r(2613),s=r(1230),u=0;!function(e){e[e.Single=0]="Single",e[e.Start=1]="Start",e[e.End=2]="End";}(t.ClonedEventType||(t.ClonedEventType={})),function(e){e[e.NoParent=1]="NoParent";}(n=t.ValidationErrorType||(t.ValidationErrorType={})),function(e){e[e.Consumer=0]="Consumer",e[e.ConsumerAnonymous=1]="ConsumerAnonymous",e[e.Business=2]="Business",e[e.BusinessAnonymous=3]="BusinessAnonymous",e[e.Unknown=4]="Unknown";}(t.AccountType||(t.AccountType={})),t.addEventProps=function(e,t,r,n){s.assign(e,t);var o={};for(var a in r){if(Object.prototype.hasOwnProperty.call(r,a)){var u=r[a],l=o[a]="number"==typeof u?{type:u}:u;l.definedInName=t.shortEventName,2===l.type&&(l.isMetric=!0);}}e.metadata=n?i.__assign({},n.prototype.metadata,o):o;};var l=new WeakMap(),c=function(){function e(e,t,r){this.context={},this.validationErrors=0,this.data={},this.context=i.__assign({},this.addContext({})),this.id=u++,this.enabled=this._isEnabled(),r?this.parentId=r.id:this.requiresParent&&this._addValidationError(n.NoParent),this.startTime=e&&e.startTimeOverride||o.Manager.getTime(),this.vector=new a.CorrelationVector(r?r.vector:a.CorrelationVector.RootVector),e&&this._setData(e),this._logEvent(t);}return e.enabled=function(){return this.prototype._isEnabled();},e.isTypeOf=function(e){return e.eventName.indexOf(this.prototype.shortEventName+",")>=0;},e.withManager=function(e){if(!e||e===o.Manager)return this;var t=l.get(e);t||(t=new WeakMap(),l.set(e,t));var r=t.get(this);if(r)return r;var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this;}return i.__extends(t,e),t;}(this);return n.prototype.manager=e,r=n,t.set(this,r),r;},e.withData=function(e){if(!e)return this;var t="function"!=typeof e?function(t){return i.__assign({},e,t);}:e;return function(e){function r(){return null!==e&&e.apply(this,arguments)||this;}return i.__extends(r,e),r.prototype.addData=function(r){var n=i.__assign({},r,t(r));return i.__assign({},n,e.prototype.addData.call(this,n));},r;}(this);},e.withContext=function(e){if(!e)return this;var t="function"!=typeof e?function(t){return i.__assign({},e,t);}:e;return function(e){function r(){return null!==e&&e.apply(this,arguments)||this;}return i.__extends(r,e),r.prototype.addContext=function(r){var n=i.__assign({},r,t(r));return i.__assign({},n,e.prototype.addContext.call(this,n));},r;}(this);},e.from=function(e){return e?this.withManager(e.prototype.manager).withContext(function(t){return e.prototype.addContext(t);}).withData(function(t){return e.prototype.addData(t);}):this;},e.prototype.addContext=function(e){return p(this.manager,e,{});},e.prototype.addData=function(e){return e;},e.prototype._isEnabled=function(){return!this.samplingFeature||o.Manager.isFeatureEnabled(this.samplingFeature);},e.prototype._setData=function(e){for(var t=this.data,r=0,n=Object.keys(e);r<n.length;r++){var i=n[r];i in this.metadata&&d(this.manager,e,t,i);}s.assign(this.data,this.addData(this.data));},e.prototype._logEvent=function(e){this.manager.logEvent(this,e);},e.prototype._addValidationError=function(e){this.validationErrors=this.validationErrors|e,this.manager.logValidationError(this,e);},e;}();function d(e,t,r,n){var i=t[n];switch(_typeof(i)){case"string":var o=e.cleanString(i,n);return void(void 0!==o&&(r[n]=o));case"undefined":return;case"object":return void(i&&Object.getPrototypeOf(i)===Object.prototype?r[n]=p(e,i,{}):r[n]=i);default:return void(r[n]=i);}}function p(e,t,r){for(var n=0,i=Object.keys(t);n<i.length;n++){d(e,t,r,i[n]);}return r;}t.EventBase=c;var h=c.prototype;h.eventName="EventBase,",h.shortEventName="EventBase",h.critical=!1,h.requiresParent=!0,h.manager=o.Manager;},957:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Success=0]="Success",e[e.Failure=1]="Failure",e[e.ExpectedFailure=2]="ExpectedFailure";}(t.ResultTypeEnum||(t.ResultTypeEnum={}));},958:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=r(1235);n.__exportStar(r(865),t),t.getLocaleNumberString=function(e,t,r){var n=r,o=i.default.language;if(e)try{n=e.toLocaleString(o,t);}catch(r){n=e.toLocaleString([],t);}return n;};},959:function _(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),i=function(e){function t(r){var i=e.call(this,r)||this;i.name="ApiError";var o=r.innerError,a=o instanceof t?{correlationId:o.correlationId,isExpected:o.isExpected,code:o.code,extraData:o.extraData}:o instanceof Error?{code:o.name}:{},s=r.correlationId,u=void 0===s?a.correlationId:s,l=r.isExpected,c=void 0===l?a.isExpected:l,d=r.extraData;return i.correlationId=u,i.isExpected=!!c,i.code=r.code||a.code||"",i.extraData=n.__assign({},a.extraData||{},d||{}),i;}return n.__extends(t,e),t;}(r(2620).CustomError);t.ApiError=i;}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/components-file-sharing-dialog-a02ffcb5af5e0e439f61.js.map