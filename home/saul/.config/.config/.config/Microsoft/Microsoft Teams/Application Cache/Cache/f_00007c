function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}(this.webpackJsonp=this.webpackJsonp||[]).push([[2],{1047:function _(e,t,n){"use strict";n.d(t,"i",function(){return E;}),n.d(t,"a",function(){return M;}),n.d(t,"b",function(){return P;}),n.d(t,"h",function(){return U;}),n.d(t,"g",function(){return I;}),n.d(t,"f",function(){return j;}),n.d(t,"e",function(){return D;}),n.d(t,"d",function(){return w;}),n.d(t,"k",function(){return l;}),n.d(t,"j",function(){return g;}),n.d(t,"c",function(){return O;});var r,i,o,s,a,u,c,d,h,l,p,f,m,y,b,v,g,S,T,_,C,A,R,O,E=200,M="/api/v1/",P="/api/v2/",U=12e4,I=3e4,j="https://chatsvcagg.teams.microsoft.com",D="https://chatsvcagg.teams.microsoft.com",w={startupclean:"teams/users/me",startupdelta:"teams/users/me/updates",startupcleananonymous:"teams/users/anonymous",startupdeltaanonymous:"teams/users/anonymous/updates"};!function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff",e[e.HealthcareCareCoordination=5]="HealthcareCareCoordination";}(r||(r={})),function(e){e.None="none",e.Owners="owners",e.Members="members",e.OwnersAndMembers="ownersAndMembers";}(i||(i={})),function(e){e[e.None=0]="None",e[e.Private=1]="Private",e[e.Secret=2]="Secret",e[e.Public=3]="Public",e[e.HiddenMembership=4]="HiddenMembership",e[e.Unknown=5]="Unknown",e[e.All=6]="All";}(o||(o={})),function(e){e[e.InProgress=0]="InProgress",e[e.Success=1]="Success",e[e.Error=2]="Error";}(s||(s={})),function(e){e[e.None=0]="None",e[e.Private=1]="Private",e[e.TenantWide=2]="TenantWide";}(a||(a={})),function(e){e[e.Everyone=0]="Everyone",e[e.Moderators=1]="Moderators";}(u||(u={})),function(e){e[e.Everyone=0]="Everyone",e[e.Moderators=1]="Moderators";}(c||(c={})),function(e){e[e.NotAllowed=0]="NotAllowed",e[e.Allowed=1]="Allowed";}(d||(d={})),function(e){e[e.NotAllowed=0]="NotAllowed",e[e.Allowed=1]="Allowed";}(h||(h={})),function(e){e[e.Undefined=0]="Undefined",e[e.User=1]="User",e[e.Admin=2]="Admin",e[e.Guest=3]="Guest";}(l||(l={})),function(e){e[e.Everyone=0]="Everyone",e[e.Moderators=1]="Moderators",e[e.EveryoneButGuests=2]="EveryoneButGuests";}(p||(p={})),function(e){e[e.Unknown=-1]="Unknown",e[e.Private=1]="Private",e[e.Channel=2]="Channel";}(f||(f={})),function(e){e[e.AnyonePost=0]="AnyonePost",e[e.AnyoneWithWarning=1]="AnyoneWithWarning",e[e.OwnersPost=2]="OwnersPost";}(m||(m={})),function(e){e[e.Strict=0]="Strict",e[e.Moderate=1]="Moderate",e[e.NoRestriction=2]="NoRestriction";}(y||(y={})),function(e){e[e.Standard=0]="Standard",e[e.Private=1]="Private",e[e.Shared=4]="Shared";}(b||(b={})),function(e){e[e.Single=0]="Single",e[e.Occurrence=1]="Occurrence",e[e.Exception=2]="Exception",e[e.RecurringMaster=3]="RecurringMaster";}(v||(v={})),function(e){e[e.None=0]="None",e[e.Adhoc=1]="Adhoc",e[e.Scheduled=2]="Scheduled",e[e.Recurring=3]="Recurring",e[e.Broadcast=4]="Broadcast";}(g||(g={})),function(e){e[e.None=0]="None",e[e.Daily=1]="Daily",e[e.Weekly=2]="Weekly",e[e.Monthly=3]="Monthly",e[e.RelativeMonthly=4]="RelativeMonthly",e[e.Yearly=5]="Yearly",e[e.RelativeYearly=6]="RelativeYearly";}(S||(S={})),function(e){e[e.First=0]="First",e[e.Second=1]="Second",e[e.Third=2]="Third",e[e.Fourth=3]="Fourth",e[e.Last=4]="Last";}(T||(T={})),function(e){e[e.January=1]="January",e[e.February=2]="February",e[e.March=3]="March",e[e.April=4]="April",e[e.May=5]="May",e[e.June=6]="June",e[e.July=7]="July",e[e.August=8]="August",e[e.September=9]="September",e[e.October=10]="October",e[e.November=11]="November",e[e.December=12]="December";}(_||(_={})),function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday";}(C||(C={})),function(e){e[e.First=0]="First",e[e.Second=1]="Second",e[e.Third=2]="Third",e[e.Fourth=3]="Fourth",e[e.Last=4]="Last";}(A||(A={})),function(e){e[e.None=0]="None",e[e.Sfb=1]="Sfb";}(R||(R={})),function(e){e[e.Meeting=1]="Meeting",e[e.None=0]="None",e[e.Channel=2]="Channel";}(O||(O={}));},1048:function _(e,t,n){"use strict";n.d(t,"c",function(){return r;}),n.d(t,"b",function(){return i;}),n.d(t,"d",function(){return o;}),n.d(t,"a",function(){return s;});var r={saveUnknownUser:"unknown_user_profile_generated",unknownUserFromDB:"unknown_user_from_index_db"},i={botType:"BOT"},o={member:"Member",guest:"Guest",voiceApp:"ADVoiceApp",DistributionList:"Group",Bot:"Bot",person:"Person",federated:"Federated",skypeConsumer:"SkypeConsumer"},s={showWarningBannerMinimumThreshold:20,type:{team:"team",channel:"channel",person:"person",webhook:"webhook",bot:"BOT",addABot:"addABot",app:"app"},hintElement:"ts-hint"};},1049:function _(e,t,n){"use strict";n.d(t,"c",function(){return r;}),n.d(t,"a",function(){return o;}),n.d(t,"b",function(){return a;});var r,i,o,s=n(921);!function(e){e[e.Sync=1]="Sync",e[e.LongPoll=2]="LongPoll",e[e.SfB=3]="SfB",e[e.SyncRelated=4]="SyncRelated",e[e.Local=5]="Local",e[e.CSAReplyChain=6]="CSAReplyChain",e[e.DeltaSync=7]="DeltaSync";}(r||(r={})),function(e){e[e.Muted=0]="Muted",e[e.Simple=1]="Simple",e[e.Important=2]="Important",e[e.Mentioned=3]="Mentioned";}(i||(i={})),function(e){e[e.StartupSyncClean=1]="StartupSyncClean",e[e.StartupSyncUpdate=2]="StartupSyncUpdate",e[e.ThreadDetailsSync=3]="ThreadDetailsSync",e[e.LongPoll=4]="LongPoll",e[e.ResolverPutConversation=5]="ResolverPutConversation",e[e.LocalUpdate=6]="LocalUpdate";}(o||(o={}));var a=function(){function e(){}return e.NotificationConversationId=s.m.PrivateFeed+"notifications",e.StarredConversationId=s.m.PrivateFeed+"starred",e.CallLogConversationId=s.m.PrivateFeed+"calllogs",e;}();},1050:function _(e,t,n){"use strict";n.d(t,"a",function(){return r;});var r=function r(e,t){if(!e.serverResponse)throw e;var n=e.serverResponse.status;if(n&&t.retryCount++<t.policy.maxRetryCount&&t.policy.shouldRetry(n))return t.retriesTable[n]=(t.retriesTable[n]||0)+1,t.policy.errorHandler(e,t);throw e;};},1255:function _(e,t,n){"use strict";n(59);var r=n(1281),i=(function(){function e(e,t){this.value=e,this.piiKind=t;}e.isPIIValue=function(e){return!!e&&"string"!=typeof e&&void 0!==e.scrub;},e.prototype.scrub=function(){return Object(r.sha256)(JSON.stringify(this.value));};}(),n(11)),o=n(2702),s=n(921);n(1047);n.d(t,"g",function(){return u;}),n.d(t,"e",function(){return c;}),n.d(t,"b",function(){return d;}),n.d(t,"c",function(){return h;}),n.d(t,"a",function(){return l;}),n.d(t,"d",function(){return p;}),n.d(t,"f",function(){return m;});s.m.SkypeSpacesUser,s.x,s.m.SkypeSpacesUser,s.a;function a(e,t){return!!e&&e.substr(0,t.length)===t;}function u(e){return a(e,s.m.SkypeSpacesThread)||c(e);}function c(e){return a(e,s.m.PrivateFeed);}function d(e){return f(Object(o.a)(e.conversationLink)).conversationId;}function h(e){if(!e||!e.conversationLink)throw TypeError("Chat-Service-Utils: Missing conversationLink");var t=f(Object(i.last)(e.conversationLink.split("/"))||"");return t.isValid?t.itemId:e.id;}function l(e,t,n){var r=e;if(t&&(t[s.z.ExtensionDefinitionContainer]||t[s.z.P2PChatUniqueRosterThread]&&r&&r.length>2)){var o=function(e,t){if(e&&e.length>2){var n=Object(i.partition)(e,function(e){return!p(e.id)||t&&t.indexOf(e.id)>-1;});return{members:n[0],botMembers:n[1]};}return{members:e,botMembers:[]};}(e,n);return{members:o.members,botMembers:o.botMembers};}return{members:r,botMembers:[]};}function p(e){return!!e&&!e.startsWith(s.b.VoiceAppPrefix)&&(e.startsWith(s.m.BotPrefix)||e.startsWith(s.b.BotPrefixOld));}function f(e){if(!e)return{isValid:!1,conversationId:"",itemId:""};var t=e.split(";");if(1===t.length)return{isValid:!1,conversationId:t[0],itemId:""};if(2!==t.length||0!==t[1].indexOf(s.F)||t[1].indexOf(s.D)>-1)return{isValid:!1,conversationId:"",itemId:""};var n,r,i=t[1].substr(s.F.length);return{isValid:(n=i,r=Number(n),!(!r||r<s.G)),conversationId:t[0],itemId:i};}function m(e){return Object(i.includes)(s.y,e.messagetype);}},1280:function _(e,t,n){"use strict";n.d(t,"e",function(){return o;}),n.d(t,"a",function(){return s;}),n.d(t,"b",function(){return a;}),n.d(t,"d",function(){return c;}),n.d(t,"c",function(){return d;});var r=n(11),i="://";function o(e,t,n,r){try{return t(new URL(n,r));}catch(t){return e;}}function s(e){return u(e);}function a(e){return u(e,!0);}function u(e,t){void 0===t&&(t=!1);var n=e.indexOf(i);n=n<=0?0:n+i.length;var o=[e.indexOf("/",n),e.indexOf("?",n),e.length],s=Math.min.apply(Math,Object(r.without)(o,-1));return t?e.slice(s).toLowerCase():e.slice(n,s).toLowerCase();}function c(e,t){if(!e)return"";if(e.startsWith("/"))return e;var n=e.indexOf(":");if(n<=0)return"";for(var r=(e=(e=e.replace(/(\')/g,"%27")).replace(/(\")/g,"%22")).substring(0,n).toLowerCase(),i=0,o=t;i<o.length;i++){if(r===o[i])return e;}return"http"===r?"https"+e.substring(n):"";}function d(e,t){if(!t)return t;var n=new RegExp("[?&]"+e+"=([^&#]*)").exec(t);return n&&n.length>1?decodeURI(n[1]):"";}},1281:function _(module,exports,__webpack_require__){(function(process,global){var __WEBPACK_AMD_DEFINE_RESULT__;!function(){"use strict";var ERROR="input is invalid type",WINDOW="object"==(typeof window==="undefined"?"undefined":_typeof(window)),root=WINDOW?window:{};root.JS_SHA256_NO_WINDOW&&(WINDOW=!1);var WEB_WORKER=!WINDOW&&"object"==(typeof self==="undefined"?"undefined":_typeof(self)),NODE_JS=!root.JS_SHA256_NO_NODE_JS&&"object"==_typeof(process)&&process.versions&&process.versions.node;NODE_JS?root=global:WEB_WORKER&&(root=self);var COMMON_JS=!root.JS_SHA256_NO_COMMON_JS&&"object"==_typeof(module)&&module.exports,AMD=__webpack_require__(1282),ARRAY_BUFFER=!root.JS_SHA256_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,HEX_CHARS="0123456789abcdef".split(""),EXTRA=[-2147483648,8388608,32768,128],SHIFT=[24,16,8,0],K=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],OUTPUT_TYPES=["hex","array","digest","arrayBuffer"],blocks=[];!root.JS_SHA256_NO_NODE_JS&&Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e);}),!ARRAY_BUFFER||!root.JS_SHA256_NO_ARRAY_BUFFER_IS_VIEW&&ArrayBuffer.isView||(ArrayBuffer.isView=function(e){return"object"==_typeof(e)&&e.buffer&&e.buffer.constructor===ArrayBuffer;});var createOutputMethod=function createOutputMethod(e,t){return function(n){return new Sha256(t,!0).update(n)[e]();};},createMethod=function createMethod(e){var t=createOutputMethod("hex",e);NODE_JS&&(t=nodeWrap(t,e)),t.create=function(){return new Sha256(e);},t.update=function(e){return t.create().update(e);};for(var n=0;n<OUTPUT_TYPES.length;++n){var r=OUTPUT_TYPES[n];t[r]=createOutputMethod(r,e);}return t;},nodeWrap=function nodeWrap(method,is224){var crypto=eval("require('crypto')"),Buffer=eval("require('buffer').Buffer"),algorithm=is224?"sha224":"sha256",nodeMethod=function nodeMethod(e){if("string"==typeof e)return crypto.createHash(algorithm).update(e,"utf8").digest("hex");if(null==e)throw new Error(ERROR);return e.constructor===ArrayBuffer&&(e=new Uint8Array(e)),Array.isArray(e)||ArrayBuffer.isView(e)||e.constructor===Buffer?crypto.createHash(algorithm).update(new Buffer(e)).digest("hex"):method(e);};return nodeMethod;},createHmacOutputMethod=function createHmacOutputMethod(e,t){return function(n,r){return new HmacSha256(n,t,!0).update(r)[e]();};},createHmacMethod=function createHmacMethod(e){var t=createHmacOutputMethod("hex",e);t.create=function(t){return new HmacSha256(t,e);},t.update=function(e,n){return t.create(e).update(n);};for(var n=0;n<OUTPUT_TYPES.length;++n){var r=OUTPUT_TYPES[n];t[r]=createHmacOutputMethod(r,e);}return t;};function Sha256(e,t){t?(blocks[0]=blocks[16]=blocks[1]=blocks[2]=blocks[3]=blocks[4]=blocks[5]=blocks[6]=blocks[7]=blocks[8]=blocks[9]=blocks[10]=blocks[11]=blocks[12]=blocks[13]=blocks[14]=blocks[15]=0,this.blocks=blocks):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e?(this.h0=3238371032,this.h1=914150663,this.h2=812702999,this.h3=4144912697,this.h4=4290775857,this.h5=1750603025,this.h6=1694076839,this.h7=3204075428):(this.h0=1779033703,this.h1=3144134277,this.h2=1013904242,this.h3=2773480762,this.h4=1359893119,this.h5=2600822924,this.h6=528734635,this.h7=1541459225),this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0,this.is224=e;}function HmacSha256(e,t,n){var r,i=_typeof(e);if("string"===i){var o,s=[],a=e.length,u=0;for(r=0;r<a;++r){(o=e.charCodeAt(r))<128?s[u++]=o:o<2048?(s[u++]=192|o>>6,s[u++]=128|63&o):o<55296||o>=57344?(s[u++]=224|o>>12,s[u++]=128|o>>6&63,s[u++]=128|63&o):(o=65536+((1023&o)<<10|1023&e.charCodeAt(++r)),s[u++]=240|o>>18,s[u++]=128|o>>12&63,s[u++]=128|o>>6&63,s[u++]=128|63&o);}e=s;}else{if("object"!==i)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR);}e.length>64&&(e=new Sha256(t,!0).update(e).array());var c=[],d=[];for(r=0;r<64;++r){var h=e[r]||0;c[r]=92^h,d[r]=54^h;}Sha256.call(this,t,n),this.update(d),this.oKeyPad=c,this.inner=!0,this.sharedMemory=n;}Sha256.prototype.update=function(e){if(!this.finalized){var t,n=_typeof(e);if("string"!==n){if("object"!==n)throw new Error(ERROR);if(null===e)throw new Error(ERROR);if(ARRAY_BUFFER&&e.constructor===ArrayBuffer)e=new Uint8Array(e);else if(!(Array.isArray(e)||ARRAY_BUFFER&&ArrayBuffer.isView(e)))throw new Error(ERROR);t=!0;}for(var r,i,o=0,s=e.length,a=this.blocks;o<s;){if(this.hashed&&(this.hashed=!1,a[0]=this.block,a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),t)for(i=this.start;o<s&&i<64;++o){a[i>>2]|=e[o]<<SHIFT[3&i++];}else for(i=this.start;o<s&&i<64;++o){(r=e.charCodeAt(o))<128?a[i>>2]|=r<<SHIFT[3&i++]:r<2048?(a[i>>2]|=(192|r>>6)<<SHIFT[3&i++],a[i>>2]|=(128|63&r)<<SHIFT[3&i++]):r<55296||r>=57344?(a[i>>2]|=(224|r>>12)<<SHIFT[3&i++],a[i>>2]|=(128|r>>6&63)<<SHIFT[3&i++],a[i>>2]|=(128|63&r)<<SHIFT[3&i++]):(r=65536+((1023&r)<<10|1023&e.charCodeAt(++o)),a[i>>2]|=(240|r>>18)<<SHIFT[3&i++],a[i>>2]|=(128|r>>12&63)<<SHIFT[3&i++],a[i>>2]|=(128|r>>6&63)<<SHIFT[3&i++],a[i>>2]|=(128|63&r)<<SHIFT[3&i++]);}this.lastByteIndex=i,this.bytes+=i-this.start,i>=64?(this.block=a[16],this.start=i-64,this.hash(),this.hashed=!0):this.start=i;}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this;}},Sha256.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex;e[16]=this.block,e[t>>2]|=EXTRA[3&t],this.block=e[16],t>=56&&(this.hashed||this.hash(),e[0]=this.block,e[16]=e[1]=e[2]=e[3]=e[4]=e[5]=e[6]=e[7]=e[8]=e[9]=e[10]=e[11]=e[12]=e[13]=e[14]=e[15]=0),e[14]=this.hBytes<<3|this.bytes>>>29,e[15]=this.bytes<<3,this.hash();}},Sha256.prototype.hash=function(){var e,t,n,r,i,o,s,a,u,c=this.h0,d=this.h1,h=this.h2,l=this.h3,p=this.h4,f=this.h5,m=this.h6,y=this.h7,b=this.blocks;for(e=16;e<64;++e){t=((i=b[e-15])>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,n=((i=b[e-2])>>>17|i<<15)^(i>>>19|i<<13)^i>>>10,b[e]=b[e-16]+t+b[e-7]+n<<0;}for(u=d&h,e=0;e<64;e+=4){this.first?(this.is224?(o=300032,y=(i=b[0]-1413257819)-150054599<<0,l=i+24177077<<0):(o=704751109,y=(i=b[0]-210244248)-1521486534<<0,l=i+143694565<<0),this.first=!1):(t=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),r=(o=c&d)^c&h^u,y=l+(i=y+(n=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7))+(p&f^~p&m)+K[e]+b[e])<<0,l=i+(t+r)<<0),t=(l>>>2|l<<30)^(l>>>13|l<<19)^(l>>>22|l<<10),r=(s=l&c)^l&d^o,m=h+(i=m+(n=(y>>>6|y<<26)^(y>>>11|y<<21)^(y>>>25|y<<7))+(y&p^~y&f)+K[e+1]+b[e+1])<<0,t=((h=i+(t+r)<<0)>>>2|h<<30)^(h>>>13|h<<19)^(h>>>22|h<<10),r=(a=h&l)^h&c^s,f=d+(i=f+(n=(m>>>6|m<<26)^(m>>>11|m<<21)^(m>>>25|m<<7))+(m&y^~m&p)+K[e+2]+b[e+2])<<0,t=((d=i+(t+r)<<0)>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10),r=(u=d&h)^d&l^a,p=c+(i=p+(n=(f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+(f&m^~f&y)+K[e+3]+b[e+3])<<0,c=i+(t+r)<<0;}this.h0=this.h0+c<<0,this.h1=this.h1+d<<0,this.h2=this.h2+h<<0,this.h3=this.h3+l<<0,this.h4=this.h4+p<<0,this.h5=this.h5+f<<0,this.h6=this.h6+m<<0,this.h7=this.h7+y<<0;},Sha256.prototype.hex=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,i=this.h4,o=this.h5,s=this.h6,a=this.h7,u=HEX_CHARS[e>>28&15]+HEX_CHARS[e>>24&15]+HEX_CHARS[e>>20&15]+HEX_CHARS[e>>16&15]+HEX_CHARS[e>>12&15]+HEX_CHARS[e>>8&15]+HEX_CHARS[e>>4&15]+HEX_CHARS[15&e]+HEX_CHARS[t>>28&15]+HEX_CHARS[t>>24&15]+HEX_CHARS[t>>20&15]+HEX_CHARS[t>>16&15]+HEX_CHARS[t>>12&15]+HEX_CHARS[t>>8&15]+HEX_CHARS[t>>4&15]+HEX_CHARS[15&t]+HEX_CHARS[n>>28&15]+HEX_CHARS[n>>24&15]+HEX_CHARS[n>>20&15]+HEX_CHARS[n>>16&15]+HEX_CHARS[n>>12&15]+HEX_CHARS[n>>8&15]+HEX_CHARS[n>>4&15]+HEX_CHARS[15&n]+HEX_CHARS[r>>28&15]+HEX_CHARS[r>>24&15]+HEX_CHARS[r>>20&15]+HEX_CHARS[r>>16&15]+HEX_CHARS[r>>12&15]+HEX_CHARS[r>>8&15]+HEX_CHARS[r>>4&15]+HEX_CHARS[15&r]+HEX_CHARS[i>>28&15]+HEX_CHARS[i>>24&15]+HEX_CHARS[i>>20&15]+HEX_CHARS[i>>16&15]+HEX_CHARS[i>>12&15]+HEX_CHARS[i>>8&15]+HEX_CHARS[i>>4&15]+HEX_CHARS[15&i]+HEX_CHARS[o>>28&15]+HEX_CHARS[o>>24&15]+HEX_CHARS[o>>20&15]+HEX_CHARS[o>>16&15]+HEX_CHARS[o>>12&15]+HEX_CHARS[o>>8&15]+HEX_CHARS[o>>4&15]+HEX_CHARS[15&o]+HEX_CHARS[s>>28&15]+HEX_CHARS[s>>24&15]+HEX_CHARS[s>>20&15]+HEX_CHARS[s>>16&15]+HEX_CHARS[s>>12&15]+HEX_CHARS[s>>8&15]+HEX_CHARS[s>>4&15]+HEX_CHARS[15&s];return this.is224||(u+=HEX_CHARS[a>>28&15]+HEX_CHARS[a>>24&15]+HEX_CHARS[a>>20&15]+HEX_CHARS[a>>16&15]+HEX_CHARS[a>>12&15]+HEX_CHARS[a>>8&15]+HEX_CHARS[a>>4&15]+HEX_CHARS[15&a]),u;},Sha256.prototype.toString=Sha256.prototype.hex,Sha256.prototype.digest=function(){this.finalize();var e=this.h0,t=this.h1,n=this.h2,r=this.h3,i=this.h4,o=this.h5,s=this.h6,a=this.h7,u=[e>>24&255,e>>16&255,e>>8&255,255&e,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24&255,n>>16&255,n>>8&255,255&n,r>>24&255,r>>16&255,r>>8&255,255&r,i>>24&255,i>>16&255,i>>8&255,255&i,o>>24&255,o>>16&255,o>>8&255,255&o,s>>24&255,s>>16&255,s>>8&255,255&s];return this.is224||u.push(a>>24&255,a>>16&255,a>>8&255,255&a),u;},Sha256.prototype.array=Sha256.prototype.digest,Sha256.prototype.arrayBuffer=function(){this.finalize();var e=new ArrayBuffer(this.is224?28:32),t=new DataView(e);return t.setUint32(0,this.h0),t.setUint32(4,this.h1),t.setUint32(8,this.h2),t.setUint32(12,this.h3),t.setUint32(16,this.h4),t.setUint32(20,this.h5),t.setUint32(24,this.h6),this.is224||t.setUint32(28,this.h7),e;},HmacSha256.prototype=new Sha256(),HmacSha256.prototype.finalize=function(){if(Sha256.prototype.finalize.call(this),this.inner){this.inner=!1;var e=this.array();Sha256.call(this,this.is224,this.sharedMemory),this.update(this.oKeyPad),this.update(e),Sha256.prototype.finalize.call(this);}};var exports=createMethod();exports.sha256=exports,exports.sha224=createMethod(!0),exports.sha256.hmac=createHmacMethod(),exports.sha224.hmac=createHmacMethod(!0),COMMON_JS?module.exports=exports:(root.sha256=exports.sha256,root.sha224=exports.sha224,AMD&&(__WEBPACK_AMD_DEFINE_RESULT__=function(){return exports;}.call(exports,__webpack_require__,exports,module),void 0===__WEBPACK_AMD_DEFINE_RESULT__||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)));}();}).call(this,__webpack_require__(164),__webpack_require__(163));},1282:function _(e,t){(function(t){e.exports=t;}).call(this,{});},1283:function _(e,t,n){"use strict";n.d(t,"b",function(){return o;}),n.d(t,"a",function(){return s;});var r=n(11),i=n(2704);n(2705);function o(e){return{url:e.url,title:e.title,description:e.description,previewEnabled:!0,thumbnail:e.thumbnail,thumbnailMeta:e.thumbnail_meta};}function s(e){return Object(r.map)(Object(r.compact)(e),function(e,t){return{"@type":i.a.hyperLink,itemid:t.toString(),url:e.url,previewenabled:e.previewEnabled,preview:{previewurl:e.thumbnail,previewmeta:e.thumbnailMeta,title:e.title,description:e.description}};});}},2702:function _(e,t,n){"use strict";n.d(t,"a",function(){return i;});var r=n(1280);function i(e){var t=Object(r.e)(e,function(e){return e.pathname;},e,"http://example.com");return decodeURIComponent(t.slice(t.lastIndexOf("/")+1));}},2703:function _(e,t,n){"use strict";n.d(t,"b",function(){return i;}),n.d(t,"a",function(){return o;});var r=n(712),i=function i(e){return e&&e.startsWith(r.a.Pstn);},o=function o(e){return a(s(e.slice(r.a.Pstn.length)));},s=function s(e){return e.replace(/_([a-z]+\d+|\d+[a-z]+)[a-z\d]*$/gi,"");},a=function a(e){return e.replace(/[ \(\)\-_]+/g,"");};},2704:function _(e,t,n){"use strict";var r;n.d(t,"a",function(){return r;}),function(e){e.mention="http://schema.skype.com/Mention",e.inputExtension="http://schema.skype.com/InputExtension",e.amsVideo="http://schema.skype.com/AMSVideo",e.amsImage="http://schema.skype.com/AMSImage",e.emoji="http://schema.skype.com/Emoji",e.live="http://schema.skype.com/Live",e.giphy="http://schema.skype.com/Giphy",e.filesHyperlink="http://schema.skype.com/HyperLink/Files",e.hyperLink="http://schema.skype.com/HyperLink";}(r||(r={}));},2705:function _(e,t,n){"use strict";n.d(t,"a",function(){return o;});var r=n(0),i=n(11);function o(e,t){function n(e){if(!Object(i.isArray)(e)&&!Object(i.isObject)(e)||Object(i.isDate)(e))return e;var n={};Object(i.forOwn)(e,function(e,r){n[r]=o(e,t);});var s=t;n[s];return Object(r.__rest)(n,["symbol"==_typeof(s)?s:s+""]);}return Object(i.isArray)(e)?e.map(n):n(e);}},2706:function _(e,t,n){"use strict";n.d(t,"b",function(){return a;}),n.d(t,"c",function(){return u;}),n.d(t,"d",function(){return c;}),n.d(t,"e",function(){return d;}),n.d(t,"a",function(){return h;});var r=n(0),i=2,o=4,s=.5,a=function(){function e(e,t,n){this.maxDelay=e,this.initialDelay=t,this.calculate=n,this.errCount=0;}return Object.defineProperty(e.prototype,"errorCount",{get:function get(){return this.errCount;},enumerable:!0,configurable:!0}),e.prototype.next=function(){return Math.min(this.maxDelay,this.calculate(this.initialDelay,++this.errCount));},e.prototype.reset=function(){this.errCount=0;},e;}(),u=(function(e){function t(t,n){return e.call(this,t,n,function(e,t){return Math.pow(e,t);})||this;}Object(r.__extends)(t,e);}(a),function(e){function t(t,n,r){return e.call(this,r,t,function(e,t){return e*Math.pow(n,t-1);})||this;}return Object(r.__extends)(t,e),t;}(a)),c=function(e){function t(t){return e.call(this,t,t,function(){return t;})||this;}return Object(r.__extends)(t,e),t;}(a),d=function(e){function t(t){return e.call(this,t,t,function(){return Math.floor(Math.random()*t);})||this;}return Object(r.__extends)(t,e),t;}(a),h=function(e){function t(t,n){return e.call(this,n,t,function(e,t){var n=Math.random()*Math.pow(i,t-1);return Math.floor((s*Math.pow(o,t-1)+n)*e);})||this;}return Object(r.__extends)(t,e),t;}(a);},2719:function _(e,t,n){"use strict";var r=n(0),i=n(284),o=n(134),s=n(54),a=n(11),u=n(112);var c,d,h,l=function(){function e(e,t,n){this.onBatchReady=e,this.batchingIntervalInMs=t,this.maxBatchRequests=n,this.intervalId=null,this.queue=[];}return e.prototype.submit=function(e){var t=function(){var e={};return e.promise=new Promise(function(t,n){e.resolve=t,e.reject=n;}),e;}();return this.queue.push({request:e,deferred:t}),this.maxBatchRequests&&this.queue.length>=this.maxBatchRequests?(this.stop(),this.processQueue()):this.start(),t.promise;},e.prototype.start=function(){var e=this;this.intervalId||(this.intervalId=Object(u.a)().setInterval(function(){return e.processQueue();},this.batchingIntervalInMs));},e.prototype.stop=function(){this.intervalId&&(Object(u.a)().clearInterval(this.intervalId),this.intervalId=null);},e.prototype.processQueue=function(){var e=this,t=this.queue.length;if(t>0){var n=this.queue.splice(0,t);this.onBatchReady(n.map(function(e){return e.request;})).then(function(t){return e.processBatchResults(n,t);}).catch(function(t){return e.processBatchError(n,t);});}else this.stop();},e.prototype.processBatchResults=function(e,t){Object(a.zipWith)(e,t,function(e,t){t instanceof Error?e.deferred.reject(t):e.deferred.resolve(t);});},e.prototype.processBatchError=function(e,t){Object(a.each)(e,function(e){e.deferred.reject(t);});},e;}(),p=n(2703),f=n(769);!function(e){e.addToCall="addToCall",e.addToChat="addToChat",e.addToMeeting="addToMeeting",e.addToSpeedDialOrContacts="addToSpeedDialOrContacts",e.addToTeam="addToTeam",e.atMention="atMention",e.callForwardGroupSelection="callForwardGroupSelection",e.callRouting="callToRouting",e.delegationSelection="delegationSelection",e.meetingSchedule="meetingSchedule",e.newChat="newChat",e.orgChart="orgChart",e.presenceSettings="presenceSettings",e.priorityContactsSelection="priorityContactsSelection",e.searchResults="searchResults",e.searchSuggestions="searchSuggestions",e.shareToTeams="shareToTeams",e.taggedContactsSelection="taggedContactSelection",e.transfer="transfer",e.escalateMessage="escalateMessage",e.allFalse="allFalse",e.allTrue="allTrue",e.custom="custom";}(c||(c={})),function(e){e.AADTenant="AADTenant",e.Bot="Bot",e.CallQandAA="CallQandAA",e.DisabledUser="DisabledUser",e.DL="DL",e.Federated="Federated",e.FederatedConsumer="FederatedConsumer",e.Guest="Guest",e.ModernGroup="ModernGroup",e.PersonalContact="PersonalContact",e.Pstn="Pstn",e.Room="Room",e.UserDefinedGroup="UserDefinedGroup",e.TeamTags="TeamTags";}(d||(d={})),function(e){e.AAD="AAD",e.IndexedDb="IndexedDB",e.MiddleTier="MT",e.Substrate="3S",e.TopNCache="TopNCache";}(h||(h={}));var m=n(1048),y=n(412),b=n(766),v=function(){function e(){}return e.prototype.initialize=function(e){this.logger=e,this.logger.debug("Event Logging-Service initialized");},e.getInstance=function(){return this.instance;},e.prototype.event=function(e,t){Object(b.b)(y.a.Tracking,e,t);},e.prototype.customEvent=function(e,t,n){Object(b.b)(e,t,n);},e.instance=new e(),e;}();var g,S;!function(e){e[e.Sunday=0]="Sunday",e[e.Monday=1]="Monday",e[e.Tuesday=2]="Tuesday",e[e.Wednesday=3]="Wednesday",e[e.Thursday=4]="Thursday",e[e.Friday=5]="Friday",e[e.Saturday=6]="Saturday";}(g||(g={}));var T,_=[d.AADTenant,d.Guest,d.Federated,d.FederatedConsumer,d.Bot,d.DisabledUser,d.DL,d.ModernGroup,d.PersonalContact,d.UserDefinedGroup,d.Pstn,d.CallQandAA,d.Room,d.TeamTags],C=(d.AADTenant,d.Guest,d.Federated,d.FederatedConsumer,d.Bot,d.DisabledUser,d.DL,d.ModernGroup,d.PersonalContact,d.UserDefinedGroup,d.Pstn,(S={})[c.callForwardGroupSelection]=[],S[c.allTrue]=_,S[c.searchSuggestions]=_,S[c.searchResults]=[d.AADTenant,d.Guest,d.Federated,d.FederatedConsumer,d.Bot,d.DisabledUser,d.ModernGroup,d.PersonalContact,d.UserDefinedGroup,d.Pstn,d.CallQandAA],S[c.addToTeam]=[d.AADTenant,d.Guest,d.Federated,d.FederatedConsumer,d.Bot,d.DisabledUser,d.Pstn],S[c.newChat]=[d.AADTenant,d.Guest,d.Federated,d.FederatedConsumer,d.Bot,d.DisabledUser,d.DL,d.ModernGroup,d.UserDefinedGroup,d.TeamTags,d.Room],S[c.transfer]=[d.AADTenant,d.Guest,d.DisabledUser,d.DL,d.ModernGroup,d.PersonalContact,d.UserDefinedGroup,d.Pstn,d.CallQandAA],S[c.addToCall]=[d.AADTenant,d.Guest,d.Bot,d.DisabledUser,d.UserDefinedGroup,d.Pstn],S[c.addToChat]=[d.AADTenant,d.Guest,d.Federated,d.FederatedConsumer,d.Bot,d.DisabledUser,d.TeamTags],S[c.callRouting]=[d.AADTenant,d.Guest,d.Bot,d.DisabledUser,d.DL,d.PersonalContact,d.UserDefinedGroup,d.Pstn,d.CallQandAA],S[c.delegationSelection]=[d.AADTenant],S[c.presenceSettings]=[d.AADTenant,d.Guest,d.Federated,d.FederatedConsumer,d.PersonalContact,d.Pstn],S[c.addToMeeting]=[d.AADTenant,d.Guest,d.Federated,d.FederatedConsumer,d.Bot,d.DisabledUser,d.DL,d.ModernGroup,d.PersonalContact,d.UserDefinedGroup,d.Pstn],S[c.meetingSchedule]=[d.AADTenant,d.Guest,d.Federated,d.DL,d.ModernGroup,d.PersonalContact,d.Pstn],S[c.addToSpeedDialOrContacts]=[d.AADTenant,d.Guest,d.Federated,d.FederatedConsumer,d.Bot,d.DisabledUser,d.PersonalContact,d.Pstn,d.CallQandAA],S[c.atMention]=[d.AADTenant,d.Guest,d.Bot,d.Pstn],S[c.orgChart]=[d.AADTenant,d.Guest,d.Pstn],S[c.priorityContactsSelection]=[d.AADTenant,d.Federated,d.FederatedConsumer,d.Pstn],S[c.taggedContactsSelection]=[d.AADTenant,d.Guest,d.DL,d.PersonalContact],S[c.shareToTeams]=[d.AADTenant,d.Guest,d.Federated,d.FederatedConsumer,d.DisabledUser,d.PersonalContact,d.UserDefinedGroup],S[c.escalateMessage]=[d.AADTenant],S[c.allFalse]=[],S[c.custom]=[],S),A=function A(e,t){return Object(a.flatten)(e.filter(function(e){var n=e[0];e[1];return n===t;}).map(function(e){e[0];return e[1];}));},R=((T={})[h.Substrate]=[d.AADTenant],T[h.AAD]=[d.Guest],T[h.IndexedDb]=[d.Federated,d.FederatedConsumer,d.Bot,d.Pstn],T[h.MiddleTier]=[],T[h.TopNCache]=[],function(){function e(e,t){this.includeFeatures=e,this.name=t,this.includeAADTenant=!1,this.includeGuest=!1,this.includeFederated=!1,this.includeFederatedConsumer=!1,this.includeBot=!1,this.includeDisabledUser=!1,this.includeDL=!1,this.includeModernGroup=!1,this.includePersonalContact=!1,this.includeUserDefinedGroup=!1,this.includePstn=!1,this.includeCallQandAA=!1,this.includeRoom=!1,this.includeTeamTags=!1,this.includeAADTenant=Object(a.includes)(e,d.AADTenant),this.includeGuest=Object(a.includes)(e,d.Guest),this.includeFederated=Object(a.includes)(e,d.Federated),this.includeFederatedConsumer=Object(a.includes)(e,d.FederatedConsumer),this.includeBot=Object(a.includes)(e,d.Bot),this.includeDisabledUser=Object(a.includes)(e,d.DisabledUser),this.includeDL=Object(a.includes)(e,d.DL),this.includeModernGroup=Object(a.includes)(e,d.ModernGroup),this.includePersonalContact=Object(a.includes)(e,d.PersonalContact),this.includeUserDefinedGroup=Object(a.includes)(e,d.UserDefinedGroup),this.includePstn=Object(a.includes)(e,d.Pstn),this.includeCallQandAA=Object(a.includes)(e,d.CallQandAA),this.includeRoom=Object(a.includes)(e,d.Room),this.includeTeamTags=Object(a.includes)(e,d.TeamTags);}return e.fromName=function(t,n){if(void 0===n&&(n=[]),!(t in C))throw new TypeError("Invalid `name` attribute passed. Please make sure it exists in PEOPLE_FILTER_NAME_CONFIG.");var i=A(n,!0),o=A(n,!1);return new e(a.without.apply(null,Object(r.__spreadArrays)([Object(a.concat)(C[t],i)],o)),t);},e.createFrom=function(t,n,r){return new e(n||t.includeFeatures,r||t.name);},e.includesAll=function(e,t){return Object(a.every)(t,function(t){return Object(a.includes)(e.includeFeatures,t);});},e.includesAny=function(e,t){return Object(a.some)(t,function(t){return Object(a.includes)(e.includeFeatures,t);});},e;}()),O=function(){function e(){}return e.isUnknownUser=function(e){return"unknown@af4716f4-406e-409b-acc1-b8bf9efe83fa.com"===e.email;},e.getRequestCount=function(e){return e&&e.requestCount||e.$$requestCount||0;},e.sanitizeUserProfileObject=function(e){if(!e)throw new Error("Invalid user profile object passed");var t=Object(r.__assign)({isSelf:void 0,managerLevel:void 0},e);t.isSelf,t.managerLevel,t.userClassification;return Object(r.__rest)(t,["isSelf","managerLevel","userClassification"]);},e.getCacheExpiryCallbackForUser=function(e,t){return void 0===t&&(t=null),function(n){if(n.isAnonymousUser)return 0;var r=n.skypeTeamsInfo&&n.skypeTeamsInfo.isSkypeTeamsUser;return e.enableNonTeamsUserShortCacheExpiry&&!r?576e5:t||12096e5;};},e.sendTelemetryForIndexDBUnknownUser=function(e,t){var n,r;(e=Object(a.map)(e,function(e){return e.includes("temp_fed:")?"UnresolvedFederationUserMriLogText":e;}))&&e.length>0&&(n=m.c.unknownUserFromDB,r={errors:JSON.stringify([{unknownUserMris:e,callerInfo:t}])},v.getInstance().event(n,r));},e.isEnoughProfileInfoInCache=function(t,n){return t&&!e.isUnknownUser(t)&&(!n||n&&!Object(a.isUndefined)(t.isShortProfile)&&!t.isShortProfile);},e.addDescription=function(e,t){if(void 0===t&&(t=!1),!e.description&&e.type!==m.b.botType){var n=e.userPrincipalName.substr(0,e.userPrincipalName.indexOf("@")).toUpperCase();e.description=e.jobTitle?"("+n+") "+e.jobTitle:e.userType===m.d.guest||t?e.email||e.userPrincipalName:n;}},e.addGuestIndicator=function(e,t){var n=t?t("Guest"):"Guest",r=e.guestlessDisplayName.indexOf(n);r>-1?e.guestlessDisplayName=e.guestlessDisplayName.substring(0,r).trimRight():(e.displayName=e.displayName+" "+n,e.givenName&&(e.guestGivenName=e.givenName+" "+n),e.surname&&(e.guestSurname=e.surname+" "+n));},e.addUserTypeInfo=function(e){e.type&&"ADUser"===e.type||"User"===e.objectType?(e.type=m.a.type.person,e.$$subType="ADUser"):e.type&&(e.$$subType=e.type);},e.addSkypeTeamsInfo=function(e,t){if(e){e.skypeTeamsInfo=e.skypeTeamsInfo||{isSkypeTeamsUser:!0};var n=t.sfb.testUsers,r=!n||n.indexOf(e.userPrincipalName)<0;e.skypeTeamsInfo.isSkypeTeamsUser=!!e.skypeTeamsInfo.isSkypeTeamsUser&&r;}},e.applyFeatureFlagSettings=function(e,t){var n=e.includeFeatures;switch(e.name){case c.addToMeeting:case c.meetingSchedule:t.enableFederatedUsersInMeetings||(n=Object(a.difference)(n,[d.Federated])),t.enableBotsInScheduledMeetings&&(n=Object(a.difference)(n,[d.Bot]));break;case c.addToChat:t.enableFederatedUsersInAddToChat||(n=Object(a.difference)(n,[d.Federated]));break;case c.addToTeam:t.enableFederatedUsersInAddToTeam||(n=Object(a.difference)(n,[d.Federated]));break;case c.addToSpeedDialOrContacts:t.enableFederatedUsersInAddToSpeedDialOrContacts||(n=Object(a.difference)(n,[d.Federated]));}return R.createFrom(e,n);},e.filterSearchResults=function(t,n,r){var i=n;return(t=e.applyFeatureFlagSettings(t,r)).includeFederated||(i=i.filter(function(t){return!e.isFederatedUser(t);})),t.includeGuest||(i=i.filter(function(t){return!e.isGuestUser(t);})),t.includeBot||(i=i.filter(function(t){return!e.isBot(t);})),t.includeDL||(i=i.filter(function(t){return!e.isDistributionList(t);})),t.includePstn||(i=i.filter(function(t){return!e.isPSTNUser(t);})),t.includeAADTenant||(i=i.filter(function(t){return!e.isInTenantUser(t);})),i;},e.isFederatedUser=function(e){return!!e.isFederated;},e.isGuestUser=function(e){return e.type===m.d.guest||e.userType===m.d.guest;},e.isInTenantUser=function(t){return!(t.type!==m.a.type.person&&"ADUser"!==t.type||e.isGuestUser(t)||t.isFederated);},e.isBot=function(e){return e.type===m.b.botType&&e.givenName===m.d.Bot;},e.isDistributionList=function(e){return e.type===m.d.DistributionList&&e.objectType===m.d.DistributionList;},e.isPSTNUser=function(e){return e.mri&&0===e.mri.indexOf("4:");},e.isSfcUser=function(e){return e.type===m.d.skypeConsumer;},e;}();n.d(t,"a",function(){return E;});var E=function(){function e(e){var t=this;this.send=e,this.MAX_PEOPLE_EMAIL_LIMIT=999,this.USERS_FETCH_URL_FORMAT="beta/users/fetch?isMailAddress={isMailAddress}&enableGuest=true&skypeTeamsInfo={skypeTeamsInfo}&canBeSmtpAddress={canBeSmtpAddress}",this.USERS_SEARCH_URL="beta/users/search",this.GET_USER_URL_FORMAT="beta/users/{upn}/?throwIfNotFound=false&isMailAddress={isMailAddress}&enableGuest=true",this.GET_GROUP_USER_URL_FORMAT="beta/teams/{officeGroupId}/officeGroup",this.PROCESSING_INTERVAL=50,this.MAX_BATCH_REQUESTS=500,this.MAX_PEOPLE_MRI_LIMIT=999,this.batchQueueMri=new l(function(e){return t.onBatchQueueMriReady(e);},this.PROCESSING_INTERVAL,this.MAX_BATCH_REQUESTS),this.batchQueueEmail=new l(function(e){return t.onBatchQueueEmailReady(e);},this.PROCESSING_INTERVAL,this.MAX_BATCH_REQUESTS);}return e.prototype.getPeopleProfilesByMri=function(e){if(!e)return Promise.reject("Invalid mri");var t=e;if(Object(p.b)(t)){var n=Object(p.a)(t);return Promise.resolve(this.generatePstnProfile(t,n));}return this.batchQueueMri.submit(e);},e.prototype.generatePstnProfile=function(e,t){return{mri:e,displayName:t,givenName:t,surname:"",userPrincipalName:e,accountEnabled:!1};},e.prototype.getPeopleProfilesByEmail=function(e){return e?this.batchQueueEmail.submit(e):Promise.reject("Invalid email");},e.prototype.getPeopleProfilesByMris=function(e,t,n){return void 0===t&&(t=!0),void 0===n&&(n=!1),Object(r.__awaiter)(this,void 0,Promise,function(){var i,a,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(e.length>this.MAX_PEOPLE_MRI_LIMIT)throw Object(o.a)("PeopleService",s.c.MaxLimitReached,"getPeopleProfilesByMris",void 0,"Max allowed mriList size = "+this.MAX_PEOPLE_MRI_LIMIT);return i=this.USERS_FETCH_URL_FORMAT.replace("{isMailAddress}","false").replace("{skypeTeamsInfo}",t?"true":"false").replace("{canBeSmtpAddress}",n?"true":"false"),[4,this.post(i,e)];case 1:return a=r.sent(),u=new Map(),a&&a.map(function(e){return u.set(e.mri,e);}),[2,u];}});});},e.prototype.getPeopleProfilesByEmails=function(e,t,n){return void 0===t&&(t=!0),void 0===n&&(n=!1),Object(r.__awaiter)(this,void 0,Promise,function(){var i,a,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(e.length>this.MAX_PEOPLE_EMAIL_LIMIT)throw Object(o.a)("PeopleService",s.c.MaxLimitReached,"getPeopleProfilesByEmails",void 0,"Max allowed emailList size = "+this.MAX_PEOPLE_EMAIL_LIMIT);return i=this.USERS_FETCH_URL_FORMAT.replace("{isMailAddress}","true").replace("{skypeTeamsInfo}",t?"true":"false").replace("{canBeSmtpAddress}",n?"true":"false"),[4,this.post(i,e)];case 1:return a=r.sent(),u=new Map(),a&&a.map(function(e){return u.set(e.mail,e);}),[2,u];}});});},e.prototype.searchUsers=function(e,t,n,o,s){return void 0===n&&(n=R.fromName(c.allTrue)),void 0===o&&(o=!0),void 0===s&&(s=!0),Object(r.__awaiter)(this,void 0,Promise,function(){var a,u,c,d;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return e.trim()?(a=Object(i.stringify)({includeDLs:n.includeDL,includeBots:n.includeBot,useGraphRelevance:o,skypeTeamsInfo:s}),u=this.USERS_SEARCH_URL+"?"+a,[4,this.post(u,e)]):[2,Promise.resolve([])];case 1:return c=r.sent(),d=new f.a(t),[2,O.filterSearchResults(n,c,d)];}});});},e.prototype.getUser=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!0),Object(r.__awaiter)(this,void 0,Promise,function(){var i;return Object(r.__generator)(this,function(r){return i=this.GET_USER_URL_FORMAT.replace("{upn}",e).replace("{isMailAddress}",t?"true":"false").replace("{skypeTeamsInfo}",n?"true":"false"),[2,this.get(i)];});});},e.prototype.getOfficeGroup=function(e){return Object(r.__awaiter)(this,void 0,Promise,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=this.GET_GROUP_USER_URL_FORMAT.replace("{officeGroupId}",e),[4,this.getRaw(t).then(function(e){return e.body.json();})];case 1:return n=r.sent(),[2,Promise.resolve(n)];}});});},e.prototype.onBatchQueueMriReady=function(e){return this.getPeopleProfilesByMris(e).then(function(t){return e.map(function(e){return t.get(e);});});},e.prototype.onBatchQueueEmailReady=function(e){return this.getPeopleProfilesByEmails(e).then(function(t){return e.map(function(e){return t.get(e);});});},e.prototype.postRaw=function(e,t){return this.send({url:e,method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json;charset=UTF-8"}});},e.prototype.post=function(e,t){return this.postRaw(e,t).then(function(e){return e.body.json();}).then(function(e){return e.value;});},e.prototype.getRaw=function(e){return this.send({url:e,method:"GET"});},e.prototype.get=function(e){return this.getRaw(e).then(function(e){return e.body.json();}).then(function(e){return e.value;});},e;}();},2722:function _(e,t,n){"use strict";var r=n(0),i=n(1049),o=n(1255),s=n(54),a=n(724),u=n(777),c=n(216),d=n(2706),h=n(289),l=n(767),p=n(11),f=n(1050),m=3e5,y=6,b=1e3,v=3,g=2,S=1e3,T=3e5,_="retry-after",C=500,A=600;function R(e){var t=e.get(a.a.ChatService),n=t.maxRetryTimeMs,r=t.maxRetryCount,i=t.minRetryIntervalMs,o=t.maxEndpointFallbackCount,s=t.exponentialDelayFactor;return{retryMaxTimeMs:P(n,m),maxRetryCount:P(r,y),expDelayFactor:P(s,g),expDelayMinIntervalMs:P(i,b),maxEndpointFallbackCount:P(o,v),maxNotAuthorizedCount:1,maxMinusOneCount:5};}var O=function O(e){var t=R(e),n=t.retryMaxTimeMs,r=t.maxRetryCount,i=t.maxEndpointFallbackCount,o=t.maxNotAuthorizedCount,a=t.maxMinusOneCount;return{shouldRetry:function shouldRetry(e){return M(e)||[s.g.THROTTLED,s.g.NOT_AUTHORIZED,-1].indexOf(e)>-1;},errorHandler:function errorHandler(e,t){var n=e.serverResponse,r=n.status,u=function(e){var t=Object(p.toNumber)(e[_]);return!Object(p.isNaN)(t)&&new d.d(Math.min(t*S,T));}(n.headers)||t.delay,h=(t.retriesTable[s.g.SERVICE_UNAVAILABLE]||0)+(t.retriesTable[s.g.BAD_GATEWAY]||0),l=t.retriesTable[s.g.NOT_AUTHORIZED]||0,f=t.retriesTable[-1]||0;if([s.g.SERVICE_UNAVAILABLE,s.g.BAD_GATEWAY].indexOf(r)>-1&&h<=i)return Object(c.a)(u.next());if(r===s.g.THROTTLED||M(r,[s.g.SERVICE_UNAVAILABLE,s.g.BAD_GATEWAY]))return Object(c.a)(u.next());if(r===s.g.NOT_AUTHORIZED&&l<=o)return Object(c.a)(u.next());if(-1===r&&f<a)return Object(c.a)(u.next());throw e;},retryMaxTimeMs:n,maxRetryCount:r,createDelay:function createDelay(){var t=R(e),n=t.expDelayFactor,r=t.expDelayMinIntervalMs,i=t.retryMaxTimeMs;return new d.c(r,n,i);}};};function E(e,t){return function(n){return function(e,t){return Object(l.a)(e,t.retryMaxTimeMs);}(function(e,t){return Object(h.a)(e,f.a)({policy:t,delay:t.createDelay(),retryCount:0,retriesTable:{}});}(function(){return e(n);},t),t);};}function M(e,t){return void 0===t&&(t=[]),e>=C&&e<A&&-1===t.indexOf(e);}function P(e,t){return Object(p.isNil)(e)?t:e;}var U=n(773),I=n(286),j=n(112);function D(e){var t=this;return Object(h.a)(e,function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return e instanceof TypeError&&!Object(j.a)().navigator.onLine?[4,Object(c.a)(I.b)]:[3,2];case 1:return t.sent(),[3,3];case 2:throw e;case 3:return[2];}});});});}var w=n(1280),H=n(2702),F=n(134);n.d(t,"a",function(){return L;});var x="v1/users/ME/conversations",k=["/v1/users/ME/conversations/ALL/properties","/v1/users/ME/conversations/ALL/messages","/v1/threads/ALL"],L=(s.g.BAD_REQUEST,s.g.FORBIDDEN,s.g.NOT_FOUND,function(){function e(e,t){this.coreSettings=t;this._maxPageSizeForConversations=200,this._maxPageSizeForConvMessages=200,this._send=Object(u.a)(e),this._sendRetryChatService=E(this._send,O(this.coreSettings));}return Object.defineProperty(e.prototype,"maxPageSizeForConversations",{get:function get(){return this._maxPageSizeForConversations;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"maxPageSizeForConvMessages",{get:function get(){return this._maxPageSizeForConvMessages;},enumerable:!0,configurable:!0}),e.prototype.createEndpoint=function(e,t){return Object(r.__awaiter)(this,void 0,Promise,function(){return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,Object(U.a)(this._sendRetryChatService,s.g.OK)({method:"PUT",url:"v2/users/ME/endpoints/"+t,headers:{"content-type":"application/json"},body:JSON.stringify({endpointFeatures:e,startingTimeSpan:0,subscriptions:[{channelType:"HttpLongPoll",interestedResources:k}]})})];case 1:return[2,n.sent().body.json()];}});});},e.prototype.deleteEndpoint=function(e){return Object(r.__awaiter)(this,void 0,Promise,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,this._deleteRaw("v2/users/ME/endpoints/"+e)];case 1:return t.sent(),[2];}});});},e.prototype.pollSubscription=function(e,t){return Object(r.__awaiter)(this,void 0,Promise,function(){var n,i,o,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return n=e.split("?"),e=n[0],i=n[1],t&&!Object(w.c)("activeTimeout",i)&&(o=this.coreSettings.get(a.a.ChatService).activeTimeoutCNSDefaultValue||135,u="activeTimeout="+o,i=i?i+"&"+u:u),[4,Object(U.a)(D(this._send),s.g.OK)({method:"GET",url:e,headers:i?{"x-ms-query-params":i}:{},timeout:9e4})];case 1:return[2,r.sent().body.json()];}});});},e.prototype.postActiveEndpoint=function(e){return Object(r.__awaiter)(this,void 0,Promise,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,Object(U.a)(this._sendRetryChatService,s.g.CREATED)({method:"POST",url:e,body:JSON.stringify({timeout:135})})];case 1:return t.sent(),[2,Promise.resolve("")];}});});},e.prototype.getMyConversations=function(e,t,n,r){void 0===e&&(e="All"),void 0===t&&(t=1),void 0===n&&(n=null),void 0===r&&(r=this.maxPageSizeForConversations);var i=x+"?view=msnp24Equivalent&pageSize="+Math.min(r,this.maxPageSizeForConversations);if(n)i+="&syncState="+encodeURIComponent(n);else{if(t<1)return Promise.reject(Object(F.a)("ChatService",s.c.InvalidInput,"getMyConversations",void 0,"Start time too low"));i+="&startTime="+t,null!=e&&(i+="&targetType="+encodeURIComponent(e));}return this._get(i,this._sendRetryChatService);},e.prototype.getMembersConsumptionHorizon=function(e){return this._get("v1/threads/"+encodeURIComponent(e)+"/consumptionhorizons",this._sendRetryChatService);},e.prototype.getMyConversation=function(e){return this._get(x+"/"+encodeURIComponent(e)+"?view=msnp24Equivalent",this._sendRetryChatService);},e.prototype.getThreadMembers=function(e,t){return void 0===t&&(t=5),this._get("v1/threads/"+encodeURIComponent(e)+"/members?view=msnp24Equivalent&pageSize="+t,this._sendRetryChatService);},e.prototype.getThread=function(e){return this._get("v1/threads/"+encodeURIComponent(e)+"?view=msnp24Equivalent",this._sendRetryChatService);},e.prototype.getThreads=function(e){if(Object(p.some)(e,function(e){return Object(p.isEmpty)(e);}))throw TypeError("Invalid thread ids");return this._get("v1/threads?view=msnp24Equivalent&threadIds="+encodeURIComponent(e.join(",")),this._sendRetryChatService);},e.prototype.createThread=function(e,t,n){return Object(r.__awaiter)(this,void 0,Promise,function(){var i,o,a,u,c;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t&&(n.topic=t),[4,this._postRaw("v1/threads",{members:e,properties:n})];case 1:if(i=r.sent(),o=i.status,a=i.headers.location,u=i.body,-1===[201,207].indexOf(o)||void 0===a)throw Object(F.a)("ChatService",s.c.RemoteOperationFailed,"createThread",void 0,void 0,i);return c=Object(H.a)(a),[2,{status:o,threadId:c,responseBody:u}];}});});},e.prototype.addMembersToThread=function(e,t,n){return Object(r.__awaiter)(this,void 0,Promise,function(){var i;return Object(r.__generator)(this,function(r){return Object(p.isEmpty)(t)?[2,Promise.reject(Object(F.a)("ChatService",s.c.InvalidInput,"addMembersToThread",void 0,"no members"))]:(i=t.map(function(e){var t=e.id,r=e.role,i={id:t,role:void 0===r?"Admin":r};return Object(p.isNil)(n)||(i.shareHistoryTime=n),i;}),[2,this._postRaw("v1/threads/"+encodeURIComponent(e)+"/members",{members:i})]);});});},e.prototype.removeMemberFromThread=function(e,t){return Object(r.__awaiter)(this,void 0,Promise,function(){return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,this._deleteRaw("v1/threads/"+encodeURIComponent(e)+"/members/"+t)];case 1:return n.sent(),[2];}});});},e.prototype.setConversationConsumptionHorizon=function(e,t,n){return void 0===n&&(n=!1),Object(r.__awaiter)(this,void 0,Promise,function(){var i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return i=n?"consumptionHorizonBookmark":"consumptionhorizon",[4,this._send({url:"v1/users/ME/conversations/"+encodeURIComponent(e)+"/properties?name="+i,method:"PUT",body:JSON.stringify(n?{consumptionHorizonBookmark:t}:{consumptionhorizon:t})})];case 1:return r.sent(),[2];}});});},e.prototype.getConversationMessages=function(e,t,n,r){if(void 0===t&&(t=1),void 0===n&&(n=null),void 0===r&&(r=this.maxPageSizeForConvMessages),t<1)return Promise.reject(Object(F.a)("ChatService",s.c.InvalidInput,"getConversationMessages",void 0,"Start time too low"));var i=x+"/"+encodeURIComponent(e)+"/messages?view=msnp24Equivalent";return Object(o.g)(e)&&(i+="|supportsMessageProperties"),i+="&pageSize="+Math.min(r,this.maxPageSizeForConvMessages),n&&(i+="&syncState="+encodeURIComponent(n)),i+="&startTime="+t,this._getRaw(i,this._sendRetryChatService).then(function(e){return e.body.json().then(function(t){var n=t;return n._metadata.contextid=e.headers.contextid,n;});});},e.prototype.getConversationMessage=function(e,t){return this._get(x+"/"+encodeURIComponent(e)+"/messages/"+encodeURIComponent(t)+"?view=msnp24Equivalent|supportsMessageProperties",this._sendRetryChatService);},e.prototype.postMessageToConversation=function(e,t){return this._postRaw(x+"/"+encodeURIComponent(e)+"/messages",t).then(function(e){return e.body.json().then(function(t){return{id:e.headers.location&&Object(p.last)(e.headers.location.split("/")),originalarrivaltime:t&&t.OriginalArrivalTime};});});},e.prototype.postInvoke=function(e){return Object(r.__awaiter)(this,void 0,Promise,function(){var t,n,i;return Object(r.__generator)(this,function(o){switch(o.label){case 0:return t=Object(r.__assign)({name:e.name,text:e.text,messageType:e.messageType,value:JSON.parse(e.value),imdisplayname:e.imdisplayName,serverMessageId:e.serverMessageId,clientMessageId:e.clientMessageId},e.threadId&&{conversation:{id:e.threadId}}),n="v1/agents/"+e.botMri+"/invoke",[4,this._postRaw(n,t,!0)];case 1:return[4,o.sent().body.text()];case 2:return[2,(i=o.sent())&&i.length>0?JSON.parse(i):""];}});});},e.prototype.updateMessageInConversation=function(e,t){return Object(r.__awaiter)(this,void 0,Promise,function(){return Object(r.__generator)(this,function(n){switch(n.label){case 0:if(!t.id)throw new RangeError("ID is required for updating a message");return[4,this._putRaw(x+"/"+encodeURIComponent(e)+"/messages/"+t.id,t)];case 1:return n.sent(),[2];}});});},e.prototype.addMessageEmotion=function(e,t,n){return Object(r.__awaiter)(this,void 0,Promise,function(){var i,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return i=new Date(),o={emotions:{key:n,value:i.getTime()}},[4,this._setMessageProperty(e,t,"emotions",o)];case 1:return r.sent(),[2,o.emotions.value];}});});},e.prototype.updateMessageLinks=function(e,t,n){return Object(r.__awaiter)(this,void 0,Promise,function(){return Object(r.__generator)(this,function(r){return[2,this._setMessageProperty(e,t,"links",n)];});});},e.prototype.removeMessageEmotion=function(e,t,n){return this._deleteMessageProperty(e,t,"emotions",{emotions:{key:n}});},e.prototype.setConversationTitle=function(e,t){return Object(r.__awaiter)(this,void 0,Promise,function(){return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,this._setThreadProperty(e,"topic",{topic:t})];case 1:return n.sent(),[2];}});});},e.prototype.deleteMessage=function(e,t){return Object(r.__awaiter)(this,void 0,Promise,function(){return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,this._deleteRaw(x+"/"+encodeURIComponent(e)+"/messages/"+t+"?behavior=softDelete")];case 1:return n.sent(),[2];}});});},e.prototype.undeleteMessage=function(e,t){return this._deleteMessageProperty(e,t,"deletetime",{deletetime:null});},e.prototype.markStarredMessageAsDeleted=function(e){return this._setMessageProperty(i.b.StarredConversationId,e,"starred",{starred:{key:"isDeleted",value:"true"}});},e.prototype.getMyProperties=function(){return this._get("v1/users/ME/properties");},e.prototype.setMyProperty=function(e,t){var n="v1/users/ME/properties?name="+encodeURIComponent(e),r={};return r[e]=t,this._putRaw(n,r).then(function(t){var n=t.status;return n!==s.g.OK?Promise.reject(Object(F.a)("ChatService",s.c.FailedToUpdate,"setMyProperty",void 0,"User preferences property "+e+" wasn't updated. Response status code: "+n)):Promise.resolve();});},e.prototype._messagePropertyUrl=function(e,t,n){return x+"/"+encodeURIComponent(e)+"/messages/"+t+"/properties?name="+n;},e.prototype._setMessageProperty=function(e,t,n,i){return Object(r.__awaiter)(this,void 0,Promise,function(){return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,this._putRaw(this._messagePropertyUrl(e,t,n),i)];case 1:return r.sent(),[2];}});});},e.prototype._threadPropertyUrl=function(e,t){return"v1/threads/"+encodeURIComponent(e)+"/properties?name="+t;},e.prototype._setThreadProperty=function(e,t,n){return Object(r.__awaiter)(this,void 0,Promise,function(){return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,this._putRaw(this._threadPropertyUrl(e,t),n)];case 1:return r.sent(),[2];}});});},e.prototype._deleteMessageProperty=function(e,t,n,i){return Object(r.__awaiter)(this,void 0,Promise,function(){return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,this._deleteRaw(this._messagePropertyUrl(e,t,n),i)];case 1:return r.sent(),[2];}});});},e.prototype._getRaw=function(e,t){return t({url:e,method:"GET"});},e.prototype._get=function(e,t){return void 0===t&&(t=this._send),this._getRaw(e,t).then(function(e){return e.body.json();}).catch(function(e){if(e.code!==s.c.RemoteOperationFailed||Object(F.c)(e,"status",0)!==s.g.NOT_FOUND)throw e;});},e.prototype._putRaw=function(e,t){return this._send({url:e,method:"PUT",headers:{"content-type":"application/json"},body:JSON.stringify(t)});},e.prototype._postRaw=function(e,t,n){return this._send({url:e,method:"POST",headers:{"content-type":"application/json"},body:n?JSON.stringify(t,function(e,t){return null===t?void 0:t;}):JSON.stringify(t)});},e.prototype._deleteRaw=function(e,t){return this._send({url:e,method:"DELETE",body:JSON.stringify(t)});},e;}());},2724:function _(e,t,n){"use strict";var r=n(0),i=n(724),o=n(54),s=n(78),a=n(773),u=n(230),c=n(289),d=n(216),h=n(2706),l=n(1050),p=n(11),f=500,m=600,y=1e4,b=32e4,v=6,g=12,S=3e5,T=0;function _(e,t){return function(n){return function(e,t){return Object(c.a)(e,l.a)({policy:t,delay:t.createDelay(),retryCount:0,retriesTable:{}});}(function(){return e(n);},t);};}var C=function C(e){var t=function(e){return{replyChainRetryMaxNotAuthorizedRetries:R(e.get(i.a.CsaService).replyChainRetryMaxNotAuthorizedRetries,T)};}(e).replyChainRetryMaxNotAuthorizedRetries;return{shouldRetry:function shouldRetry(e){return function(e){return e>=f&&e<m;}(e)||e===o.g.THROTTLED||e===o.g.NOT_AUTHORIZED||-1===e;},errorHandler:function errorHandler(e,n){var r=e.serverResponse.status;if(!n.retriesTable[r])throw new Error("ReplyChainCallRetryPolicy: retry count for "+r+" is empty");if(r===o.g.NOT_AUTHORIZED&&n.retriesTable[r]>t)throw e;return Object(d.a)(n.delay.next());},retryMaxTimeMs:7e3,maxRetryCount:3,createDelay:function createDelay(){return new h.b(7e3,1e3,function(e,t){return(Math.pow(2,t)-1)*e;});}};},A=function A(e){var t=function(e){var t=e.get(i.a.CsaService),n=t.startupDataMaxRetryTimeMs,r=t.startupRetryMaximumExponentialRetries,o=t.startupRetryMaximumRetries,s=t.startupRetryMinimumInterval,a=t.startupRetryIntervalAfterExponentialRetries;return{retryMaxTimeMs:R(n,b),maxExponentialRetryCount:R(r,v),maxTotalRetryCount:R(o,g),minimumInterval:R(s,y),intervalAfterExponentialRetry:R(a,S)};}(e),n=t.retryMaxTimeMs,r=t.maxExponentialRetryCount,s=t.maxTotalRetryCount,a=t.minimumInterval,u=t.intervalAfterExponentialRetry;return{shouldRetry:function shouldRetry(e){return-1===e||e===o.g.THROTTLED||e===o.g.SERVICE_UNAVAILABLE||e===o.g.SERVER_ERROR;},errorHandler:function errorHandler(e,t){return Object(d.a)(t.delay.next());},retryMaxTimeMs:n,maxRetryCount:s,createDelay:function createDelay(){return new h.b(n,a,function(e,t){return t&&t<=r?e*Math.pow(2,t-1):t&&t>r?u:e;});}};};function R(e,t){return Object(p.isNil)(e)?t:e;}var O=n(772),E=n(134),M=n(1047);n.d(t,"a",function(){return P;});var P=function(){function e(e,t,n,r){var s=this;this.authenticationService=e,this.platformService=t,this.coreSettings=n,this._isAnonymousUserCached=void 0,this.getChat=Object(O.a)(function(e){return s._getChat(e);}),this.getBadges=Object(O.a)(function(){return s._getBadges();}),this.getTeams=Object(O.a)(function(){return s._getTeams();}),this.getChatsByTitle=Object(O.a)(function(e){return s._getChatsByTitle(e);}),this.getReplyChain=Object(O.a)(function(e,t,n){return s._getReplyChain(e,t,n);});var c=this.coreSettings.get(i.a.CsaService).apiConstants||{},d=c.resource,h=void 0===d?M.f:d,l=c.host,p=void 0===l?M.e:l,f=c.version,m=void 0===f?M.a:f,y=c.endpoints,b=void 0===y?M.d:y;this.startupCleanEndpoint=b.startupclean,this.startupDeltaEndpoint=b.startupdelta,this.startupCleanAnonymousEndpoint=b.startupcleananonymous,this.startupDeltaAnonymousEndpoint=b.startupdeltaanonymous,this.csaSend=this._addRingOverrideHeader(Object(a.a)(Object(u.a)(e.authorize(r,""+h),""+p+m),o.g.OK)),this.csaSendV2=this._addRingOverrideHeader(Object(a.a)(Object(u.a)(e.authorize(r,""+h),""+p+M.b),o.g.OK));this.csaReplyChainCallSend=_(this.csaSend,C(n)),this.csaStartupCallSend=_(this.csaSend,A(n)),this.csaAnonymousStartupCallSend=function(e){return _(function(e){return s._addRingOverrideHeader(Object(a.a)(Object(u.a)(s._addBearerTokenHeader(r,e),""+p+m),o.g.OK));}(e),A(n));};}return e.prototype.getReplyChains=function(e,t,n,r,o){if(void 0===n&&(n=20),!e||!t)return Promise.reject("teamId or channelId cannot be empty");var s="teams/"+e+"/channels/"+t+"?pageSize="+n;o&&(s+="&skip="+o);var a=this.coreSettings.get(i.a.CsaService).httpTimeoutMillisGetReplyChains||M.g;return this.csaReplyChainCallSend({method:"GET",url:s,headers:r&&{"x-ms-continuation":r}||void 0,timeout:a}).then(function(e){return e.body.json();});},e.prototype.getChats=function(e,t){var n="teams/users/me/chats";return e&&(n+="?pageSize="+e),t&&(n+="&continuationToken="+encodeURIComponent(t)),this.csaSendV2({method:"GET",url:n}).then(function(e){return e.body.json();});},e.prototype.getMessages=function(e,t,n){return void 0===n&&(n=M.i),this.csaSend({method:"GET",url:"chats/"+encodeURIComponent(e)+"/messages?messagePageSize="+n,headers:t&&{"x-ms-messageToken":t}||void 0}).then(function(e){return e.body.json();});},e.prototype.getMessage=function(e,t){return this.csaSend({method:"GET",url:"chats/"+encodeURIComponent(e)+"/messages/"+t}).then(function(e){return e.body.json();});},e.prototype.getChatsWithUsers=function(e,t){var n="teams/users/me/chats/members";return t&&(n+="?partialMatch=true"),this.csaSend({method:"POST",url:n,headers:{"content-type":"application/json"},body:JSON.stringify(e)}).then(function(e){return e.body.json();});},e.prototype.getStartupData=function(e){return Object(r.__awaiter)(this,void 0,Promise,function(){var t,n,s,a,u,c;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,this.isAnonymousUser()];case 1:return t=r.sent(),[4,this.validateEndpoint(e,t)];case 2:if(r.sent(),n=this.buildStartupBasePath(e,t),s={method:"GET",url:n+="?isPrefetch=false&enableMembershipSummary=true",headers:e&&{"x-ms-synctoken":e}||void 0,timeout:this.coreSettings.get(i.a.CsaService).httpTimeoutMillisGetCsaStartup||M.h},a=this.csaStartupCallSend,!t)return[3,8];r.label=3;case 3:return r.trys.push([3,7,,8]),this.authenticationService.getSkypeToken?[4,this.authenticationService.getSkypeToken()]:[3,5];case 4:return u=r.sent(),a=this.csaAnonymousStartupCallSend(u.token),[3,6];case 5:return[2,Promise.reject(Object(E.a)(o.d.CSAService,o.c.RemoteOperationFailed,"getStartupData",void 0,"Could not get Skype token for anonymous user. getSkypeToken is not implemented"))];case 6:return[3,8];case 7:return c=r.sent(),[2,Promise.reject(Object(E.a)(o.d.CSAService,o.c.RemoteOperationFailed,"getStartupData",{innerError:c},"Could not get Skype token for anonymous user"))];case 8:return[2,a(s).then(function(e){return e.body.json();})];}});});},e.prototype.validateEndpoint=function(e,t){return e&&(!t&&!this.startupDeltaEndpoint||t&&!this.startupDeltaAnonymousEndpoint)?Promise.reject("endpoint cannot be empty for startupdelta call"):e||(t||this.startupCleanEndpoint)&&(!t||this.startupCleanAnonymousEndpoint)?Promise.resolve():Promise.reject("endpoint cannot be empty for startupclean call");},e.prototype.buildStartupBasePath=function(e,t){var n="";return n+=t?this.getAnonymousStartupBasePath(e):this.getDefaultStartupBasePath(e);},e.prototype.getAnonymousStartupBasePath=function(e){return e?this.startupDeltaAnonymousEndpoint:this.startupCleanAnonymousEndpoint;},e.prototype.getDefaultStartupBasePath=function(e){return e?this.startupDeltaEndpoint:this.startupCleanEndpoint;},e.prototype.isAnonymousUser=function(){return Object(r.__awaiter)(this,void 0,Promise,function(){var e,t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:if(void 0!==this._isAnonymousUserCached)return[3,6];n.label=1;case 1:return n.trys.push([1,5,,6]),this.authenticationService.isAnonymous?(e=this,[4,this.authenticationService.isAnonymous()]):[3,3];case 2:return e._isAnonymousUserCached=n.sent(),[3,4];case 3:return[2,Promise.reject(Object(E.a)(o.d.CSAService,o.c.RemoteOperationFailed,"getStartupData",void 0,"Could not check for anonymous user. isAnonymous is not implemented"))];case 4:return[3,6];case 5:return t=n.sent(),[2,Promise.reject(Object(E.a)(o.d.CSAService,o.c.RemoteOperationFailed,"getStartupData",{innerError:t},"Could not check for anonymous user"))];case 6:return[2,Promise.resolve(this._isAnonymousUserCached)];}});});},e.prototype._getReplyChain=function(e,t,n){return this.csaSend({method:"GET",url:"teams/"+encodeURIComponent(e)+"/channels/"+encodeURIComponent(t)+"/"+encodeURIComponent(n)}).then(function(e){return e.body.json();});},e.prototype._getChat=function(e){return this.csaSend({method:"GET",url:"teams/users/me/chats/"+encodeURIComponent(e)}).then(function(e){return e.body.json();});},e.prototype._getBadges=function(){return this.csaSend({method:"GET",url:"teams/users/me/badges?getUnreadNotificationCount=true&getUnreadChatCount=true"}).then(function(e){return e.body.json();});},e.prototype._getTeams=function(){return this.csaSend({method:"GET",url:"teams/users/me/teams?enableMembershipSummary=true"}).then(function(e){return e.body.json();});},e.prototype._getChatsByTitle=function(e){return this.csaSend({method:"GET",url:"teams/users/me/chats/chatsByTitle?title="+encodeURIComponent(e)}).then(function(e){return e.body.json();});},e.prototype._addBearerTokenHeader=function(e,t){return function(n){return e(Object(r.__assign)(Object(r.__assign)({},n),{headers:Object(r.__assign)(Object(r.__assign)({},n.headers),{Authorization:"Bearer "+t})}));};},e.prototype._addRingOverrideHeader=function(e){var t=this._getClientType(),n=this.coreSettings.get(i.a.Metadata).ring;return function(i){return e(Object(r.__assign)(Object(r.__assign)({},i),{headers:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},i.headers),n&&n.id&&{"x-ringoverride":n.id}),t&&{"x-ms-client-type":t})}));};},e.prototype._getClientType=function(){return this.platformService.config.hostingParent===s.d.Outlook?s.d.Outlook:this.platformService.config.clientType;},e;}();},921:function _(e,t,n){"use strict";n.d(t,"B",function(){return i;}),n.d(t,"F",function(){return o;}),n.d(t,"C",function(){return s;}),n.d(t,"G",function(){return a;}),n.d(t,"q",function(){return u;}),n.d(t,"a",function(){return c;}),n.d(t,"D",function(){return d;}),n.d(t,"f",function(){return h;}),n.d(t,"g",function(){return l;}),n.d(t,"i",function(){return p;}),n.d(t,"p",function(){return f;}),n.d(t,"s",function(){return m;}),n.d(t,"w",function(){return y;}),n.d(t,"t",function(){return b;}),n.d(t,"x",function(){return v;}),n.d(t,"o",function(){return g;}),n.d(t,"v",function(){return S;}),n.d(t,"m",function(){return r;}),n.d(t,"E",function(){return C;}),n.d(t,"b",function(){return A;}),n.d(t,"u",function(){return R;}),n.d(t,"h",function(){return T;}),n.d(t,"n",function(){return E;}),n.d(t,"z",function(){return O;}),n.d(t,"e",function(){return M;}),n.d(t,"d",function(){return P;}),n.d(t,"A",function(){return U;}),n.d(t,"j",function(){return j;}),n.d(t,"l",function(){return D;}),n.d(t,"y",function(){return N;}),n.d(t,"k",function(){return w;}),n.d(t,"c",function(){return F;}),n.d(t,"r",function(){return k;});var r,i="unq.gbl.spaces",o="messageid=",s=";"+o,a=Date.UTC(2e3,0,1),u=new Date("2016-07-01").getTime(),c="teamsvisitor:",d="clientId",h="@sfbonprem.unq.gbl.spaces",l="@fed.unq.gbl.spaces",p="preview-",f="newchat",m="@sfb.unq.gbl.spaces",y="sfb:",b="@sfc.unq.gbl.spaces",v="orgid:",g="8:",S=["live","sip_profile","myspace","c2c","sms"];!function(e){e.SkypeSpacesThread="19:",e.PrivateFeed="48:",e.SkypeSpacesUser="8:",e.Pstn="4:",e.BotPrefix="28:";}(r||(r={}));r.BotPrefix,r.BotPrefix,r.PrivateFeed,r.BotPrefix,r.SkypeSpacesUser,r.BotPrefix,r.SkypeSpacesThread;var T,_,C="0;0;0",A={VoiceAppPrefix:r.BotPrefix+"orgid:",BotPrefixOld:r.SkypeSpacesUser+r.BotPrefix},R=(r.SkypeSpacesThread,r.SkypeSpacesThread+"sfc:");r.SkypeSpacesUser;!function(e){e.NORMAL="normal",e.HIGH="high",e.URGENT="urgent";}(T||(T={})),function(e){e[e.NoAccess=209]="NoAccess",e[e.InvalidToken=230]="InvalidToken",e[e.ThreadNotFound=732]="ThreadNotFound";}(_||(_={}));var O,E=r.SkypeSpacesThread+"fed:";!function(e){e.ArchivalLevel="archivalLevel",e.ChannelDefaultSectionId="channelDefaultNotesSectionId",e.ChannelSettings="channelSettings",e.Classification="classification",e.CreatedAt="createdat",e.CreatingFromTemplate="creatingFromTemplate",e.Creator="creator",e.DocumentLibraryId="channelDocsDocumentLibraryId",e.DynamicMembership="dynamicMembership",e.FavDefault="favDefault",e.FolderRelativeUrl="channelDocsFolderRelativeUrl",e.GapDetectionEnabled="gapDetectionEnabled",e.GroupId="groupId",e.GuestUsers="guestUsersCategory",e.HasTranscript="hasTranscript",e.Integration="integration:",e.IsDeleted="isdeleted",e.IsFederated="isFederated",e.IsStickyThread="isStickyThread",e.IsTeamLocked="isTeamLocked",e.IsThreadDisabled="isDisabled",e.LastJoinAt="lastjoinat",e.LastLeaveAt="lastleaveat",e.LastSyncTime="lastSyncTime",e.Meeting="meeting",e.MemberLimitExceeded="isMaxMemberLimitExceeded",e.NotebookId="notebookId",e.NotesSectionInfo="notesSectionInfo",e.ParentSpaces="parentSpaces",e.Picture="picture",e.PictureETag="pictureETag",e.RosterVersion="rosterVersion",e.SensitivityLabelDisplayName="sensitivityLabelDisplayName",e.SensitivityLabelId="sensitivityLabelId",e.SensitivityLabelName="sensitivityLabelName",e.SensitivityLabelTooltip="sensitivityLabelToolTip",e.ShareHistoryTime="sharehistorytime",e.SiteUrl="sharepointSiteUrl",e.SpaceId="spaceId",e.SpaceThreadTopic="spaceThreadTopic",e.SpaceThreadVersion="spaceThreadVersion",e.SpaceType="spaceType",e.SpaceType_Class="class",e.SpaceType_Edu="edu",e.SpaceType_HealthcareCareCoordination="healthcareCareCoordination",e.SpaceType_Plc="plc",e.SpaceType_Staff="staff",e.SpaceType_Standard="standard",e.SpaceTypes="spaceTypes",e.TabType="tab::",e.TeamAdminSettings="spaceAdminSettings",e.TeamSmtpAddress="teamSmtpAddress",e.TeamStatus="teamStatus",e.TenantId="tenantid",e.ThreadType="threadType",e.TopicDescription="description",e.TopicThreadTopic="topicThreadTopic",e.TopicThreadVersion="topicThreadVersion",e.Version="version",e.Visibility="visibility",e.Topics="topics",e.Liveness="awareness_conversationLiveState",e.TopicName="topic",e.XTeamName="spaceThreadTopic",e.ExtensionDefinitionContainer="extensionDefinitionContainer",e.Hidden="hidden",e.P2PChatDefaultNotesInfo="groupDefaultNotesInfo",e.P2PChatFilesIndexId="chatFilesIndexId",e.P2PChatFilesIndexId_Value="2",e.P2PChatFixedRosters="fixedRoster",e.P2PChatUniqueRosterThread="uniquerosterthread",e.P2PMessagingDisabled="messagingdisabled";}(O||(O={}));var M,P,U,I,j,D;O.IsDeleted,O.LastJoinAt,O.LastLeaveAt,O.ShareHistoryTime,O.SpaceId,O.ThreadType;!function(e){e.Chat="Chat",e.Conversation="Conversation",e.Meeting="Meeting",e.OneOnOne="1on1",e.PhoneChat="PhoneChat",e.ReplyChain="ReplyChain",e.Team="Space",e.Thread="Thread",e.Topic="Topic";}(M||(M={})),function(e){e.Alerts="alerts",e.BlockedAtTime="conversationblockedat",e.Collapsed="collapsed",e.ConsumptionHorizon="consumptionhorizon",e.ConsumptionHorizonBookmark="consumptionHorizonBookmark",e.Favorite="favorite",e.Followed="isfollowed",e.Hidden="hidden",e.HiddenTime="unpinnedTime",e.InteropConversationStatus="interopconversationstatus",e.isPinned="ispinned",e.LastImportantImTime="lastimportantimreceivedtime",e.LastUrgentImTime="lasturgentimreceivedtime",e.Loud="loud",e.Muted="muted",e.Normal="normal",e.PinnedConsumptionHorizon="consumptionHorizonForPinnedMessages",e.RetentionHorizon="retentionHorizon",e.RetentionHorizonV2="retentionHorizonV2",e.SmartReplies="quickReplyAugmentation",e.Subscription="subscription",e.SuggestedActions="augmentation",e.Version="spaceConversationVersion";}(P||(P={})),function(e){e.Chat="chat",e.Meeting="meeting",e.OneOnOne="1on1",e.PhoneChat="phonechat",e.SfbInteropChat="sfbinteropchat",e.Team="space",e.Topic="topic";}(U||(U={})),function(e){e.None="none",e.Space="space",e.Topic="topic";}(I||(I={})),function(e){e.ExpirationTime="memberExpirationTime",e.Following="isFollowing",e.IsFavorite="isFavorite",e.IsModerator="isModerator",e.IsPinned="isPinned",e.Reader="isReader",e.Role="role";}(j||(j={})),function(e){e.AddCustomApp="ThreadActivity/AddCustomApp",e.AddMember="ThreadActivity/AddMember",e.Call="Event/Call",e.CallPushNotification="Signal/Flamingo",e.CallRecording="RichText/Media_CallRecording",e.CallTranscript="RichText/Media_CallTranscript",e.ClearTyping="Control/ClearTyping",e.Collaborate="Collaborate",e.ConsumptionHorizonUpdate="ThreadActivity/MemberConsumptionHorizonUpdate",e.Contacts="RichText/Contacts",e.Custom="Custom",e.DeleteCustomApp="ThreadActivity/DeleteCustomApp",e.DeleteMember="ThreadActivity/DeleteMember",e.Files="RichText/Files",e.FlikMessage="RichText/Media_FlikMsg",e.HistoryDisclosedUpdate="ThreadActivity/HistoryDisclosedUpdate",e.HTML="RichText/Html",e.IsReaderUpdated="ThreadActivity/MemberFeatureFlagUpdate",e.JoiningEnabledUpdate="ThreadActivity/JoiningEnabledUpdate",e.LegacyMemberAdded="ThreadActivity/LegacyMemberAdded",e.LegacyMemberUpgraded="ThreadActivity/LegacyMemberUpgraded",e.Location="RichText/Location",e.MediaCard="RichText/Media_Card",e.Meeting="Meeting",e.MemberConsumptionHorizonUpdate="ThreadActivity/MemberConsumptionHorizonUpdate",e.MemberJoined="ThreadActivity/MemberJoined",e.MemberLeft="ThreadActivity/MemberLeft",e.Moji="RichText/Media_FlikMsg",e.PictureUpdate="ThreadActivity/PictureUpdate",e.RetentionDeleted="ThreadActivity/RetentionDeleted",e.RichText="RichText",e.RoleUpdate="ThreadActivity/RoleUpdate",e.ScreenShare="ScreenShare",e.Sms="RichText/Sms",e.SpaceDescriptionUpdated="ThreadActivity/SpaceDescriptionUpdated",e.SpaceThreadChannelAdded="ThreadActivity/SpaceThreadChannelAdded",e.SpaceTopicUpdated="ThreadActivity/SpaceTopicUpdated",e.Text="Text",e.ThreadActivityMessageTypePrefix="ThreadActivity/",e.ThreadArchivalUpdate="ThreadActivity/ThreadArchivalUpdate",e.TopicDeleted="ThreadActivity/TopicDeleted",e.TopicDescriptionUpdated="ThreadActivity/TopicDescriptionUpdated",e.TopicTopicUpdated="ThreadActivity/TopicTopicUpdated",e.TopicUpdated="ThreadActivity/TopicUpdate",e.Typing="Control/Typing",e.UpdateFavDefault="ThreadActivity/UpdateFavDefault",e.UpgradeCustomApp="ThreadActivity/UpgradeCustomApp",e.URIObject="RichText/UriObject",e.Video="Event/SkypeVideoMessage";}(D||(D={}));var w,H,F,x,k,L,B,N=[D.AddMember,D.DeleteMember,D.RoleUpdate,D.TopicTopicUpdated,D.TopicUpdated,D.TopicDeleted,D.SpaceTopicUpdated,D.SpaceThreadChannelAdded,D.SpaceDescriptionUpdated,D.TopicDescriptionUpdated,D.PictureUpdate,D.HistoryDisclosedUpdate,D.JoiningEnabledUpdate,D.LegacyMemberAdded,D.LegacyMemberUpgraded,D.AddCustomApp,D.DeleteCustomApp,D.UpgradeCustomApp,D.UpdateFavDefault,D.MemberJoined,D.MemberLeft,D.ThreadArchivalUpdate,D.RetentionDeleted];!function(e){e.Activity="activity",e.CallLog="call-log",e.Cards="cards",e.CrossPostId="crossPostId",e.DeleteTime="deletetime",e.DeliveryState="deliveryState",e.EditTime="edittime",e.EmailDetails="emaildetails",e.Emotions="emotions",e.GenericStreamMetadata="genericStreamMetadata",e.Importance="importance",e.InteropType="interopType",e.IsRead="isread",e.Meeting="meeting",e.MeetingScheduledInfo="scheduledmeetinginfo",e.MeetingTitle="meetingtitle",e.MeetingType="@type",e.OnBehalfOf="onbehalfof",e.Pinned="pinned",e.PolicyViolation="policyViolation",e.ReplyPermissions="replyPermission",e.Starred="starred",e.Subject="subject",e.SystemDelete="systemdelete",e.Title="title";}(w||(w={})),function(e){e.ConversationUpdate="ConversationUpdate",e.CustomUserProperties="CustomUserProperties",e.MessageUpdate="MessageUpdate",e.NewMessage="NewMessage",e.ThreadPropertyUpdate="ThreadPropertyUpdate",e.ThreadUpdate="ThreadUpdate";}(H||(H={})),function(e){e.MemberConsumptionHorizonUpdate="ThreadActivity/MemberConsumptionHorizonUpdate";}(F||(F={})),function(e){e[e.None=0]="None",e[e.Network=1]="Network",e[e.Local=2]="Local";}(x||(x={})),function(e){e.Admin="Admin",e.User="User",e.Guest="Guest",e.None="None";}(k||(k={})),function(e){e.MeetingsUserParticipatesIn="participated",e.MeetingsUserIsInvitedTo="all",e.MeetingsManuallyUnmuted="none";}(L||(L={})),function(e){e.Unknown="0",e.Available="1",e.NotAvailable="2";}(B||(B={}));}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/2-cd57c7a2ebc3e964752a.js.map