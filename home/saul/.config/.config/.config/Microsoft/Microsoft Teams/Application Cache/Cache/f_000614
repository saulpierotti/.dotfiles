webpackJsonp([19],{1899:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n(1900)},1900:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e}).apply(this,arguments)},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(t,"__esModule",{value:!0});var s=n(1901),c=n(55),u=n(1902),l=n(1903),f=n(1904),p=n(1908),d=function(e){function t(t,n,r,i,a,o,s,c,u,l,f,p,d,h,g,v,m,y,S){var b=e.call(this,s)||this;return b.constants=t,b.utilityService=n,b.settingsService=r,b.authenticationService=i,b.localizationService=a,b.eventingService=o,b.presenceManagerService=c,b.htmlSanitizer=u,b.dateFormatService=l,b.presenceService=f,b.$translate=p,b.resources=d,b.timeagoCalcService=h,b.platformDetectService=g,b.loggingService=v,b.logger=m,b.actionCallbacks=y,b.dataCallbacks=S,b.changeTheme=function(e){var t=window.LPC;t&&t.loadTheme(b.getTheme(e))},b.initializeOnAppLaunchAndReinit("First Initialize"),b}return r(t,e),Object.defineProperty(t.prototype,"isLivePersonaCardInitialized",{get:function(){return!(null==this.lpcPromise||null==window.LPC)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isLivePersonaCardEnabled",{get:function(){return!!this.settingsService.valueAsBoolean(this.constants.settings.names.enableLivePersonaCard)},enumerable:!0,configurable:!0}),t.prototype.mtmaTelemetryIdentifier=function(){return"LivePersonaCardService"},t.prototype.cleanupOnAppTeardown=function(e){this.logger.log("LivePersonaCardService onAppTeardown: reason = {0}",e),this.richPresenceFunction=void 0,this.presenceUpdateListener=void 0,this.lpcPromise=null,window.LPC=null},t.prototype.initializeOnAppLaunchAndReinit=function(e){var t=this;this.logger.log("LivePersonaCardService Initialize reason {0}",e),this.eventingService.unsafeOnWithTenantScope(this.constants.events.layout.themeChanged,function(e,n){t.isLivePersonaCardInitialized&&t.changeTheme(n)}),this.richPresenceFunction=l.GetRichPresenceFunction(this.presenceManagerService,this.utilityService,this.htmlSanitizer,this.dateFormatService,this.settingsService,this.constants,this.presenceService,this.$translate,this.resources,this.timeagoCalcService,this.platformDetectService,this.localizationService)},t.prototype.initializeLPC=function(){return a(this,void 0,void 0,function(){var e,t,n,r,a,c,u,l,f,p;return o(this,function(o){if(this.isLivePersonaCardInitialized)return[2,this.lpcPromise];e=this.loggingService.newScenario("LivePersonaCard_Initialize"),t=this.utilityService.generateUUID(),n=this.localizationService.getLocale(),r=this.settingsService.getVersion().clientVersion,a=this.settingsService.isInternalRing(),c=a?"df":"",u=this.getTeamsConfig(t,n,c),l=this.settingsService.getRing(),this.logger.info("Client Correlation ID for LivePersonaCard in Teams Main Window: clientCorrelationId="+t);try{return f=function(e){this.presenceUpdateListener=e}.bind(this),this.lpcPromise=s.initializeLivePersonaCardAsync(i({},u,{actionCallbacks:this.actionCallbacks,dataCallbacks:this.dataCallbacks,dataUpdateBroadcaster:{setPresenceUpdateListener:f},getAuthToken:this.getAuthToken(t),logMessage:function(e,t,n){this.logger.debug("LogType="+e+", LogResultType="+t+", Message="+n)},theme:this.getTheme(this.settingsService.getActiveTheme()),hostAppRing:l&&l.id?l.id:void 0,hostAppVersion:r})),this.lpcPromise.then(function(){var t=window.LPC&&window.LPC.version||"";e.stop({message:"LivePersonaCard loaded",version:t})}).catch(function(t){throw e.fail({message:"Could not load LivePersonaCard"}),t}),[2,this.lpcPromise]}catch(t){throw p="Could not load live persona card: "+t,e.fail({message:p}),new Error(p)}return[2]})})},t.prototype.createLPC=function(e,t){var n=this,r=t.profile,a=t.behavior,o=t.ariaLabel,s=t.externalAppSessionCorrelationId,c=t.disableAccessibilityDefaults;if(this.isLivePersonaCardInitialized){var u=this.utilityService.generateUUID(),l="Guest"===r.role,f="Federated"===r.type,p=l||f?"External":"User",d={personaInfo:{identifiers:{PersonaType:p,AadObjectId:r.objectId,HostAppPersonaId:r.mri,Upn:r.userPrincipalName,Smtp:r.email,DisplayName:r.displayName},displayName:r.displayName,firstName:r.givenName,lastName:r.surname},behavior:i({disableHover:!1,locationToOpen:"Card",cardPlacementMode:"AnchorSide"},a),ariaLabel:o,disableAccessibilityDefaults:!!c,externalAppSessionCorrelationId:s,clientScenario:"MicrosoftTeams_MainWindow"};this.attachHoverTargetAsync(e,d),this.presenceManagerService.trackPresenceV2(r.mri,void 0,u,function(e){var t=n.richPresenceFunction(e);n.presenceUpdateListener&&n.presenceUpdateListener({personaId:{PersonaType:p,AadObjectId:r.objectId,Smtp:r.email,Upn:r.userPrincipalName,HostAppPersonaId:e},presence:t})});var h=function(){this.presenceManagerService.untrackPresenceV2(r.mri,void 0,u)}.bind(this);return{destroy:function(){window.setTimeout(function(){window.LPC.removedPersonaFromPage(e)},250),h()}}}this.logger.error("Not initialized")},t.prototype.attachHoverTargetAsync=function(e,t){window.setTimeout(function(){window.LPC.addedPersonaToPageV2(e,t)},250)},t.prototype.getTheme=function(e){switch(e){case c.LpcTheme.Default:return f.defaultTheme;case c.LpcTheme.Dark:return f.darkTheme;case c.LpcTheme.HighContrast:return f.highContrastTheme;default:return f.defaultTheme}},t.prototype.getTeamsConfig=function(e,t,n){return{culture:t||window.navigator.language||"en-us",region:n,clientCorrelationId:e,clientType:"MicrosoftTeamsAngular",clientContextType:"Generic",complianceEnvironment:"Prod",options:{isImmersiveProfileEnabled:!1,isLinkedInIntegrationEnabled:!1}}},t.prototype.getAuthToken=function(e){var t=this;return function(n,r){return a(t,void 0,void 0,function(){var t,i;return o(this,function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,this.authenticationService.getAuthTokens(["https://loki.delve.office.com/"])];case 1:return(t=a.sent())?n(t,e):r("Error retrieving auth token",e),[3,3];case 2:return i=a.sent(),this.logger.error("Error acquiring access token for LOKI"),r("Error retrieving auth token",e),[3,3];case 3:return[2]}})})}},t}(teamspace.services.MTMABase);t.LivePersonaCardService=d,angular.module("teamspace.lpcService",["teamspace.loggingService","teamspace.authenticationService","teamspace.utilityService","teamspace.peopleService","teamspace.navigationService","teamspace.conversationsService","teamspace.localizationService","teamspace.eventingService","teamspace.messageService","teamspace.settingsService","teamspace.callingUserActionService","teamspace.presenceManagerService","teamspace.htmlSanitizer","teamspace.dateFormatService","teamspace.platformDetectService"]).factory("lpcService",["constants","callingPolicyStore","utilityService","settingsService","loggingService","authenticationService","$rootScope","navigationService","conversationsService","localizationService","eventingService","messageService","peopleService","callingUserActionService","presenceManagerService","htmlSanitizer","dateFormatService","presenceService","$translate","resources","timeagoCalcService","platformDetectService","profilePictureLoaderService","orchestrationService","analyticsService",function(e,t,n,r,i,a,o,s,c,f,h,g,v,m,y,S,b,C,w,P,k,T,L,A,O){var x=i.newLogger("LivePersonaCardService"),I=new p.LpcTelemetryHelper(O,i),U=I.logPanelActionEvent.bind(I),_=u.LPCActionCallbackFactory(o,e,x,v,c,s,m,g,U),E=l.LPCDataCallbackFactory(x,y,n,S,b,r,e,C,w,P,k,T,f,L,t);return new d(e,n,r,a,f,h,A,y,S,b,C,w,P,k,T,i,x,_,E)}])},1901:function(e,t,n){!function(t,n){e.exports=n()}(window,function(){return function(e){function t(t){for(var n,r,a=t[0],o=t[1],s=0,u=[];s<a.length;s++)r=a[s],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&u.push(i[r][0]),i[r]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n]);for(c&&c(t);u.length;)u.shift()()}function n(t){if(r[t])return r[t].exports;var i=r[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,n),i.l=!0,i.exports}var r={},i={1:0};n.e=function(e){var t=[],r=i[e];if(0!==r)if(r)t.push(r[2]);else{var a=new Promise(function(t,n){r=i[e]=[t,n]});t.push(r[2]=a);var o,s=document.createElement("script");s.charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.src=function(e){return n.p+""+({0:"feed-bootstrapper",2:"topic-card-bootstrapper",3:"vendors~aria-webjs-sdk"}[e]||e)+"_"+{0:"cd25d4e3eb9bc54cacbc",2:"ac177d04cc6f1e04b622",3:"98116dba6251f48431a2"}[e]+".js"}(e),0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous");var c=new Error;o=function(t){s.onerror=s.onload=null,clearTimeout(u);var n=i[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src;c.message="Loading chunk "+e+" failed.\n("+r+": "+a+")",c.name="ChunkLoadError",c.type=r,c.request=a,n[1](c)}i[e]=void 0}};var u=setTimeout(function(){o({type:"timeout",target:s})},12e4);s.onerror=s.onload=o,document.head.appendChild(s)}return Promise.all(t)},n.m=e,n.c=r,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="https://lpcres.delve.office.com/lpc/versionless/",n.oe=function(e){throw console.error(e),e};var a=window.webpackJsonpMidgardBootstrapper=window.webpackJsonpMidgardBootstrapper||[],o=a.push.bind(a);a.push=t,a=a.slice();for(var s=0;s<a.length;s++)t(a[s]);var c=o;return n(n.s=11)}([function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=function(e,t,n,r,i){this.name=e,this.message=t,this.rootCorrelationId=n,this.statusCode=r,this.numberOfRetries=i}},function(e,t,n){"use strict";var r;n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i}),function(e){e.getAuthToken="GetAuthTokenDuration",e.getAuthTokenFromStart="GetAuthTokenFromStartDuration",e.getLokiConfig="GetLokiConfigDuration",e.getLokiConfigFromStart="GetLokiConfigFromStartDuration",e.getLpcBundles="GetLpcBundlesDuration",e.getLpcBundlesFromStart="GetLpcBundlesFromStartDuration",e.startLpc="StartLpcDuration",e.startLpcFromStart="StartLpcFromStartDuration",e.getOfficeFeedBundles="GetOfficeFeedBundlesFromStartDuration"}(r||(r={}));var i=function(){function e(e){this.targetWindow=e,this.start=this.getCurrentTime(),this.timings={}}return e.prototype.measureFromStart=function(e){this.timings[e]=Math.round(this.getCurrentTime()-this.start)},e.prototype.startCustomTiming=function(e){try{this.targetWindow.performance.mark(e+"-start")}catch(e){}},e.prototype.endCustomTiming=function(e){try{this.targetWindow.performance.mark(e+"-end"),this.targetWindow.performance.measure(e,e+"-start",e+"-end");var t=this.targetWindow.performance.getEntriesByName(e)[0];this.timings[e]=Math.round(t.duration)}catch(e){}},e.prototype.getAllTimings=function(){var e=this;try{var t=this.targetWindow.performance.getEntriesByType("resource");t&&t.forEach(function(t){if(t&&t.name){var n=t.name.toLowerCase(),r=!1;-1!==n.indexOf("authtoken/loki")?(n="AuthRequestDuration",r=!0):-1!==n.indexOf("service.svc?action=getclientaccesstoken&ep=1&app=mail")?(n="AuthRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacard_")?(n="LpcBundleRequestDuration",r=!0):-1!==n.indexOf("/lpc/versionless/livepersonacardstrings")?(n="LpcStringsRequestDuration",r=!0):-1!==n.indexOf("/api/v1/configuration/")&&(n="InitConfigRequestDuration",r=!0),r&&(e.timings[n]=Math.round(t.duration))}})}catch(e){}return this.timings},e.prototype.getCurrentTime=function(){return this.targetWindow.performance&&"function"==typeof this.targetWindow.performance.now?performance.now():Date.now()},e}()},function(e,t,n){"use strict";function r(e){return u.filter(function(t){return t.targetWindow===e})[0]}function i(e){var t=e.targetWindow||window,n=r(t);return n||(n={targetWindow:t,bootstrapperConfig:e,ariaLogger:new c(e),initializationPromise:void 0,forceRefreshInitializationPromise:!1}),function(e){var t=r(e.targetWindow);if(t){var n=u.indexOf(t);u[n]=e}else u.push(e)}(n),n}function a(e){var t=r(e);if(t){var n=t.bootstrapperConfig.targetWindow;n&&(delete n.LPC,delete n.LivePersonaCardHoverTarget,delete n.LivePersonaCardHoverTargetV2,delete n.LivePersonaCardStrings,delete n.LivePersonaCardStringsLpcMini,delete n.OfficeFeed,delete n.OfficeFeedFull,delete n.OfficeFeedStrings,delete n.MeetingInsightsV2,delete n.MidgardBootstrapper,delete n.PersonaInsightRing),delete t.bootstrapperConfig.targetWindow,delete t.ariaLogger,delete t.initializationPromise,delete t.bootstrapperConfig}!function(e){var t=r(e);if(t){var n=u.indexOf(t);u.splice(n,1)}}(e)}var o=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},s=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},c=function(){function e(e){this.bootstrapperConfig=e,this.loggers=new Map}return e.prototype.logEventAsync=function(e,t){return o(this,void 0,void 0,function(){return s(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,this.getLoggerAsync(t)];case 1:return n.sent().logEvent(e),[4,this.getLogManagerAsync()];case 2:return n.sent().flush(this.noOp),[3,4];case 3:return n.sent(),console.log("Live Persona Card ERROR: Failed to log an event to Aria"),[3,4];case 4:return[2]}})})},e.prototype.updateContextWithLokiDataAsync=function(e,t){return o(this,void 0,void 0,function(){var n;return s(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,this.getLoggerAsync(t)];case 1:return(n=r.sent()).setContext("LokiUrl",e.LokiUrl),n.setContext("tenantAadObjectId",e.TenantAadObjectId),n.setContext("userAadObjectId",e.UserAadObjectId),n.setContext("userPuid",e.UserPuid),[3,3];case 2:throw r.sent(),new Error("Live Persona Card ERROR: Failed to update Aria's context");case 3:return[2]}})})},e.prototype.getLoggerAsync=function(e){return o(this,void 0,void 0,function(){var t,n,r;return s(this,function(i){switch(i.label){case 0:return(t=this.loggers.get(e))?[3,3]:[4,this.getLogManagerAsync()];case 1:return n=i.sent(),[4,this.getCollectorUrlAsync()];case 2:r=i.sent(),(t=n.initialize(e,{collectorUri:r}))||(t=n.getLogger(e)),this.loggers.set(e,t),t.setContext("culture",this.bootstrapperConfig.culture),t.setContext("region",this.bootstrapperConfig.region),t.setContext("clientType",this.bootstrapperConfig.clientType),t.setContext("clientContextType",this.bootstrapperConfig.clientContextType),t.setContext("clientCorrelationId",this.bootstrapperConfig.clientCorrelationId),t.setContext("bootstrapperVersion","1.20200312.20.0"),t.setContext("complianceEnvironment",this.bootstrapperConfig.complianceEnvironment),i.label=3;case 3:return[2,t]}})})},e.prototype.getLogManagerAsync=function(){return o(this,void 0,void 0,function(){return s(this,function(e){switch(e.label){case 0:return[4,n.e(3).then(n.t.bind(null,43,7))];case 1:return[2,e.sent().AWTLogManager]}})})},e.prototype.getCollectorUrlAsync=function(){return o(this,void 0,void 0,function(){var e;return s(this,function(t){switch(t.label){case 0:return[4,n.e(3).then(n.t.bind(null,43,7))];case 1:switch(e=t.sent(),this.bootstrapperConfig.complianceEnvironment){case"Blackforest":return[2,e.AWT_COLLECTOR_URL_GERMANY];case"GccHigh":return[2,e.AWT_COLLECTOR_URL_USGOV_DOJ];case"DoD":return[2,e.AWT_COLLECTOR_URL_USGOV_DOD];case"Gallatin":throw new Error("Gallatin not supported by Aria");case"GccModerate":case"Prod":default:return[2,void 0]}return[2]}})})},e.prototype.noOp=function(){},e}();n.d(t,"b",function(){return i}),n.d(t,"a",function(){return a});var u=[]},function(e,t,n){"use strict";function r(e,t,n){try{n.sessionStorage&&n.sessionStorage.setItem&&n.sessionStorage.setItem(e,t)}catch(e){}}function i(e,t,n){return new Promise(function(i,s){e?(r(o,e,n),i(e)):t(function(e,t){e?(r(o,e,n),i(e)):s(new a.a("GetAuthTokenError","Auth token is undefined",t))},function(e,t){var n=function(e){return/^AADSTS\d+?:/.test(e)}(e)?e:"";s(new a.a("GetAuthTokenError",n,t))})})}var a=n(0);n.d(t,"a",function(){return i});var o="LokiAuthToken"},function(e,t,n){"use strict";function r(e){var t={};return Object.keys(e).forEach(function(n){t["Perf_"+n]=e[n].toString()}),t}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=3e5},function(e,t,n){"use strict";function r(e,t){var n=this,r=0,a=function(e,t){return o(n,void 0,void 0,function(){var n;return s(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,6]),[4,i(e,t)];case 1:return o.sent(),[3,6];case 2:return n=o.sent(),r<c?(r++,[4,a(e,t)]):[3,4];case 3:return o.sent(),[3,5];case 4:throw n.numberOfRetries=r,n;case 5:return[3,6];case 6:return[2]}})})};return a(e,t)}function i(e,t){return new Promise(function(n,r){var i=t.document.createElement("script");i.type="text/javascript",i.charset="utf-8",i.crossOrigin="anonymous",i.src=e,i.addEventListener("load",function(){n()}),i.addEventListener("error",function(){r(new a.a("LoadScriptError","Unexpected error while loading script on page."))}),t.document.body.appendChild(i)})}n.d(t,"a",function(){return r});var a=n(0),o=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},s=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},c=2},function(e,t,n){"use strict";function r(e){switch(e.complianceEnvironment){case"Blackforest":return a;case"GccHigh":return o;case"DoD":return s;case"Gallatin":return c;case"GccModerate":case"Prod":default:return i}}n.d(t,"a",function(){return r});var i="e5ad760145754ffc9704e67c800087f2-dc72ff20-3e8a-401a-b9a8-ec72e4dd3e22-7257",a="e5ad760145754ffc9704e67c800087f2-fe4f92a6-9453-4f06-a3f9-52484ba9c6a1-7193",o="e5ad760145754ffc9704e67c800087f2-5eda57b1-3b30-42c8-a461-bf3c6ee769d8-7057",s="e5ad760145754ffc9704e67c800087f2-e57f210b-942a-4f32-aaa3-2fd7b8d44a62-7359",c=""},function(e,t,n){"use strict";function r(e){return{ErrorType:e.name,ErrorMessage:e.message||"",RootCorrelationId:e.rootCorrelationId||"",IsClientOnline:navigator&&void 0!==typeof navigator.onLine?navigator.onLine:""}}n.d(t,"a",function(){return r})},function(e,t,n){"use strict";function r(e){return"ppe"===e.region||"df"===e.region||"msit"===e.region?h.replace("{0}",e.region):function(e){switch(e){case"Blackforest":return u;case"GccModerate":return l;case"GccHigh":return f;case"DoD":return p;case"Gallatin":return d;case"Prod":return c;case"Unknown":throw new Error("'Unknown' is not an expected environment type in Loki");default:return e}}(e.complianceEnvironment)}function i(e,t){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(t.location.search),r=t.decodeURIComponent||window.decodeURIComponent;return null===n?"":r&&r(n[1].replace(/\+/g," "))||""}function a(e,t,n){return s(function(e,t){var n=t||e.culture,i=r(e);return g.replace("{0}",i).replace("{1}",n)}(t,i(w,n)),e,S(S({},t),{clientFeature:"LivePersonaCard"}),n)}function o(e,t,n){return s(function(e,t){var n=t||e.culture,i=r(e);return v.replace("{0}",i).replace("{1}",n)}(t,i(w,n)),e,S(S({},t),{clientFeature:"OfficeFeed"}),n)}function s(e,t,n,r){return new Promise(function(a,o){var s=new XMLHttpRequest;s.open("GET",e,!0),s.setRequestHeader("authToken",t),s.setRequestHeader("Accept","application/json");var c=y.replace(/[xy]/g,function(e){var t;if(window.crypto){var n=new Uint8Array(1);window.crypto.getRandomValues(n),t=n[0]}else t=Math.floor(16*Math.random());return("x"===e?t%16:t%4+8).toString(16)});s.setRequestHeader("X-RootCorrelationId",c),s.setRequestHeader("X-CorrelationId",c),s.setRequestHeader("X-ClientCorrelationId",n.clientCorrelationId),s.setRequestHeader("X-ClientType",n.clientType),s.setRequestHeader("X-ClientFeature",n.clientFeature),n.hostAppRing&&s.setRequestHeader("X-HostAppRing",n.hostAppRing),n.hostAppVersion&&s.setRequestHeader("X-HostAppVersion",n.hostAppVersion),r&&r.React&&r.React.version&&r.ReactDOM&&s.setRequestHeader("X-HostAppReactVersion",r.React.version);var u=i(P,r)||i(C,r);u&&(s.setRequestHeader(C,u),s.setRequestHeader(P,u));var l=i(k,r);l&&s.setRequestHeader(k,l),s.addEventListener("load",function(){if(200===s.status)try{var e=JSON.parse(s.response);e.RootCorrelationId=c,e.LokiVersion=s.getResponseHeader("x-serverversion")||"",a(e)}catch(e){o(new m.a("GetLokiConfigError","Failed to parse initialization config.",c))}else o(new m.a("GetLokiConfigError","Couldn't retrieve initialization config. Status code is "+s.status,c,s.status))}),s.addEventListener("error",function(){o(new m.a("GetLokiConfigError","Couldn't retrieve initialization config, request failed to complete.",c))}),s.addEventListener("timeout",function(){o(new m.a("GetLokiConfigError","Loki config request timed out after "+b+" ms.",c))}),s.timeout=b,s.send()})}var c="https://loki.delve.office.com",u="https://loki.delve.office.de",l="https://gcc.loki.delve.office.com",f="https://gcchigh.loki.office365.us",p="https://dod.loki.office365.us",d="https://loki.office365.cn",h="https://{0}.loki.delve.office.com",g="{0}/api/v1/livepersonacard/configuration?cultureName={1}",v="{0}/api/v1/officefeed/configuration?cultureName={1}&returnResources=true",m=n(0),y="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return o});var S=function(){return(S=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},b=6e4,C="LivePersonaCardVersionOverride",w="LivePersonaCardCultureOverride",P="MidgardVersion",k="MidgardBranch"},function(e,t,n){"use strict";function r(e){return void 0===e||"string"!=typeof e||""===e||null===e}function i(e){return void 0===e||"function"!=typeof e}function a(e){var t="";if(e){var n=[];r(e.culture)&&n.push("culture"),r(e.clientType)&&n.push("clientType"),r(e.clientContextType)&&n.push("clientContextType"),r(e.clientCorrelationId)&&n.push("clientCorrelationId"),i(e.logMessage)&&n.push("logMessage"),i(e.getAuthToken)&&n.push("getAuthToken"),n.length>0&&(t="Invalid required parameter(s): "+n.join(", ")+". Check the values and types you're passing. "),e.region&&-1===s.indexOf(e.region.toLowerCase().trim())&&(t+="Invalid region value. Allowed values are: empty string for production environments, and "+s.join(", ")+" for pre-production environments. "),-1===c.indexOf(e.complianceEnvironment)&&(t+="Environment is missing or wrong. Allowed values are: "+c.join(", ")+". We currently don't support other Sovereign Clouds.")}else t="Config must be defined.";if(t)throw new o.a("ValidateBootstrapperConfigError",t)}var o=n(0);n.d(t,"a",function(){return a});var s=["msit","df","ppe"],c=["Prod","Blackforest","GccModerate","GccHigh","DoD","Gallatin"]},function(e,t,n){"use strict";function r(e,t,n){return m(this,void 0,void 0,function(){var r,a;return y(this,function(o){switch(o.label){case 0:return(a=Object(v.b)(t)).lpcConfig?(r=a.lpcConfig,[3,3]):[3,1];case 1:return[4,i(e,t,n)];case 2:r=o.sent(),a.lpcConfig=r,o.label=3;case 3:return[2,r]}})})}function i(e,t,n){return m(this,void 0,void 0,function(){var r,a;return y(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,8]),[4,Object(g.a)(e,t,n)];case 1:return r=o.sent(),[3,8];case 2:return(a=o.sent()).statusCode&&401===a.statusCode?[4,Object(h.a)(void 0,t.getAuthToken,n)]:[3,4];case 3:e=o.sent(),o.label=4;case 4:return b<S?(b++,[4,i(e,t,n)]):[3,6];case 5:return r=o.sent(),[3,7];case 6:throw a.numberOfRetries=b,a;case 7:return[3,8];case 8:return[2,r]}})})}function a(e,t){var n=e.ResourceUrls||[];if(0===n.length){var r=e.Resources[k],i=e.Resources[w];"OwaPeopleHub"===e.Workload&&(i=e.Resources[P]),n=[r,i]}return Promise.all(n.map(function(e){return Object(C.a)(e,t)})).then(function(){return n})}function o(e,t){var n=Object(v.b)(t).targetWindow;return new Promise(function(r,i){setTimeout(function(){try{n.LPC||i(new T.a("StartLivePersonaCardError","targetWindow.LPC is undefined.")),n.LivePersonaCardStrings&&n.LivePersonaCardStrings.strings||n.LivePersonaCardStringsLpcMini&&n.LivePersonaCardStringsLpcMini.strings||i(new T.a("StartLivePersonaCardError","targetWindow.LivePersonaCardStrings is undefined."));var a=function(e,t){var n=Object(v.b)(t).targetWindow;return{refreshAuthToken:s(t),logToExternalApplication:t.logMessage,contextType:t.clientContextType,strings:n.LivePersonaCardStringsLpcMini&&n.LivePersonaCardStringsLpcMini.strings||n.LivePersonaCardStrings&&n.LivePersonaCardStrings.strings,source:t.clientType,consumerCorrelationId:t.clientCorrelationId,activeFlights:e.Flights,isDebug:!1,culture:t.culture,dataCallbacks:t.dataCallbacks,actionCallbacks:t.actionCallbacks,dataUpdateBroadcaster:t.dataUpdateBroadcaster,privateDataCallbacks:t.privateDataCallbacks,options:t.options?t.options:{hideDocumentFilter:!1},theme:t.theme,lokiUrl:e.LokiUrl,lokiVersion:e.LokiVersion,tenantAadObjectId:e.TenantAadObjectId,userAadObjectId:e.UserAadObjectId,userPuid:e.UserPuid,ecsConfigIds:e.EcsConfigIds,ecsETag:e.EcsEtag,loggedInUserUpn:e.Upn,complianceEnvironment:t.complianceEnvironment,userDisplayName:e.UserDisplayName}}(e,t);n.LPC.start(a),r()}catch(e){i(new T.a("StartLivePersonaCardError",e.name))}},0)})}function s(e){return function(t){e.getAuthToken(function(e,n){t(e,"",n)},function(e,n){t("",e,n)})}}function c(e){return _(this,void 0,void 0,function(){var t,n,i,s=this;return E(this,function(c){return t=Object(v.b)(e),n=function(){return Object(v.b)(e).ariaLogger},!t.forceRefreshInitializationPromise&&t.initializationPromise?[2,t.initializationPromise]:(i=new x.a(t.targetWindow),t.forceRefreshInitializationPromise=!1,t.initializationPromise=new Promise(function(c,u){return _(s,void 0,void 0,function(){var s,l,f,p,d,g,v;return E(this,function(m){switch(m.label){case 0:s=t.targetWindow,l=Object(L.a)(e),m.label=1;case 1:return m.trys.push([1,7,,8]),Object(I.a)(e),i.startCustomTiming(x.b.getAuthToken),[4,Object(h.a)(e.authToken,e.getAuthToken,s)];case 2:return f=m.sent(),i.endCustomTiming(x.b.getAuthToken),i.measureFromStart(x.b.getAuthTokenFromStart),i.startCustomTiming(x.b.getLokiConfig),[4,r(f,e,s)];case 3:return p=m.sent(),i.endCustomTiming(x.b.getLokiConfig),i.measureFromStart(x.b.getLokiConfigFromStart),i.startCustomTiming(x.b.getLpcBundles),[4,a(p,s)];case 4:return m.sent(),i.endCustomTiming(x.b.getLpcBundles),i.measureFromStart(x.b.getLpcBundlesFromStart),i.startCustomTiming(x.b.startLpc),[4,o(p,e)];case 5:return m.sent(),i.endCustomTiming(x.b.startLpc),i.measureFromStart(x.b.startLpcFromStart),[4,n().updateContextWithLokiDataAsync(p,l).catch(function(){console.log("Live Persona Card ERROR: Bootstrapper failed to initialize Aria, continuing without.")})];case 6:return m.sent(),(d=Object(O.a)(i.getAllTimings())).RootCorrelationId=p.RootCorrelationId,d.isConsumer=e.isConsumer,n().logEventAsync({name:"initializeLivePersonaCard_success",properties:d},l),c(),[3,8];case 7:return g=m.sent(),v=Object(O.a)(i.getAllTimings()),n().logEventAsync({name:"initializeLivePersonaCard_failure",properties:U(U(U({},Object(A.a)(g)),v),{isConsumer:e.isConsumer})},l),u("Failed to initialize Live Persona Card: "+g.name+" "+g.message),[3,8];case 8:return[2]}})})}),t.initializationPromise.catch(function(){setTimeout(function(){t&&(t.forceRefreshInitializationPromise=!0)},d.a)}),[2,t.initializationPromise])})})}function u(e){Object(v.a)(e)}function l(e){return _(this,void 0,void 0,function(){var t;return E(this,function(n){switch(n.label){case 0:return t=Object(v.b)(e),[4,Object(h.a)(e.authToken,e.getAuthToken,t.targetWindow)];case 1:return[2,r(n.sent(),e,t.targetWindow)]}})})}function f(e){return _(this,void 0,void 0,function(){return E(this,function(t){return[2,n.e(2).then(n.bind(null,45)).then(function(t){return(0,t.initializeTopicCardAsync)(e)})]})})}function p(e){return _(this,void 0,void 0,function(){return E(this,function(t){switch(t.label){case 0:return[4,n.e(0).then(n.bind(null,44))];case 1:return[2,(0,t.sent().initializeOfficeFeedAsync)(e)]}})})}n.r(t);var d=n(5),h=n(3),g=n(9),v=n(2),m=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},y=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o},S=2,b=0,C=n(6),w="livepersonacard_with-react",P="livepersonacard_without-react",k="livepersonacardstrings",T=n(0),L=n(7),A=n(8),O=n(4),x=n(1),I=n(10);n.d(t,"initializeLivePersonaCardAsync",function(){return c}),n.d(t,"freeBootstrapperMemory",function(){return u}),n.d(t,"fetchLokiConfigAsync",function(){return l}),n.d(t,"lazyInitializeTopicCardAsync",function(){return f}),n.d(t,"lazyInitializeOfficeFeedAsync",function(){return p});var U=function(){return(U=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},_=function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):((t=e.value)instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((r=r.apply(e,t||[])).next())})},E=function(e,t){function n(n){return function(o){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(a=2&n[0]?i.return:n[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=t.call(e,s)}catch(e){n=[6,e],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,o])}}var r,i,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o};try{var M=window.document.createElement("link"),F=Boolean("onmscontentzoom"in window.document);M.rel=F?"dns-prefetch":"preconnect",M.href="https://lpcres.delve.office.com/",window.document.head.appendChild(M)}catch(e){console.log("Live Persona Card ERROR: Bootstrapper failed to warm up the connection to Midgard CDN.",e)}}])})},1902:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(i,a){function o(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){e.done?i(e.value):new n(function(t){t(e.value)}).then(o,s)}c((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;c;)try{if(i=1,a&&(o=2&n[0]?a.return:n[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,n[1])).done)return o;switch(a=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,a=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(o=c.trys,!(o=o.length>0&&o[o.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3])){c.label=n[1];break}if(6===n[0]&&c.label<o[1]){c.label=o[1],o=n;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(n);break}o[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(e){n=[6,e],a=0}finally{i=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,a,o,s,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},a=this;Object.defineProperty(t,"__esModule",{value:!0});var o=n(55),s=function(e,t,n){return function(r){var i={slug:r.peopleSlug||r.slug,groupName:r.groupName||r.teamName,middlePane:r.middlePane,threadId:r.threadId,messageId:void 0,ctx:r.ctx,navCtx:e.navContext.livePersonaCard,appId:null};return n.navigatePromise(t,e.states.appConversation,i)}},c=function(e,t){return function(n,o){return void 0===o&&(o=!1),r(a,void 0,void 0,function(){var r;return i(this,function(i){return(r=e.getChatConversationWith(n))?[2,t.placeCall({conversationId:r.id,withVideo:o,context:teamspace.services.CallTelemetryContext.LivePersonCard,checkUserMode:!0,isChannelMeeting:!1})]:[2,Promise.reject("Cannot find the chat")]})})}},u=function(e,t){return function(n,r){var i=e.getChatConversationWith(n);if(!i)return Promise.reject("Cannot find the chat");var a=SkypeX.Services.Utilities.newClientMessageId();return t.createMessage({conversationId:i.id,replyChainId:null,messageSubject:null,messageBody:r,messagePreview:r,fileAttachments:null,extensions:null,mentions:null,inputExtensionAttachments:null,embeddedLinks:null,isHtml:!1,importance:null,clientId:a,externalId:null,draftObjectId:null,inlineImages:null})}},l=function(e,t,n,s,c,u){return function(l,f){var p=l.persona;return r(a,void 0,void 0,function(){var r,a,l,d,h;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t.info("LPC::Starting chat"),r=e.scenarios.people.livePersonaCardStartChat,[4,n.getAllLatestPeopleProfile([p.HostAppPersonaId],r,!1)];case 1:return a=i.sent()[0],l=s.getPrivateChatUserMri(a,r),[4,c({groupName:a.displayName,peopleSlug:l,middlePane:e.messages.panes.conversations,ctx:e.navigation.context.chat})];case 2:return i.sent(),f(!0),u(o.LpcCallbackTelemetryType.chatAction),[3,4];case 3:return d=i.sent(),h="Failed to navigate to chat",t.error(h),f(!1,h),[3,4];case 4:return[2]}})})}},f=function(e,t,n,s,c,u){return function(s,l){return r(a,void 0,void 0,function(){var r,a,f,p;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),t.info("LPC::Navigating to user's org chart"),r=e.scenarios.people.livePersonaCardOrgChart,[4,n.getAllLatestPeopleProfile([s.HostAppPersonaId],r,!1)];case 1:return a=i.sent()[0],[4,c({groupName:a.displayName,slug:s.HostAppPersonaId,middlePane:e.peopleTab.panes.organization,ctx:e.navigation.context.chat})];case 2:return i.sent(),l(!0),u(o.LpcCallbackTelemetryType.orgChartAction),[3,4];case 3:return f=i.sent(),p="Failed to navigate to org chat",t.error(p),l(!1,p),[3,4];case 4:return[2]}})})}},p=function(e,t,n){return function(s,c){return r(a,void 0,void 0,function(){var r,a;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e.info("LPC::Starting audio call"),[4,t(s.HostAppPersonaId)];case 1:return i.sent(),c(!0),n(o.LpcCallbackTelemetryType.audioCallAction),[3,3];case 2:return r=i.sent(),a="Failed to start audio call with",e.error(a),c(!1,a),[3,3];case 3:return[2]}})})}},d=function(e,t,n){return function(s,c){return r(a,void 0,void 0,function(){var r,a;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e.info("LPC::Starting video call"),[4,t(s.HostAppPersonaId,!0)];case 1:return i.sent(),c(!0),n(o.LpcCallbackTelemetryType.videoCallAction),[3,3];case 2:return r=i.sent(),a="Failed to start video call with",e.error(a),c(!1,a),[3,3];case 3:return[2]}})})}},h=function(e,t,n){return function(s,c,u){return r(a,void 0,void 0,function(){var r,a;return i(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,3]),e.info("LPC::Sending message to user, message length {0}",c&&c.length),[4,t(s.HostAppPersonaId,c)];case 1:return i.sent(),u(!0),n(o.LpcCallbackTelemetryType.quickMessageAction),[3,3];case 2:return r=i.sent(),a="Failed to send message",e.error(a),u(!1,a),[3,3];case 3:return[2]}})})}};t.LPCActionCallbackFactory=function(e,t,n,r,i,a,o,g,v){var m=s(t,e,a),y=c(i,o),S=u(i,g);return{startChat:l(t,n,r,i,m,v),showOrgChart:f(t,n,r,0,m,v),sendQuickMessage:h(n,S,v),startVideoCall:d(n,y,v),startAudioCall:p(n,y,v)}}},1903:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(55);t.unescapeHtmlEntities=function(e){if(!e)return e;var t=document.createElement("textarea");return t.innerHTML=e,t.value};var i=function(e,t,n){return function(e,r){var i={mri:e.HostAppPersonaId,principalName:e.Smtp,displayName:e.DisplayName||"",size:n.profilePictureSizes.medium};t.loadImage(i,!1,!1,!1).then(function(e){var t=e&&e.imgUrl||"";r(t,{})}).catch(function(e){r(void 0,void 0,e)})}},a=function(e,t,n){var i=e.status,a=e.flwPresence;if(t.valueAsBoolean(n.settings.names.enableFlwPresence)){if(a===SkypeX.Services.UserFlwPresence.OffShift)return r.PersonaPresence.offline;if(a===SkypeX.Services.UserFlwPresence.OnShift)switch(i){case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:return r.PersonaPresence.busy;default:return r.PersonaPresence.online}}switch(i){case SkypeX.Services.UserStatus.Online:return r.PersonaPresence.online;case SkypeX.Services.UserStatus.Offline:case SkypeX.Services.UserStatus.OutOfOffice:case SkypeX.Services.UserStatus.Unknown:return r.PersonaPresence.offline;case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.AppearAway:return r.PersonaPresence.away;case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.OnThePhone:return r.PersonaPresence.busy;case SkypeX.Services.UserStatus.OutToLunch:case SkypeX.Services.UserStatus.Presenting:case SkypeX.Services.UserStatus.Focusing:return r.PersonaPresence.dnd;default:return r.PersonaPresence.offline}},o=function(e,t,n,r,i,a,o){if(!t||0===t.length)return e;var s=r.getLocalTimezone();if(n&&s!==n){var c=(new Date).toLocaleDateString(i.getLocale(),{timeZoneName:"short"}).split(" "),u=c.length>0?c[c.length-1]:null;u&&(t=a.instant(o.strings.person_card_on_shift_end_time_with_timezone,{shiftEndTime:t,timeZoneCode:u}))}return a.instant(o.strings.person_card_on_shift_status_label,{onShiftStatus:e,shiftEndTime:t})},s=function(e,t,n,r,i,a,s,c,u){var l=e.status,f=e.calendarData,p=e.lastSeenAt,d=e.flwPresence,h=e.extensions;if(t.valueAsBoolean(i.settings.names.enableFlwPresence)){if(d===SkypeX.Services.UserFlwPresence.OffShift)return n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OffShift);if(d===SkypeX.Services.UserFlwPresence.OnShift){var g=void 0,v=void 0,m=SkypeX.Services.UnifiedPresenceExtensionsParser.getShiftsData(h);switch(m&&m.currentShift&&(g=u.getDate(new Date(m.currentShift.endTime),"shortTime"),v=m.currentShift.teamOlsonCode),l){case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.Presenting:var y=r.instant(a.strings.status_label_person_card_with_primary_and_secondary_status,{primaryStatus:n.GetTranslatedStatusText(l),secondaryStatus:n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OnShift)});return o(y,g,v,c,u,r,a);default:var S=n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OnShift);return o(S,g,v,c,u,r,a)}}}var b=p&&(new Date).getTime()-p.getTime()<=i.timeInMiliseconds.year;if(f&&f.isOutOfOffice)switch(l){case SkypeX.Services.UserStatus.Online:case SkypeX.Services.UserStatus.Busy:case SkypeX.Services.UserStatus.OnThePhone:case SkypeX.Services.UserStatus.InAMeeting:case SkypeX.Services.UserStatus.OutToLunch:case SkypeX.Services.UserStatus.Presenting:case SkypeX.Services.UserStatus.Focusing:return r.instant(a.strings.status_label_person_card_with_primary_and_secondary_status,{primaryStatus:n.GetTranslatedStatusText(l),secondaryStatus:n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice)});case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.Offline:return b?s.transformIntoTimeago(p):n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice);default:return n.GetTranslatedStatusText(SkypeX.Services.UserStatus.OutOfOffice)}else switch(l){case SkypeX.Services.UserStatus.Away:case SkypeX.Services.UserStatus.BeRightBack:case SkypeX.Services.UserStatus.Idle:case SkypeX.Services.UserStatus.Offline:return b?s.transformIntoTimeago(p):n.GetTranslatedStatusText(l);default:return n.GetTranslatedStatusText(l)}},c=function(e,t,n,r,i){var a="";return e.calendarData&&e.calendarData.outOfOfficeNote&&e.calendarData.outOfOfficeNote.message&&(a=r.stripHtml(i.sanitizeHtml(e.calendarData.outOfOfficeNote.message)).trim()),a},u=function(e,t,n,r,i,a){var o={message:"",publishTime:""};if(e.note){var s=e.note.message,u=e.note.publishTime;if(u&&u.trim()){var l=new Date(u);o.publishTime=a.getMessageDisplayableDateTime(l)}if(s){var f=r.stripHtml(i.sanitizeHtml(s)).trim(),p=c(e,0,0,r,i);f.length&&!p.length&&(o.message=f)}}return o.message&&o.publishTime?o:void 0},l=function(e,n,r,i){var a=[],o=function(i){_.each(i,function(i){if("span"===i.name&&i.attribs&&i.attribs.itemtype===n.semanticObjectSchemas.mention&&i.attribs["data-itemprops"]){var s=r.DomUtils.getText(i),c=JSON.parse(e.decodeHtml(i.attribs["data-itemprops"])).mri;a.push({text:t.unescapeHtmlEntities(s),hostAppPersonaId:c})}else"text"===i.type?a.push({text:t.unescapeHtmlEntities(r.DomUtils.getText(i)),hostAppPersonaId:void 0}):"br"===i.name?a.push({text:" ",hostAppPersonaId:void 0}):i.children&&i.children.length>0&&o(i.children)})};return o(i),a},f=function(e,t,n,r,i,a){if(t.valueAsBoolean(n.settings.names.enableStatusNoteV2)&&e.note){var o={message:[],publishTime:""},s=e.note.message,c=e.note.publishTime;if(s){var u=i.sanitizeHtml(s).trim(),f=window.htmlparser2,p=f.parseDOM("<div>"+u+"</div>"),d=l(r,n,f,p);o.message=d}if(c&&c.trim()){var h=new Date(c);o.publishTime=a.getMessageDisplayableDateTime(h)}return o.message.length&&o.publishTime?o:void 0}},p=function(e,t,n,r,i,o,l,p,d,h,g,v){return function(m){var y=e.getPresence(m);return{presence:a(y,i,o),isOutOfOffice:!!y.calendarData&&!!y.calendarData.isOutOfOffice,oofMessage:c(y,0,0,t,n),presenceText:s(y,i,l,p,o,d,h,g,v),statusNote:u(y,0,0,t,n,r),statusNoteV2:f(y,i,o,t,n,r)}}},d=function(e,t,n,r,i,a,o,s,c,u,l,f){return function(d,h){h(p(e,t,n,r,i,a,o,s,c,u,l,f)(d.HostAppPersonaId),void 0)}},h=function(e){return function(t){var n={disableChat:!1,disableOrg:!Boolean(!t||"User"===t.PersonaType),disableCall:!1,disableVideo:!1},r=e.getSettingValue(SkypeX.Services.CallingPolicyStorageKey.allowPrivateCalling);return n.disableCall=!r,n.disableVideo=!r,n}};t.GetRichPresenceFunction=p,t.LPCDataCallbackFactory=function(e,t,n,r,a,o,s,c,u,l,f,p,g,v,m){return{getAndPrefetchPersonaImageUri:i(0,v,s),getRichPresence:d(t,n,r,a,o,s,c,u,l,f,p,g),getHeaderActionsPolicy:h(m)}}},1904:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1905);t.defaultTheme=r.defaultTheme;var i=n(1906);t.darkTheme=i.darkTheme;var a=n(1907);t.highContrastTheme=a.highContrastTheme},1905:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="rgba(37,36,36,0.75)",i={themePrimary:r,themeSecondary:r,neutralPrimary:"#252424",neutralSecondary:r,neutralLight:"#FAF9F8",neutralLighter:"#f3f2f1",neutralLighterAlt:"#ffffff",neutralPrimaryAlt:"#FAF9F8",neutralSecondaryAlt:"#2A2828",neutralTertiary:"#c8c6c4",neutralTertiaryAlt:"#FAF9F8",neutralQuaternary:"#f3f2f1",neutralQuaternaryAlt:"#ffffff",purple:"#6264a7",magenta:"#943670",magentaDark:"rgba(148,54,112,0.05)"};t.defaultTheme={palette:i}},1906:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fontColor="rgba(255,255,255,0.75)",t.white="#2d2c2c",t.darkThemePalette={themePrimary:t.fontColor,themeSecondary:t.fontColor,neutralPrimary:"#ffffff",neutralSecondary:t.fontColor,neutralLight:"#3b3a39",neutralLighter:"#201F1F",neutralLighterAlt:t.white,neutralPrimaryAlt:"#3B3A3A",neutralSecondaryAlt:t.fontColor,neutralTertiary:"#605e5c",neutralTertiaryAlt:"#3b3a39",neutralQuaternary:"#201F1F",neutralQuaternaryAlt:"#201F1F",white:t.white,purple:"#a6a7dc",magenta:"#ae3d84",magentaDark:"rgba(207,96,152,0.1)",black:"#ffffff"},t.darkTheme={palette:t.darkThemePalette}},1907:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r="#000000",i="#ffffff",a={themePrimary:"#ffffff",themeSecondary:"#ffffff",neutralPrimary:i,neutralSecondary:"#ffffff",neutralLight:r,neutralLighter:i,neutralLighterAlt:i,neutralPrimaryAlt:r,neutralSecondaryAlt:"#ffffff",neutralTertiary:"#30f42c",neutralTertiaryAlt:r,neutralQuaternary:r,neutralQuaternaryAlt:i,white:r,black:i,purple:"#ffff00",magenta:i,magentaDark:r};t.highContrastTheme={palette:a}},1908:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=teamspace.components.PanelActionGesture,i=teamspace.components.PanelActionOutcome,a=teamspace.components.PanelActionScenario,o=teamspace.components.PanelActionScenarioType,s=teamspace.components.PanelModuleName,c=teamspace.components.PanelModuleType,u=n(55),l=function(){function e(e,t){this.analyticsService=e,this.loggingService=t}return e.prototype.logPanelActionEvent=function(e){var t,n,l,f,p=this,d=c.people,h=i.nav,g=o.people,v=teamspace.PanelRegion.popover;switch(e){case u.LpcCallbackTelemetryType.audioCallAction:n=r.click,l=a.navCalling,f=s.lpcAudioCall,t="AudioCallLpc";break;case u.LpcCallbackTelemetryType.chatAction:n=r.click,l=a.navChat,f=s.lpcStartChat,t="ChatLpc";break;case u.LpcCallbackTelemetryType.orgChartAction:n=r.click,l=a.orgChart,f=s.lpcOrgChart,t="OrgChartLpc";break;case u.LpcCallbackTelemetryType.quickMessageAction:n=r.click,h=i.submit,l=a.quickIM,f=s.lpcQuickIM,t="QuickIMLpc";break;case u.LpcCallbackTelemetryType.videoCallAction:n=r.click,l=a.navCalling,f=s.lpcVideoCall,t="VideoCallLpc";break;default:return}var m={action:{gesture:n,outcome:h,scenario:l?teamspace.shared.AttributeHelper.tryGetEnum(l.toString(),a,this.loggingService):null,scenarioType:g?teamspace.shared.AttributeHelper.tryGetEnum(g.toString(),o,this.loggingService):null},module:{name:teamspace.shared.AttributeHelper.tryGetEnum(f.toString(),s,this.loggingService),type:teamspace.shared.AttributeHelper.tryGetEnum(d.toString(),c,this.loggingService),summary:t}};this.analyticsService.getAnalyticsPanelActionEventData(m,v).then(function(e){p.analyticsService.sendPanelAction(e)})},e}();t.LpcTelemetryHelper=l},55:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});!function(e){e[e.none=0]="none",e[e.offline=1]="offline",e[e.online=2]="online",e[e.away=3]="away",e[e.dnd=4]="dnd",e[e.blocked=5]="blocked",e[e.busy=6]="busy",e[e.oof=7]="oof"}(t.PersonaPresence||(t.PersonaPresence={}));!function(e){e.Default="default",e.HighContrast="contrast",e.Dark="dark"}(t.LpcTheme||(t.LpcTheme={}));!function(e){e[e.audioCallAction=0]="audioCallAction",e[e.chatAction=1]="chatAction",e[e.orgChartAction=2]="orgChartAction",e[e.quickMessageAction=3]="quickMessageAction",e[e.videoCallAction=4]="videoCallAction",e[e.personImageCallback=5]="personImageCallback",e[e.richPresenceCallback=6]="richPresenceCallback"}(t.LpcCallbackTelemetryType||(t.LpcCallbackTelemetryType={}))}},[1899]);
//# sourceMappingURL=https://statics.teams.cdn.office.net/hashedjs/lazy-ng1-mod-lpc-services.min.js-0bef69db.map