(this.webpackJsonp=this.webpackJsonp||[]).push([[56],{1053:function _(e,t){},1123:function _(e,t){},1454:function _(e,t,n){var r=n(813),o=n(1455),i=n(885),a="Expected a function",s=Math.max,c=Math.min;e.exports=function(e,t,n){var d,u,l,f,p,h,m=0,g=!1,b=!1,v=!0;if("function"!=typeof e)throw new TypeError(a);function y(t){var n=d,r=u;return d=u=void 0,m=t,f=e.apply(r,n);}function _(e){var n=e-h;return void 0===h||n>=t||n<0||b&&e-m>=l;}function O(){var e=o();if(_(e))return C(e);p=setTimeout(O,function(e){var n=t-(e-h);return b?c(n,l-(e-m)):n;}(e));}function C(e){return p=void 0,v&&d?y(e):(d=u=void 0,f);}function w(){var e=o(),n=_(e);if(d=arguments,u=this,h=e,n){if(void 0===p)return function(e){return m=e,p=setTimeout(O,t),g?y(e):f;}(h);if(b)return clearTimeout(p),p=setTimeout(O,t),y(h);}return void 0===p&&(p=setTimeout(O,t)),f;}return t=i(t)||0,r(n)&&(g=!!n.leading,l=(b="maxWait"in n)?s(i(n.maxWait)||0,t):l,v="trailing"in n?!!n.trailing:v),w.cancel=function(){void 0!==p&&clearTimeout(p),m=0,d=h=u=p=void 0;},w.flush=function(){return void 0===p?f:C(o());},w;};},1455:function _(e,t,n){var r=n(812);e.exports=function(){return r.Date.now();};},1456:function _(e,t,n){var r=n(1457),o=n(1458),i=n(1107),a=n(800);e.exports=function(e,t){return(a(e)?r:o)(e,i(t));};},1457:function _(e,t){e.exports=function(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e);){;}return e;};},1458:function _(e,t,n){var r=n(1459),o=n(1094)(r,!0);e.exports=o;},1459:function _(e,t,n){var r=n(1460),o=n(806);e.exports=function(e,t){return e&&r(e,t,o);};},1460:function _(e,t,n){var r=n(1093)(!0);e.exports=r;},1462:function _(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"chatServicePostActiveEvent"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"chatServicePostActiveEvent"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"result"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:90}};n.loc.source={body:"subscription chatServicePostActiveEvent {\n  chatServicePostActiveEvent {\n    result\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var r={};function o(e,t){return e.definitions.find(function(e){return!!e.name&&e.name.value==t;});}n.definitions.forEach(function(e){if(e.name){var t=new Set();!function e(t,n){if("FragmentSpread"===t.kind)n.add(t.name.value);else if("VariableDefinition"===t.kind){var r=t.type;"NamedType"===r.kind&&n.add(r.name.value);}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,n);}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,n);}),t.definitions&&t.definitions.forEach(function(t){e(t,n);});}(e,t),r[e.name.value]=t;}}),e.exports=n,e.exports.chatServicePostActiveEvent=function(e,t){var n=Object.assign({},e),i=o(e,t);n.definitions=[i];for(var a=r[t]||new Set(),s=new Set(),c=new Set(a);c.size>0;){var d=c;c=new Set(),d.forEach(function(e){s.has(e)||(s.add(e),(r[e]||new Set()).forEach(function(e){c.add(e);}));});}return s.forEach(function(t){var r=o(e,t);r&&n.definitions.push(r);}),n;}(n,"chatServicePostActiveEvent");},1463:function _(e,t){var n={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"subscription",name:{kind:"Name",value:"presencePostActiveEvent"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"presencePostActiveEvent"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"endpointId"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:88}};n.loc.source={body:"subscription presencePostActiveEvent {\n  presencePostActiveEvent {\n    endpointId\n  }\n}\n",name:"GraphQL request",locationOffset:{line:1,column:1}};var r={};function o(e,t){return e.definitions.find(function(e){return!!e.name&&e.name.value==t;});}n.definitions.forEach(function(e){if(e.name){var t=new Set();!function e(t,n){if("FragmentSpread"===t.kind)n.add(t.name.value);else if("VariableDefinition"===t.kind){var r=t.type;"NamedType"===r.kind&&n.add(r.name.value);}t.selectionSet&&t.selectionSet.selections.forEach(function(t){e(t,n);}),t.variableDefinitions&&t.variableDefinitions.forEach(function(t){e(t,n);}),t.definitions&&t.definitions.forEach(function(t){e(t,n);});}(e,t),r[e.name.value]=t;}}),e.exports=n,e.exports.presencePostActiveEvent=function(e,t){var n=Object.assign({},e),i=o(e,t);n.definitions=[i];for(var a=r[t]||new Set(),s=new Set(),c=new Set(a);c.size>0;){var d=c;c=new Set(),d.forEach(function(e){s.has(e)||(s.add(e),(r[e]||new Set()).forEach(function(e){c.add(e);}));});}return s.forEach(function(t){var r=o(e,t);r&&n.definitions.push(r);}),n;}(n,"presencePostActiveEvent");},2717:function _(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"walk",function(){return cr;}),n.d(r,"getNextTextNode",function(){return dr;});var o={};n.r(o),n.d(o,"createTextRange",function(){return Or;}),n.d(o,"executeOnCollapsedRange",function(){return Cr;}),n.d(o,"replaceTextInNode",function(){return wr;}),n.d(o,"isCharacterABoundary",function(){return jr;}),n.d(o,"atWordBoundary",function(){return Er;}),n.d(o,"getCharacterAt",function(){return Tr;}),n.d(o,"getPreviousWord",function(){return kr;}),n.d(o,"getCurrentWord",function(){return Pr;}),n.d(o,"getTextInRange",function(){return Ir;}),n.d(o,"shrinkToInnerMostElementNode",function(){return Ar;}),n.d(o,"shrinkToLastTextNode",function(){return Hr;});var i=n(0),a=n(2722),s=n(2724),c=n(2719),d=n(724),u=function(){function e(e,t,n){this.send=e,this.coreSettings=t,this.localeCode=n;}return e.prototype.getGiphys=function(t){return Object(i.__awaiter)(this,void 0,Promise,function(){var n;return Object(i.__generator)(this,function(r){return n=[{name:"query",value:t},{name:"rating",value:this.getGiphyRating()},{name:"limit",value:e.GIPHYS_RESULT_LIMIT},{name:"lang",value:this.localeCode}],[2,this.post(e.GIPHYS_FETCH_URL,n)];});});},e.prototype.postRaw=function(e,t){return this.send({url:e,method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json;charset=UTF-8"}});},e.prototype.post=function(e,t){return this.postRaw(e,t).then(function(e){return e.body.json();}).then(function(e){return e.result;});},e.prototype.getGiphyRating=function(){switch(this.coreSettings.get(d.a.Messaging).giphyRatingType){case d.b.GiphyRatingType.Moderate:return"g";case d.b.GiphyRatingType.NoRestriction:return"pg-13";case d.b.GiphyRatingType.Strict:default:return"y";}},e.GIPHYS_FETCH_URL="beta/commands/com.microsoft.teamspace.inputextension.giphy/execute?version=1.0",e.GIPHYS_RESULT_LIMIT="27",e;}(),l=function(){function e(e,t){this.send=e,this.localeCode=t;}return e.prototype.getEmoticons=function(t,n){return Object(i.__awaiter)(this,void 0,Promise,function(){var r,o,a;return Object(i.__generator)(this,function(i){return r=this.getLocaleString(),o=[{name:"locale",value:r}],n?o.push({name:"id",value:t}):o.push({name:"filter",value:t}),a=this.craftUrlWithParams(n?e.EMOTICON_FETCH_URL:e.EMOTICONS_FETCH_URL,o),[2,this._get(a)];});});},e.prototype.getEmoticonCategories=function(){return Object(i.__awaiter)(this,void 0,Promise,function(){var t,n,r;return Object(i.__generator)(this,function(o){return t=this.getLocaleString(),n=[{name:"locale",value:t}],r=this.craftUrlWithParams(e.CATEGORIES_FETCH_URL,n),[2,this._get(r)];});});},e.prototype.getEmoticonsInCategory=function(t){return Object(i.__awaiter)(this,void 0,Promise,function(){var n,r,o;return Object(i.__generator)(this,function(i){return n=this.getLocaleString(),r=[{name:"locale",value:n},{name:"id",value:t}],o=this.craftUrlWithParams(e.CATEGORY_FETCH_URL,r),[2,this._get(o)];});});},e.prototype.craftUrlWithParams=function(e,t){var n=t.filter(function(e){return e.value.length>0;}).map(function(e){return e.name+"="+e.value;});return n.length>0?e+"?"+n.join("&"):e;},e.prototype._getRaw=function(e){return this.send({url:e,method:"GET",headers:{"Content-Type":"application/json;charset=UTF-8"}});},e.prototype._get=function(e){return this._getRaw(e).then(function(e){return e.body.json();});},e.prototype.getLocaleString=function(){var e=this.localeCode.split("-");return e[0]+"_"+e[1].toUpperCase();},e.EMOTICONS_FETCH_URL="beta/fun/emoticons",e.EMOTICON_FETCH_URL="beta/fun/emoticon",e.CATEGORIES_FETCH_URL="beta/fun/categories",e.CATEGORY_FETCH_URL="beta/fun/category",e;}(),f=n(54),p=n(11),h=n(80),m=n(773),g=n(777),b=function(){function e(e,t,n){this.coreSettings=n;var r=this.coreSettings.get(d.a.Messaging).enableUrlPreviewV2Endpoint;this.isUrlpV2Enabled=r||!1,this.urlpSend=Object(m.a)(Object(g.a)(this.isUrlpV2Enabled?e.bind(t,d.b.Gtm.urlpV2):e.bind(t,d.b.Gtm.urlp)),f.g.OK);}return e.prototype.getPreview=function(e){var t=this.getHeaders();return this.urlpSend({url:"v1/url/info?url="+e,headers:t,method:"GET"}).then(function(e){return e.body.json();});},e.prototype.getHeaders=function(){var e=Object(h.v4)();return{"Content-Type":"application/x-www-form-urlencoded",RequestId:e,CorrelationId:e,TransactionId:e};},e;}(),v=function v(e){return{composeType:e.composeType,composeValue:e.composeValue,fieldValues:e.fieldValues};},y=function y(e){return{id:e.id,description:e.description,unicode:e.unicode,animation:e.animation,etag:e.etag};},_=function _(e){return{id:e.id,title:e.title,description:e.description};},O=n(183),C="retry-after",w=n(1280),j="asm.skype.com",S="api.ams.gcc.teams.microsoft.com",E="api.ams.dod.teams.microsoft.us",T="asyncgw.teams.microsoft.com",k="/v1/objects",P="/ams";function I(e){if(H(e))return!0;var t=Object(w.b)(e);return function(e){var t=Object(w.a)(e).toLowerCase();return t.endsWith(j)||t===S||t===E||t.endsWith(T);}(e)&&t.startsWith(k);}function A(e){if(!e||e.length<6)return!1;if(71!==e[0]||73!==e[1]||70!==e[2])return!1;for(var t=0,n=0;n<e.length-9&&!(33===e[n]&&249===e[n+1]&&4===e[n+2]&&44===e[n+8]&&++t>1);n++){;}return t>1;}function H(e){return Object(w.b)(e).toLowerCase().startsWith(P+k);}var x=n(134),K=n(289),R=n(216),D=n(2706),M=function(){function e(e,t,n,r,o,a){var s=this;this.discover=n,this.coreSettings=r,this.scenarioFactory=a,this._amsUrlPromise=void 0,this._amsV2UrlPromise=void 0;var c=this.coreSettings.get(d.a.Messaging).msgEnableAmsV2DomainInMW;this.isAmsV2Enabled=c||!1,this.logger=o.newLogger("AsyncMediaService"),this._send=Object(g.a)(this.isAmsV2Enabled?t.bind(e,d.b.Gtm.amsV2):t.bind(e,d.b.Gtm.ams)),this._sendWithRetry=Object(K.a)(this._send,function(e,t){return Object(i.__awaiter)(s,void 0,void 0,function(){var n,r,o,a,s,c;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return n=e.serverResponse,o=(r=void 0===n?{}:n).status,a=r.headers,o&&(o===f.g.THROTTLED||o>=f.g.SERVER_ERROR)&&void 0!==t.retryCounter&&t.delay&&t.maxRetryCount&&t.retryCounter++<t.maxRetryCount?(s=a&&a[C]||0,c=Math.max(s,t.delay.next()),[4,Object(R.a)(c)]):[3,2];case 1:return i.sent(),[3,3];case 2:throw e;case 3:return[2];}});});});}return e.prototype.uploadItem=function(t,n,r,o){return void 0===r&&(r="IMAGE"),Object(i.__awaiter)(this,void 0,Promise,function(){var a,s;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return t&&n&&("IMAGE"!==r||t instanceof Uint8Array)?[4,this._postItem(n,r,o)]:[2,Promise.reject(Object(x.a)(e.CONTEXT,f.c.Undefined,"uploadImage",void 0,"Invalid upload arguments"))];case 1:return a=i.sent(),[4,this.amsUrlPromise];case 2:return s=i.sent(),[4,this._putItem(t,a,r)];case 3:return i.sent(),"DOCUMENT"===r?[2,{objectId:a,amsUrl:s}]:[2,this._getImageResponse({amsUrl:s,objectId:a},A(t))];}});});},e.prototype.forwardContent=function(t,n){return Object(i.__awaiter)(this,void 0,Promise,function(){var r,o,a,s,c;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,this.amsUrlPromise];case 1:r=i.sent(),(o={})[n]=["read"],i.label=2;case 2:return i.trys.push([2,5,,7]),[4,this._send({url:"v1/objects/{objectId}/forward".replace("{objectId}",t),method:"POST",headers:{"Content-type":"application/json",Accept:"application/json","x-ms-client-version":"1415/1.0.0.2018090100"},body:JSON.stringify({permissions:o})})];case 3:return[4,i.sent().body.json()];case 4:if(!(a=i.sent())||!a.id)throw Object(x.a)(e.CONTEXT,f.c.InvalidResponse,"forwardContent",void 0,"Invalid AMS forward response");return[2,this._getImageResponse({objectId:a.id,amsUrl:r},!1)];case 5:return s=i.sent(),[4,this._getErrorString(s)];case 6:throw c=i.sent(),this.logger.error("forward content failed for "+t+". "+c),s;case 7:return[2];}});});},e.prototype.downloadItem=function(t,n){return Object(i.__awaiter)(this,void 0,Promise,function(){var r,o,a,s,c,d;return Object(i.__generator)(this,function(u){switch(u.label){case 0:if(!t)throw Object(x.a)(e.CONTEXT,f.c.Undefined,"downloadItem",void 0,"Invalid download arguments");return[4,I(t)?this.getUpdatedUrl(t):this.constructAmsUrl(t,"/views/original")];case 1:r=u.sent(),o={url:r,method:"GET",headers:{Accept:"*/*","x-ms-client-version":"1415/1.0.0.2018090100"}},n&&(o=Object(i.__assign)(Object(i.__assign)({},o),{delay:new D.a(1e3,144e3),retryCounter:0,maxRetryCount:5})),a=n?this._sendWithRetry:this._send,u.label=2;case 2:return u.trys.push([2,5,,7]),[4,a(o)];case 3:return[4,u.sent().body.blob()];case 4:if(!(s=u.sent()))throw Object(x.a)(e.CONTEXT,f.c.InvalidResponse,"downloadItem",void 0,"Invalid AMS Get response");return[2,s];case 5:return c=u.sent(),[4,this._getErrorString(c)];case 6:throw d=u.sent(),this.logger.error("error downloading image "+t+" from ams. "+d),c;case 7:return[2];}});});},e.prototype.constructAmsUrl=function(e,t){return void 0===t&&(t=""),Object(i.__awaiter)(this,void 0,Promise,function(){return Object(i.__generator)(this,function(n){switch(n.label){case 0:return[4,this.isAmsV2Enabled?this.amsV2UrlPromise:this.amsUrlPromise];case 1:return[2,n.sent()+"v1/objects/"+e+t];}});});},e.prototype.createAmsScenario=function(e){return this.scenarioFactory.newScenario(e);},e.prototype._postItem=function(t,n,r){return Object(i.__awaiter)(this,void 0,Promise,function(){var o,a,s,c,d,u;return Object(i.__generator)(this,function(i){switch(i.label){case 0:(o={})[t]=["read"],a=JSON.stringify({type:"DOCUMENT"===n?"sharing/file":"pish/image",permissions:o,filename:r}),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,this._send({url:"v1/objects/",method:"POST",headers:{"Content-type":"application/json",Accept:"application/json","x-ms-client-version":"1415/1.0.0.2018090100"},body:a})];case 2:return[4,(s=i.sent()).body.json()];case 3:return c=i.sent(),s&&c&&c.id?[2,c.id]:[2,Promise.reject(Object(x.a)(e.CONTEXT,f.c.InvalidResponse,"postItem",void 0,"Invalid AMS Post response"))];case 4:return d=i.sent(),[4,this._getErrorString(d)];case 5:throw u=i.sent(),this.logger.error("failed to get object id from ams. "+u),d;case 6:return[2];}});});},e.prototype._putItem=function(e,t,n){return Object(i.__awaiter)(this,void 0,Promise,function(){var r,o;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,4]),[4,this._send({url:"v1/objects/"+t+"/content/"+("DOCUMENT"===n?"original":"imgpsh"),method:"PUT",headers:{"Content-type":"application/octet-stream","x-ms-client-version":"1415/1.0.0.2018090100"},body:e})];case 1:return i.sent(),[3,4];case 2:return r=i.sent(),[4,this._getErrorString(r)];case 3:throw o=i.sent(),this.logger.error("failed to upload image "+t+" to ams. "+o),r;case 4:return[2];}});});},e.prototype._getErrorString=function(e){var t;return Object(i.__awaiter)(this,void 0,void 0,function(){var n;return Object(i.__generator)(this,function(r){switch(r.label){case 0:return e.serverResponse?[4,null===(t=e.serverResponse)||void 0===t?void 0:t.body.text()]:[3,2];case 1:return n=r.sent(),[2,"status :"+e.serverResponse.status+" "+n];case 2:return[2,e.toString()];}});});},e.prototype._getImageResponse=function(e,t){var n=e.amsUrl+(t?"v1/objects/{objectId}/views/imgpsh_mobile_save_anim":"v1/objects/{objectId}/views/imgo");return{objectId:e.objectId,inlineSizeUrl:n.replace("{objectId}",e.objectId)};},Object.defineProperty(e.prototype,"amsUrlPromise",{get:function get(){return this._amsUrlPromise||(this._amsUrlPromise=this.discover.regionGtm(d.b.Gtm.ams)),this._amsUrlPromise;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"amsV2UrlPromise",{get:function get(){return this._amsV2UrlPromise||(this._amsV2UrlPromise=this.discover.regionGtm(d.b.Gtm.amsV2)),this._amsV2UrlPromise;},enumerable:!0,configurable:!0}),e.prototype.getUpdatedUrl=function(e){return Object(i.__awaiter)(this,void 0,Promise,function(){var t,n;return Object(i.__generator)(this,function(r){switch(r.label){case 0:return t=e,!this.isAmsV2Enabled||H(e)?[3,2]:[4,this.amsV2UrlPromise];case 1:n=r.sent(),t=function(e,t){return e&&I(e)?t+new URL(e).pathname.substring(1):e;}(e,n),r.label=2;case 2:return[2,Promise.resolve(this.addQueryParam(t))];}});});},e.prototype.addQueryParam=function(e){return e.endsWith("?v=1")||(e+="?v=1"),e;},e.CONTEXT="AsyncMediaService",e;}(),N={type:"safelinks",safelinksAtpMT:{type:"safelinksmt",getUrlReputationRestEndpoint:"beta/atpsafelinks/geturlreputationrest/",RESOURCE_KEY:"https://dataservice.o365filtering.com"}},L=function(){function e(e,t,n,r){var o=this;this.send=e,this.authenticationService=t,this.coreSettings=n,this.handleGetATPAuthToken=function(){return o.authenticationService.acquireToken(N.safelinksAtpMT.RESOURCE_KEY);},this.logger=r.newLogger("AtpSafelinksService");}return e.prototype.getUrlReputationRestMT=function(e,t){return Object(i.__awaiter)(this,void 0,Promise,function(){var n,r,o,a;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(!this.coreSettings.get(d.a.Messaging).enabledATPSafelinks||!this._isAtpSafelinksSubscriptionEnabled())return this.logger.log("enabledATPSafelinks false"),[2,{status:f.g.OK,url:t}];i.label=1;case 1:return i.trys.push([1,5,,6]),[4,this.handleGetATPAuthToken()];case 2:return n=i.sent(),[4,this._post(N.safelinksAtpMT.getUrlReputationRestEndpoint,this._getRequestBody(t,n),this._getHeaders(e))];case 3:return r=i.sent(),this.logger.log("getUrlReputationRestMT started"),[4,r.body.json()];case 4:return o=i.sent(),[2,{url:t,status:r.status,data:o&&o.isATPSafelinksEnabled?o:{isATPSafelinksEnabled:!1}}];case 5:return a=i.sent(),this.logger.error("AtpSafelinks MT API failed with Error: "+(a&&a.message)),[2,{url:t,status:-1}];case 6:return[2];}});});},e.prototype._getRequestBody=function(e,t){return{urlList:[e],atptoken:t};},e.prototype._getHeaders=function(e){var t={"content-type":"application/json"};return e&&(this._addHeader(e.user,"X-sourceUser",t),this._addHeader(e.id,"X-sourceId",t),this._addHeader(e.detail,"X-sourceDetail",t)),t;},e.prototype._addHeader=function(e,t,n){n[t]=e;},e.prototype._post=function(e,t,n){return Object(i.__awaiter)(this,void 0,Promise,function(){return Object(i.__generator)(this,function(r){return[2,Object(m.a)(this.send,f.g.OK)({url:e,method:"POST",body:JSON.stringify(t),headers:n})];});});},e.prototype._isAtpSafelinksSubscriptionEnabled=function(){var e=this.coreSettings.get(d.a.UserResources).licenseSettings;return!(!e||!e.isAtpSafelinksEnabled);},e;}(),U=n(769),F=function(){function e(e,t,n){this.coreSettings=n;var r=this.coreSettings.get(d.a.Messaging).enableUrlPreviewV2Endpoint;this.isUrlpV2Enabled=r||!1,this.imageProxySend=Object(m.a)(Object(g.a)(this.isUrlpV2Enabled?e.bind(t,d.b.Gtm.urlpV2):e.bind(t,d.b.Gtm.urlp)),f.g.OK);}return e.prototype.getImageAsBinary=function(e){return Object(i.__awaiter)(this,void 0,Promise,function(){var t;return Object(i.__generator)(this,function(n){switch(n.label){case 0:return[4,this.imageProxySend({url:"/v1/url/image/original?url="+e,method:"GET"})];case 1:return[4,n.sent().body.arrayBuffer()];case 2:return t=n.sent(),[2,new Uint8Array(t)];}});});},e;}(),V=n(112),B=n(771),G=n(100),W={OnDemandTranslationTooManyCharacters:"OnDemandTranslationTooManyCharacters",UnknownError:"UnknownError"},$=function $(e){return function(t){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,r,o,a,s;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return i.trys.push([0,2,,5]),[4,Object(g.a)(e)(t)];case 1:return[2,i.sent()];case 2:return n=i.sent(),(r=n.serverResponse)?[4,r.body.json()]:[3,4];case 3:throw o=i.sent(),a=o.errorCode,s=W.UnknownError,o.errorCode&&(s=W[a]||s),Object(x.a)(f.d.RejectHttpError,f.c.RemoteOperationFailed,s,void 0,void 0,r);case 4:throw n;case 5:return[2];}});});};},z=function(){function e(e,t){this.scenarioFactory=t,this._send=Object(m.a)($(e),f.g.OK);}return e.prototype.createTranslationScenario=function(){return this.scenarioFactory.newScenario(G.a.OnDemandTranslation);},e.prototype.translate=function(t,n,r){return Object(i.__awaiter)(this,void 0,Promise,function(){var o;return Object(i.__generator)(this,function(i){return t&&0!==t.length&&n?(o={texts:t,toLanguage:n},r&&(o.doNotTranslate={itemType:r}),[2,this.post(e.TRANSLATE_URL,o)]):[2,Promise.resolve(null)];});});},e.prototype.post=function(e,t){return this._send({url:e,method:"POST",body:JSON.stringify(t),headers:{"Content-type":"application/json;charset=UTF-8"}}).then(function(e){return e.body.json();});},e.TRANSLATE_URL="beta/translate",e;}();function q(e,t,n,r,o,i,f,p,h,m){var g=new a.a(n.bind(f,d.b.Gtm.chatService),m),v=new s.a(e,h,m,f),y=new c.a(n.bind(f,d.b.Gtm.middleTier)),_=new u(n.bind(f,d.b.Gtm.middleTier),m,h.config.localeCode),O=new l(n.bind(f,d.b.Gtm.middleTier),h.config.localeCode),C=new M(f,n,r,m,i,p),w=new z(n.bind(f,d.b.Gtm.middleTier),p),j=new F(n,f,m);return{authenticationService:e,atpSafelinksService:new L(n.bind(f,d.b.Gtm.middleTier),e,m,i),chatService:g,csaService:v,peopleService:y,giphyService:_,emoticonService:O,asyncMediaService:C,imageProxyService:j,discover:r,chatServiceEndpointProvider:t?new t(g,p):null,loggerFactory:i,settingsService:o,urlPreviewService:new b(n,f,m),storage:new B.a(Object(V.a)().localStorage,"localItemsStorage.mw.messages"),translateService:w,coreSettings:m};}function J(e,t){return Object(p.isEmpty)(t)||!t?e:e.concat("-",t);}var X={Query:{giphys:function giphys(e,t,n){var r=t.searchFilter,o=n.giphyService;return Object(i.__awaiter)(this,void 0,void 0,function(){return Object(i.__generator)(this,function(e){return[2,o.getGiphys(r).then(function(e){var t=e[0].result;return t?t.map(v):[];})];});});},emoticons:function emoticons(e,t,n){var r=t.searchFilter,o=t.exactMatch,a=t.categoryId,s=n.emoticonService;return Object(i.__awaiter)(this,void 0,void 0,function(){var e;return Object(i.__generator)(this,function(t){switch(t.label){case 0:return a?[4,s.getEmoticonsInCategory(a)]:[3,2];case 1:return[2,(e=t.sent())?e.emoticons.map(y):[]];case 2:return[4,s.getEmoticons(r,o)];case 3:return[2,(e=t.sent())?e.emoticons.map(y):[]];}});});},emoticonCategories:function emoticonCategories(e,t,n){var r=n.emoticonService;return Object(i.__awaiter)(this,void 0,void 0,function(){var e;return Object(i.__generator)(this,function(t){switch(t.label){case 0:return[4,r.getEmoticonCategories()];case 1:return[2,(e=t.sent())?e.map(_):[]];}});});},messageDraft:function messageDraft(e,t,n){var r=t.convId,o=t.clientMessageId,a=n.storage;return Object(i.__awaiter)(this,void 0,void 0,function(){var e,t,n,s,c,d;return Object(i.__generator)(this,function(i){return e=J(r,o),(t=a.getItem(e))?(n=JSON.parse(t),s=n.message,c=Object(p.get)(s,"computed"),d=c.isExpanded,Object.assign(s,{isExpanded:d}),[2,{id:e,convId:r,message:s}]):[2,null];});});},downloadAmsItem:function downloadAmsItem(e,t,n){var r=t.urlOrObjectId,o=t.type,a=t.applyRetry,s=n.asyncMediaService;return Object(i.__awaiter)(this,void 0,void 0,function(){var e;return Object(i.__generator)(this,function(t){switch(t.label){case 0:return[4,s.downloadItem(r,a)];case 1:switch(e=t.sent(),o){case O.a.BlobType.Text:return[2,(n=e,new Promise(function(e,t){if(null!=n){var r=new FileReader();r.addEventListener("loadend",function(){try{e(r.result);}catch(e){t(e);}}),r.readAsText(n);}else t(new Error("Blob content was empty"));}))];case O.a.BlobType.Url:default:return[2,URL.createObjectURL(e)];}return[2];}var n;});});},constructAmsUrl:function constructAmsUrl(e,t,n){var r=t.amsDocId;return n.asyncMediaService.constructAmsUrl(r);},getUrlReputationRest:function getUrlReputationRest(e,t,n){var r=t.originalUrl,o=t.context,a=n.atpSafelinksService;return Object(i.__awaiter)(this,void 0,void 0,function(){var e;return Object(i.__generator)(this,function(t){switch(t.label){case 0:return[4,a.getUrlReputationRestMT(o,r)];case 1:return[2,{url:(e=t.sent()).url,hasSucceeded:e.status===f.g.OK,data:e.data}];}});});}},Mutation:{saveMessageDraft:function saveMessageDraft(e,t,n){var r=t.convId,o=t.message,a=n.storage;return Object(i.__awaiter)(this,void 0,void 0,function(){var e,t;return Object(i.__generator)(this,function(n){return e=Object(p.has)(o,"id")?J(r,o.clientMessageId):r,t={id:e,message:o},a.setItem(e,JSON.stringify(t)),[2,e];});});},removeMessageDraft:function removeMessageDraft(e,t,n){var r=t.convId,o=t.clientMessageId,a=n.storage;return Object(i.__awaiter)(this,void 0,void 0,function(){var e;return Object(i.__generator)(this,function(t){return e=J(r,o),a.removeItem(e),[2,e];});});},setConversationTitle:function setConversationTitle(e,t,n){var r=t.convId,o=t.title,a=n.chatService;return Object(i.__awaiter)(this,void 0,Promise,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,a.setConversationTitle(r,o)];case 1:return e.sent(),[2,!0];}});});},translateMessage:function translateMessage(e,t,n){var r=t.messageContent,o=t.messageEditTime,a=t.dontTranslateItemTypes,s=n.translateService,c=n.settingsService,d=n.loggerFactory;return Object(i.__awaiter)(this,void 0,Promise,function(){var e,t;return Object(i.__generator)(this,function(n){return e=new U.a(c).appLocale,t=s.createTranslationScenario(),[2,s.translate([r||""],e,a).then(function(e){return t.stop(),{response:JSON.stringify(e),requestState:O.a.TranslationRequestState.Done,messageEditTime:o};}).catch(function(e){var n=d.newLogger("Translate Message resolvers"),r="translation failed with unknown error - errorCode: "+(e&&e.code),o={errors:"unknown"},i=O.a.TranslationRequestState.Error;return e.subContext&&e.subContext===W.OnDemandTranslationTooManyCharacters&&(r="translation failed with too many characters - errorCode: "+(e&&e.code),o.errors="too many characters",i=O.a.TranslationRequestState.ErrorTooManyCharacters),n.error(r),t.fail(o),Promise.resolve({response:null,requestState:i});})];});});}},Subscription:{}},Q=/[\u200B]/,Y=/[\u200B-\u200D\uFEFF]/,Z=new RegExp(Y,"g"),ee=new Set(["background","background-color","color","font","font-size","font-style","font-weight","text-decoration","text-decoration-line"]),te=["pre","code"],ne=(n(1053),function(e,t){return void 0===t&&(t=100),function(n){return function(){for(var r=[],o=0;o<arguments.length;o++){r[o]=arguments[o];}var a=performance.now(),s=n.call.apply(n,Object(i.__spreadArrays)([n],r)),c=performance.now(),d=c-a;return d>t?console.warn("Teams:Compose:"+e+" Performance degradation: "+d+"ms"):d>=1&&console.debug("Teams:Compose:"+e+" Performance "+d+"ms"),s;};};}),re=n(2669),oe=function oe(e){for(var t="",n=[e];n.length>0;){var r=n.shift();re.b.ElementType.isTag(r)?n.unshift.apply(n,r.children||[]):t+=r.data;}return t;},ie=function ie(e){if(0===e.length)return e;var t,n=e[0].parent;return n&&(n.children=[],t=n.parent),e.forEach(function(e){return e.parent=t;}),e;},ae=function ae(e,t){var n,r=[],o=ce(t);return(e=Object(p.filter)(e))&&0!==e.length?(o.parent=e[0].parent,e.forEach(function(t,i){for(var a=t;a&&(a.parent=o,r.push(a),a.prev=n,n&&(n.next=a),n=a,(a=a.next)!==e[i+1]);){;}}),o.children=r,o):o;},se=function se(e){return de(re.b.ElementType.Text,"text",e);},ce=function ce(e,t){return void 0===t&&(t={}),de(re.b.ElementType.Tag,e,"",t);};function de(e,t,n,r){return void 0===n&&(n=""),void 0===r&&(r={}),{name:t,children:[],type:e,prev:void 0,parent:void 0,data:n,attribs:r,next:void 0};}var ue=function ue(e,t){if(e&&t)return e.map(function(e){return{handle:e.instance[t].bind(e.instance),transient:e.config.transient,filter:e.config.filter,name:e.config.name};});},le=function le(e,t){var n=he(function(e,t){return{updated:t.result,isReactElement:!1,result:t.result};},ge,!0);return fe(e,n,t);},fe=function fe(e,t,n){return e&&0!==e.length?function(r){return Object(i.__awaiter)(void 0,void 0,Promise,function(){var o,a,s,c;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(!r)return[2,{handled:!1,result:null}];o=t(r,e,n),i.label=1;case 1:return(a=o.next(a&&a.value)).value instanceof Promise?(s=a,[4,a.value]):[3,3];case 2:s.value=i.sent(),i.label=3;case 3:if(!a.done)return[3,1];i.label=4;case 4:return[2,{handled:(c=a)&&c.value&&c.value.handled,transientHandled:c&&c.value&&c.value.transientHandled,result:c&&c.value&&c.value.result}];}});});}:function(){return Promise.resolve({handled:!1,result:null});};},pe=function pe(e,t,n){return e&&0!==e.length?function(r){if(!r)return{handled:!1,result:null};var o=t(r,e,n).next().value;return{handled:o&&o.handled,transientHandled:o&&o.transientHandled,result:o&&o.result};}:function(){return{handled:!1,result:null};};},he=function he(e,t,n){return function(r,o,a){var s,c,d,u,l,f,h,m,g;return Object(i.__generator)(this,function(i){switch(i.label){case 0:s=!1,d=r,u=0,l=o,i.label=1;case 1:return u<l.length?(f=l[u],d?function(e,t){if(t.type===re.b.ElementType.Text)return be(e.filter,"text");if(be(e.filter,t.name||""))return!0;for(var n=0,r=Object(p.keys)(t.attribs);n<r.length;n++){var o=r[n];if(be(e.filter,o)||be(e.filter,o,re.b.DomUtils.getAttributeValue(t,o)))return!0;}return!1;}(f,d)?(h=f.handle(d,a),n?[4,h]:[3,3]):[3,4]:[3,5]):[3,5];case 2:h=i.sent(),i.label=3;case 3:if((m=me(d,h=h,t))&&m.handled){if(g=e(d,m),d=g.updated,c=g.result,!f.transient||m.isReactElement)return[2,{handled:!0,transientHandled:s,result:c}];s=!0;}i.label=4;case 4:return u++,[3,1];case 5:return[2,{handled:!1,transientHandled:s,result:c}];}});};},me=function me(e,t,n){return void 0===t?n(e,[]):null===t?(re.b.DomUtils.removeElement(e),{handled:!0,isReactElement:!1,result:null}):n(e,t);},ge=function ge(e,t){if(0===(t=Array.isArray(t)?t:[t]).length)return{handled:!1,isReactElement:!1,result:e};!function(e,t){var n;if(t=Object(p.filter)(t),e&&0!==t.length){var r=e.parent,o=e.next,a=e.prev;t.forEach(function(n,r){n.parent=e.parent,n.next=t[r+1]||o,n.prev=t[r-1]||a;}),a&&(a.next=Object(p.first)(t)),o&&(o.prev=Object(p.last)(t)),r&&(r.children||(r.children=[]),(n=r.children).splice.apply(n,Object(i.__spreadArrays)([r.children.lastIndexOf(e),1],t)));}}(e,t);var n=t[0];return e.parent||Object.assign(e,n),{handled:!0,isReactElement:!1,result:n};},be=function be(e,t,n){return Array.isArray(e)||(e=[e]),e.some(function(e){if("string"==typeof e)return e===t||"*"===e;if(void 0!==n){if(e[t]===n)return!0;if("class"===t&&e[t])return n.search(e[t])>-1;}return!1;});},ve=function ve(e,t){return Object(i.__awaiter)(void 0,void 0,Promise,function(){var n,r,o,a;return Object(i.__generator)(this,function(i){switch(i.label){case 0:n=ae(e,"div"),r=ye(n.children,t),i.label=1;case 1:return(o=r.next(o&&o.value)).value instanceof Promise?(a=o,[4,o.value]):[3,3];case 2:a.value=i.sent(),i.label=3;case 3:if(!o.done)return[3,1];i.label=4;case 4:return[2,{result:ie(n.children),transientHandled:o.value&&o.value.transientHandled||void 0,handled:o.value&&o.value.handled||!1}];}});});},ye=function ye(e,t){var n,r,o,a;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(Object(p.isEmpty)(e))return[2,{handled:!1,result:null}];n=e.slice(),r={handled:!1,transientHandled:!1,result:null},i.label=1;case 1:return o=n.shift(),[4,t(o)];case 2:if((a=i.sent())&&a.handled)return r.handled=!0,[3,3];a&&a.transientHandled&&(r.transientHandled=!0),n=o.children&&o.children.concat(n)||n,i.label=3;case 3:if(n.length)return[3,1];i.label=4;case 4:return[2,r];}});},_e=(n(817),function(e,t){var n=this;this._name=e,this._hooksEmitter=t,this._disposers=[],this._manualDisposalMap=new WeakMap(),this.disposeHooks=function(){n._disposers.forEach(function(e){return e();}),n._disposers=[];},this.invokeCommand=function(e){return n._dispatch(n._name,"Command",e);},this.insertElement=function(e,t){n._dispatch(n._name,"Element",{element:e,resolver:t});},this.insertText=function(e){n._dispatch(n._name,"Text",{text:e});},this.getSelection=function(e){return n._dispatch(n._name,"GetSelection",e);},this.setSelection=function(e){return n._dispatch(n._name,"SetSelection",e);},this.applyStyle=function(e,t){return n._dispatch(n._name,"ApplyStyle",{style:e,variableValues:t});},this.removeStyle=function(e,t){return n._dispatch(n._name,"RemoveStyle",{style:e,variableValues:t});},this.focusEditor=function(){return n._dispatch(n._name,"FocusEditor",void 0);},this.invokeExtension=function(e,t){return n._dispatch(n._name,"Extension",{name:e,args:t});},this.insertCard=function(e,t,r){return new Promise(function(o){n._dispatch(n._name,"Card",{name:e,props:t,id:r,onMount:o});});},this.onKeyDown=function(e,t){return n._onEvent("keyDown$",e,t);},this.onKeyUp=function(e,t){return n._onEvent("keyUp$",e,t);},this.onSelectionChanged=function(e,t){return n._onEvent("selectionChanged$",e,t);},this.onChange=function(e,t){return n._onEvent("change$",e,t);},this.onClick=function(e,t){return n._onEvent("click$",e,t);},this._dispatch=function(e,t,r){return n._hooksEmitter.next({name:e,hook:t,payload:r});},this._onEvent=function(e,t,r){void 0===r&&(r={});var o=r.dispose,i=r.onlyOnce,a=void 0!==i&&i;o&&n._disposers.push(o);var s=a?function(e){t(e),n._disposeHandler(t);}:t;return n._dispatch(n._name,"Event",{type:e,handler:s,trackForDispose:function trackForDispose(e){n._queueDisposeSub(e),n._manualDisposalMap.set(t,function(){return n._disposeSub(e);});}}),function(){return n._disposeHandler(t);};},this._disposeHandler=function(e){var t=n._manualDisposalMap.get(e);t&&(t(),n._manualDisposalMap.delete(e));},this._queueDisposeSub=function(e){return n._disposers.push(function(){return n._disposeSub(e);});},this._disposeSub=function(e){e.unsubscribe();};}),Oe=function Oe(e,t){return function(n){return Ce(e,n),t&&t(n),function(t){return Reflect.set(t,Symbol.for("ComposeFramework"),{config:n,type:e}),Object.defineProperty(t,"name",{value:n.name}),t;};};},Ce=function Ce(e,t){if(!t)throw new Error("Extension missing config");if(!e)throw new Error("Extension must specify component type");if(!t.name)throw new Error("Extension missing name");},we=(n(839),n(768)),je=function(){function e(e,t){var n=this;this.name=e,this._initialState=t,this.mutate=function(e){var t=n.current,r=Object(i.__assign)(Object(i.__assign)({},t),e(t));n._state.next(r);},this._state=new we.a(this._initialState),this._state$=this._state.asObservable();}return Object.defineProperty(e.prototype,"current",{get:function get(){return this._state.getValue();},enumerable:!0,configurable:!0}),e.prototype.observe=function(){return this._state$;},e.prototype.reset=function(){var e=this;this.mutate(function(){return e._initialState;});},e;}(),Se=n(125);function Ee(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t;}var Te,ke=function ke(e,t){return!!Ee(e,t)||null!=e&&null!=t&&(Array.isArray(e)&&Array.isArray(t)?Pe(e,t):Ie(e,t));},Pe=function Pe(e,t){if(e.length!==t.length)return!1;for(var n=e.length-1;n>=0;n--){if(!Ee(e[n],t[n]))return!1;}return!0;},Ie=function Ie(e,t){var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(var o=0,i=n;o<i.length;o++){var a=i[o];if(!Ee(e[a],t[a]))return!1;}return!0;},Ae=function(e){function t(t){var n=e.call(this,"extensions",{AsyncTransformer:new Map(),Autocomplete:new Map(),Block:new Map(),Bounded:new Map(),Card:new Map(),SideEffect:new Map(),PastedContent:new Map(),PastedFiles:new Map(),Transformer:new Map(),Word:new Map()})||this;return n._context=t,n.extensionCacheSet=[],n.hooksEmitter=new Se.a(),n;}return Object(i.__extends)(t,e),t.prototype.load=function(e){var t=this;if(Object(p.isEmpty)(e))return this.extensionCacheSet.forEach(function(e){e.disposeHooks();}),void(this.extensionCacheSet=[]);var n=[],r=Object(p.reduce)(e,function(r,o,a){var s,c=t.extensionCacheSet[a];return c&&Ee(e&&e[a],c.definition)?s=c.metadata:(c&&c.disposeHooks(),s=function(e,t,n){if(void 0===t&&(t={}),e){var r=Object(p.isArray)(e)?e:[e,{}],o=r[0],a=r[1],s=Reflect.get(o,Symbol.for("ComposeFramework"));if(!s)throw new Error("Extension not found - "+o.name);var c,d={};if(n){var u=new Set(s.config.hooks||[]);if(!Object(p.isEmpty)(u)){var l=new _e(s.config.name,n);c=l,u.forEach(function(e){var t;d=Object(i.__assign)(Object(i.__assign)({},d),((t={})[e]=Reflect.get(l,e),t));});}}return Object(i.__assign)(Object(i.__assign)({},s),{instance:Reflect.construct(o,[Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},a),t),{hooks:d})]),disposeHooks:c?c.disposeHooks:p.noop});}}(o,t._context,t.hooksEmitter)),n.push({definition:e&&e[a],metadata:s,disposeHooks:s&&s.disposeHooks||p.noop}),s?Object(i.__spreadArrays)(r,[s]):r;},[]);this.extensionCacheSet=n,this._updateStateWithLoadedExtension(r);},t.prototype.find=function(e,t){if(Object(p.isString)(t)){var n=this.current[e].get(t);return n&&!n.instance.isUnavailable?n:void 0;}if(Object(p.isFunction)(t))return this.values(e).find(t);if(Object(p.isObject)(t))return this.values(e).find(function(e){var n=e.instance;return n.canExecute&&n.canExecute(t);});throw new Error("Invalid predicate");},t.prototype.values=function(e){return Array.from(this.current[e].values()).filter(function(e){return!e.instance.isUnavailable;});},t.prototype._updateStateWithLoadedExtension=function(e){this.mutate(function(t){var n=t;return e.forEach(function(e){var t,r=n[e.type];r.set(e.config.name,e),n=Object(i.__assign)(Object(i.__assign)({},n),((t={})[e.type]=r,t));}),n;});},t;}(je),He=function He(e){return Oe("Transformer",function(e){if(!e.filter)throw new Error("Transformer "+e.name+" has no filter");})(e);},xe=function xe(e){return Oe("AsyncTransformer",function(e){if(!e.filter)throw new Error("AsyncTransformer "+e.name+" has no filter");})(e);},Ke=function Ke(e,t,n,r){return Object(i.__awaiter)(void 0,void 0,Promise,function(){var o;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return t.length?(o=ue(t,n),[4,ve(e,le(o,r))]):[2,e];case 1:return[2,i.sent().result||[]];}});});},Re=function Re(e,t,n,r){if(!t.length)return e;var o,i,a,s=ue(t,n);return function(e,t){var n=ae(e,"div"),r=ye(n.children,t),o={done:!1,value:void 0};do{o=r.next(o.value);}while(!o.done);return{result:ie(n.children),transientHandled:o.value&&o.value.transientHandled||void 0,handled:o.value&&o.value.handled||!1};}(e,(o=s,i=r,a=he(function(e,t){return{updated:t.result,result:t.result};},ge,!1),pe(o,a,i))).result||[];},De=function De(e,t){var n=new Ae(t);return n.load(e),n.values("Transformer");},Me=function Me(e,t){var n=new Ae(t);return n.load(e),n.values("Transformer").concat(n.values("AsyncTransformer"));},Ne=function Ne(e){return{preTransformers:e.filter(function(e){return void 0!==e.instance.preTransform;}),transformers:e.filter(function(e){return void 0!==e.instance.transform;})};},Le=ne("TransformAsync")(function(e,t,n,r){return Object(i.__awaiter)(void 0,void 0,Promise,function(){var o,a,s,c;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return!t||Object(p.isEmpty)(e)?[2,""]:(o=re.b.parseDOM(t),new Ae(n).load(e),a=Ne(Me(e,n)),s=a.preTransformers,c=a.transformers,[4,Ke(o,s,"preTransform",r)]);case 1:return o=i.sent(),[4,Ke(o,c,"transform",r)];case 2:return o=i.sent(),[2,re.b.DomUtils.getOuterHTML(o)];}});});}),Ue=(ne("Transform")(function(e,t,n,r){if(!t||Object(p.isEmpty)(e))return"";var o=re.b.parseDOM(t),i=Ne(De(e,n)),a=i.preTransformers,s=i.transformers;return o=Re(o,a,"preTransform",r),o=Re(o,s,"transform",r),re.b.DomUtils.getOuterHTML(o);}),ne("TransformToJsx")(function(e,t,n,r){if(!t)return null;if(Object(p.isEmpty)(e))return Object(re.a)(t);var o,i,a,s=Ne(De(e,n)),c=s.preTransformers,d=s.transformers,u=(o=ue(d,"transform"),i=r,a=he(function(e,t){return{updated:e,isReactElement:!0,result:t.result};},function(e,t){return 0===(t=Array.isArray(t)?t:[t]).length?{handled:!1,isReactElement:!0,result:null}:{handled:!0,isReactElement:!0,result:t[0]};},!1),pe(o,a,i));return Object(re.a)(t,{transform:function transform(e){return u(e).result;},preprocessNodes:function preprocessNodes(e){return Re(e,c,"preTransform",r);}});}),n(232)),Fe=n(220),Ve=n(234),Be=n(764),Ge=function Ge(e,t){var n=ne(e)(t);return function(t,r){return function(o){return o.pipe(Object(Be.a)(function(o){var i=n(t,r,o);return i instanceof Promise?Object(Ue.a)(i).pipe(Object(Be.a)(function(n){return We(e,n,o,t);})):We(e,i,o,t);}));};};},We=function We(e,t,n,r){return t?(r.newLogger(""+e).debug("handled the input.."),Fe.a):Object(Ve.a)(n);},$e=(Oe("Autocomplete"),function(){return Ge("AutocompleteKeyProcessor",function(e,t,n){if(!t.autocomplete.isInitialized)return!1;switch(n.type){case"keydown":return t.autocomplete.onKeyDown(n);case"keyup":var r=e.textHelper.getTextInRange(e.selectedRange);return t.autocomplete.onKeyUp(n,r);default:return!1;}});}),ze=n(3),qe=n(848),Je=n(887),Xe=n(904),Qe=n(889),Ye=n(37),Ze=n(209),et=function et(e){switch(e.keyCode){case Te.Shift:case Te.Alt:case Te.Ctrl:case Te.Meta:case Te.Win:case Te.End:case Te.Home:case Te.PageDown:case Te.PageUp:return!0;default:return!1;}};!function(e){e[e.Shift=16]="Shift",e[e.Ctrl=17]="Ctrl",e[e.Alt=18]="Alt",e[e.Win=91]="Win",e[e.Meta=93]="Meta",e[e.End=35]="End",e[e.Home=36]="Home",e[e.Left=37]="Left",e[e.Up=38]="Up",e[e.Right=39]="Right",e[e.Down=40]="Down",e[e.PageUp=33]="PageUp",e[e.PageDown=34]="PageDown",e[e.Tab=9]="Tab",e[e.Backspace=8]="Backspace",e[e.Enter=13]="Enter",e[e.Pause=19]="Pause",e[e.Esc=27]="Esc",e[e.Space=32]="Space",e[e.Print=44]="Print",e[e.Insert=45]="Insert",e[e.Delete=46]="Delete",e[e.Num0=48]="Num0",e[e.Num9=57]="Num9",e[e.A=65]="A",e[e.Z=90]="Z",e[e.NumPad0=96]="NumPad0",e[e.NumPad9=105]="NumPad9",e[e.Add=107]="Add",e[e.Divide=111]="Divide",e[e.SemiColon=186]="SemiColon",e[e.ForwardSlash=191]="ForwardSlash",e[e.OpenBracket=219]="OpenBracket",e[e.SingleQuote=222]="SingleQuote";}(Te||(Te={}));var tt,nt,rt,ot,it,at=function at(e,t){return function(n){var r=n.keyCode;return r>=e&&r<=t;};},st=(tt=[Te.Space,Te.Enter],function(e){var t=e.keyCode;return tt.some(function(e){return e===t;});}),ct=function ct(e){return at(Te.Num0,Te.Num9)(e)||e.getModifierState("NumLock")&&at(Te.NumPad0,Te.NumPad9)(e);},dt=at(Te.A,Te.Z),ut=function ut(e){return"autocomplete-picker-item"+e;},lt=function(e){function t(t,n){var r=e.call(this,"autocomplete",{items:[],extension:void 0,selectedIndex:-1,element:void 0})||this;return r._editor=t,r._context=n,r.selectItem=function(e){var t=r.current,n=t.items,o=t.extension,i=t.element,a=t.selectedIndex,s=e||n[a];if(s){r._logger.debug("selecting item...");var c=o.instance.onSelect(s,r.localText);r._editor.insertInEditor(c,i);}},r.reset=function(){e.prototype.reset.call(r),r._editor.setEditableAttribute("aria-controls",void 0),r._editor.setEditableAttribute("aria-expanded",void 0),r._editor.setEditableAttribute("aria-activedescendant",void 0),r._editor.setEditableAttribute("aria-autocomplete",void 0);},r._logger=r._editor.newLogger("AutocompleteState"),r.reset(),r;}return Object(i.__extends)(t,e),Object.defineProperty(t.prototype,"isInitialized",{get:function get(){return!!this.current.extension;},enumerable:!0,configurable:!0}),t.prototype.init=function(e,t){return Object(i.__awaiter)(this,void 0,void 0,function(){var n,r,o=this;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e.instance.execute(t)];case 1:return n=i.sent(),!this.isInitialized&&n&&n.length?(this._logger.debug("Initializing autocomplete...",e.config.name),r=this._editor.wrapTextWithElement(t),this.mutate(function(){return{extension:e,element:r};}),this._editor.mutations.onRemove(r.$,function(){return o.reset();}),this._updateItems(t),this.localText=t,this._editor.setEditableAttribute("aria-autocomplete","list"),[2]):[2];}});});},t.prototype.moveToNext=function(){this._logger.debug("moving selection to next item..."),this._moveSelection(!1);},t.prototype.moveToPrevious=function(){this._logger.debug("moving selection to previous item..."),this._moveSelection(!0);},t.prototype.onSelectionChanged=function(e){var t=this,n=e.selection;if(!e.path.elements.some(function(e){return e.tag===t.current.element.tag;})&&n){var r=this._editor.unwrapTextInElement(this.current.element),o=n.collapsed?void 0:{container:r,offset:n.end.offset};this._editor.selectRange(this._editor.createRange(n.start,o));}return!1;},t.prototype.onKeyDown=function(e){switch(e.keyCode){case Te.Up:case Te.Down:return e.keyCode===Te.Down?this.moveToNext():this.moveToPrevious(),e.cancel(),e.stop(),!0;case Te.Tab:case Te.Enter:return this.selectItem(),e.cancel(),e.stop(),!0;case Te.Esc:return this._editor.unwrapTextInElement(this.current.element),this.reset(),e.cancel(),e.stop(),!0;default:return!1;}},t.prototype.onKeyUp=function(e,t){switch(e.keyCode){case Te.Delete:case Te.Backspace:case Te.Space:return this._updateItems(t),!0;default:return!(!dt(e)&&!ct(e))&&(this._updateItems(t),!0);}},t.prototype._updateItems=function(e){return Object(i.__awaiter)(this,void 0,Promise,function(){var t,n,r,o=this;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return t=this.current.extension,e?[4,Promise.resolve(t.instance.execute(e))]:[2];case 1:return n=i.sent(),Object(p.isEmpty)(n)?(this._editor.unwrapTextInElement(this.current.element),this._context.ariaLiveContext&&Object(p.delay)(function(){o._context.ariaLiveContext.announce(o._context.i18n.stringTranslate("compose","people_noResults"));},200),[2]):(this._editor.setEditableAttribute("aria-controls","autocomplete-picker-list"),this._editor.setEditableAttribute("aria-expanded","true"),this._editor.setEditableAttribute("aria-activedescendant",ut(0)),r=Object(p.first)(n),this.mutate(function(){return{items:n,selectedIndex:0,selectedItem:r};}),[2]);}});});},t.prototype._moveSelection=function(e){var t=this;this._logger.debug("selecting previous..."),this.mutate(function(n){var r=Object(p.clamp)(n.selectedIndex+(e?-1:1),0,Object(p.size)(n.items)-1);return t._editor.setEditableAttribute("aria-activedescendant",ut(r)),{selectedIndex:r,selectedItem:n.items&&n.items[r]};});},t;}(je),ft=function(e){function t(){return e.call(this,"events",{beforePaste$:!0,paste$:!0,keyUp$:!0,change$:!0,click$:!0,keyDown$:!0,afterPaste$:!1,input$:!0,selectionChanged$:!0})||this;}return Object(i.__extends)(t,e),t.prototype.on=function(e){return this.mutate(function(t){var n;return Object(i.__assign)(Object(i.__assign)({},t),((n={})[e]=!0,n));}),this;},t.prototype.off=function(e){return this.mutate(function(t){var n;return Object(i.__assign)(Object(i.__assign)({},t),((n={})[e]=!1,n));}),this;},t;}(je),pt=ze.createContext({id:void 0,store:void 0,disabled:!1,composeContext:void 0}),ht=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._subscription=Ye.a.EMPTY,t;}return Object(i.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this,t=this.props,n=t.state,r=t.storeStateToPropsMap;this._subscription=n.observe().pipe(Object(Ze.a)(function(t){return r(t,e._externalProps);})).subscribe(this.setState.bind(this));},t.prototype.componentDidUpdate=function(e){if(this.props!==e){var t=this.props,n=t.state,r=t.storeStateToPropsMap;this.setState(r(n.current,this._externalProps));}},t.prototype.componentWillUnmount=function(){this._subscription.closed||this._subscription.unsubscribe();},t.prototype.render=function(){if(!this.state)return null;var e=this.props,t=e.state,n=e.storeToActionsMap,r=e.WrappedComponent,o=n&&n(t,this._externalProps);return ze.createElement(r,Object(i.__assign)({},this._externalProps,this.state,o));},Object.defineProperty(t.prototype,"_externalProps",{get:function get(){var e=this.props;e.storeStateToPropsMap,e.storeToActionsMap,e.state,e.WrappedComponent;return Object(i.__rest)(e,["storeStateToPropsMap","storeToActionsMap","state","WrappedComponent"]);},enumerable:!0,configurable:!0}),t;}(ze.PureComponent),mt=n(925),gt=function gt(e,t){void 0===t&&(t=ke);var n=ze.useRef(e);return t(n.current,e)||(n.current=e),n.current;},bt=function bt(e,t){var n=ze.useContext(pt).store,r=gt(t),o=ze.useMemo(function(){return n&&new _e(e,n.extensions.hooksEmitter);},[n,e]),a=ze.useMemo(function(){var e={};return r.forEach(function(t){var r;e=Object(i.__assign)(Object(i.__assign)({},e),((r={})[t]=n?o[t]:p.noop,r));}),e;},[n,r,o]);return gt(a);},vt=n(236),yt=function(e){function t(t){var n=e.call(this,t)||this;return n._onItemSelected=function(e){var t=n.props,r=t.item,o=t.onClick;o&&o(r);},n._ensureVisibleIfSelected=function(){n.props.isSelected&&Object(vt.findDOMNode)(n).scrollIntoView(!1);},n;}return Object(i.__extends)(t,e),t.prototype.componentDidMount=function(){this._ensureVisibleIfSelected();},t.prototype.componentDidUpdate=function(){this._ensureVisibleIfSelected();},t.prototype.render=function(){var e=this.props,t=e.item,n=e.isSelected,r=e.styleVariables,o=e.index,a=t.ariaLabel,s=(t.displayText,Object(i.__rest)(t,["ariaLabel","displayText"]));return ze.createElement(Xe.a.Item,Object(i.__assign)({},s,{onClick:this._onItemSelected,selectable:!0,selected:n,id:ut(o),"aria-label":a,variables:Object(i.__assign)({isAutocomplete:!0},r)}));},t;}(ze.PureComponent),_t=function _t(e){var t=e.title,n=e.footer,r=e.items,o=e.selectedIndex,a=e.onSelect,s=e.name,c=e.styleVariables,d=e.updatePosition,u=bt(s,["focusEditor"]).focusEditor,l=ze.useRef(a),f=ze.useCallback(function(e){u(),l.current(e);},[u]);return ze.useLayoutEffect(d,[d,r.length]),ze.createElement(Je.a,{column:!0,variables:{isAutocomplete:!0},"data-tid":"AutocompletePopup-"+s},ze.createElement(Je.a.Item,null,Ot({styleVariables:c,title:t})),ze.createElement(Je.a.Item,null,ze.createElement(Xe.a,{variables:Object(i.__assign)({customScrollbar:!0},c),id:"autocomplete-picker-list","aria-label":t,selectable:!0},Object(p.map)(r,function(e,t){return ze.createElement(yt,{key:e.key,onClick:f,item:e,index:t,isSelected:t===o,styleVariables:c});}))),n&&ze.createElement(Je.a.Item,null,n));},Ot=function Ot(e){var t=e.styleVariables,n=e.title;return ze.createElement(Qe.a,{as:"h3",content:n,variables:Object(i.__assign)({isAutocomplete:!0},t)});},Ct=(nt="autocomplete",rt=function rt(e){var t=e.items,n=e.extension,r=e.element,o=e.selectedIndex;return Object(i.__assign)({items:t,selectedIndex:o,element:r&&r.$,isOpen:!Object(p.isEmpty)(t)},function(e){if(!e)return{title:"",name:"",footer:void 0};var t=e.config,n=t.footer,r=t.name,o=t.styleVariables;return{title:e.instance.title||"",footer:n,name:r,styleVariables:o};}(n));},ot=function ot(e){return{onSelect:e.selectItem,onClose:e.reset};},function(e){return function(t){return ze.createElement(pt.Consumer,null,function(n){var r=n.store,o=n.disabled,a=n.composeContext;return r&&ze.createElement(ht,Object(i.__assign)({state:r[nt],storeStateToPropsMap:rt,storeToActionsMap:ot,WrappedComponent:e},{disabled:o,composeContext:a},t));});};})(function(e){var t=e.element,n=e.isOpen,r=e.onClose,o=ze.useCallback(function(e,t){!t.open&&r();},[r]),a=ze.useCallback(function(t){return{content:ze.createElement(_t,Object(i.__assign)({},e,{updatePosition:t})),variables:{removePopupContentPadding:!0,hasNoBorder:!0}};},[e]);return t?ze.createElement(qe.a,{target:t,open:n,onOpenChange:o,renderContent:a,variables:{isAutocomplete:!0}}):null;}),wt=(Oe("Block"),function(e,t,n,r){return void 0===r&&(r=!1),e.textHelper.executeOnCollapsedRange(t,function(){var o=e.createPath(t.start.container,t.root),i=new Set(Object(p.map)(o.elements,function(e){return e.tag;})),a=i.size;return!(r&&a>2)&&!i.has(n);});}),jt=function jt(e,t,n){var r=e.getStartElement(),o=r.getHtml();return t.setHtml(o),t.insertBefore(r),r.remove(),n.selectNode(t),e;},St=function St(e,t,n){var r=e.getStartElement(),o=t.length>0?n.textHelper.shrinkToInnerMostElementNode(e,t):t;return t.insertBefore(r),r.appendTo(o),n.selectNode(r),r;},Et=(Oe("Bounded",function(e){if(e.delimiter.end||(e.delimiter.end=e.delimiter.start),1!==e.delimiter.start.length)throw new Error("Start delimiter for "+e.name+" must be exactly one character");if(1!==e.delimiter.end.length)throw new Error("End delimiter for "+e.name+" must be exactly one character");}),function(e,t){var n=e.selectedRange;if(!n)return!1;var r=n.start,o=r.container,i=r.offset;return t&&e.textHelper.isCharacterABoundary({container:o,offset:i-1},t.config.delimiter.start);}),Tt=function Tt(e,t,n,r){var o=e.selectedRange;if(!o)return!1;var i=o.clone();return i.move(-2),n&&e.walker.walk(o.start,"CHARACTER",kt(e,t,"FORWARDS"),"FORWARDS")||r&&e.walker.walk(i.start,"CHARACTER",kt(e,t,"BACKWARDS"),"BACKWARDS");},kt=function kt(e,t,n){return void 0===n&&(n="FORWARDS"),function(r,o,i){var a=e.selectedRange,s="FORWARDS"===n?t.config.delimiter.end:t.config.delimiter.start;if(!a||s!==r||!e.textHelper.isCharacterABoundary({container:o,offset:i},s)||a.isParentForbidden())return!1;var c,d=a.start;"BACKWARDS"===n?((c=e.createRange({container:o,offset:i},d)).moveStart(1),c.moveEnd(-1)):c=e.createRange(d,{container:o,offset:i});var u=c.cloneContents();if(!u.getText())return!1;var l=t.instance.canExecute(u);if(!l)return!1;var f=t.instance.execute(u,l);if(t.config.tag&&c.path.elements.some(function(e){return e.tag===t.config.tag;}))return!1;return Pt(e,c,f,n),!0;};},Pt=function Pt(e,t,n,r){var o=e.selectedRange;if(o){e.save(),e.lockUndo();var i=o.start;if(t.extractContents(),o=e.selectedRange){var a=e.createRange(o.start);"BACKWARDS"===r?a.moveStart(-2):(a.moveStart(-1),a.moveEnd(1)),a.extractContents();}var s=e.createFromHtml(n);if(e.insertElement(s),"FORWARDS"===r){var c=e.createRange({container:i.container,offset:i.offset-1});e.selectRange(c);}e.unlockUndo();}},It=function It(e,t,n,r,o){return Object(i.__awaiter)(void 0,void 0,Promise,function(){var a,s,c,d,u,l,f;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return s=e.newLogger("InsertCard"),(c=t.extensions.find("Card",n))?(o?a=e.mutations.find('card[itemid="'+o+'"]'):(o=Object(h.v4)().replace(/-/g,""),(d=e.createFromTag("card")).setAttribute("contenteditable","false"),d.setAttribute("itemscope",c.config.name),d.setAttribute("itemid",o),At(e,d),a=d.$),a?[4,c.instance.serializeProps(r)]:[2,void 0]):(s.error("Couldn't find card with name: "+n),[2,void 0]);case 1:return u=i.sent()||{},a.setAttribute("data-itemprops",JSON.stringify(u)),[4,c.instance.insert(r,o)];case 2:return(l=i.sent())?(vt.render(l,a),f=e.mutations.onRemove(a,function(){return vt.unmountComponentAtNode(a);}),e.mutations.onAdd(f,function(){return It(e,t,n,r,o);}),[2,o]):[2];}});});},At=function At(e,t){try{var n=e.selectedRange;if(!n)throw new Error("no selected range to insert");var r=e.createPath(n.getStartElement()),o=Object(p.reverse)(r.elements).find(function(e){return!!CKEDITOR.dtd.$list[e.tag];});o?(t.insertAfter(o),e.save()):e.insertElement(t);}catch(n){e.newLogger("InsertCardWrapper").error("We failed to insert the wrapper at the specified location, defaulting to the end instead."),e.insertElement(t);}},Ht=ne("InsertCard")(It),xt=ne("UpcastCard")(function(e,t,n){e.mutations.query("card",function(r){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var o,a,s,c;return Object(i.__generator)(this,function(i){return o=r.getAttribute("itemscope")||void 0,a=Object(p.unescape)(r.getAttribute("data-itemprops")||void 0),s=r.getAttribute("itemid"),o&&a&&s?((c=JSON.parse(a)).context=n,[2,It(e,t,o,c,s)]):[2];});});});}),Kt=(n(1123),n(949),n(872)),Rt=function Rt(e){e.stopPropagation(),e.preventDefault();},Dt=(ze.memo(function(e){e.ariaLiveContext,e.coreSettings,e.i18n,e.loggerFactory,e.isPlaintext,e.dataTidPrefix;var t=e.tag,n=e.dataTid,r=e.icon,o=e.onClick,a=e.active,s=e.content,c=e.disabled,d=e.hidden,u=e.as,l=void 0===u?Kt.a:u,f=Object(i.__rest)(e,["ariaLiveContext","coreSettings","i18n","loggerFactory","isPlaintext","dataTidPrefix","tag","dataTid","icon","onClick","active","content","disabled","hidden","as"]),h=f.name,m=function(e){return ze.useCallback(function(t,n){t.preventDefault(),t.nativeEvent.stopImmediatePropagation(),e&&e(t,n);},[e]);}(o),g=ze.useState(!1),b=g[0],v=g[1],y=bt(h,["onSelectionChanged","getSelection"]),_=y.onSelectionChanged;return function(e,t,n,r){void 0===e&&(e=!1),ze.useEffect(function(){!e&&t&&n(function(e){return e&&r(!!e.path.elements.find(function(e){return Object(p.isString)(t)?e.tag===t:!Object(p.isEmpty)(e.tag.match(t));}));});},[e,t,n,r]);}(d,t,y.getSelection,v),function(e,t,n,r){void 0===e&&(e=!1),ze.useEffect(function(){if(!e&&t)return n(function(e){return r(!!e.path.elements.find(function(e){return Object(p.isString)(t)?e.tag===t:!Object(p.isEmpty)(e.tag.match(t));}));});},[e,t,n,r]);}(d,t,_,v),d?null:ze.createElement(l,Object(i.__assign)({key:h,icon:r&&{name:r,outline:!0},"data-tid":n||h,disabled:c,active:a||b,content:s||f.title,onClick:m,onMouseDown:Rt},f));}),function(){function e(e,t){this.char=e,this.modifiers=t;}return e.prototype.isMatching=function(e,t){return e.ctrlKey===this.isCtrl&&e.altKey===this.isAlt&&e.shiftKey===this.isShift&&e.metaKey===this.isMeta&&t===this.character;},Object.defineProperty(e.prototype,"isCtrl",{get:function get(){return this.modifiers.hasOwnProperty("ctrl");},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShift",{get:function get(){return this.modifiers.hasOwnProperty("shift");},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAlt",{get:function get(){return this.modifiers.hasOwnProperty("alt")||this.modifiers.hasOwnProperty("option");},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isMeta",{get:function get(){return this.modifiers.hasOwnProperty("meta")||this.modifiers.hasOwnProperty("cmd")||this.modifiers.hasOwnProperty("command");},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"character",{get:function get(){return this.char;},enumerable:!0,configurable:!0}),e;}()),Mt={modifiers:["ctrl","shift","alt","meta","cmd","option","command"],nonPrintableCharacterMap:{backspace:{code:[8],key:["Backspace"],value:"backspace"},tab:{code:[9],key:["Tab"],value:"tab"},enter:{code:[13],key:["Enter"],value:"enter"},shift:{code:[16],key:["Shift"],value:"shift"},ctrl:{code:[17],key:["Ctrl"],value:"ctrl"},alt:{code:[18],key:["Alt"],value:"alt"},capslock:{code:[20],key:["CapsLock"],value:"capslock"},esc:{code:[27],key:["Escape","Esc"],value:"esc"},space:{code:[32],key:["Spacebar"," "],value:"space"},pageup:{code:[33],key:["PageUp"],value:"pageup"},pagedown:{code:[34],key:["PageDown"],value:"pagedown"},end:{code:[35],key:["End"],value:"end"},home:{code:[36],key:["Home"],value:"home"},left:{code:[37],key:["ArrowLeft","Left"],value:"left"},up:{code:[38],key:["ArrowUp","Up"],value:"up"},right:{code:[39],key:["ArrowRight","Right"],value:"right"},down:{code:[40],key:["ArrowDown","Down"],value:"down"},insert:{code:[45],key:["Insert"],value:"insert"},del:{code:[46],key:["Delete","Del"],value:"del"},meta:{code:[91,93,224],key:["Meta"],value:"meta"},f1:{code:[112],key:["F1"],value:"f1"},f4:{code:[115],key:["F4"],value:"f4"},f6:{code:[117],key:["F6"],value:"f6"},f10:{code:[121],key:["F10"],value:"f10"}},specialCharactersMap:{106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",115:"f4",117:"f6",121:"f10",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}},Nt=function(){function e(e,t,n,r){this.aHotkey=e,this.anArea=t,this.aCommandId=n,this.aDescription=r,this.handler=void 0;}return Object.defineProperty(e.prototype,"hotkey",{get:function get(){return this.aHotkey;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"area",{get:function get(){return this.anArea;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"commandId",{get:function get(){return this.aCommandId;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"description",{get:function get(){return this.aDescription;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"assignedHandler",{get:function get(){return this.handler;},enumerable:!0,configurable:!0}),e.prototype.assignHandler=function(e){this.handler=e;},e.prototype.unassignHandler=function(e){return this.handler===e&&(this.handler=void 0,!0);},e.prototype.reassignHotkey=function(e){this.aHotkey=e;},e.prototype.getKeyInfo=function(t){return void 0===t&&(t=0),e.convertHotkeyToKeyInfo(this.hotkey[t]);},e.prototype.getKeyInfos=function(){return this.hotkey.map(function(t){return e.convertHotkeyToKeyInfo(t);});},e.splitHotkey=function(e){for(var t,n=[],r="",o=0;o<e.length;++o){"+"!==(t=e.charAt(o))?r=r.concat(t):""!==r?(n.push(r),r=""):r="+";}return""!==r&&n.push(r),n;},e.convertHotkeyToKeyInfo=function(t){var n=e.splitHotkey(t),r=n.filter(function(e){return Mt.modifiers.indexOf(e.toLowerCase())>=0;}).reduce(function(e,t){var n;return Object(p.assign)(e,((n={})[t.toLowerCase()]=!0,n));},{}),o=n.filter(function(e){return Mt.modifiers.indexOf(e.toLowerCase())<0;});if(1!==o.length)throw new Error("The hotkey character is not specified.");return new Dt(o[0],r);},e;}(),Lt=function(){function e(){this.modifier="alt",this.keyMaps=[],this.originalKeyMaps=[],this.commandIdToAreaDescription=new Map(),this.isVirtualStrategy=!1,this.keyMaps=[],this.addCommandIdToAreaDescription("ShowShortcuts",["Global"],"shortcut_show_shortcuts"),this.addCommandIdToAreaDescription("GoToPowerBar",["Global"],"shortcut_go_to_search"),this.addCommandIdToAreaDescription("NewChat",["Global"],"shortcut_compose_new"),this.addCommandIdToAreaDescription("OpenSettingsMenu",["Global"],"shortcut_open_settings"),this.addCommandIdToAreaDescription("OpenHelp",["Global"],"shortcut_open_help"),this.addCommandIdToAreaDescription("NextLandmark",["Global"],"shortcut_next_landmark"),this.addCommandIdToAreaDescription("PreviousLandmark",["Global"],"shortcut_previous_landmark"),this.addCommandIdToAreaDescription("SlashCommands",["Global"],"shortcut_open_all_slash_commands"),this.addCommandIdToAreaDescription("SlashCommandGoto",["Global"],"shortcut_jump_to_goto_slash_command"),this.addCommandIdToAreaDescription("InvokeCortana",["Global"],"shortcut_invoke_cortana"),this.addCommandIdToAreaDescription("Escape",["Global"],"shortcut_esc_general"),this.addCommandIdToAreaDescription("NextLeftRailItem",["Global"],"shortcut_next_left_rail_item"),this.addCommandIdToAreaDescription("PreviousLeftRailItem",["Global"],"shortcut_previous_left_rail_item"),this.addCommandIdToAreaDescription("ReorderTeamsUp",["Global"],"shortcut_reorder_teams_up"),this.addCommandIdToAreaDescription("ReorderTeamsDown",["Global"],"shortcut_reorder_teams_down"),this.addCommandIdToAreaDescription("ComposeFull",["ChatList","ChatPanel"],"shortcut_chat_compose_full"),this.addCommandIdToAreaDescription("UploadFile",["ChatList","ChatPanel"],"shortcut_chat_upload_file"),this.addCommandIdToAreaDescription("UploadFileChannel",["ChannelList","ChannelPanel"],"shortcut_channel_upload_file"),this.addCommandIdToAreaDescription("Compose",["ChatPanel"],"shortcut_chat_compose"),this.addCommandIdToAreaDescription("ComposeChannel",["ChannelPanel"],"shortcut_channel_compose"),this.addCommandIdToAreaDescription("SendFromExpandedCompose",["ChatPanel"],"shortcut_send_from_expanded_box"),this.addCommandIdToAreaDescription("ComposeFullChannel",["ChannelList","ChannelPanel"],"shortcut_channel_compose_full"),this.addCommandIdToAreaDescription("ReplyChannel",["ChannelPanel"],"shortcut_channel_reply"),this.addCommandIdToAreaDescription("NewLine",["ChannelPanel","ChatPanel"],"shortcut_start_new_line"),this.addCommandIdToAreaDescription("PageUp",["ChatPanel"],"shortcut_page_up"),this.addCommandIdToAreaDescription("PageDown",["ChatPanel"],"shortcut_page_down"),this.addCommandIdToAreaDescription("SelectAll",["ChatPanel"],"shortcut_select_all"),this.addCommandIdToAreaDescription("SelectPrevious",["ChatPanel"],"shortcut_select_previous"),this.addCommandIdToAreaDescription("SelectNext",["ChatPanel"],"shortcut_select_next"),this.addCommandIdToAreaDescription("CallingScreenToggleFullScreen",["CallingScreen"],"shortcut_calling_screen_toggle_full_screen"),this.addCommandIdToAreaDescription("ToggleSharingToolbar",["CallingScreen"],"shortcut_focus_to_sharing_toolbar"),this.addCommandIdToAreaDescription("StartAudioCallInChat",["ChatPanel"],"shortcut_chat_start_call_audio"),this.addCommandIdToAreaDescription("StartVideoCallInChat",["ChatPanel"],"shortcut_chat_start_call_video"),this.addCommandIdToAreaDescription("StartScreenShareInChat",["ChatPanel"],"shortcut_chat_start_screenshare_only_call"),this.addCommandIdToAreaDescription("AcceptIncomingCallWithAudio",["Global"],"shortcut_accept_incoming_call_with_audio"),this.addCommandIdToAreaDescription("AcceptIncomingCallWithVideo",["Global"],"shortcut_accept_incoming_call_with_video"),this.addCommandIdToAreaDescription("AcceptIncomingScreenshareOnlyCall",["Global"],"shortcut_accept_incoming_screenshare_only_call"),this.addCommandIdToAreaDescription("RejectIncomingCall",["Global"],"shortcut_reject_incoming_call"),this.addCommandIdToAreaDescription("RejectIncomingScreenshareOnlyCall",["Global"],"shortcut_reject_incoming_screenshare_only_call"),this.addCommandIdToAreaDescription("ToggleMuteCurrentCall",["Global"],"shortcut_toggle_mute"),this.addCommandIdToAreaDescription("ToggleVideoCurrentCall",["Global"],"shortcut_toggle_video"),this.addCommandIdToAreaDescription("ToggleBackgroundBlurCurrentCall",["Global"],"shortcut_toggle_backgroundblur"),this.addCommandIdToAreaDescription("AdmitLobbyParticipant",["Global"],"shortcut_admit_lobby_participant"),this.addCommandIdToAreaDescription("CalendarGotoCurrentTime",["Calendar"],"shortcut_calendar_current_time"),this.addCommandIdToAreaDescription("CalendarNextView",["Calendar"],"shortcut_calendar_next_view"),this.addCommandIdToAreaDescription("CalendarPreviousView",["Calendar"],"shortcut_calendar_prev_view"),this.addCommandIdToAreaDescription("CalendarDayView",["Calendar"],"shortcut_calendar_day_view"),this.addCommandIdToAreaDescription("CalendarWorkWeekView",["Calendar"],"shortcut_calendar_work_week_view"),this.addCommandIdToAreaDescription("CalendarWeekView",["Calendar"],"shortcut_calendar_week_view"),this.addCommandIdToAreaDescription("CalendarNewMeeting",["Calendar"],"shortcut_calendar_new_meeting"),this.addCommandIdToAreaDescription("CalendarSchedulingFormSaveMeeting",["CalendarSchedulingForm"],"shortcut_calendar_scheduling_form_save_meeting"),this.addCommandIdToAreaDescription("CalendarSchedulingFormJoinMeeting",["CalendarSchedulingForm"],"shortcut_calendar_scheduling_form_join_meeting"),this.addCommandIdToAreaDescription("CalendarSchedulingFormSuggestedTime",["CalendarSchedulingForm"],"shortcut_calendar_scheduling_form_suggested_time"),this.addCommandIdToAreaDescription("DownloadDiagnosticLogs",["Global"],"shortcut_download_logs"),this.addCommandIdToAreaDescription("DebugUIElements",["Global"],"shortcut_show_debug_elements"),this.addCommandIdToAreaDescription("ShowGrid",["Global"],"shortcut_show_grid"),this.addCommandIdToAreaDescription("LiveSiteDebugging",["Global"],"shortcut_live_site_debug"),this.addCommandIdToAreaDescription("PageLoadStatus",["Global"],"shortcut_show_page_load"),this.addCommandIdToAreaDescription("ShowDiagnosticWindow",["Global"],"shortcut_show_diag_window"),this.addCommandIdToAreaDescription("ShowPerformanceDashboard",["Global"],"shortcut_show_perf_dashboard"),this.addCommandIdToAreaDescription("PurgeMemory",["Global"],"shortcut_purge_memory"),this.addCommandIdToAreaDescription("ContextMenu",["ChatPanel"],"shortcut_context_menu"),this.addCommandIdToAreaDescription("ContextMenuChannel",["ChannelPanel"],"shortcut_context_menu"),this.addCommandIdToAreaDescription("Heading1",["ChatPanel","ChannelPanel"],"shortcut_compose_format_heading1"),this.addCommandIdToAreaDescription("Heading2",["ChatPanel","ChannelPanel"],"shortcut_compose_format_heading2"),this.addCommandIdToAreaDescription("Heading3",["ChatPanel","ChannelPanel"],"shortcut_compose_format_heading3"),this.addCommandIdToAreaDescription("Paragraph",["ChatPanel","ChannelPanel"],"shortcut_compose_format_paragraph"),this.addCommandIdToAreaDescription("BlockQuote",["ChatPanel","ChannelPanel"],"shortcut_compose_format_blockquote"),this.addCommandIdToAreaDescription("Code",["ChatPanel","ChannelPanel"],"shortcut_compose_format_code"),this.addCommandIdToAreaDescription("AddRedbang",["ChatPanel","ChannelPanel"],"shortcut_mark_message_important"),this.addCommandIdToAreaDescription("InsertHyperlink",["ChatPanel","ChannelPanel"],"shortcut_insert_hyperlink"),this.addCommandIdToAreaDescription("InsertTableColRow",["ChatPanel","ChannelPanel"],"shortcut_insert_table_col_row"),this.addCommandIdToAreaDescription("RemoveTableColRow",["ChatPanel","ChannelPanel"],"shortcut_remove_table_col_row");}return e.prototype.getAllKeymaps=function(){return this.keyMaps;},e.prototype.getModifier=function(){return this.modifier;},e.prototype.getGlobalKeymaps=function(){return this.keyMaps.filter(function(e){return"Global"===e.area;});},e.prototype.getAreaKeymaps=function(e){return this.keyMaps.filter(function(t){return t.area===e;});},e.prototype.getCommandKeymap=function(e){return Object(p.find)(this.keyMaps,function(t){return t.commandId===e;});},e.prototype.setVirtualShortcutStrategy=function(e){var t=this;if(!this.isVirtualStrategy){var n=[];this.originalKeyMaps=this.keyMaps,e&&e.forEach(function(e){var r=t.getCommandKeymap(e);r&&n.push(r);}),this.keyMaps=n,this.isVirtualStrategy=!0;}},e.prototype.resetStrategy=function(){this.isVirtualStrategy&&(this.keyMaps=this.originalKeyMaps,this.isVirtualStrategy=!1);},e.prototype.addHotKey=function(e,t){var n=this.commandIdToAreaDescription.get(t);if(n)for(var r=0,o=n.areas;r<o.length;r++){var i=o[r];this.keyMaps.push(new Nt(e,i,t,n.description));}},e.prototype.reassignModifier=function(e){this.modifier=e;},e.prototype.reassignHotkey=function(e,t){var n=Object(p.find)(this.keyMaps,function(e){return e.commandId===t;});if(!n)throw new Error("The command "+t+" not registered in the strategy.");n.reassignHotkey(e);},e.prototype.removeHotkey=function(e){Object(p.remove)(this.keyMaps,function(t){return t.commandId===e;});},e.prototype.addCommandIdToAreaDescription=function(e,t,n){this.commandIdToAreaDescription.set(e,{areas:t,description:n});},e;}(),Ut=function(e){function t(){return e.call(this)||this;}return Object(i.__extends)(t,e),t;}(Lt),Ft=function(e){function t(t){var n=e.call(this)||this;return n.reassignModifier("cmd"),n.addHotKey(["cmd+."],"ShowShortcuts"),n.addHotKey(["alt+/"],"ShowShortcuts"),n.addHotKey(["cmd+e"],"GoToPowerBar"),n.addHotKey(["cmd+/"],"SlashCommands"),n.addHotKey(["cmd+g"],"SlashCommandGoto"),n.addHotKey(["cmd+n"],"NewChat"),n.addHotKey(["cmd+,"],"OpenSettingsMenu"),n.addHotKey(["f1"],"OpenHelp"),n.addHotKey(["option+c"],"InvokeCortana"),n.addHotKey(["esc"],"Escape"),n.addHotKey(["option+up"],"PreviousLeftRailItem"),n.addHotKey(["option+down"],"NextLeftRailItem"),n.addHotKey(["cmd+shift+up"],"ReorderTeamsUp"),n.addHotKey(["cmd+shift+down"],"ReorderTeamsDown"),n.addHotKey(["cmd+shift+f6"],"PreviousLandmark"),n.addHotKey(["cmd+f6"],"NextLandmark"),n.addHotKey(["c"],"Compose"),n.addHotKey(["c"],"ComposeChannel"),n.addHotKey(["cmd+shift+x"],"ComposeFull"),n.addHotKey(["cmd+shift+x"],"ComposeFullChannel"),n.addHotKey(["cmd+enter"],"SendFromExpandedCompose"),n.addHotKey(["cmd+o"],"UploadFile"),n.addHotKey(["cmd+o"],"UploadFileChannel"),n.addHotKey(["r"],"ReplyChannel"),n.addHotKey(["shift+enter"],"NewLine"),n.addHotKey(["pageup"],"PageUp"),n.addHotKey(["pagedown"],"PageDown"),n.addHotKey(["cmd+a"],"SelectAll"),n.addHotKey(["shift+up"],"SelectPrevious"),n.addHotKey(["shift+down"],"SelectNext"),n.addHotKey(["cmd+shift+space"],"ToggleSharingToolbar"),n.addHotKey(["cmd+shift+a"],"AcceptIncomingCallWithVideo"),n.addHotKey(["cmd+shift+a"],"AcceptIncomingScreenshareOnlyCall"),n.addHotKey(["cmd+shift+s"],"AcceptIncomingCallWithAudio"),n.addHotKey(["cmd+shift+d"],"RejectIncomingCall"),n.addHotKey(["cmd+shift+d"],"RejectIncomingScreenshareOnlyCall"),n.addHotKey(["cmd+shift+c"],"StartAudioCallInChat"),n.addHotKey(["cmd+shift+e"],"StartScreenShareInChat"),n.addHotKey(["cmd+shift+u"],"StartVideoCallInChat"),n.addHotKey(["cmd+shift+m"],"ToggleMuteCurrentCall"),n.addHotKey(["cmd+shift+o"],"ToggleVideoCurrentCall"),n.addHotKey(["cmd+shift+f"],"CallingScreenToggleFullScreen"),n.addHotKey(["cmd+shift+p"],"ToggleBackgroundBlurCurrentCall"),n.addHotKey(["cmd+shift+l"],"AdmitLobbyParticipant"),n.addHotKey(["option+."],"CalendarGotoCurrentTime"),n.addHotKey(["ctrl+option+left"],"CalendarPreviousView"),n.addHotKey(["ctrl+option+right"],"CalendarNextView"),n.addHotKey(["cmd+option+1"],"CalendarDayView"),n.addHotKey(["cmd+option+2"],"CalendarWorkWeekView"),n.addHotKey(["cmd+option+3"],"CalendarWeekView"),n.addHotKey(["option+shift+n"],"CalendarNewMeeting"),n.addHotKey(["cmd+s"],"CalendarSchedulingFormSaveMeeting"),n.addHotKey(["option+shift+j"],"CalendarSchedulingFormJoinMeeting"),n.addHotKey(["option+shift+s"],"CalendarSchedulingFormSuggestedTime"),n.addHotKey(["cmd+option+shift+1"],"DownloadDiagnosticLogs"),t||(n.addHotKey(["cmd+option+shift+2"],"DebugUIElements"),n.addHotKey(["cmd+option+shift+4"],"ShowGrid"),n.addHotKey(["cmd+option+shift+5"],"LiveSiteDebugging"),n.addHotKey(["cmd+option+shift+6"],"PageLoadStatus"),n.addHotKey(["cmd+option+shift+8"],"ShowDiagnosticWindow"),n.addHotKey(["cmd+option+shift+9"],"ShowPerformanceDashboard"),n.addHotKey(["cmd+option+shift+p"],"PurgeMemory")),n.addHotKey(["shift+f10"],"ContextMenu"),n.addHotKey(["cmd+option+1"],"Heading1"),n.addHotKey(["cmd+option+2"],"Heading2"),n.addHotKey(["cmd+option+3"],"Heading3"),n.addHotKey(["cmd+option+4"],"BlockQuote"),n.addHotKey(["cmd+option+5"],"Code"),n.addHotKey(["cmd+option+p"],"Paragraph"),n.addHotKey(["cmd+shift+i"],"AddRedbang"),n.addHotKey(["cmd+k"],"InsertHyperlink"),n.addHotKey(["cmd+option++"],"InsertTableColRow"),n.addHotKey(["cmd+option+-"],"RemoveTableColRow"),n;}return Object(i.__extends)(t,e),t;}(Lt),Vt=function(e){function t(t){var n=e.call(this)||this;return n.reassignModifier("cmd+shift"),n.addHotKey(["cmd+."],"ShowShortcuts"),n.addHotKey(["alt+/"],"ShowShortcuts"),n.addHotKey(["cmd+e"],"GoToPowerBar"),n.addHotKey(["cmd+/"],"SlashCommands"),n.addHotKey(["cmd+shift+g"],"SlashCommandGoto"),n.addHotKey(["option+n"],"NewChat"),n.addHotKey(["cmd+shift+,"],"OpenSettingsMenu"),n.addHotKey(["cmd+f1"],"OpenHelp"),n.addHotKey(["option+c"],"InvokeCortana"),n.addHotKey(["esc"],"Escape"),n.addHotKey(["option+up"],"PreviousLeftRailItem"),n.addHotKey(["option+down"],"NextLeftRailItem"),n.addHotKey(["cmd+shift+f6"],"PreviousLandmark"),n.addHotKey(["cmd+f6"],"NextLandmark"),n.addHotKey(["c"],"Compose"),n.addHotKey(["c"],"ComposeChannel"),n.addHotKey(["cmd+shift+x"],"ComposeFull"),n.addHotKey(["cmd+shift+x"],"ComposeFullChannel"),n.addHotKey(["cmd+enter"],"SendFromExpandedCompose"),n.addHotKey(["cmd+shift+o"],"UploadFile"),n.addHotKey(["cmd+shift+o"],"UploadFileChannel"),n.addHotKey(["r"],"ReplyChannel"),n.addHotKey(["shift+enter"],"NewLine"),n.addHotKey(["pageup"],"PageUp"),n.addHotKey(["pagedown"],"PageDown"),n.addHotKey(["cmd+a"],"SelectAll"),n.addHotKey(["shift+up"],"SelectPrevious"),n.addHotKey(["shift+down"],"SelectNext"),n.addHotKey(["cmd+shift+space"],"ToggleSharingToolbar"),n.addHotKey(["cmd+shift+a"],"AcceptIncomingCallWithVideo"),n.addHotKey(["cmd+shift+s"],"AcceptIncomingCallWithAudio"),n.addHotKey(["cmd+shift+d"],"RejectIncomingCall"),n.addHotKey(["cmd+shift+c"],"StartAudioCallInChat"),n.addHotKey(["cmd+shift+u"],"StartVideoCallInChat"),n.addHotKey(["cmd+shift+m"],"ToggleMuteCurrentCall"),n.addHotKey(["cmd+shift+f"],"CallingScreenToggleFullScreen"),n.addHotKey(["cmd+shift+l"],"AdmitLobbyParticipant"),n.addHotKey(["option+."],"CalendarGotoCurrentTime"),n.addHotKey(["ctrl+option+left"],"CalendarPreviousView"),n.addHotKey(["ctrl+option+right"],"CalendarNextView"),n.addHotKey(["cmd+option+1"],"CalendarDayView"),n.addHotKey(["cmd+option+2"],"CalendarWorkWeekView"),n.addHotKey(["cmd+option+3"],"CalendarWeekView"),n.addHotKey(["option+shift+n"],"CalendarNewMeeting"),n.addHotKey(["cmd+s"],"CalendarSchedulingFormSaveMeeting"),n.addHotKey(["option+shift+j"],"CalendarSchedulingFormJoinMeeting"),n.addHotKey(["option+shift+s"],"CalendarSchedulingFormSuggestedTime"),n.addHotKey(["cmd+option+shift+1"],"DownloadDiagnosticLogs"),t||(n.addHotKey(["cmd+option+shift+2"],"DebugUIElements"),n.addHotKey(["cmd+option+shift+4"],"ShowGrid"),n.addHotKey(["cmd+option+shift+5"],"LiveSiteDebugging"),n.addHotKey(["cmd+option+shift+6"],"PageLoadStatus"),n.addHotKey(["cmd+option+shift+8"],"ShowDiagnosticWindow"),n.addHotKey(["cmd+option+shift+9"],"ShowPerformanceDashboard"),n.addHotKey(["cmd+option+shift+p"],"PurgeMemory")),n.addHotKey(["shift+f10"],"ContextMenu"),n.addHotKey(["cmd+option+1"],"Heading1"),n.addHotKey(["cmd+option+2"],"Heading2"),n.addHotKey(["cmd+option+3"],"Heading3"),n.addHotKey(["cmd+option+4"],"BlockQuote"),n.addHotKey(["cmd+option+5"],"Code"),n.addHotKey(["cmd+option+p"],"Paragraph"),n.addHotKey(["cmd+shift+i"],"AddRedbang"),n.addHotKey(["cmd+k"],"InsertHyperlink"),n.addHotKey(["cmd+option++"],"InsertTableColRow"),n.addHotKey(["cmd+option+-"],"RemoveTableColRow"),n;}return Object(i.__extends)(t,e),t;}(Lt),Bt=function(e){function t(t){var n=e.call(this)||this;return n.reassignModifier("ctrl"),n.addHotKey(["ctrl+."],"ShowShortcuts"),n.addHotKey(["alt+/"],"ShowShortcuts"),n.addHotKey(["ctrl+e"],"GoToPowerBar"),n.addHotKey(["ctrl+/"],"SlashCommands"),n.addHotKey(["ctrl+g"],"SlashCommandGoto"),n.addHotKey(["ctrl+n"],"NewChat"),n.addHotKey(["ctrl+,"],"OpenSettingsMenu"),n.addHotKey(["f1"],"OpenHelp"),n.addHotKey(["alt+c"],"InvokeCortana"),n.addHotKey(["esc"],"Escape"),n.addHotKey(["alt+up"],"PreviousLeftRailItem"),n.addHotKey(["alt+down"],"NextLeftRailItem"),n.addHotKey(["ctrl+shift+up"],"ReorderTeamsUp"),n.addHotKey(["ctrl+shift+down"],"ReorderTeamsDown"),n.addHotKey(["ctrl+shift+f6"],"PreviousLandmark"),n.addHotKey(["ctrl+f6"],"NextLandmark"),n.addHotKey(["c"],"Compose"),n.addHotKey(["c"],"ComposeChannel"),n.addHotKey(["ctrl+shift+x"],"ComposeFull"),n.addHotKey(["ctrl+shift+x"],"ComposeFullChannel"),n.addHotKey(["ctrl+enter"],"SendFromExpandedCompose"),n.addHotKey(["ctrl+o"],"UploadFile"),n.addHotKey(["ctrl+o"],"UploadFileChannel"),n.addHotKey(["r"],"ReplyChannel"),n.addHotKey(["shift+enter"],"NewLine"),n.addHotKey(["pageup"],"PageUp"),n.addHotKey(["pagedown"],"PageDown"),n.addHotKey(["ctrl+a"],"SelectAll"),n.addHotKey(["shift+up"],"SelectPrevious"),n.addHotKey(["shift+down"],"SelectNext"),n.addHotKey(["ctrl+shift+space"],"ToggleSharingToolbar"),n.addHotKey(["ctrl+shift+a"],"AcceptIncomingCallWithVideo"),n.addHotKey(["ctrl+shift+a"],"AcceptIncomingScreenshareOnlyCall"),n.addHotKey(["ctrl+shift+s"],"AcceptIncomingCallWithAudio"),n.addHotKey(["ctrl+shift+d"],"RejectIncomingCall"),n.addHotKey(["ctrl+shift+d"],"RejectIncomingScreenshareOnlyCall"),n.addHotKey(["ctrl+shift+c"],"StartAudioCallInChat"),n.addHotKey(["ctrl+shift+e"],"StartScreenShareInChat"),n.addHotKey(["ctrl+shift+u"],"StartVideoCallInChat"),n.addHotKey(["ctrl+shift+m"],"ToggleMuteCurrentCall"),n.addHotKey(["ctrl+shift+o"],"ToggleVideoCurrentCall"),n.addHotKey(["ctrl+shift+f"],"CallingScreenToggleFullScreen"),n.addHotKey(["ctrl+shift+p"],"ToggleBackgroundBlurCurrentCall"),n.addHotKey(["ctrl+shift+l"],"AdmitLobbyParticipant"),n.addHotKey(["alt+."],"CalendarGotoCurrentTime"),n.addHotKey(["ctrl+alt+left"],"CalendarPreviousView"),n.addHotKey(["ctrl+alt+right"],"CalendarNextView"),n.addHotKey(["ctrl+alt+1"],"CalendarDayView"),n.addHotKey(["ctrl+alt+2"],"CalendarWorkWeekView"),n.addHotKey(["ctrl+alt+3"],"CalendarWeekView"),n.addHotKey(["alt+shift+n"],"CalendarNewMeeting"),n.addHotKey(["ctrl+s"],"CalendarSchedulingFormSaveMeeting"),n.addHotKey(["alt+shift+j"],"CalendarSchedulingFormJoinMeeting"),n.addHotKey(["alt+shift+s"],"CalendarSchedulingFormSuggestedTime"),n.addHotKey(["ctrl+alt+shift+1"],"DownloadDiagnosticLogs"),t||(n.addHotKey(["ctrl+alt+shift+2"],"DebugUIElements"),n.addHotKey(["ctrl+alt+shift+4"],"ShowGrid"),n.addHotKey(["ctrl+alt+shift+5"],"LiveSiteDebugging"),n.addHotKey(["ctrl+alt+shift+6"],"PageLoadStatus"),n.addHotKey(["ctrl+alt+shift+8"],"ShowDiagnosticWindow"),n.addHotKey(["ctrl+alt+shift+9"],"ShowPerformanceDashboard"),n.addHotKey(["ctrl+alt+shift+p"],"PurgeMemory")),n.addHotKey(["shift+f10"],"ContextMenu"),n.addHotKey(["ctrl+alt+1"],"Heading1"),n.addHotKey(["ctrl+alt+2"],"Heading2"),n.addHotKey(["ctrl+alt+3"],"Heading3"),n.addHotKey(["ctrl+alt+4"],"BlockQuote"),n.addHotKey(["ctrl+alt+5"],"Code"),n.addHotKey(["ctrl+alt+p"],"Paragraph"),n.addHotKey(["ctrl+shift+i"],"AddRedbang"),n.addHotKey(["ctrl+k"],"InsertHyperlink"),n.addHotKey(["ctrl+alt++"],"InsertTableColRow"),n.addHotKey(["ctrl+alt+-"],"RemoveTableColRow"),n;}return Object(i.__extends)(t,e),t;}(Lt),Gt=function(e){function t(t){var n=e.call(this)||this;return n.reassignModifier("ctrl+shift"),n.addHotKey(["ctrl+."],"ShowShortcuts"),n.addHotKey(["alt+/"],"ShowShortcuts"),n.addHotKey(["ctrl+e"],"GoToPowerBar"),n.addHotKey(["ctrl+/"],"SlashCommands"),n.addHotKey(["ctrl+shift+g"],"SlashCommandGoto"),n.addHotKey(["alt+n"],"NewChat"),n.addHotKey(["ctrl+shift+,"],"OpenSettingsMenu"),n.addHotKey(["ctrl+f1"],"OpenHelp"),n.addHotKey(["alt+c"],"InvokeCortana"),n.addHotKey(["esc"],"Escape"),n.addHotKey(["alt+up"],"PreviousLeftRailItem"),n.addHotKey(["alt+down"],"NextLeftRailItem"),n.addHotKey(["ctrl+shift+f6"],"PreviousLandmark"),n.addHotKey(["ctrl+f6"],"NextLandmark"),n.addHotKey(["c"],"Compose"),n.addHotKey(["c"],"ComposeChannel"),n.addHotKey(["ctrl+shift+x"],"ComposeFull"),n.addHotKey(["ctrl+shift+x"],"ComposeFullChannel"),n.addHotKey(["ctrl+enter"],"SendFromExpandedCompose"),n.addHotKey(["ctrl+shift+o"],"UploadFile"),n.addHotKey(["ctrl+shift+o"],"UploadFileChannel"),n.addHotKey(["r"],"ReplyChannel"),n.addHotKey(["shift+enter"],"NewLine"),n.addHotKey(["pageup"],"PageUp"),n.addHotKey(["pagedown"],"PageDown"),n.addHotKey(["ctrl+shift+i"],"AddRedbang"),n.addHotKey(["ctrl+a"],"SelectAll"),n.addHotKey(["shift+up"],"SelectPrevious"),n.addHotKey(["shift+down"],"SelectNext"),n.addHotKey(["ctrl+shift+space"],"ToggleSharingToolbar"),n.addHotKey(["ctrl+shift+a"],"AcceptIncomingCallWithVideo"),n.addHotKey(["ctrl+shift+s"],"AcceptIncomingCallWithAudio"),n.addHotKey(["ctrl+shift+d"],"RejectIncomingCall"),n.addHotKey(["ctrl+shift+c"],"StartAudioCallInChat"),n.addHotKey(["ctrl+shift+u"],"StartVideoCallInChat"),n.addHotKey(["ctrl+shift+m"],"ToggleMuteCurrentCall"),n.addHotKey(["ctrl+shift+f"],"CallingScreenToggleFullScreen"),n.addHotKey(["ctrl+shift+l"],"AdmitLobbyParticipant"),n.addHotKey(["alt+."],"CalendarGotoCurrentTime"),n.addHotKey(["ctrl+alt+left"],"CalendarPreviousView"),n.addHotKey(["ctrl+alt+right"],"CalendarNextView"),n.addHotKey(["ctrl+alt+1"],"CalendarDayView"),n.addHotKey(["ctrl+alt+2"],"CalendarWorkWeekView"),n.addHotKey(["ctrl+alt+3"],"CalendarWeekView"),n.addHotKey(["alt+shift+n"],"CalendarNewMeeting"),n.addHotKey(["ctrl+s"],"CalendarSchedulingFormSaveMeeting"),n.addHotKey(["alt+shift+j"],"CalendarSchedulingFormJoinMeeting"),n.addHotKey(["alt+shift+s"],"CalendarSchedulingFormSuggestedTime"),n.addHotKey(["ctrl+alt+shift+1"],"DownloadDiagnosticLogs"),t||(n.addHotKey(["ctrl+alt+shift+2"],"DebugUIElements"),n.addHotKey(["ctrl+alt+shift+4"],"ShowGrid"),n.addHotKey(["ctrl+alt+shift+5"],"LiveSiteDebugging"),n.addHotKey(["ctrl+alt+shift+6"],"PageLoadStatus"),n.addHotKey(["ctrl+alt+shift+8"],"ShowDiagnosticWindow"),n.addHotKey(["ctrl+alt+shift+9"],"ShowPerformanceDashboard"),n.addHotKey(["ctrl+alt+shift+p"],"PurgeMemory")),n.addHotKey(["shift+f10"],"ContextMenu"),n.addHotKey(["ctrl+alt+1"],"Heading1"),n.addHotKey(["ctrl+alt+2"],"Heading2"),n.addHotKey(["ctrl+alt+3"],"Heading3"),n.addHotKey(["ctrl+alt+4"],"BlockQuote"),n.addHotKey(["ctrl+alt+5"],"Code"),n.addHotKey(["ctrl+alt+p"],"Paragraph"),n.addHotKey(["ctrl+k"],"InsertHyperlink"),n.addHotKey(["ctrl+alt++"],"InsertTableColRow"),n.addHotKey(["ctrl+alt+-"],"RemoveTableColRow"),n;}return Object(i.__extends)(t,e),t;}(Lt),Wt=function(e){function t(t){var n=e.call(this,t)||this;return n.removeHotkey("SlashCommands"),n;}return Object(i.__extends)(t,e),t;}(Gt),$t=function(e){function t(t){var n=e.call(this,t)||this;return n.reassignHotkey(["ctrl+shift+7"],"SlashCommands"),n;}return Object(i.__extends)(t,e),t;}(Bt),zt=function(e){function t(t){var n=e.call(this,t)||this;return n.removeHotkey("SlashCommands"),n.reassignHotkey(["cmd+shift+;"],"OpenSettingsMenu"),n;}return Object(i.__extends)(t,e),t;}(Vt),qt=function(e){function t(t){var n=e.call(this,t)||this;return n.reassignHotkey(["cmd+shift+7"],"SlashCommands"),n;}return Object(i.__extends)(t,e),t;}(Ft),Jt=function(e){function t(t){var n=e.call(this,t)||this;return n.removeHotkey("SlashCommands"),n;}return Object(i.__extends)(t,e),t;}(Gt),Xt=function(e){function t(t){var n=e.call(this,t)||this;return n.reassignHotkey(["ctrl+shift+7"],"SlashCommands"),n;}return Object(i.__extends)(t,e),t;}(Bt),Qt=function(e){function t(t){var n=e.call(this,t)||this;return n.removeHotkey("SlashCommands"),n;}return Object(i.__extends)(t,e),t;}(Vt),Yt=function(e){function t(t){var n=e.call(this,t)||this;return n.reassignHotkey(["cmd+shift+7"],"SlashCommands"),n;}return Object(i.__extends)(t,e),t;}(Ft),Zt=function(e){function t(t){var n=e.call(this,t)||this;return n.reassignHotkey(["ctrl+shift+/"],"SlashCommands"),n;}return Object(i.__extends)(t,e),t;}(Gt),en=function(e){function t(t){var n=e.call(this,t)||this;return n.reassignHotkey(["ctrl+shift+/"],"SlashCommands"),n;}return Object(i.__extends)(t,e),t;}(Bt),tn=function(e){function t(t){var n=e.call(this,t)||this;return n.reassignHotkey(["cmd+;"],"ShowShortcuts"),n.reassignHotkey(["cmd+shift+/"],"SlashCommands"),n;}return Object(i.__extends)(t,e),t;}(Vt),nn=function(e){function t(t){var n=e.call(this,t)||this;return n.reassignHotkey(["cmd+;"],"ShowShortcuts"),n.reassignHotkey(["cmd+shift+/"],"SlashCommands"),n;}return Object(i.__extends)(t,e),t;}(Ft),rn=function(){function e(){}return e.createMapping=function(t,n,r,o,i){return e.strategy?e.strategy:(a=i?new Ut():o?e.getLocalizedStrategy(t,n,r):n?e.isMac?new Ft(t):new Bt(t):e.isMac?new Vt(t):new Gt(t),e.strategy=a,a);var a;},e.resetCache=function(){e.strategy=null;},e.getLocalizedStrategy=function(t,n,r){var o=e.isMac?"mac":"windows",i=n?"desktop":"browser",a={mac:{desktop:{de:new qt(t),es:new Yt(t),fr:new nn(t),default:new Ft(t)},browser:{de:new zt(t),es:new Qt(t),fr:new tn(t),default:new Vt(t)}},windows:{desktop:{de:new $t(t),es:new Xt(t),fr:new en(t),default:new Bt(t)},browser:{de:new Wt(t),es:new Jt(t),fr:new Zt(t),default:new Gt(t)}}};return a[o][i][r]?a[o][i][r]:a[o][i].default;},e.isMac=/Mac|iPod|iPhone|iPad/.test(navigator.platform),e;}();!function(e){e.Initializing="shortcutsInitializing",e.ShortcutInvoked="shortcutInvoked";}(it||(it={}));var on,an=18,sn=27,cn=96,dn=105,un=115,ln=function(){function e(e){this.shortcutService=e,this.logger=void 0,this.nextHandler=void 0,this.globalKeymaps=this.shortcutService.getKeymappingStrategy().getGlobalKeymaps();}return e.prototype.getNextHandler=function(){return this.nextHandler;},e.prototype.setNextHandler=function(e){this.nextHandler=e;},e.prototype.handle=function(e){var t=this.handleKeys(e);this.nextHandler&&t&&this.nextHandler.handle(e);},e.prototype.resetCache=function(){this.globalKeymaps=this.shortcutService.getKeymappingStrategy().getGlobalKeymaps();},e.prototype.getKeyMaps=function(e){var t=this,n=this.shortcutService.getCurrentArea(),r=[];return n&&"Global"!==n&&(r=Object(p.filter)(this.shortcutService.getCurrentAreaKeymaps(),function(n){return t.isMatching(n.getKeyInfos(),e);})),0===r.length&&(r=Object(p.filter)(this.globalKeymaps,function(n){return t.isMatching(n.getKeyInfos(),e);})),r;},e.prototype.stopEvent=function(e){this.preventDefault(e),this.stopPropagation(e);},e.prototype.preventDefault=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;},e.prototype.stopPropagation=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0;},e.prototype.isAnyModifierPressed=function(e){return e.ctrlKey||e.shiftKey||e.altKey||e.metaKey;},e.prototype.isAnyModifierWithoutShiftPressed=function(e){return e.ctrlKey||e.altKey||e.metaKey;},e.prototype.setLogger=function(e){this.logger=e;},e.prototype.logEvent=function(e){var t={command:e};this.shortcutService.getConfig().sendEvent(it.ShortcutInvoked,t);},e;}(),fn=function(e){function t(t){var n=e.call(this,t)||this;n.shortcutService=t;var r=t.getConfig().newLogger("keyboardhandlers-input-field-filter");return n.setLogger(r),n;}return Object(i.__extends)(t,e),t.prototype.handleKeys=function(e){return!this.isInputFieldAndNoModifierPressed(e)||(this.logger.debug("We are in the input field and the pressed key doesn't have any modifier, it has been processed, no need to process next handlers in the sequence."),!1);},t.prototype.isMatching=function(){return!1;},t.prototype.isInputFieldAndNoModifierPressed=function(e){try{var t="INPUT"===e.target.nodeName||"SELECT"===e.target.nodeName||"TEXTAREA"===e.target.nodeName||"WEBVIEW"===e.target.nodeName||e.target.isContentEditable,n=e.keyCode||e.which;return!!(this.isAnyModifierWithoutShiftPressed(e)||"F1"!==e.key&&"F10"!==e.key)&&t&&!this.isAnyModifierWithoutShiftPressed(e)&&n!==sn;}catch(e){return this.logger.error("The error in detecting event target. {0}",e),!1;}},t;}(ln),pn=function(e){function t(t){var n=e.call(this,t)||this;n.shortcutService=t;var r=t.getConfig().newLogger("keyboardhandlers-open-dialog-filter");return n.setLogger(r),n;}return Object(i.__extends)(t,e),t.prototype.handleKeys=function(e){if(this.shortcutService.getConfig().isModalDialogOpen()){var t=this.getKeyMaps(e);if(t&&t[0]&&["NextLandmark","PreviousLandmark","DownloadDiagnosticLogs"].indexOf(t[0].commandId)>-1&&t[0].assignedHandler){this.stopEvent(e),this.logger.debug("Dialog is open, but 'NextLandmark' or 'PreviousLandmark' or 'DownloadDiagnosticLogs' command was used."),this.logEvent(t[0].commandId),t[0].assignedHandler(e);var n=this.shortcutService.getConfig().updateState;n&&n();}return!1;}return!0;},t.prototype.isMatching=function(e,t){var n,r=t.keyCode||t.which,o=Object(p.find)(Mt.nonPrintableCharacterMap,function(e){return e.code.indexOf(r)>-1;});return n=o?o.value:Mt.specialCharactersMap[r]?Mt.specialCharactersMap[r]:String.fromCharCode(r).toLowerCase(),e.some(function(e){return e.isMatching(t,n);});},t;}(ln),hn=/f[0-9]|Page(Up|Down)|Escape+/i,mn=function(e){function t(t){var n=e.call(this,t)||this;n.shortcutService=t;var r=t.getConfig().newLogger("keyboardhandlers-no-character-filter");return n.setLogger(r),n;}return Object(i.__extends)(t,e),t.prototype.handleKeys=function(e){return!!this.shouldBypass(e);},t.prototype.isMatching=function(){return!1;},t.prototype.shouldBypass=function(e){var t=e.keyCode||e.which,n=!Object(p.find)(Mt.nonPrintableCharacterMap,function(e){return e.code.indexOf(t)>-1;});return e.key&&hn.test(e.key)?["F1","F4","F6","F10","PageUp","PageDown","Escape"].indexOf(e.key)>-1:n||this.isAnyModifierPressed(e);},t;}(ln),gn=function(e){function t(t){var n=e.call(this,t)||this;n.shortcutService=t;var r=t.getConfig().newLogger("keyboardhandlers-unicode-numpad-filter");return n.setLogger(r),n;}return Object(i.__extends)(t,e),t.prototype.handleKeys=function(e){return!!this.shouldBypass(e);},t.prototype.isMatching=function(){return!1;},t.prototype.shouldBypass=function(e){return!(e.altKey&&!e.ctrlKey&&!e.shiftKey&&!e.metaKey&&e.keyCode>=cn&&e.keyCode<=dn);},t;}(ln),bn=function(e){function t(t){var n=e.call(this,t)||this;n.shortcutService=t;var r=t.getConfig().newLogger("keyboardhandlers-one-character-handler");return n.setLogger(r),n;}return Object(i.__extends)(t,e),t.prototype.handleKeys=function(e){if(this.shouldBypass(e))return!0;var t=this.getKeyMaps(e);if(t&&t[0]&&t[0].assignedHandler){"Escape"!==e.key&&this.stopEvent(e),this.logger.debug("Executing the action: {0}",t[0].commandId),this.logEvent(t[0].commandId),t[0].assignedHandler(e);var n=this.shortcutService.getConfig().updateState;n&&n();}return!1;},t.prototype.isMatching=function(e,t){var n,r=t.keyCode||t.which,o=Object(p.find)(Mt.nonPrintableCharacterMap,function(e){return e.code.indexOf(r)>-1;});return n=o?o.value:Mt.specialCharactersMap[r]?Mt.specialCharactersMap[r]:String.fromCharCode(r).toLowerCase(),e.some(function(e){return e.isMatching(t,n);});},t.prototype.shouldBypass=function(e){return this.isAnyModifierWithoutShiftPressed(e)||"Global"===this.shortcutService.getCurrentArea();},t;}(ln),vn=function(e){function t(t){var n=e.call(this,t)||this;n.shortcutService=t;var r=t.getConfig().newLogger("keyboardhandlers-regular-handler");return n.setLogger(r),n;}return Object(i.__extends)(t,e),t.prototype.handleKeys=function(e){if(!this.isAnyModifierPressed(e))return!0;var t=this.getKeyMapsOrNull(e);if(t&&t[0]&&t[0].assignedHandler){this.stopEvent(e),this.logger.debug("Executing the action: {0}",t[0].commandId),this.logEvent(t[0].commandId),t[0].assignedHandler(e);var n=this.shortcutService.getConfig().updateState;n&&n();}return!1;},t.prototype.isMatching=function(e,t){var n,r=t.keyCode||t.which,o=Object(p.find)(Mt.nonPrintableCharacterMap,function(e){return e.code.indexOf(r)>-1;});return n=o?o.value:Mt.specialCharactersMap[r]?Mt.specialCharactersMap[r]:String.fromCharCode(r).toLowerCase(),e.some(function(e){return e.isMatching(t,n);});},t.prototype.getKeyMapsOrNull=function(e){var t=this.shortcutService.getDynamicAppBarKeyMaps(e);if(t&&t[0]&&t[0].assignedHandler)return t;var n=this.getKeyMaps(e);return n&&n[0]&&n[0].assignedHandler?n:null;},t;}(ln),yn=function(e){function t(t){var n=e.call(this,t)||this;n.shortcutService=t;var r=t.getConfig().newLogger("keyboardhandlers-page-up-down-handler");return n.setLogger(r),n;}return Object(i.__extends)(t,e),t.prototype.handleKeys=function(e){if(this.isPageUpOrDownEvent(e)){var t=this.getKeyMaps(e);if(t&&t[0]&&t[0].assignedHandler){this.stopEvent(e),this.logger&&this.logger.debug("Executing the action: {0}",t[0].commandId),this.logEvent(t[0].commandId),t[0].assignedHandler(e);var n=this.shortcutService.getConfig().updateState;n&&n();}return!1;}return!0;},t.prototype.isMatching=function(e,t){var n=t.keyCode||t.which,r=Object(p.find)(Mt.nonPrintableCharacterMap,function(e){return e.code.indexOf(n)>-1;}),o=r?r.value:String.fromCharCode(n).toLowerCase();return e.some(function(e){return e.isMatching(t,o);});},t.prototype.isPageUpOrDownEvent=function(e){return"PageUp"===e.key||"PageDown"===e.key;},t;}(ln),_n=function(){function e(e){this.config=e,this.shortcutsDisabled=!1,this.isPrevAltGr=!1,this.appBarKeyMaps=[],this.logger=e.newLogger("services-keyboard-shortcuts"),this.keymappingStrategy=rn.createMapping(this.config.isPublicRing(),this.config.isDesktopApp(),this.config.keyboardLayoutLanguage,this.config.enableLocalizedKeyboardShortcuts(),this.config.isSurfaceHub());var t=new fn(this),n=new mn(this),r=new gn(this),o=new pn(this),i=new bn(this),a=new yn(this),s=new vn(this);t.setNextHandler(n),n.setNextHandler(r),r.setNextHandler(o),o.setNextHandler(a),a.setNextHandler(i),i.setNextHandler(s),this.keyHandler=t;}return e.prototype.init=function(){this.config.sendEvent(it.Initializing),this.config.addEventListener("keydown",this.onHandleKeyDown.bind(this),!0),this.config.addEventListener("keyup",this.onHandleKeyUp.bind(this)),this.logger.debug("Application shortcuts initialized.");},e.prototype.disableShortcuts=function(e){this.keymappingStrategy.setVirtualShortcutStrategy(e),this.resetHandlersCachedMaps(),this.shortcutsDisabled=!0,this.logger.debug("Application shortcuts disabled.");},e.prototype.reenableShortcuts=function(){this.keymappingStrategy.resetStrategy(),this.resetHandlersCachedMaps(),this.shortcutsDisabled=!1,this.logger.debug("Application shortcuts enabled.");},e.prototype.assignCommandHandler=function(e,t){this.logger.debug("Assigning command handler to the command {0}.",e);var n=Object(p.filter)(this.getKeymappingStrategy().getAllKeymaps(),function(t){return t.commandId===e;});if(n&&n.length>0)for(var r in n){n.hasOwnProperty(r)&&n[r].assignHandler(t);}else this.logger.warn("Can't assign the handler to the command {0}. Command is not registered in the keymapping strategy.",e);},e.prototype.unassignCommandHandler=function(e,t){this.logger.debug("Unassigning command handler from the command {0}.",e);var n=Object(p.filter)(this.getKeymappingStrategy().getAllKeymaps(),function(t){return t.commandId===e;});if(n&&n.length>0)for(var r in n){n.hasOwnProperty(r)&&n[r].unassignHandler(t);}else this.logger.warn("Can't unassign the handler from the command {0}. Command is not registered in the keymapping strategy.",e);},e.prototype.assignAppBarShortcutHandler=function(e,t,n){var r=this.getKeymappingStrategy().getModifier();this.logger.debug('Assigning command handler to the shortcut key combo "{0}+{1}" and label "{2}".',r,e,t);var o=new Nt([r+"+"+e],"Global",null,"shortcut_open_"+t.toLowerCase());this.appBarKeyMaps[e]=o,o.assignHandler(n);},e.prototype.unassignAppBarShortcutHandler=function(e,t,n){var r=this.getKeymappingStrategy().getModifier();this.logger.debug('Unassigning command handler from the shortcut "{0}+{1}" and itemType "{2}".',r,e,t);var o=this.appBarKeyMaps[e];o?o.unassignHandler(n):this.logger.warn('Can\'t unassign the handler from the shortcut "{0}+{1}". Command is not registered in the keymapping strategy.',r,e);},e.prototype.getDynamicAppBarKeyMaps=function(e){if(!this.shortcutsDisabled){var t=e.keyCode||e.which;t>=cn&&t<=dn&&(t-=48);var n=String.fromCharCode(t).toLowerCase();return Object(p.filter)(this.appBarKeyMaps,function(t){return!!t&&t.getKeyInfos().some(function(t){return t.isMatching(e,n);});});}},e.prototype.setCurrentArea=function(e){this.logger.debug("Setting current area to {0}.",e),this.currentArea=e;},e.prototype.unsetCurrentArea=function(e){this.currentArea===e&&(this.currentArea=void 0);},e.prototype.executeCommand=function(e){var t=Object(p.find)(this.keymappingStrategy.getAllKeymaps(),function(t){return t.commandId===e;});t&&t.assignedHandler?t.assignedHandler():this.logger.warn("Can't execute the command {0}. Handler is not assigned or command is not registered in the strategy.",e);},e.prototype.getCurrentArea=function(){return this.currentArea||"Global";},e.prototype.getKeymappingStrategy=function(){return this.keymappingStrategy;},e.prototype.getCurrentAreaKeymaps=function(){return this.getKeymappingStrategy().getAreaKeymaps(this.getCurrentArea());},e.prototype.getHotkeyForCommand=function(e,t){void 0===t&&(t=!0);var n=this.getKeymappingStrategy().getCommandKeymap(e);if(n){var r=n.hotkey[0];return t?"("+r+")":r;}},e.prototype.getConfig=function(){return this.config;},e.prototype.resetHandlersCachedMaps=function(){for(var e=this.keyHandler;e;){e.resetCache(),e=e.getNextHandler();}},e.prototype.onHandleKeyDown=function(e){var t=this;if(e.altKey&&e.location===e.DOM_KEY_LOCATION_RIGHT&&(this.isPrevAltGr=!0,this.config.setTimeout(function(){return t.isPrevAltGr=!1;},2e3)),this.isPrevAltGr){if(e.keyCode!==un||!e.altKey)return;this.isPrevAltGr=!1;}this.keyHandler&&this.keyHandler.handle(e);},e.prototype.onHandleKeyUp=function(e){!e.altKey&&e.keyCode!==an||e.location!==e.DOM_KEY_LOCATION_RIGHT||(this.isPrevAltGr=!1);},e;}(),On=ze.createContext(void 0),Cn=(function(e){function t(t){var n=e.call(this,t)||this,r=t.config,o=new _n(r);return o.init(),n.state={shortcutService:o},n;}Object(i.__extends)(t,e),t.prototype.render=function(){return ze.createElement(On.Provider,{value:this.state.shortcutService},this.props.children);};}(ze.PureComponent),On.Consumer,n(2723),ze.createContext({activePicker:void 0,setActivePicker:p.noop})),wn=ze.memo(function(e){var t=e.children,n=ze.useState(void 0),r=n[0],o=n[1];return ze.createElement(Cn.Provider,{value:gt({activePicker:r,setActivePicker:o}),children:t});}),jn=(n(964),n(2670)),Sn=n(962),En=function En(e,t){return ze.createElement(Tn,Object(i.__assign)({},t),e);},Tn=ze.memo(function(e){var t=e.Item,n=e.dataTidPrefix,r=e.variables,o=e.index,a=e.children,s=Object(i.__rest)(e,["Item","dataTidPrefix","variables","index","children"]);return ze.createElement(t,Object(i.__assign)({},s,{as:a,key:n+".item."+o,dataTidPrefix:n,variables:r}));}),kn=function kn(e,t,n,r,o){var a=ze.useState(!1),s=a[0],c=a[1],d=ze.useContext(jn.c);return Object(p.isEmpty)(e)?null:ze.createElement(Sn.a,{"aria-label":t,"data-is-focusable":"true",getOverflowItems:function getOverflowItems(t){return function(e,t,n){if(!n||Object(p.isNaN)(e))return t;var r=Object(i.__spreadArrays)(t);e<=8&&(r=t.filter(function(e,t){return 8!==t;}));var o=r[e],a=e;return o&&"divider"===o.kind&&(a+=1),r.slice(a);}(t,e,o);},items:e,onOverflowOpenChange:function onOverflowOpenChange(e,t){var n=t.overflowOpen;c(n);},overflow:o,overflowItem:{title:r?d.stringTranslate("messaging","messages_composeBoxMoreOptions"):d.stringTranslate("messaging","icons_more"),"data-tid":n+"-more-options"},overflowOpen:s,variables:{isAutoOverflow:o}});},Pn=function Pn(e,t){return{kind:"divider",variables:{isCompact:!0},key:t+".divider."+e};},In=ze.memo(function(e){var t=e.dataTid,n=e.dataTidPrefix,r=void 0===n?"command-bar":n,o=e.start,a=e.main,s=e.end,c=e.variables,d=e.ariaLabelStart,u=e.ariaLabelMain,l=e.ariaLabelEnd,f=e.showDividers,h=e.isBottomToolbar,m=function(){var e=ze.useContext(pt),t=e.composeContext,n=e.disabled;return ze.useCallback(function(e,r,o){return function(a){return e&&a(Object(i.__assign)(Object(i.__assign)({Item:e,dataTidPrefix:o,index:r},t),{disabled:n}),En);};},[t,n]);}(),g=ze.useCallback(function(e,t,n){return void 0===t&&(t=!1),function(r){var o=0;return Object(p.reduce)(r,function(r,a,s){if(Object(p.isEmpty)(a))return r;var c=t?[Pn(s,n)]:[],d=Object(p.reduce)(a,function(t,r){return r?Object(i.__spreadArrays)(t,[e(r,o++,n)]):t;},[]);return Object(p.isEmpty)(r)?d:Object(i.__spreadArrays)(r,c,d);},[]);};}(m,f,r),[m,f,r]),b=ze.useMemo(function(){return g(o);},[o,g]),v=ze.useMemo(function(){return g(a);},[a,g]),y=ze.useMemo(function(){return g(s);},[s,g]),_=kn(b,d,r),O=kn(v,u,r,h,!0),C=kn(y,l,r);return ze.createElement(Je.a,{"data-tid":t,variables:c,vAlign:"start"},_,O,C);},p.isEqual),An=n(801),Hn=n(1461),xn={type:"classic",resize_enabled:!1,title:!1,width:"100%",height:"100%",skin:"moono-lisa",startupFocus:!1,enterMode:1,shiftEnterMode:2,disableNativeSpellChecker:!1,defaultLanguage:"en",language:"en",autoParagraph:!0,removePlugins:"elementspath,floatingspace,magicline",fillEmptyBlocks:!1},Kn=Object(i.__spreadArrays)(["abbr","align","alt","axis","bgcolor","border","cellpadding","cellspacing","class","clear","color","cols","colspan","compact","content","contenteditable","coords","data-ams-src","data-itemprops","data-preview-src","data-src","data-ts-imgid","data-ts-imglen","dir","face","headers","height","href","hreflang","hspace","ismap","itemid","itemprop","itemscope","itemtype","lang","language","nohref","nowrap","rel","rev","rows","rowspan","rules","scope","scrolling","shape","size","span","src","start","style","summary","target","title","type","usemap","valign","value","vspace","width"],["mri","type","originalsrc"]);!function(e){e.color="color",e.bgColor="background-color",e.background="background",e.itemProps="data-itemprops",e.itemtype="itemtype",e.mentionId="data-mention-id",e.height="height",e.itemid="itemid",e.itemscope="itemscope",e.src="src",e.style="style",e.width="width",e.alt="alt";}(on||(on={}));var Rn,Dn=Object(i.__spreadArrays)(["a","abbr","acronym","address","area","article","aside","b","bdi","bdo","big","blockquote","br","caption","center","cite","code","col","colgroup","dd","del","dfn","dir","div","dl","dt","em","figcaption","figure","font","footer","h1","h2","h3","h4","h5","h6","header","hgroup","hr","i","img","img","ins","kbd","label","li","map","map","mark","menu","nav","ol","p","pre","q","rp","rp","rt","rt","ruby","s","samp","section","small","span","strike","strong","sub","sup","table","tbody","td","tfoot","th","thead","time","tr","tt","u","ul","var","wbr"],["mention","semantic-object","card"]),Mn=["animated-emoticon-*","copy-paste-table","emojione","emoticon-*","hljs*","language-*","swift-*","ts-image"].join(","),Nn=["content","data-itemprops","height","itemid","itemprop","itemscope","itemtype","style","title","type","width"].join(","),Ln=Kn.join(","),Un=Dn.join(" "),Fn={allowedContent:Un+"["+Ln+"]{*}("+Mn+")",pasteFilter:Un+"["+Nn+"]{"+Array.from(ee).join(",")+"}("+Un+");img[!src];a[!href];",disallowedContent:"script style"},Vn=n(2704),Bn=function Bn(e,t){return function(n){if(e.fire("saveSnapshot"),n.indexOf("<img ")>=0){var r=new(0,t.DOMParser)().parseFromString(n,"text/html");Array.from(r.images).forEach(function(t){t.closest('[itemtype="'+Vn.a.emoji+'"]')||function(e,t){e.onerror=function(){e.setAttribute(on.width,"50"),e.setAttribute(on.height,"50"),t.fire("change");},e.onload=function(){var n=e.width,r=e.height;r>250&&(n=250*n/r,r=250),e.setAttribute(on.width,""+n),e.setAttribute(on.height,""+r),t.fire("updateSnapshot"),t.fire("change");};}(t,e);}),Array.from(r.body.childNodes).forEach(function(n){if(n.nodeType===Node.TEXT_NODE)e.insertText(n.nodeValue);else{var r=new t.CKEDITOR.dom.element(n);e.insertElement(r);}});}else e.insertHtml(n);e.fire("saveSnapshot");};},Gn=function Gn(e){return $n(e,function(e){return e.data.dataValue;});},Wn=function Wn(e){return $n(e,zn);},$n=function $n(e,t){if(e.data){var n=t(e),r=re.b.parseDOM(n),o=Object(p.get)(e,"data.$.clipboardData.files")||[],i=Object(p.get)(e,"data.dataTransfer._.files")||[];return{files:o.concat(i),content:r};}},zn=function zn(e){if(!e.data.dataTransfer)return"";var t=e.data.dataValue,n=e.data.dataTransfer;return t||(t=n.getData("text/html"))&&(t=(t=t.replace(/^(\n|\r\n)/,"")).replace(/(\n|\r\n)$/,"")),t||(t=Object(p.escape)(n.getData("text/plain"))),t;},qn=n(35),Jn=n(371),Xn=n(144);function Qn(e,t,n,r){return Object(Xn.a)(n)&&(r=n,n=void 0),r?Qn(e,t,n).pipe(Object(Ze.a)(function(e){return Object(Jn.a)(e)?r.apply(void 0,e):r(e);})):new qn.a(function(r){!function e(t,n,r,o,i){var a;if(function(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener;}(t)){var s=t;t.addEventListener(n,r,i),a=function a(){return s.removeEventListener(n,r,i);};}else if(function(e){return e&&"function"==typeof e.on&&"function"==typeof e.off;}(t)){var c=t;t.on(n,r),a=function a(){return c.off(n,r);};}else if(function(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener;}(t)){var d=t;t.addListener(n,r),a=function a(){return d.removeListener(n,r);};}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(var u=0,l=t.length;u<l;u++){e(t[u],n,r,o,i);}}o.add(a);}(e,t,function(e){arguments.length>1?r.next(Array.prototype.slice.call(arguments)):r.next(e);},r,n);});}!function(e){e[e.Text=0]="Text",e[e.Element=1]="Element";}(Rn||(Rn={}));var Yn=function(){function e(e,t){this.node=e,this._nodeFactory=t;}return Object.defineProperty(e.prototype,"$",{get:function get(){return this.node.$;},enumerable:!0,configurable:!0}),e.prototype.getText=function(){return this.node.getText();},e.prototype.setText=function(e){this.node.setText(e);},e.prototype.remove=function(){this.node.remove();},e.prototype.insertBefore=function(e){this.node.insertBefore(e.node);},e.prototype.insertAfter=function(e){this.node.insertAfter(e.node);},e.prototype.appendTo=function(e){e.type===Rn.Element&&this.node.appendTo(e.node);},e.prototype.getPrevious=function(){var e=this.node.getPrevious();return e?this._nodeFactory(e):void 0;},e.prototype.getNext=function(){var e=this.node.getNext();return e?this._nodeFactory(e):void 0;},e.prototype.findParentNode=function(e){var t=this,n=!1;if(!this.isRootNode(this.node)){var r=this.node.getAscendant(function(r){return n||t.isRootNode(r)?(n=!0,!1):r.getName()===e;},!1);return r||void 0;}},e.prototype.isRootNode=function(e){return e.type===CKEDITOR.NODE_ELEMENT&&e.hasClass&&e.hasClass("cke_editable");},e;}(),Zn=function(e){function t(t){var n=e.call(this,t,tr)||this;return n.node=t,n;}return Object(i.__extends)(t,e),t.prototype.getChild=function(e){return tr(this.node.getChild(e));},Object.defineProperty(t.prototype,"type",{get:function get(){return Rn.Element;},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"first",{get:function get(){return tr(this.node.getFirst());},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"last",{get:function get(){return tr(this.node.getLast());},enumerable:!0,configurable:!0}),t.prototype.setAttribute=function(e,t){this.node.setAttribute(e,t);},t.prototype.getAttribute=function(e){return this.node.getAttribute(e);},t.prototype.getHtml=function(e){return e?this.node.getOuterHtml():this.node.getHtml();},t.prototype.setHtml=function(e){this.node.setHtml(e);},t.prototype.append=function(e){this.node.append(e.node);},t.prototype.moveChildren=function(e){e.type===Rn.Element&&this.node.moveChildren(e.node);},Object.defineProperty(t.prototype,"tag",{get:function get(){return this.node.getName();},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function get(){return this.node.getChildCount();},enumerable:!0,configurable:!0}),t.prototype.findParent=function(e){var n=this.findParentNode(e);return n?new t(n):void 0;},t.prototype.find=function(e){return this.node.find(e).toArray().map(function(e){return tr(e);});},t.prototype.breakParent=function(e){this.node.breakParent(e.node);},t.prototype.removeAttribute=function(e){this.node.removeAttribute(e);},t.prototype.addClass=function(e){this.node.addClass(e);},t.prototype.removeClass=function(e){this.node.removeClass(e);},t;}(Yn),er=function(e){function t(t){var n=e.call(this,t,tr)||this;return n.node=t,n.type=Rn.Text,n;}return Object(i.__extends)(t,e),t.prototype.getChild=function(e){},Object.defineProperty(t.prototype,"first",{get:function get(){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"last",{get:function get(){},enumerable:!0,configurable:!0}),t.prototype.setAttribute=function(e,t){},t.prototype.getAttribute=function(e){},t.prototype.getHtml=function(e){return this.getText();},t.prototype.setHtml=function(e){this.setText(e);},t.prototype.append=function(e){e.insertAfter(this);},t.prototype.moveChildren=function(e){},Object.defineProperty(t.prototype,"tag",{get:function get(){return"text";},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"length",{get:function get(){return this.node.getLength();},enumerable:!0,configurable:!0}),t.prototype.findParent=function(e){var t=this.findParentNode(e);return t?new Zn(t):void 0;},t.prototype.breakParent=function(e){var t=new Zn(new CKEDITOR.dom.element("p"));t.insertBefore(this),this.appendTo(t),t.breakParent(e);},t.prototype.find=function(e){return[];},t.prototype.removeAttribute=function(e){},t.prototype.addClass=function(e){},t.prototype.removeClass=function(e){},t;}(Yn),tr=function tr(e){switch(e.type){case CKEDITOR.NODE_TEXT:return new er(e);case CKEDITOR.NODE_ELEMENT:return new Zn(e);default:throw new Error("unrecognized node type");}},nr=function(){function e(e){this.path=e;}return Object.defineProperty(e.prototype,"elements",{get:function get(){return this.path.elements.map(function(e){return tr(e);});},enumerable:!0,configurable:!0}),e;}(),rr=function rr(e,t){var n=this;this.host=e,this.fragment=t,this.getText=function(){return n.fragment.$.textContent;},this.appendTo=function(e){return e instanceof Yn?e.type===Rn.Text?tr(n.fragment.appendTo(e.node.getParent())):tr(n.fragment.appendTo(e.node)):tr(n.fragment.appendTo(new n.host.CKEDITOR.dom.element(e)));};},or={outOfBounds:function outOfBounds(e,t){return e-1<0;},mutateOffset:function mutateOffset(e){return e-1;},nodeStartOffset:Number.MAX_SAFE_INTEGER,getNextText:function getNextText(e){return dr(e,"BACKWARDS");}},ir={outOfBounds:function outOfBounds(e,t){return e+1>=t;},mutateOffset:function mutateOffset(e){return e+1;},nodeStartOffset:0,getNextText:function getNextText(e){return dr(e,"FORWARDS");}},ar={mutateOffset:function mutateOffset(e){return e+1;},outOfBounds:function outOfBounds(e,t){return t>=e.getChildCount();},getStartOffset:function getStartOffset(e){return 0;},getSibling:function getSibling(e){return e.getNext();},outOfBoundsOffset:Number.MAX_SAFE_INTEGER},sr={mutateOffset:function mutateOffset(e){return e-1;},outOfBounds:function outOfBounds(e,t){return t<0;},getStartOffset:function getStartOffset(e){return e.type===CKEDITOR.NODE_ELEMENT?e.getChildCount()-1:-1;},getSibling:function getSibling(e){return e.getPrevious();},outOfBoundsOffset:-1},cr=function cr(e,t,n,r){switch(void 0===r&&(r="FORWARDS"),t){case"CHARACTER":return lr(n,"BACKWARDS"===r?or:ir,e);case"NODE":return ur(n,"BACKWARDS"===r?sr:ar,e);default:throw new Error("not yet implemented");}},dr=function dr(e,t){var n;void 0===t&&(t="FORWARDS");var r=e.container.type===Rn.Text;return cr(e,"NODE",function(e){if(e.type===Rn.Text){if(!r)return n=e,!0;r=!1;}return!1;},t),n;},ur=function ur(e,t,n){for(var r=n.container.node,o=n.offset;r;){if(r.type!==CKEDITOR.NODE_ELEMENT||t.outOfBounds(r,o)){if(e(tr(r)))return!0;if(r.type===CKEDITOR.NODE_ELEMENT&&r.isBlockBoundary({}))return!1;var i=t.getSibling(r);i?(r=i,o=t.getStartOffset(r)):(r=r.getParent(),o=t.outOfBoundsOffset);}else r=r.getChild(o),o=o=t.getStartOffset(r);}return!1;},lr=function lr(e,t,n){var r={container:n.container,offset:n.offset};if(t.outOfBounds(n.offset,n.container.length)){if(!(i=t.getNextText(n)))return!1;r.container=i,r.offset=t.nodeStartOffset;}for(;r.container;){if(r.container.type===Rn.Text){var o=r.container.getText();if(r.offset=Math.min(r.offset,o.length-1),e(o.charAt(r.offset),r.container,r.offset))return!0;if(t.outOfBounds(r.offset,o.length)){var i;if(!(i=t.getNextText(r)))return!1;r={container:i,offset:t.nodeStartOffset};}else r.offset=t.mutateOffset(r.offset);}else{var a=t.getNextText(r);if(!a)return!1;r={container:a,offset:t.nodeStartOffset};}}return!1;},fr=function(){function e(t,n){var r=this;this.host=t,this.range=n,this.moveStart=function(e){var t=r._applyOffset(r.start.container,r.start.offset,e),n=t.container,o=t.offset;r.range.setStart(n,o);},this.moveEnd=function(e){var t=r._applyOffset(r.end.container,r.end.offset,e),n=t.container,o=t.offset;r.range.setEnd(n,o);},this.move=function(e){var t=r._applyOffset(r.start.container,r.start.offset,e),n=t.container,o=t.offset;r.range.setStart(n,o),r.range.setEnd(n,o);},this.setStart=function(e){return r.range.setStart(e.container.node,e.offset);},this.setEnd=function(e){return r.range.setEnd(e.container.node,e.offset);},this.setStartBefore=function(e){return r.range.setStartBefore(e.node);},this.setStartAfter=function(e){return r.range.setStartAfter(e.node);},this.setEndBefore=function(e){return r.range.setEndBefore(e.node);},this.setEndAfter=function(e){return r.range.setEndAfter(e.node);},this.collapse=function(e){return r.range.collapse(e);},this.clone=function(){return new e(r.host,r.range.clone());},this.cloneContents=function(){return new rr(r.host,r.range.cloneContents());},this.extractContents=function(){return new rr(r.host,r.range.extractContents(!0));},this.getStartElement=function(){var e=r.start.container;return e.type===Rn.Text?tr(e.node.getParent()):e;},this.getEndElement=function(){var e=r.end.container;return e.type===Rn.Text?tr(e.node.getParent()):e;},this.getCommonAncestor=function(){return tr(r.range.getCommonAncestor());},this.isParentForbidden=function(){return r.path&&r.path.elements&&r.path.elements.some(function(e){return Object(p.includes)(te,e.tag);});},this.hasContentBefore=function(){var e=r.start.container.getPrevious(),t=!!e&&"text"!==e.tag&&"br"!==e.tag;return!!e&&"text"===e.tag&&/^(\w|\s)+$/.test(e.getText())||t;},this.handleBreakParent=function(){var e=r.start.container,t=e.findParent("p"),n=e.getPrevious(),o=e.getNext(),i=n&&"br"===n.tag,a=o&&"br"===o.tag;t&&(i||a)&&e.breakParent(t);},this._applyOffset=function(e,t,n){var o=n<0;if(e.type!==Rn.Text){var i=dr({container:e,offset:t},o?"BACKWARDS":"FORWARDS");return i?r._applyOffset(i,o?Number.MAX_SAFE_INTEGER:0,n):{container:e.node,offset:t};}var a=Math.min(t,e.length)+n;return a<0?r._setOffset(e.node,a,r._buildGetSiblingForOffset(a,"BACKWARDS"),0,function(e,t){return e+t.getLength();}):a>e.length?r._setOffset(e.node,a,r._buildGetSiblingForOffset(a,"FORWARDS"),e.length,function(t){return t-e.length;}):{container:e.node,offset:a};},this._buildGetSiblingForOffset=function(e,t){return function(n){var r=dr({container:tr(n),offset:e},t);return r?r.node:void 0;};},this._setOffset=function(e,t,n,o,i){var a=n(e);return a?(e=a,t=i(t,a)):t=o,t<0?r._applyOffset(tr(e),0,t):a?r._applyOffset(tr(a),0,t):{container:e,offset:t};};}return Object.defineProperty(e.prototype,"collapsed",{get:function get(){return this.range.collapsed;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"start",{get:function get(){return{container:tr(this.range.startContainer),offset:this.range.startOffset};},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function get(){return{container:tr(this.range.endContainer),offset:this.range.endOffset};},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function get(){return tr(this.range.root);},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function get(){var e=this.start.container,t=new this.host.CKEDITOR.dom.elementPath(e.node,this.root.node);return new nr(t);},enumerable:!0,configurable:!0}),e;}(),pr=function pr(e,t,n){return function(r,o){void 0===o&&(o=10);var i=e.editable();switch(n.debug(r+" handler registered..."),r){case"keyUp$":return Qn(i.$,"keyup",{passive:!0}).pipe(br(t));case"keyDown$":return hr(e,"key",o,n).pipe(mr(t));case"click$":return Qn(i.$,"click",{passive:!0}).pipe(vr(t));case"change$":return hr(e,"change",o,n).pipe(function(e){return e.pipe(Object(Ze.a)(function(e){return t.getValue()||"";}));});case"beforePaste$":return hr(e,"beforePaste",o,n).pipe(gr(t,Wn));case"paste$":return hr(e,"paste",o,n).pipe(gr(t,Gn));case"afterPaste$":return hr(e,"afterPaste",o,n).pipe(gr(t,Gn));case"input$":return Qn(i.$,"input",{passive:!0}).pipe(yr(t));case"selectionChanged$":return hr(e,"selectionChange",o,n).pipe(_r(t.host));}};},hr=function hr(e,t,n,r){return qn.a.create(function(o){var i=e.on(t,function(e){return o.next(e);},null,null,n);return function(){i&&(i.removeListener(),r.debug(t+" handler unregistered..."));};});},mr=function mr(e){return function(t){return t.pipe(Object(Ze.a)(function(t){return{code:Object(p.get)(t,"data.domEvent.$.code"),shiftKey:Object(p.get)(t,"data.domEvent.$.shiftKey"),altKey:Object(p.get)(t,"data.domEvent.$.altKey"),ctrlKey:Object(p.get)(t,"data.domEvent.$.ctrlKey"),metaKey:Object(p.get)(t,"data.domEvent.$.metaKey"),nativeEvent:Object(p.get)(t,"data.domEvent.$"),keyCode:Object(p.get)(t,"data.domEvent.$.keyCode"),key:Object(p.get)(t,"data.domEvent.$.key"),type:Object(p.get)(t,"data.domEvent.$.type"),cancel:function cancel(){return t.cancel();},stop:function stop(){t.stop();var e=Object(p.get)(t,"data.domEvent.$");e&&e.stopPropagation&&e.stopPropagation();},selection:e.selectedRange,getModifierState:Object(p.get)(t,"data.domEvent.$.getModifierState")};}));};},gr=function gr(e,t){return function(n){return n.pipe(Object(Ze.a)(function(n){var r=t(n);return Object(i.__assign)(Object(i.__assign)({cancel:n.cancel,stop:function stop(){n.stop();var e=Object(p.get)(n,"data.domEvent.$");e&&e.stopPropagation&&e.stopPropagation();},selection:e.selectedRange},r),{updatePasteContent:function updatePasteContent(e){return n.data.dataValue=e;}});}));};},br=function br(e){return function(t){return t.pipe(Object(Ze.a)(function(t){return{code:t.code,shiftKey:t.shiftKey,altKey:t.altKey,ctrlKey:t.ctrlKey,metaKey:t.metaKey,keyCode:t.keyCode,path:new nr(Object(p.get)(t,"path")),key:t.key,type:t.type,cancel:function cancel(){return t.preventDefault();},stop:function stop(){return t.stopImmediatePropagation();},selection:e.selectedRange,getModifierState:function getModifierState(e){return t.getModifierState(e);}};}));};},vr=function vr(e){return function(t){return t.pipe(Object(Ze.a)(function(t){return{shiftKey:t.shiftKey,altKey:t.altKey,ctrlKey:t.ctrlKey,metaKey:t.metaKey,type:t.type,cancel:function cancel(){return t.preventDefault();},stop:function stop(){return t.stopImmediatePropagation();},selection:e.selectedRange,getModifierState:function getModifierState(e){return t.getModifierState(e);}};}));};},yr=function yr(e){return function(t){return t.pipe(Object(Ze.a)(function(t){return{input:t.data,cancel:function cancel(){return t.preventDefault();},stop:function stop(){return t.stopImmediatePropagation();},selection:e.selectedRange};}));};},_r=function _r(e){return function(t){return t.pipe(Object(Ze.a)(function(t){return{selection:new fr(e,t.data.selection.getRanges()[0]),path:new nr(t.data.path),cancel:t.cancel,stop:function stop(){t.stop();var e=Object(p.get)(t,"data.domEvent.$");e&&e.stopPropagation&&e.stopPropagation();}};}));};},Or=function Or(e,t,n,r){return void 0===n&&(n=0),void 0===r&&(r=e.length),{value:e,node:t,start:n,end:r};},Cr=function Cr(e,t){return e&&e.collapsed?t(e):void 0;},wr=function wr(e,t){if(void 0===t&&(t=""),e.node.type!==Rn.Text)return!1;var n=-1===e.start?0:e.start,r=-1===e.end?e.value.length:e.end,o=e.node.getText(),i=o.substring(0,n)+t+o.substring(r,o.length);return e.node.setText(i),!0;},jr=function jr(e,t){return Er(e,t)||Er(Object(i.__assign)(Object(i.__assign)({},e),{offset:e.offset+1}),t);},Sr=/(^$)|\s|[.,?_\-*`"~{}!()[\]:;]/,Er=function Er(e,t){var n=Tr(e);if(n!==t&&Sr.test(n))return!0;var r=Tr(e,!0);return!(r===t||!Sr.test(r));},Tr=function Tr(e,t){var n="",r=!t;return cr(e,"CHARACTER",function(e,t,o){return!Y.test(e)&&(r?(n=e,!0):(r=!0,!1));},t?"BACKWARDS":"FORWARDS"),n;},kr=function kr(e,t){var n=e.container,r=e.offset;if(void 0===t&&(t=" "),n.type===Rn.Text){var o=n.getText();r||(r=o.length);var i=o.substring(0,r),a=i.length,s=i.trimRight().lastIndexOf(t);-1===s?s=0:s+=1;var c=i.substring(s,a).trim().replace(Z,"");return Or(c,n,s,a);}},Pr=function Pr(e,t){var n=e.container,r=e.offset;if(void 0===t&&(t=" "),n.type===Rn.Text){var o,i=n.getText(),a=i.indexOf(t,r),s=i.lastIndexOf(t,r);return-1===s&&-1===a?o=i:-1===a?o=i.substring(s):-1===s?o=i.substring(0,a):(s===a&&(s=i.lastIndexOf(t,a-1)),o=i.substring(s,a)),Or(o,n,s,a);}},Ir=function Ir(e){return Cr(e,function(e){var t=e.start;if(t.container.type===Rn.Text){var n=t.container.getText(),r=n.trim().replace(new RegExp(Y,"g"),""),o=n.length;return Or(r,t.container,0,o);}});},Ar=function Ar(e,t){return xr(e,t,CKEDITOR.SHRINK_ELEMENT);},Hr=function Hr(e,t){return xr(e,t,CKEDITOR.SHRINK_TEXT);},xr=function xr(e,t,n,r){var o=e.host,i=e.root,a=new o.CKEDITOR.dom.range(i.node);a.selectNodeContents(t.node);var s=new o.CKEDITOR.dom.walker(a),c=n||CKEDITOR.SHRINK_ELEMENT;s.guard=Kr(c),s.evaluator=Rr(c);var d=r?s.lastForward():s.lastBackward();return d&&tr(d);},Kr=function Kr(e){var t;return function(n,r){return!(e===CKEDITOR.SHRINK_ELEMENT&&n.type===CKEDITOR.NODE_TEXT||r&&n.equals(t))&&(r||n.type!==CKEDITOR.NODE_ELEMENT||(t=n),!0);};},Rr=function Rr(e){return function(t){return t.type===(e===CKEDITOR.SHRINK_ELEMENT?CKEDITOR.NODE_ELEMENT:CKEDITOR.NODE_TEXT);};},Dr=function Dr(e,t,n){var r=this;this._editor=e,this._logger=t,this._host=n,this._trackedElementsForDeletion=new WeakMap(),this._trackedElementsForAdd=new Map(),this._deletedElements=new Map(),this._addedElements=new Map(),this._mutationId=0,this.dispose=function(){r._mutationObserver.disconnect(),r._logger.debug("disconnected");},this.onRemove=function(e,t){r._trackedElementsForDeletion.set(e,t);var n=e.getAttribute("data-mutation-id")||""+r._mutationId++;return e.setAttribute("data-mutation-id",n),n;},this.onAdd=function(e,t){r._addedElements.set(e,t);},this.query=function(e,t){var n=r._editor.editable().$;n&&n.querySelectorAll(e).forEach(function(e){return t(e);});},this.find=function(e){var t=r._editor.editable().findOne(e);return t&&t.$;},this._onMutation=function(e){Object(p.each)(e,function(e){Object(p.each)(e.removedNodes,function(e){r._handleRemove(e);}),Object(p.each)(e.addedNodes,function(e){r._handleAdd(e);});});},this._handleRemove=function(e){Mr(e)&&(r._watchedNodeRemoved(e),e.nodeType===Node.ELEMENT_NODE&&e.querySelectorAll("[data-mutation-id]").forEach(r._watchedNodeRemoved));},this._watchedNodeRemoved=function(e){var t=r._trackedElementsForDeletion.get(e);if(t){r._trackedElementsForDeletion.delete(e),r._logger.debug("tracked node was removed");var n=e.getAttribute("data-mutation-id");n&&r._deletedElements.set(n,t),n&&r._addedElements.has(n)&&(r._logger.debug("found added element"),r._trackedElementsForAdd.set(n,r._addedElements.get(n)),r._addedElements.delete(n)),r._host.requestAnimationFrame(function(){r._logger.debug("remove callback"),t(e);});}},this._handleAdd=function(e){Mr(e)&&(r._watchedNodeAdded(e),e.nodeType===Node.ELEMENT_NODE&&e.querySelectorAll("[data-mutation-id]").forEach(r._watchedNodeAdded));},this._watchedNodeAdded=function(e){if(r._trackedElementsForAdd.size){var t=e.getAttribute("data-mutation-id");if(t){var n=r._trackedElementsForAdd.get(t);if(n){r._trackedElementsForAdd.delete(t),r._logger.debug("tracked tag was added");var o=r._deletedElements.get(t);o&&(r._logger.debug("on add deleted element found"),r._trackedElementsForDeletion.set(e,o),r._deletedElements.delete(t)),r._addedElements.set(t,n),r._host.requestAnimationFrame(function(){n(e),r._logger.debug("added element callback");});}}}},this._mutationObserver=new this._host.MutationObserver(ne("MutationCallback")(this._onMutation)),this._mutationObserver.observe(this._editor.editable().$,{childList:!0,subtree:!0});},Mr=function Mr(e){return e.nodeType===Node.ELEMENT_NODE;},Nr=function Nr(e,t,n,r){return"table"===e.tag?Lr(e,t,r):"span"===e.tag&&(n.insertAfter(e),t.selectNodeContents(n.node),!0);},Lr=function Lr(e,t,n){var r=(e.node.$||{rows:void 0}).rows;if(Object(p.isEmpty)(r)||Object(p.isEmpty)(r[0].cells))return!1;var o=n(r[0].cells[0]),i=t.moveToElementEditStart(o.node);return t.select(),i;},Ur=n(122),Fr=n(155),Vr=n(121);function Br(e){return function(t){var n=new Gr(e),r=t.lift(n);return n.caught=r;};}var Gr=function(){function e(e){this.selector=e;}return e.prototype.call=function(e,t){return t.subscribe(new Wr(e,this.selector,this.caught));},e;}(),Wr=function(e){function t(t,n,r){var o=e.call(this,t)||this;return o.selector=n,o.caught=r,o;}return i.__extends(t,e),t.prototype.error=function(t){if(!this.isStopped){var n=void 0;try{n=this.selector(t,this.caught);}catch(t){return void e.prototype.error.call(this,t);}this._unsubscribeAndRecycle();var r=new Fr.a(this,void 0,void 0);this.add(r);var o=Object(Vr.a)(this,n,void 0,void 0,r);o!==r&&this.add(o);}},t;}(Ur.a),$r=/img|table|li|card|semantic-object|mention/,zr=function zr(e,t){return function(n,r){var o=e.id,a=e.element,s=e.host,c=e.loggerFactory,d=e.content,u=void 0===d?"":d,l=e.isPlainText,f=void 0!==l&&l;s.requestIdleCallback(function(){try{var e=Object(i.__assign)(Object(i.__assign)({},xn),Fn),d=s.CKEDITOR.inline(a,e);d.setData(u),d.once("instanceReady",qr(t,o,f,c,s,n));}catch(e){t.error(e),r(e);}},{timeout:250});};},qr=function qr(e,t,n,r,o,i){return function(a){var s=a.editor;e.debug('Instance "'+t+'" created.'),s.editable().setAttribute("data-tid","ckeditor"),s.editable().setAttribute("data-is-focusable","true"),s.editable().setAttribute("tabindex","0"),s.editable().removeAttribute("aria-label");var c=new Xr(t,s,r,o);c.isPlainText=n,i(c);};};function Jr(e){return Object(i.__awaiter)(this,void 0,void 0,function(){var t;return Object(i.__generator)(this,function(r){switch(r.label){case 0:return t=e.host,Object(V.a)().CKEDITOR?[3,2]:[4,n.e(5).then(n.bind(null,2715))];case 1:r.sent(),r.label=2;case 2:if(t.CKEDITOR)return[3,7];r.label=3;case 3:return r.trys.push([3,5,,7]),[4,t.chunkLoader.loadChunk(["vendors","ckeditor"])];case 4:return r.sent(),[3,7];case 5:return r.sent(),[4,n.e(5).then(n.bind(null,2715))];case 6:return r.sent(),[3,7];case 7:return[2];}});});}var Xr=function(){function e(e,t,n,i){var a=this;this.id=e,this._editor=t,this._loggerFactory=n,this.host=i,this._subscriptions=[],this.textHelper=o,this.walker=r,this.on=pr(this._editor,this,this.newLogger("EventsManager")),this.setValue=function(e){a._editor.setData(e);},this.save=function(){return a._editor.fire("saveSnapshot");},this.lockUndo=function(){a._editor.fire("lockSnapshot",{dontUpdate:!0});},this.unlockUndo=function(){a._editor.fire("unlockSnapshot");},this.createFromHtml=function(e){return tr(a.host.CKEDITOR.dom.element.createFromHtml(e));},this.createFromTag=function(e){return tr(new a.host.CKEDITOR.dom.element(e));},this.createFromElement=function(e){return tr(new a.host.CKEDITOR.dom.element(e));},this.insertElement=function(e){if(e.type===Rn.Text)a._editor.insertText(e.getText());else{a._editor.insertElement(e.node);var t=tr(new a.host.CKEDITOR.dom.text(""));Nr(e,a._editor.createRange(),t,a.createFromElement);}return e;},this.insertText=function(e){a._editor.insertText(e);},this.dispose=function(){a._subscriptions.forEach(function(e){return e&&e.unsubscribe();}),a._subscriptions=[],a.mutations.dispose(),a._editor.removeAllListeners(),a._editor.container&&a._editor.container.clearCustomData();var e="placeholder-"+a.id,t=a.host.CKEDITOR.instances[e];t===a.host.CKEDITOR.currentInstance&&(a.host.CKEDITOR.currentInstance=null),t.destroy(!0);},this.focus=function(){return a._editor.focus();},this.reset=function(){a._editor.setData(""),a._editor.resetUndo(),a._editor.fire("change");},this.execCommand=function(e){return a._editor.execCommand(e);},this.applyStyle=function(e,t){a._editor.applyStyle(new a.host.CKEDITOR.style(e,t)),a._editor.fire("change");},this.removeStyle=function(e,t){return a._editor.removeStyle(new a.host.CKEDITOR.style(e,t));},this.unwrapTextInElement=function(e){a._editor.fire("lockSnapshot");var t=new a.host.CKEDITOR.dom.text(e.getText());return e.node.insertBeforeMe(t),e.remove(),a.selectNode(tr(t)),a._editor.fire("unlockSnapshot"),tr(t);},this.wrapTextWithElement=function(e,t){void 0===t&&(t="semantic-object"),a._editor.fire("lockSnapshot");var n=e.node.node.split(e.start);n.split(e.end-e.start);var r=new a.host.CKEDITOR.dom.element(t);return r.appendText(n.getText()),r.insertAfter(n),n.remove(),a.selectNode(tr(r)),a._editor.fire("unlockSnapshot"),tr(r);},this.createRange=function(e,t){var n=new a.host.CKEDITOR.dom.range(a._editor.editable());return n.setStart(e.container.node,e.offset),n.setEnd((t||e).container.node,(t||e).offset),new fr(a.host,n);},this.selectRange=function(e){a._editor.getSelection().selectRanges([e.range]);},this.insertInEditor=function(e,t){if(t){if(t instanceof Yn){a.save();var n=a._editor.createRange(),r=a.createFromHtml(e),o=tr(new a.host.CKEDITOR.dom.text(""));r.insertBefore(t),o.insertAfter(t),t.remove(),n.selectNodeContents(o.node),n.optimize(),n.collapse(),a.save();}else{n=a._editor.createRange();var i=0===t.start?0:t.start+1;n.setStart(t.node.node,i),n.collapse(),n.optimize(),a._editor.insertHtml(e,"html",n);}}else a.save(),a._editor.insertHtml(e),a.save();},this.createPath=function(e,t){return new nr(new a.host.CKEDITOR.dom.elementPath(e.node,t?t.node:a._editor.getSelection().root));},this.selectNode=function(e){var t=a._editor.getSelection(),n=new a.host.CKEDITOR.dom.range(t.root);return n.selectNodeContents(e.node),n.collapse(),t.selectRanges([n]),new fr(a.host,t.getRanges()[0]);},this.setEditableAttribute=function(e,t){t?a._editor.editable().setAttribute(e,t):a._editor.editable().removeAttribute(e);},this.mutations=new Dr(this._editor,this.newLogger("MutationManager"),this.host),this.paste=Bn(this._editor,this.host);}return Object.defineProperty(e.prototype,"selectedRange",{get:function get(){var e=this._editor.getSelection(),t=e?e.getRanges()[0]:void 0;return t?new fr(this.host,t):void 0;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"disabled",{get:function get(){return this._editor.readOnly;},set:function set(e){this._editor.setReadOnly(!!e);},enumerable:!0,configurable:!0}),e.prototype.getValue=function(e,t){var n=this._editor.editable();if(n)return function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var r=e.getText().replace(/^[\r\n]$/g,"").replace(/[\u200B-\u200D\uFEFF\u21b5\u00A0]/g,""),o=n?r:r.trim();if(t)return o||void 0;var i=e.getHtml(),a=""!==o;if(n)return i||void 0;var s=$r.test(i);return a||s?i:void 0;}(n,void 0===e&&!!this.isPlainText||"text"===e,t);},e.prototype.newLogger=function(e){return this._loggerFactory.newLogger("Compose:"+e+" ("+this.id+")");},e.prototype.subscribe=function(e,t){var n=this,r=e.pipe(Br(function(){return e;})).subscribe(t);return this._subscriptions=Object(i.__spreadArrays)(this._subscriptions,[r]),{unsubscribe:function unsubscribe(){r.unsubscribe(),n._subscriptions=n._subscriptions.filter(function(e){return e!==r;});}};},e;}(),Qr=function Qr(e){e.CKEDITOR.dtd.card=Object(i.__assign)({},e.CKEDITOR.dtd.div),e.CKEDITOR.dtd.$block.card=1,e.CKEDITOR.dtd.$object.card=1,e.CKEDITOR.dtd.$blockLimit.card=1,e.CKEDITOR.dtd.$nonEditable.card=1,e.CKEDITOR.dtd.div.card=1;},Yr=(n(825),n(860),n(393)),Zr=n(765),eo=n(394),to=(Oe("Word"),function(e,t,n){var r=e.node.getText(),o=e.end;e.node.setText(r.substr(0,o)+" "+r.substr(o)),e.end++;var i=t.clone();i.setEnd({container:e.node,offset:e.end}),i.collapse(),n.selectRange(i);}),no=function no(e,t){var n=e.newLogger("KeyDown"),r=Object(Yr.a)($e()(e,t)),o=Object(Yr.a)(Ge("WordProcessor",function(e,t,n){var r=e.selectedRange;if(!r)return!1;var o=e.textHelper.getPreviousWord(r.start);if(!o||r.isParentForbidden())return!1;var i=t.extensions.find("Word",o);if(!i)return!1;var a=i.instance.execute(o);if(!a)throw new Error("[WordProcessor] Invalid DOM for word transform");n&&n.keyCode===Te.Space&&to(o,r,e),e.newLogger("WordProcessor").debug("Handling "+i.config.name),e.save(),e.lockUndo();var s=r.clone();s.setStart({container:o.node,offset:o.start}),s.setEnd({container:o.node,offset:o.end}),s.extractContents(),e.insertInEditor(a);var c=e.selectedRange;if(c){var d=c.clone();d.collapse(),d.move(1),e.selectRange(d);}return e.unlockUndo(),!0;})(e,t)),i=t.events.observe().pipe(Object(Ze.a)(function(e){return e.keyDown$;}),Object(Zr.a)()),a=e.on("keyDown$",1);return i.pipe(Object(Be.a)(function(e){return e?(n.debug("pipeline active..."),a):(n.debug("pipeline paused..."),Fe.a);}),Object(eo.a)(function(e){return!et(e);}),r,Object(eo.a)(function(e){return st(e);}),o,Br(function(r){return n.debug("pipeline error",r),no(e,t);}));},ro=function ro(e,t){var n=e.newLogger("KeyUp"),r=Object(Yr.a)($e()(e,t)),o=Object(Yr.a)(Ge("AutocompleteProcessor",function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,r,o;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return(n=e.selectedRange)&&n.collapsed&&!n.isParentForbidden()&&(r=e.textHelper.getPreviousWord(n.start))&&(o=t.extensions.find("Autocomplete",r))?(e.newLogger("AutocompleteProcessor").debug("[AutocompleteProcessor] Handling "+o.config.name),[4,t.autocomplete.init(o,r)]):[2,!1];case 1:return i.sent(),[2,!0];}});});})(e,t)),a=Object(Yr.a)(Ge("BlockProcessor",function(e,t){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,r,o,a,s;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return(n=e.selectedRange)?!(r=e.textHelper.getPreviousWord(n.start))||!r.value||0!==r.start||n.isParentForbidden()||n.hasContentBefore()?[2,!1]:(o=t.extensions.find("Block",r))?[4,Promise.resolve(o.instance.execute(r))]:[2,!1]:[2,!1];case 1:if(a=i.sent(),!(s=e.createFromHtml(a)))throw new Error("[BlockProcessor] Invalid DOM for block "+o.config.name);if(n.handleBreakParent(),!wt(e,n,s.tag,o.config.shouldBeRooted))return[2,!1];switch(e.newLogger("BlockProcessor").debug("Handling "+o.config.name),e.save(),e.textHelper.replaceTextInNode(r),o.config.activationMode){case"WRAP":St(n,s,e);break;case"APPEND":jt(n,s,e);break;case"EMPTY":e.insertElement(s);break;default:throw new Error("Invalid block scope for "+o.config.name);}return e.save(),[2,!0];}});});})(e,t)),s=t.events.observe().pipe(Object(Ze.a)(function(e){return e.keyUp$;}),Object(Zr.a)()),c=e.on("keyUp$");return s.pipe(Object(Be.a)(function(e){return e?(n.debug("pipeline active..."),c):(n.debug("pipeline paused..."),Fe.a);}),Object(eo.a)(function(e){return!et(e);}),r,Object(eo.a)(function(e){return st(e)||function(e){return dt(e)||ct(e)||at(Te.SemiColon,Te.ForwardSlash)(e)||at(Te.OpenBracket,Te.SingleQuote)(e)||at(Te.Add,Te.Divide)(e);}(e);}),o,Object(eo.a)(function(e){return st(e);}),a,Br(function(r){return n.debug("pipeline error",r),ro(e,t);}));},oo=function oo(e){for(var t=!1,n=[],r=0,o=e;r<o.length;r++){var i=o[r];if(i.data&&"text"===i.type){var a=io(i.data,/\r\n/g,"\n");if(a=io(a,/\n\n/g,"<p></p>"),(a=io(a,/\n/g,"<br>"))!==i.data){var s=re.b.parseDOM(a);n=n.concat(s),t=!0;continue;}}n.push(i);}return{processedContent:n,replacedContent:t};},io=function io(e,t,n){return t.test(e)?e.replace(t,n):e;},ao=(Oe("PastedContent",function(e){if(!e.filter)throw new Error(e.name+" has undefined filter");}),function(e,t){var n=e.newLogger("Paste"),r=Object(Yr.a)(Ge("BeforePasteContentHandler",function(e,t,n){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(i.__generator)(this,function(r){return n.content&&(e=oo(n.content)).replacedContent?(t=re.b.DomUtils.getOuterHTML(e.processedContent),n.updatePasteContent(t),[2,!0]):[2,!1];});});})(e,t)),o=t.events.observe().pipe(Object(Ze.a)(function(e){return e.beforePaste$;}),Object(Zr.a)()),a=e.on("beforePaste$");return o.pipe(Object(Be.a)(function(e){return e?(n.debug("pipeline active..."),a):(n.debug("pipeline paused..."),Fe.a);}),Object(eo.a)(function(e){return!!e;}),r,Br(function(r){return n.debug("pipeline error",r),ao(e,t);}));}),so=n(763),co=(Oe("PastedFiles",function(e){if(!e.mimeType)throw new Error(e.name+" can't have falsy mime type filter");}),function(e,t){var n=e.newLogger("Paste"),r=Object(Yr.a)(Ge("PastedContentHandler",function(e,t,n){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,o,a,s,c;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return n&&n.content?((r=e.newLogger("Pasted-content")).debug("pasting: "+re.b.DomUtils.getOuterHTML(n.content)),o=ue(t.extensions.values("PastedContent"),"handle"),[4,ve(n.content,le(o,n.selection))]):[2,!1];case 1:return(a=i.sent())&&a.result&&0!==a.result.length&&(a.handled||a.transientHandled)?(s=a.result,c=s.length>1||"div"!==s[0].name?re.b.DomUtils.getOuterHTML(s):re.b.DomUtils.getInnerHTML(s[0]),r.debug("pasted: "+c),e.paste(c),n.cancel(),[2,!0]):[2,!1];}});});})(e,t),Ge("PastedFilesHandler",function(e,t,n){if(!n||Object(p.isEmpty)(n.files))return!1;var r=n.files.map(function(n){return t.extensions.find("PastedFiles",function(t){var r=t.config.mimeType,o=t.instance;if(!r.test(n.type))return!1;var i=o.handle(n);return void 0!==i&&(i&&e.paste(i),!0);});}).some(function(e){return!!e;});return r&&n.cancel(),r;})(e,t)),o=t.events.observe().pipe(Object(Ze.a)(function(e){return e.paste$;}),Object(Zr.a)()),a=e.on("paste$");return o.pipe(Object(Be.a)(function(e){return e?(n.debug("pipeline active..."),a):(n.debug("pipeline paused..."),Fe.a);}),Object(eo.a)(function(e){return!!e;}),Object(so.a)(function(e){return(0,e.cancel)();}),r,Object(eo.a)(function(t){var n=re.b.DomUtils.getOuterHTML(t.content);return e.paste(n),!1;}),Br(function(r){return n.debug("pipeline error",r),co(e,t);}));}),uo=function uo(e,t){var n=e.newLogger("Input"),r=Object(Yr.a)(Ge("BoundedProcessor",function(e,t,n){if(!n.input||1!==n.input.length)return!1;var r=!1,o=!1,i=t.extensions.find("Bounded",function(e){return r=e.config.delimiter.start===n.input,o=e.config.delimiter.end===n.input,r||o;});return!(!i||!Et(e,i)||!Tt(e,i,r,o)||(n.stop(),0));})(e,t));return e.on("input$",Number.MAX_SAFE_INTEGER).pipe(r,Br(function(r){return n.debug("pipeline error",r),uo(e,t);}));},lo=function lo(e,t){if(t&&t.nodeType===Node.ELEMENT_NODE)try{var n=e.createFromHtml(t.outerHTML);return e.insertElement(n);}catch(t){return void e.newLogger("CommandProcessor").error(t);}},fo=function fo(e,t){if(t)try{e.insertText(t);}catch(t){return void e.newLogger("CommandProcessor").error(t);}},po=function po(e,t){var n=t.payload,r=n.handler,o=n.type;(0,n.trackForDispose)(e.subscribe(e.on(o,10),r));},ho=function ho(e,t){var n=e.newLogger("Hooks");return t.extensions.hooksEmitter.asObservable().pipe(Ge("HooksProcessor",function(e,t,n){return ne(n.name+" ("+n.hook+" hook)")(function(){switch(n.hook){case"Command":e.save(),e.lockUndo(),e.execCommand(n.payload),e.unlockUndo(),e.save();break;case"Element":var r=n.payload,o=r.resolver,i=r.element,a=lo(e,i);o&&a&&o(a);break;case"Text":var s=n.payload.text;fo(e,s);break;case"Event":po(e,n);break;case"GetSelection":n.payload(e.selectedRange);break;case"SetSelection":e.selectRange(n.payload);break;case"ApplyStyle":var c=n.payload;e.applyStyle(c.style,c.variableValues);break;case"RemoveStyle":var d=n.payload;e.removeStyle(d.style,d.variableValues);break;case"FocusEditor":e.focus();break;case"Card":var u=n.payload,l=u.name,f=u.props,p=u.id;(0,u.onMount)(Ht(e,t,l,f,p));break;case"Extension":default:return!1;}return!0;})();})(e,t),Br(function(r){return n.error("An error occured in the compose hooks pipeline",r),ho(e,t);}));},mo=function mo(e,t){var n=e.newLogger("SelectionChanged"),r=Object(Yr.a)(Ge("AutocompleteSelectionProcessor",function(e,t,n){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){return t.autocomplete.isInitialized?[2,t.autocomplete.onSelectionChanged(n)]:[2,!1];});});})(e,t));return e.on("selectionChanged$",1).pipe(r,Br(function(r){return n.debug("pipeline error",r),mo(e,t);}));},go=function go(e){var t=ze.useContext(pt),n=t.id,r=t.disabled,o=e.variables,a=e.placeholder,s=e.isPlainText,c=e.loadingFallback,d=(e.focusOnInit,e.updateContext,e.caretPositionOnInit,e.labelledBy,Object(i.__rest)(e,["variables","placeholder","isPlainText","loadingFallback","focusOnInit","updateContext","caretPositionOnInit","labelledBy"])),u=bo(e,t),l=u[0],f=u[1],p=u[2];return ze.useEffect(function(){return wo(l,function(e){e.disabled=r;});},[l,r]),ze.useEffect(function(){return wo(l,function(e){e.isPlainText=s;});},[l,s]),ze.createElement(An.a,Object(i.__assign)({},d,{variables:Object(i.__assign)({composeEditor:!0,showPlaceholder:p},o),content:ze.createElement(ze.Fragment,null,ze.createElement("textarea",Object(i.__assign)({ref:f,name:jo(n),placeholder:a,"aria-label":a,tabIndex:-1,"data-tid":jo(n),"data-is-focusable":!1},p?{id:jo(n)}:{})),c&&!l.current?c:void 0)}));},bo=function bo(e,t){var n=e.value,r=e.isPlainText,o=t.id,a=t.composeContext,s=a.host,c=a.loggerFactory,d=ze.useRef(null),u=ze.useRef(null),l=ze.useState(Oo(n)),f=l[0],p=l[1],h=ze.useRef(!1),m=Object(Hn.b)();return ze.useEffect(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var t;return Object(i.__generator)(this,function(l){switch(l.label){case 0:return t=u,[4,(g={id:o,host:s||Object(V.a)(),element:d.current,loggerFactory:c,content:n,isPlainText:r},Object(i.__awaiter)(void 0,void 0,Promise,function(){var e,t,n,r,o;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return e=g.id,t=g.element,n=g.host,r=g.loggerFactory,null==t?[2,Promise.reject(new Error("Cannot initialize on null."))]:[4,Jr(g)];case 1:return i.sent(),(o=r.newLogger("Compose:CKEditor")).debug("version: "+n.CKEDITOR.version+" @"+n.CKEDITOR.revision),Qr(n),n.CKEDITOR.instances[e]&&(o.warn('Instance "'+e+"\" already exists. Disposing it to create a fresh instance. Please ensure id's are unique."),n.CKEDITOR.instances[e].removeAllListeners(),n.CKEDITOR.instances[e].destroy(),delete n.CKEDITOR.instances[e]),[2,new Promise(zr(g,o))];}});}))];case 1:return t.current=l.sent(),h.current?[2]:(yo(e,m,u,p,a,f,o),[2]);}var g;});}),function(){h.current=!0,u.current&&(u.current.dispose(),u.current=null);};},[m]),vo(u,p,o,e),[u,d,f];},vo=function vo(e,t,n,r){var o=r.value,i=r.labelledBy;return ze.useEffect(function(){return wo(e,function(e){if(e.getValue()!==o){e.setValue(o);var r=Oo(o),a=i||(r?jo(n):void 0);e.setEditableAttribute("aria-labelledby",a),t(Oo(o));}});},[e,t,o,n,i]);},yo=function yo(e,t,n,r,o,i,a){var s=e.focusOnInit,c=e.updateContext,d=e.caretPositionOnInit,u=e.labelledBy,l=n.current;if(l){(s||d)&&(l.focus(),d&&function(e,t){var n=e.selectedRange;if(!n)return;n.move(t),e.selectRange(n);}(l,d)),l.subscribe(l.on("change$"),function(){return wo(n,function(e){return r(Oo(e.getValue("html",!0)));});});var f=Co(l),p=function(e,t){return{events:new ft(),extensions:new Ae(t),autocomplete:new lt(e,t)};}(l,o);_o(l,p),c({store:p,editorAPIs:f}),(i||u)&&l.setEditableAttribute("aria-labelledby",u||jo(a)),xt(l,p,t);}},_o=function _o(e,t){return[no,ro,ao,co,uo,ho,mo].forEach(function(n){return e.subscribe(n(e,t));});},Oo=function Oo(e){return!e||"<p><br></p>"===e||!e.trim();},Co=function Co(e){return{focusEditor:e.focus,resetEditor:e.reset,getValue:function getValue(t){return e.getValue(void 0===t?void 0:t?"text":"html");}};},wo=function wo(e,t){return e.current?t(e.current):void 0;};var jo=function jo(e){return"placeholder-"+e;},So=(ze.memo(function(e){var t=e.id,n=e.children,r=e.context,o=e.disabled,a=e.extensions,s=ze.useState({store:void 0,editorAPIs:{focusEditor:p.noop,getValue:p.noop,resetEditor:p.noop}}),c=s[0],d=c.store,u=c.editorAPIs,l=s[1],f=ze.useCallback(function(e){return ze.createElement(go,Object(i.__assign)({},e,{updateContext:l}));},[l]);ze.useEffect(function(){return d&&d.extensions.load(a);},[d,a]);var h=gt(r);return ze.createElement(pt.Provider,{value:gt({id:t,composeContext:h,disabled:o||!1,store:d})},ze.createElement(wn,null,n({Editor:f,CommandBar:In,editorAPIs:u}),ze.createElement(Ct,null)));}),Oe("SideEffect"),n(1255)),Eo=function(){function e(){var e=this;this._getMentionKey=function(e){var t=e.children&&e.children[0].data;return(e.attribs&&e.attribs.mri)+"_"+t;},this._mergeMentions=function(t,n){if(t.attribs)for(var r=t.attribs.mri||"",o=e._getNextContigousMention(t,r);t.children&&o;){var i=o.children;if(i&&i[0].data){var a=e._getMentionKey(o),s=n.get(a);s?n.set(a,s+1):n.set(a,1),t.children[0].data+=" "+i[0].data;}o=e._getNextContigousMention(o,r);}},this._getNextContigousMention=function(e,t){if(!e||!e.next)return null;var n=e.next,r=t===(n.attribs&&n.attribs.mri);return" "===n.data||r?n:null;};}return e.prototype.transform=function(e,t){if(e&&t&&t.messageProperties&&re.b.DomUtils.hasAttrib(e,"mri")){t.seenMentions||(t.seenMentions=new Map());var n=this._getMentionKey(e),r=t.seenMentions.get(n);if(r)return 1===r?t.seenMentions.delete(n):t.seenMentions.set(n,r-1),null;this._mergeMentions(e,t.seenMentions);var o=t.messageProperties;o.mentions||(o.mentions=[]);var i=""+o.mentions.length,a=Object(p.escape)(oe(e)),s=To(e)?"bot":"person";o.mentions.push({itemId:i,displayName:a,userId:re.b.DomUtils.getAttributeValue(e,"mri"),mentionType:s});var c=ce("span");c.attribs[on.itemtype]=Vn.a.mention,c.attribs[on.itemscope]="";var d=se(a);return re.b.DomUtils.appendChild(c,d),c.attribs[on.itemid]=i,c;}},e=Object(i.__decorate)([He({name:"AtMentionSerializer",filter:"mention"})],e);}(),To=function To(e){return e.attribs&&e.attribs.mri&&Object(So.d)(e.attribs.mri);},ko=new Map([["smile",{unicode:"",shortcuts:[":)",":-)",":=)","(smile)"],duration:2.2083,steps:53}],["laugh",{unicode:"",shortcuts:[":d",":-d",":=d","(laugh)",":>",":->","(lol)"],duration:3.2083,steps:77}],["heart",{unicode:"",shortcuts:["(heart)","<3"],duration:.7083,steps:17}],["kiss",{unicode:"",shortcuts:["(kiss)",":*",":-*",":=*","(xo)"],duration:2.875,steps:50}],["sad",{unicode:"",shortcuts:[":(",":-(",":=(","(sad)",":<",":-<"],duration:2.625,steps:63}],["tongueout",{unicode:"",shortcuts:[":p",":-p",":=p","(tongueout)","(yum)"],duration:2.9583,steps:71}],["wink",{unicode:"",shortcuts:[";)",";-)",";=)","(wink)"],duration:1.5,steps:36}],["cry",{unicode:"",shortcuts:[";(",";-(",";=(","(cry)",":'("],duration:2.0833,steps:50}],["inlove",{unicode:"",shortcuts:["(inlove)","(love)",":]",":-]"],duration:2.625,steps:63}],["hug",{unicode:"",shortcuts:["(hug)","(bear)"],duration:3.1667,steps:76}],["cwl",{unicode:"",shortcuts:["(cwl)","(cryingwithlaughter)"],duration:2.5417,steps:61}],["lips",{unicode:"",shortcuts:["(lips)"],duration:3.7083,steps:89}],["blush",{unicode:"",shortcuts:[":$",":-$",":=$",':">',"(blush)"],duration:2.875,steps:69}],["surprised",{unicode:"",shortcuts:[":o",":-o",":=o","(surprised)"],duration:2.8333,steps:68}],["penguin",{unicode:"",shortcuts:["(penguin)","(dancingpenguin)","(penguindance)"],duration:2.6667,steps:64}],["yes",{unicode:"",shortcuts:["(y)","(yes)","(thumbsup)"],duration:1.6667,steps:40}],["cool",{unicode:"",shortcuts:["(cool)","8-)","8=)","b-)","b=)","(sunglasses)"],duration:1.5833,steps:38}],["rofl",{unicode:"",shortcuts:["(rofl)","(rotfl)"],duration:3.375,steps:81}],["cat",{unicode:"",shortcuts:["(cat)","(meow)","(kitty)"],duration:5,steps:120}],["monkey",{unicode:"",shortcuts:["(monkey)","(ape)"],duration:2.0833,steps:50}],["hi",{unicode:"",shortcuts:["(wave)","(hi)","(bye)"],duration:2.375,steps:57}],["snowangel",{unicode:"",shortcuts:["(snowangel)"],duration:2.5,steps:60}],["flower",{unicode:"",shortcuts:["(flower)"],duration:3.4583,steps:83}],["giggle",{unicode:"",shortcuts:["(chuckle)","(giggle)"],duration:1.875,steps:45}],["devil",{unicode:"",shortcuts:["(devil)"],duration:2.7917,steps:67}],["party",{unicode:"",shortcuts:["(party)","<o)","<:o)"],duration:2.9583,steps:71}],["worry",{unicode:"",shortcuts:["(worry)",":s",":-s",":=s","(worried)","(scared)"],duration:2.3333,steps:56}],["champagne",{unicode:"",shortcuts:["(champagne)","(sparkling)"],duration:2.5833,steps:62}],["sun",{unicode:"",shortcuts:["(sun)"],duration:1.0833,steps:26}],["star",{unicode:"",shortcuts:["(star)"],duration:2.6667,steps:64}],["polarbear",{unicode:"",shortcuts:["(polarbear)","(polarbearhug)"],duration:5,steps:120}],["dull",{unicode:"",shortcuts:["|-(","|(","|=(","(dull)","(eyeroll)"],duration:3.2083,steps:77}],["speechless",{unicode:"",shortcuts:[":|",":-|",":=|","(speechless)"],duration:2.7917,steps:67}],["wonder",{unicode:"",shortcuts:[":^)","(wonder)","(skeptical)"],duration:2.9167,steps:70}],["angry",{unicode:"",shortcuts:["(angry)",":@",":-@",":=@","x(","x-(","x=(",";@",";-@","(rage)"],duration:4.375,steps:105}],["puke",{unicode:"",shortcuts:["(puke)",":&",":-&",":=&","+o("],duration:3.2917,steps:79}],["facepalm",{unicode:"",shortcuts:["(facepalm)","(fail)"],duration:3.2083,steps:77}],["sweat",{unicode:"",shortcuts:["(:|","(sweat)"],duration:2.875,steps:69}],["holidayspirit",{unicode:"",shortcuts:["(holidayspirit)","(crazyxmas)","(crazychristmas)"],duration:1.5,steps:36}],["sleepy",{unicode:"",shortcuts:["|-)","i-)","i=)","(snooze)","(sleepy)","(sleeping)"],duration:3,steps:72}],["bow",{unicode:"",shortcuts:["(bow)"],duration:2.5,steps:60}],["makeup",{unicode:"",shortcuts:["(makeup)"],duration:4.5,steps:108}],["cash",{unicode:"",shortcuts:["(cash)","(money)"],duration:1.125,steps:27}],["lipssealed",{unicode:"",shortcuts:[":x",":-x",":#",":-#",":=x",":=#","(lipssealed)"],duration:2.0833,steps:50}],["shivering",{unicode:"",shortcuts:["(shivering)","(cold)","(freezing)"],duration:7.9167,steps:190}],["cake",{unicode:"",shortcuts:["(cake)"],duration:4.125,steps:99}],["headbang",{unicode:"",shortcuts:["(headbang)","(banghead)"],duration:2.9583,steps:71}],["dance",{unicode:"",shortcuts:["o/",":d/","(dance)"],duration:8.5833,steps:206}],["wasntme",{unicode:"",shortcuts:["(wasntme)"],duration:3.1667,steps:76}],["hungover",{unicode:"",shortcuts:["(hungover)"],duration:3.0417,steps:73}],["yawn",{unicode:"",shortcuts:["(yawn)"],duration:3.0833,steps:74}],["gift",{unicode:"",shortcuts:["(gift)"],duration:.5417,steps:13}],["angel",{unicode:"",shortcuts:["(angel)"],duration:3.5,steps:84}],["xmastree",{unicode:"",shortcuts:["(xmastree)","(christmastree)"],duration:1.125,steps:27}],["brokenheart",{unicode:"",shortcuts:["(brokenheart)"],duration:4.375,steps:105}],["think",{unicode:"",shortcuts:["(think)",":-?",":?",":=?","*-)"],duration:2.4583,steps:59}],["clap",{unicode:"",shortcuts:["(clap)"],duration:1.6667,steps:40}],["punch",{unicode:"",shortcuts:["(punch)","*|","*-|"],duration:1.8333,steps:44}],["envy",{unicode:"",shortcuts:["(envy)"],duration:2.8333,steps:68}],["handshake",{unicode:"",shortcuts:["(handshake)"],duration:2.5833,steps:62}],["nod",{unicode:"",shortcuts:["(nod)"],duration:2.125,steps:51}],["nerdy",{unicode:"",shortcuts:["(nerd)","8-|","b-|","8|","b|","8=|","b=|","(nerdy)"],duration:2,steps:48}],["emo",{unicode:"",shortcuts:["(emo)"],duration:2.25,steps:54}],["muscle",{unicode:"",shortcuts:["(flex)","(muscle)"],duration:2.4583,steps:59}],["mmm",{unicode:"",shortcuts:["(mm)","(mmm)","(mmmm)"],duration:3.875,steps:93}],["highfive",{unicode:"",shortcuts:["(highfive)","(hifive)","(h5)"],duration:1.5833,steps:38}],["turkey",{unicode:"",shortcuts:["(turkey)","(turkeydance)"],duration:2.0833,steps:50}],["call",{unicode:"",shortcuts:["(call)"],duration:1.9167,steps:46}],["movember",{unicode:"",shortcuts:["(movember)","(moustache)","(mustache)",":{"],duration:4.5833,steps:110}],["dog",{unicode:"",shortcuts:["(dog)"],duration:2.25,steps:54}],["coffee",{unicode:"",shortcuts:["(coffee)"],duration:1.1667,steps:28}],["poke",{unicode:"",shortcuts:["(poke)","(nudge)"],duration:3.125,steps:75}],["swear",{unicode:"",shortcuts:["(swear)"],duration:3.2083,steps:77}],["donttalktome",{unicode:"",shortcuts:["(donttalk)","(donttalktome)"],duration:2.5,steps:60}],["fingerscrossed",{unicode:"",shortcuts:["(fingers)","(fingerscrossed)","(crossedfingers)"],duration:2.6667,steps:64}],["rainbow",{unicode:"",shortcuts:["(rainbow)"],duration:.8333,steps:20}],["headphones",{unicode:"",shortcuts:["(headphones)"],duration:3.5,steps:84}],["waiting",{unicode:"",shortcuts:["(waiting)"],duration:2.125,steps:51}],["festiveparty",{unicode:"",shortcuts:["(festiveparty)"],duration:3.0417,steps:73}],["bandit",{unicode:"",shortcuts:["(bandit)"],duration:4.25,steps:102}],["heidy",{unicode:"",shortcuts:["(squirrel)","(heidy)"],duration:3.125,steps:75}],["beer",{unicode:"",shortcuts:["(beer)"],duration:3.1667,steps:76}],["doh",{unicode:"",shortcuts:["(doh)"],duration:2.5,steps:60}],["bomb",{unicode:"",shortcuts:["(bomb)","(explosion)","(explode)"],duration:7.1667,steps:172}],["happy",{unicode:"",shortcuts:["(happy)"],duration:2.9167,steps:70}],["ninja",{unicode:"",shortcuts:["(ninja)"],duration:5.0833,steps:122}]]),Po=new Map([["angry","angryV2"]]),Io=function Io(e,t,n,r,o){void 0===n&&(n=!0),void 0===r&&(r=""),void 0===o&&(o=!1);var i=Ao(t,o);return Ho(e)?"https://statics.teams.cdn.office.net/evergreen-assets/skype/v2/"+(Po.get(e)||e)+"/"+i+(n?"a":"")+".png":"https://static-asm.secure.skypeassets.com/pes/v1/emoticons/"+e+"/views/default_"+i+(n?"_anim":"")+"_f"+(r?"?"+r:"");},Ao=function Ao(e,t){switch(void 0===t&&(t=!1),e){case"extra-large":return 100;case"large":return t?100:50;case"medium":return t?60:30;case"extra-small":return t?20:16;case"small":default:return t?50:20;}},Ho=function Ho(e){return ko.has(e);},xo=function(){function e(){}return e.prototype.transform=function(e,t){var n=t&&t.superSizeEmoticons?"large":"small",r=Ao(n),o=re.b.DomUtils.getAttributeValue(e,"itemid")||"",i=ce("span",{contenteditable:"false",title:re.b.DomUtils.getAttributeValue(e,"title")||"",type:"("+o+")",class:"animated-emoticon-"+r+"-"+o}),a=ce("img",{itemscope:"",itemtype:Vn.a.emoji,itemid:o,src:Io(o,n,!1),title:re.b.DomUtils.getAttributeValue(e,"title")||"",alt:re.b.DomUtils.getAttributeValue(e,"itemscope")||"",style:"width:"+r+"px;height:"+r+"px;"});return re.b.DomUtils.appendChild(i,a),i;},e=Object(i.__decorate)([He({name:"EmoticonSerializer",filter:{itemtype:Vn.a.emoji}})],e);}(),Ko=function(){function e(){}return e.prototype.transform=function(e,t){var n=(!!t&&!!t.superSizeEmoticons?50:20)+"px";return e.attribs||(e.attribs={}),e.attribs.height=n,e.attribs.width=n,function(e,t){if(e){e.attribs||(e.attribs={}),t||delete e.attribs.style;var n=[];Object(p.forOwn)(t,function(e,t){n.push(t+": "+e);}),e.attribs.style=n.join(";"),e.attribs.style||delete e.attribs.style;}}(e,{"max-height":n,"max-width":n,height:n,width:n}),e;},e=Object(i.__decorate)([He({name:"EmojiOneSerializer",filter:{class:new RegExp("emojione")}})],e);}(),Ro=new RegExp("emojione"),Do=new RegExp(/animated-emoticon.*?/),Mo=/img|table/,No=function No(e){return!!e&&(re.b.DomUtils.getAttributeValue(e,"itemtype")===Vn.a.emoji||Do.test(re.b.DomUtils.getAttributeValue(e,"class")||"")||(t=e,Ro.test(re.b.DomUtils.getAttributeValue(t,"class")||"")));var t;},Lo=3,Uo=function(){function e(){}return e.prototype.preTransform=function(e,t){var n,r=Object(p.isUndefined)(t.superSizeEmoticons)?0:t.superSizeEmoticons;"br"===e.name?t.containsPotentiallyIncludedWhitespace=!0:Object(p.isNumber)(r)&&(t.superSizeEmoticons=No(e)?(n=r,!t.containsPotentiallyIncludedWhitespace&&n<Lo&&n+1):!function(e){return e&&!No(e.parent)&&!(e.parent&&No(e.parent.parent))&&(Mo.test(e.name||"")||!(!e.data||!e.data.replace("","").replace(/[\u200B-\u200D\uFEFF]/g,"").trim()));}(e)&&r);},e=Object(i.__decorate)([He({name:"BigEmoticonPreprocessor",filter:"*"})],e);}();var Fo="blob:"+window.location.origin;var Vo,Bo,Go=function(){function e(e){var t=e.loggerFactory;this._logger=t.newLogger("InlineImageSerializer");}var t;return e.prototype.transform=function(e,t){var n=this;if(!this.isConfigValid(t))return this._logger.error("invalid config"),Promise.resolve(void 0);var r=re.b.DomUtils.getAttributeValue(e,"src");if(!r)return this._logger.error("image src is missing"),Promise.resolve(void 0);var o=function(e){if(e&&I(e)){var t=new RegExp(k+"/([\\w|\\-]+)","i"),n=e.match(t);return n&&n[1]||"";}return"";}(r);return o?t.asyncMediaService.forwardContent(o,t.conversationId).then(function(r){return n._logger.error("forwarded ams image "+o+" to "+r.objectId),Wo(e,r,t.messageProperties),e;}).catch(function(e){throw n._logger.error("forward content failed "+e),e;}):r.startsWith("http://")||r.startsWith("https://")?function(e){return!!e&&(I(e)||e.includes(".giphy.com")||e.includes("statics.teams.cdn.office.net")||e.includes("statics.teams.microsoft.com")||e.includes(Fo));}(r)?Promise.resolve(void 0):t.imageProxyService.getImageAsBinary(r).then(function(r){return n.uploadAndUpdateImage(r,e,t,n._logger);}).catch(function(e){throw n._logger.error("pasted from web image upload failed "+e),e;}):r.startsWith("blob:")?function(e){if(!e||!e.startsWith("blob"))return Promise.reject("undefined blob url");var t=new XMLHttpRequest();return t.open("GET",e,!0),t.responseType="arraybuffer",new Promise(function(e,n){t.onload=function(){200===t.status?e(new Uint8Array(t.response)):n({status:t.status,statusText:t.statusText});},t.send();});}(r).then(function(r){return n.uploadAndUpdateImage(r,e,t,n._logger);}).catch(function(e){throw n._logger.error("image upload failed "+e),e;}):(this._logger.error("deleting unsupported image "+r),Promise.resolve(null));},e.prototype.isConfigValid=function(e){return!!(e&&e.asyncMediaService&&e.messageProperties&&e.imageProxyService&&e.conversationId);},e.prototype.uploadAndUpdateImage=function(e,t,n,r){var o=n.asyncMediaService.createAmsScenario(G.a.AmsImageUpload);return n.asyncMediaService.uploadItem(e,n.conversationId,"IMAGE","MicrosoftTeams-image.png").then(function(e){return o.stop(),Wo(t,e,n.messageProperties),t;}).catch(function(e){throw o.fail({errors:e}),r.error("Ams image upload failed with "+e),e;});},e=Object(i.__decorate)([xe({name:"InlineImageSerializer",filter:["img","image"]}),Object(i.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==mt.IComposeContext&&mt.IComposeContext)?t:Object])],e);}(),Wo=function Wo(e,t,n){e.attribs||(e.attribs={});var r=e.attribs.src;e.attribs.id=t.objectId,e.attribs.href=t.inlineSizeUrl,e.attribs["target-src"]=t.inlineSizeUrl,e.attribs.src=t.inlineSizeUrl,e.attribs[on.itemtype]=Vn.a.amsImage,r&&r.startsWith("blob")&&URL.revokeObjectURL(r),n.amsReferences||(n.amsReferences=[]),n.amsReferences=Object(i.__spreadArrays)(n.amsReferences,[t.objectId]);},$o=function(){function e(){}return e.prototype.transform=function(e){return e.attribs||(e.attribs={}),e.attribs.class="copy-paste-table",e.attribs.itemprop="copy-paste-table",e;},e=Object(i.__decorate)([He({name:"TableSerializer",filter:"table",transient:!0})],e);}(),zo=function(){function e(){}return e.prototype.transform=function(e){return Object(p.isEmpty)(e.children)&&re.b.DomUtils.appendChild(e,se("")),e;},e=Object(i.__decorate)([He({name:"TableCellSerializer",filter:"td",transient:!0})],e);}(),qo=n(1283),Jo=function(){function e(e){var t=e.loggerFactory;this._logger=t.newLogger("UrlPreviewSerializer");}var t;return e.prototype.transform=function(e,t){return Object(i.__awaiter)(this,void 0,Promise,function(){var n,r,o;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(!e||!t.messageProperties||t.messageProperties.urlPreview||!t.urlPreviewService||!re.b.DomUtils.hasAttrib(e,"href"))return[2,void 0];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,t.urlPreviewService.getPreview(e.attribs.href)];case 2:return n=i.sent(),[3,4];case 3:return r=i.sent(),this._logger.warn("url preview failed "+r),n=void 0,[3,4];case 4:return n?(o=Object(qo.b)(n),t.messageProperties.urlPreview=o,[2,e]):[2,void 0];}});});},e=Object(i.__decorate)([xe({name:"URLPreviewSerializer",filter:"a",transient:!0}),Object(i.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==mt.IComposeContext&&mt.IComposeContext)?t:Object])],e);}(),Xo=/^(\s|[\u200B-\u200D\uFEFF])*$/,Qo=function(){function e(){}return e.prototype.preTransform=function(e,t){return Yo(e)?void(t.whiteSpaceId&&t.whiteSpaceId++):(t.whiteSpaceId||(t.whiteSpaceId=1),e.attribs||(e.attribs={}),e.attribs["data-only-whitespace"]=""+(t.whiteSpaceId+1),e);},e=Object(i.__decorate)([He({name:"WhiteSpacePreprocessor",filter:["div","p","br","span","text"],transient:!0})],e);}(),Yo=function Yo(e){return!Xo.test(oe(e))||!!re.b.DomUtils.findOne(function(e){if(e.attribs&&Object.keys(e.attribs).length||!e.name)return!0;switch(e.name.toLowerCase()){case"br":case"div":case"p":case"span":break;default:return!0;}return!1;},[e]);},Zo=function(){function e(){}return e.prototype.transform=function(e,t){if(t.whiteSpaceId)return+re.b.DomUtils.getAttributeValue(e,"data-only-whitespace")>t.whiteSpaceId?null:(delete e.attribs["data-only-whitespace"],e);},e=Object(i.__decorate)([He({name:"TrailingWhiteSpaceSerializer",filter:["data-only-whitespace"],transient:!0})],e);}(),ei=function(){function e(){}return e.prototype.preTransform=function(e){return null;},e=Object(i.__decorate)([He({name:"RemoveHiddenSelectionSerializer",filter:["data-cke-hidden-sel"]})],e);}(),ti=function(){function e(e){var t=e.loggerFactory;this._logger=t.newLogger("CodeSnippetsSerializer");}var t;return e.prototype.transform=function(e,t){return Object(i.__awaiter)(this,void 0,Promise,function(){var n,r,o,a,s,c;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(!e||!t||!t.messageProperties)return[2,void 0];if(n=Object(p.unescape)(re.b.DomUtils.getAttributeValue(e,"data-itemprops")),r=re.b.DomUtils.getAttributeValue(e,"itemid"),o=re.b.DomUtils.getElementsByTagName("code",e)[0],!n)return this._logger.error("The props was missing"),[2,null];if(!o)return this._logger.error("The code snippet was missing"),[2,null];if(!r)return this._logger.error("The id of the card was missing"),[2,null];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this._uploadAndUpdateCard(r,JSON.parse(n),o,t)];case 2:return i.sent(),a=ce("span",{content:r,itemprop:"cardId"}),s=ce("span",{class:"inline-compose-card",itemid:r,itemscope:"",itemtype:Vn.a.inputExtension}),re.b.DomUtils.appendChild(s,a),this._logger.debug("Uploaded code snippet",r),[2,s];case 3:return c=i.sent(),this._logger.error("Failed to upload the code snippet",c),[2,null];case 4:return[2];}});});},e.prototype._uploadAndUpdateCard=function(e,t,n,r){return Object(i.__awaiter)(this,void 0,Promise,function(){var o,a,s,c,d,u,l,f,p;return Object(i.__generator)(this,function(h){switch(h.label){case 0:return o=t.amsReferenceId,a=t.source,s=t.name,c=t.language,d=t.wrap,u=r.messageProperties.amsReferences||[],l=r.messageProperties.cards||[],o?[3,2]:(f=re.b.DomUtils.getInnerHTML(n),p=a+"~~~~###@@TACOCAT@@###~~~~"+f,[4,r.asyncMediaService.uploadItem(p,r.conversationId,"DOCUMENT")]);case 1:o=h.sent().objectId,h.label=2;case 2:return r.messageProperties.amsReferences=Object(i.__spreadArrays)(u,[o]),r.messageProperties.cards=Object(i.__spreadArrays)(l,[{appId:e,cardClientId:e,contentType:"application/vnd.microsoft.card.codesnippet",content:JSON.stringify({type:"application/vnd.microsoft.card.codesnippet",editable:!0,id:e,name:s,language:c,wrap:d,lines:n.children?n.children.length:0,cardClientId:e,amsReferenceId:o})}]),[2];}});});},e=Object(i.__decorate)([xe({name:"CodeSnippets",filter:(Vo={},Vo.itemscope="CodeSnippetCard",Vo)}),Object(i.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==mt.IComposeContext&&mt.IComposeContext)?t:Object])],e);}(),ni=n(2705),ri=function(){function e(){}return e.prototype.transform=function(e,t){if(e&&re.b.DomUtils.hasAttrib(e,"href")&&t&&t.files&&t.messageProperties&&t.existingLinks){if(!re.b.DomUtils.hasAttrib(e,on.itemProps))return di(e,t);var n=e.attribs[on.itemid],r=t.files,o=t.messageProperties;try{var i=ci(r,e);if(!i)return;var a=i.objectUrl,s=i.shareUrl,c=i.title,d=i.type;s&&(e.attribs.href=s),oi(e,c,s);var u=ai({objectUrl:a,shareUrl:s,itemid:n,type:d,title:c});si(o,u);}catch(e){return;}return e;}},e=Object(i.__decorate)([He({name:"SharepointLinkSerializer",filter:"a"})],e);}(),oi=function oi(e,t,n){e.children&&ii(t,e,n);},ii=function ii(e,t,n){for(var r=[t];0!==r.length;){var o=r.pop();if(o&&o.children)for(var i=0,a=o.children;i<a.length;i++){var s=a[i];if("text"===s.type&&Object(p.startsWith)(s.data,"https"))return s.data=e,t.attribs&&(t.attribs.title=n),!0;r.push(s);}}return!1;},ai=function ai(e){var t=e.objectUrl,n=e.shareUrl,r=e.itemid,o=e.type;return{title:e.title,objectUrl:t,description:"",fileShareUrlMeta:{id:r||"",objectUrl:t,type:o,shareUrl:n}};},si=function si(e,t){e.embeddedLinks||(e.embeddedLinks=[]),e.embeddedLinks.push(t);},ci=function ci(e,t){var n=t.attribs[on.itemid],r=e.find(function(e){return e.id===n;});if(r)return{shareUrl:r.shareUrl,title:r.title,objectUrl:c=r.objectUrl,type:s=r.type};if(t.attribs[on.itemtype]===Vn.a.filesHyperlink){var o=t.attribs[on.itemProps];if(o){var i=Object(p.unescape)(Object(p.unescape)(o)),a=JSON.parse(i),s=a.type,c=a.objectUrl;return{shareUrl:a.shareUrl,title:a.title,objectUrl:c,type:s};}}},di=function di(e,t){if(re.b.DomUtils.hasAttrib(e,"href")){var n=e.attribs.href,r=t.existingLinks.filter(function(e){var t;return(null===(t=e.fileShareUrlMeta)||void 0===t?void 0:t.shareUrl)===n;});if(r&&r.length&&r[0].fileShareUrlMeta)return si(t.messageProperties,Object(ni.a)(r[0],"__typename")),e;}},ui=[function(){function e(){}return e.prototype.transform=function(e){if(e.data&&Q.test(e.data))return e.data=e.data.replace(new RegExp(Q,"g"),""),e;},e=Object(i.__decorate)([He({name:"RemoveZwsSerializer",filter:"text",transient:!0})],e);}(),ei,Uo,Go,Eo,ti,zo,$o,xo,Ko,Qo,Zo,Jo,ri,function(){function e(e){var t=e.loggerFactory;this._logger=t.newLogger("MessageExtensionCardSerializer");}var t;return e.prototype.transform=function(e,t){return Object(i.__awaiter)(this,void 0,Promise,function(){var n,r,o,a,s,c;return Object(i.__generator)(this,function(d){if(!e||!t||!t.messageProperties)return[2,void 0];if(n=Object(p.unescape)(re.b.DomUtils.getAttributeValue(e,"data-itemprops")),r=re.b.DomUtils.getAttributeValue(e,"itemid"),!n)return this._logger.error("The props was missing"),[2,null];if(!r)return this._logger.error("The id of the card was missing"),[2,null];try{return o=t.messageProperties.cards||[],(a=JSON.parse(n).card).cardClientId=r,t.messageProperties.cards=Object(i.__spreadArrays)(o,[a]),s=ce("span",{content:r,itemprop:"cardId"}),c=ce("span",{class:"inline-compose-card",itemid:r,itemscope:"",itemtype:Vn.a.inputExtension}),re.b.DomUtils.appendChild(c,s),[2,Promise.resolve(c)];}catch(e){return this._logger.error("Error while adding message extension card to message",e),[2,Promise.resolve(null)];}return[2];});});},e=Object(i.__decorate)([xe({name:"MessageExtension",filter:(Bo={},Bo.itemscope="MessageExtensionCard",Bo)}),Object(i.__metadata)("design:paramtypes",["function"==typeof(t=void 0!==mt.IComposeContext&&mt.IComposeContext)?t:Object])],e);}()],li=function li(e,t,n,r,o){var a;return Object(i.__awaiter)(void 0,void 0,Promise,function(){var s,c,d=e.content,u=e.computed,l=e.files,f=e.clientMessageId,p=Object(i.__rest)(e,["content","computed","files","clientMessageId"]);return Object(i.__generator)(this,function(e){switch(e.label){case 0:return s=Object(i.__assign)({conversationId:t,existingLinks:(null===(a=u)||void 0===a?void 0:a.embeddedLinks)||[],messageProperties:u?Object(i.__assign)(Object(i.__assign)({},u),{embeddedLinks:[]}):{},files:l},o),[4,Le(ui,d,{coreSettings:n,loggerFactory:r},s)];case 1:return c=e.sent(),r.newLogger("chat-resolver-utils").log("serialized message "+f),[2,Object(i.__assign)({content:c,computed:s.messageProperties,files:l,clientMessageId:f},p)];}});});},fi={Mutation:{sendMessage:function sendMessage(e,t){var n=e.convId,r=e.message,o=e.action,a=t.asyncMediaService,s=t.imageProxyService,c=t.urlPreviewService,d=t.loggerFactory,u=t.coreSettings;return Object(i.__awaiter)(this,void 0,Promise,function(){var e;return Object(i.__generator)(this,function(t){switch(t.label){case 0:return[4,li(r,n,u,d,{asyncMediaService:a,imageProxyService:s,urlPreviewService:c})];case 1:return e=t.sent(),[2,{convId:n,message:e,action:o}];}});});}}},pi=n(1462),hi=function hi(e){return e.subscribe({query:pi}).map(function(e){return e.data;});},mi=n(1463),gi=function gi(e){return e.subscribe({query:mi}).map(function(e){return e.data;});};function bi(e){return{chatServicePostActiveSubscription:hi(e),presencePostActiveSubscription:gi(e)};}n.d(t,"resolvers",function(){return X;}),n.d(t,"context",function(){return q;}),n.d(t,"IContext",function(){}),n.d(t,"chatMutationForwardResolvers",function(){return fi;}),n.d(t,"createSubscriptionEvents",function(){return bi;});},817:function _(e,t){},825:function _(e,t){},839:function _(e,t){},859:function _(e,t,n){"use strict";var r=n(789),o=n(784),i=n(785),a=n(786),s=n(787),c=n(788),d=n(783),u=n(3),l=n(1016),f=n(782),p=n(883),h=n(790),m=function(e){function t(){return Object(o.a)(this,t),Object(a.a)(this,Object(s.a)(t).apply(this,arguments));}return Object(c.a)(t,e),Object(i.a)(t,[{key:"renderComponent",value:function value(e){var t=e.ElementType,n=e.classes,o=e.unhandledProps,i=e.accessibility;return u.createElement(t,Object(r.a)({},i.attributes.root,o,{className:n.root}));}}]),t;}(l.a);Object(d.a)(m,"displayName","ToolbarDivider"),Object(d.a)(m,"create",void 0),Object(d.a)(m,"className","ui-toolbar__divider"),Object(d.a)(m,"propTypes",Object.assign({},f.commonPropTypes.createCommon())),m.create=Object(p.a)({Component:m,mappedProp:"content"}),t.a=Object(h.a)(m);},860:function _(e,t){},872:function _(e,t,n){"use strict";var r=n(789),o=n(784),i=n(785),a=n(786),s=n(787),c=n(791),d=n(788),u=n(783),l=n(881),f=n.n(l),p=n(793),h=n.n(p),m=n(3),g=n(4),b=n(792),v=n(796),y=n(1018),_=function _(e){var t=Object(y.a)(e);return t.attributes.root=Object.assign({},t.attributes.root,{"aria-haspopup":e.popup?"dialog":e.menu?"menu":void 0}),t.keyActions.wrapper=Object.assign({},t.keyActions.wrapper,{performWrapperClick:{keyCombinations:[{keyCode:v.Enter},{keyCode:v.Spacebar}]},closeMenuAndFocusTrigger:{keyCombinations:e.menu&&e.menuOpen?[{keyCode:v.Escape},{keyCode:v.Tab,shiftKey:!0}]:null},doNotNavigateNextToolbarItem:{keyCombinations:e.menu&&e.menuOpen?[{keyCode:v.ArrowLeft},{keyCode:v.ArrowRight}]:null}}),t;},O=n(781),C=n.n(O),w=n(2723),j=n(2725),S=n(1120),E=n(1097),T=n(1098),k=n(1016),P=n(782),I=n(883),A=n(790),H=n(2671),x=n(849),K=n(797),R=n(801),D=n(848),M=n(805),N=n(2720),L=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),d=0;d<r;d++){i[d]=arguments[d];}return n=Object(a.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(i))),Object(u.a)(Object(c.a)(n),"actionHandlers",{performClick:function performClick(e){e.preventDefault(),n.handleClick(e);},performWrapperClick:function performWrapperClick(e){n.handleWrapperClick(e);},closeMenuAndFocusTrigger:function closeMenuAndFocusTrigger(e){n.trySetMenuOpen(!1,e),h()(n.itemRef.current,"focus");},doNotNavigateNextToolbarItem:function doNotNavigateNextToolbarItem(e){e.stopPropagation();}}),Object(u.a)(Object(c.a)(n),"itemRef",m.createRef()),Object(u.a)(Object(c.a)(n),"menuRef",m.createRef()),Object(u.a)(Object(c.a)(n),"handleMenuOverrides",function(e,t){return function(r){return{onBlur:function onBlur(t){f()(e(),function(e){return e.current.contains(t.relatedTarget);})||n.trySetMenuOpen(!1,t);},onItemClick:function onItemClick(e,t){var o=t.popup,i=t.menuOpen;h()(r,"onItemClick",e,t),o||(n.trySetMenuOpen(i,e),i||h()(n.itemRef.current,"focus"));},variables:Object(M.d)(t,r.variables)};};}),Object(u.a)(Object(c.a)(n),"handleBlur",function(e){h()(n.props,"onBlur",e,n.props);}),Object(u.a)(Object(c.a)(n),"handleFocus",function(e){h()(n.props,"onFocus",e,n.props);}),Object(u.a)(Object(c.a)(n),"handleClick",function(e){var t=n.props,r=t.disabled,o=t.menu,i=t.menuOpen;r?e.preventDefault():(o&&n.trySetMenuOpen(!i,e),h()(n.props,"onClick",e,n.props));}),Object(u.a)(Object(c.a)(n),"handleWrapperClick",function(e){n.props.menu&&Object(S.a)(n.menuRef.current,e,n.context.target)&&(n.trySetMenuOpen(!1,e),h()(n.itemRef.current,"focus"));}),Object(u.a)(Object(c.a)(n),"handleOutsideClick",function(e){return function(t){var r=Object(S.a)(n.itemRef.current,t,n.context.target),o=f()(e(),function(e){return Object(S.a)(e.current,t,n.context.target);});r||o||n.trySetMenuOpen(!1,t);};}),n;}return Object(d.a)(t,e),Object(i.a)(t,[{key:"renderComponent",value:function value(e){var n=this,o=e.ElementType,i=e.classes,a=e.unhandledProps,s=e.accessibility,c=e.variables,d=this.props,u=d.icon,l=d.children,f=d.disabled,p=d.popup,g=d.menu,b=d.menuOpen,v=d.wrapper,y=m.createElement(o,Object(r.a)({},s.attributes.root,a,Object(E.a)(s.keyHandlers.root,a),{disabled:f,className:i.root,onBlur:this.handleBlur,onFocus:this.handleFocus,onClick:this.handleClick}),Object(T.a)(l)?l:K.a.create(u)),_=b?m.createElement(N.a,null,function(e,t){return m.createElement(m.Fragment,null,m.createElement(w.a,{innerRef:function innerRef(e){t.current=e,n.menuRef.current=e;}},m.createElement(H.a,{align:"start",position:"above",modifiers:{preventOverflow:{escapeWithReference:!1}},targetRef:n.itemRef},x.a.create(g,{overrideProps:n.handleMenuOverrides(e,c)}))),m.createElement(j.a,{listener:n.handleOutsideClick(e),target:n.context.target,type:"click",capture:!0}));}):null;if(p)return D.a.create(p,{defaultProps:function defaultProps(){return{trapFocus:!0};},overrideProps:{trigger:y,children:void 0}});if(g){var O=m.createElement(m.Fragment,null,m.createElement(w.a,{innerRef:this.itemRef},y),_);return v?R.a.create(v,{defaultProps:function defaultProps(){return Object.assign({className:C()(t.slotClassNames.wrapper,i.wrapper)},s.attributes.wrapper,Object(E.a)(s.keyHandlers.wrapper,v));},overrideProps:function overrideProps(e){return{children:O,onClick:function onClick(t){n.handleWrapperClick(t),h()(e,"onClick",t);}};}}):O;}return m.createElement(w.a,{innerRef:this.itemRef},y);}},{key:"trySetMenuOpen",value:function value(e,t){h()(this.props,"onMenuOpenChange",t,Object.assign({},this.props,{menuOpen:e}));}}]),t;}(k.a);Object(u.a)(L,"displayName","ToolbarItem"),Object(u.a)(L,"className","ui-toolbar__item"),Object(u.a)(L,"slotClassNames",{wrapper:"".concat(L.className,"__wrapper")}),Object(u.a)(L,"create",void 0),Object(u.a)(L,"propTypes",Object.assign({},P.commonPropTypes.createCommon(),{active:g.bool,disabled:g.bool,icon:b.k,menu:g.oneOfType([b.o,g.arrayOf(b.o)]),menuOpen:g.bool,onMenuOpenChange:g.func,onClick:g.func,onFocus:g.func,onBlur:g.func,popup:g.oneOfType([g.shape(Object.assign({},D.a.propTypes,{trigger:b.l,children:b.l})),g.string]),wrapper:b.o})),Object(u.a)(L,"defaultProps",{as:"button",accessibility:_,wrapper:{}}),L.create=Object(I.a)({Component:L,mappedProp:"content"});t.a=Object(A.a)(L);},894:function _(e,t,n){"use strict";var r=n(789),o=n(784),i=n(785),a=n(786),s=n(787),c=n(791),d=n(788),u=n(783),l=n(793),f=n.n(l),p=n(824),h=n(3),m=n(4),g=n(1098),b=n(1016),v=n(782),y=n(883),_=n(790),O=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),d=0;d<r;d++){i[d]=arguments[d];}return n=Object(a.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(i))),Object(u.a)(Object(c.a)(n),"handleBlur",function(e){n.props.focusable&&f()(n.props,"onBlur",e,n.props);}),Object(u.a)(Object(c.a)(n),"handleFocus",function(e){n.props.focusable&&f()(n.props,"onFocus",e,n.props);}),n;}return Object(d.a)(t,e),Object(i.a)(t,[{key:"renderComponent",value:function value(e){var t=e.ElementType,n=e.classes,o=(e.variables,e.accessibility),i=e.unhandledProps,a=this.props,s=a.children,c=a.content,d=a.focusable;return h.createElement(t,Object(r.a)({},o.attributes.root,Object(u.a)({},p.a,d),i,{className:n.root,onBlur:this.handleBlur,onFocus:this.handleFocus}),Object(g.a)(s)?s:c);}}]),t;}(b.a);Object(u.a)(O,"displayName","ToolbarCustomItem"),Object(u.a)(O,"className","ui-toolbar__customitem"),Object(u.a)(O,"create",void 0),Object(u.a)(O,"propTypes",Object.assign({},v.commonPropTypes.createCommon(),{fitted:m.oneOfType([m.bool,m.oneOf(["horizontally","vertically"])]),focusable:m.bool,onFocus:m.func,onBlur:m.func})),O.create=Object(y.a)({Component:O,mappedProp:"content"}),t.a=Object(_.a)(O);},906:function _(e,t,n){"use strict";var r=n(789),o=n(784),i=n(785),a=n(786),s=n(787),c=n(791),d=n(788),u=n(783),l=n(808),f=n.n(l),p=n(814),h=n.n(p),m=n(1022),g=n.n(m),b=n(940),v=n.n(b),y=n(3),_=n(4),O=n(792),C=n(2723),w=n(1097),j=n(1098),S=n(1016),E=n(782),T=n(883),k=n(805),P=n(790),I=n(1018),A=function A(e){return{attributes:{root:{role:"radio","aria-checked":e.active,"aria-disabled":e.disabled}},keyActions:Object(I.a)(e).keyActions};},H=n(796),x=function x(){return{attributes:{root:{role:"radiogroup"}},keyActions:{root:{nextItem:{keyCombinations:[{keyCode:H.ArrowDown}]},prevItem:{keyCombinations:[{keyCode:H.ArrowUp}]}}}};},K=n(859),R=n(872),D=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),d=0;d<r;d++){i[d]=arguments[d];}return n=Object(a.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(i))),Object(u.a)(Object(c.a)(n),"itemRefs",[]),Object(u.a)(Object(c.a)(n),"actionHandlers",{nextItem:function nextItem(e){return n.setFocusedItem(e,1);},prevItem:function prevItem(e){return n.setFocusedItem(e,-1);}}),Object(u.a)(Object(c.a)(n),"setFocusedItem",function(e,t){var r=n.props.items,o=v()(n.itemRefs,function(e,t){var n=r[t];return n&&!n.disabled;}),i=g()(o,function(e){return 0===e.current.tabIndex;})||0,a=o.length,s=i+t;s>=a&&(s=0),s<0&&(s=a-1);var c=o[s].current;c&&c.focus(),n.context.target.activeElement===c&&e.stopPropagation(),e.preventDefault();}),Object(u.a)(Object(c.a)(n),"handleItemOverrides",function(e){return function(t){return{variables:Object(k.d)(e,t.variables)};};}),n;}return Object(d.a)(t,e),Object(i.a)(t,[{key:"renderItems",value:function value(e){var t=this,n=this.props,r=n.activeIndex,o=n.items,i=this.handleItemOverrides(e);return this.itemRefs=[],h()(o,function(e,n){var o=f()(e,"kind","item"),a=y.createRef();if(t.itemRefs[n]=a,"divider"===o)return K.a.create(e,{overrideProps:i});var s=R.a.create(e,{defaultProps:function defaultProps(){return{accessibility:A,active:r===n};},overrideProps:i});return y.createElement(C.a,{innerRef:a,key:s.key},s);});}},{key:"renderComponent",value:function value(e){var t=e.ElementType,n=e.classes,o=e.variables,i=e.accessibility,a=e.unhandledProps,s=this.props.children;return y.createElement(t,Object(r.a)({},i.attributes.root,a,Object(w.a)(i.keyHandlers.root,a),{className:n.root}),Object(j.a)(s)?s:this.renderItems(o));}}]),t;}(S.a);Object(u.a)(D,"displayName","ToolbarRadioGroup"),Object(u.a)(D,"className","ui-toolbars"),Object(u.a)(D,"create",void 0),Object(u.a)(D,"propTypes",Object.assign({},E.commonPropTypes.createCommon(),{activeIndex:_.number,items:O.e(["divider","item"])})),Object(u.a)(D,"defaultProps",{accessibility:x}),D.create=Object(T.a)({Component:D,mappedProp:"content"});t.a=Object(P.a)(D);},925:function _(e,t){},949:function _(e,t){},962:function _(e,t,n){"use strict";var r=n(789),o=n(784),i=n(785),a=n(786),s=n(787),c=n(791),d=n(788),u=n(783),l=n(1454),f=n.n(l),p=n(793),h=n.n(p),m=n(1456),g=n.n(m),b=n(808),v=n.n(b),y=n(814),_=n.n(y),O=n(1018),C=function C(e){var t=Object(O.a)(e);return t.attributes.root=Object.assign({},t.attributes.root,{"aria-pressed":!!e.active}),t;},w=n(824),j=n(832),S=function S(e){return{attributes:{root:{role:"toolbar"}},focusZone:{mode:j.b.Embed,props:{shouldFocusInnerElementWhenReceivedFocus:!0,direction:j.a.horizontal}}};},E=n(3),T=n(792),k=n(4),P=n(2723),I=n(2725),A=n(1098),H=n(1016),x=n(782),K=n(883),R=n(805),D=n(790),M=n(894),N=n(859),L=n(872),U=n(849),F=n(856),V=n(843),B=n(870),G=n(906),W=function(e){function t(){var e,n;Object(o.a)(this,t);for(var r=arguments.length,i=new Array(r),d=0;d<r;d++){i[d]=arguments[d];}return n=Object(a.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(i))),Object(u.a)(Object(c.a)(n),"overflowContainerRef",E.createRef()),Object(u.a)(Object(c.a)(n),"overflowItemRef",E.createRef()),Object(u.a)(Object(c.a)(n),"offsetMeasureRef",E.createRef()),Object(u.a)(Object(c.a)(n),"lastVisibleItemIndex",void 0),Object(u.a)(Object(c.a)(n),"animationFrameId",void 0),Object(u.a)(Object(c.a)(n),"rtl",void 0),Object(u.a)(Object(c.a)(n),"handleItemOverrides",function(e){return function(t){return{variables:Object(R.d)(e,t.variables)};};}),Object(u.a)(Object(c.a)(n),"hideOverflowItems",function(){var e=n.overflowContainerRef.current,t=n.overflowItemRef.current,r=n.offsetMeasureRef.current;if(e&&t&&r){n.rtl?e.scrollTo(Number.MAX_SAFE_INTEGER,0):e.scrollTo(0,0);var o,i,a=e.children,s=e.getBoundingClientRect(),c=t.getBoundingClientRect(),d=r.getBoundingClientRect(),u={horizontal:n.rtl?d.right-s.right:s.left-d.left,vertical:s.top-d.top},l=!1;g()(a,function(e,r){if(e===t)return!0;var a=e.getBoundingClientRect();return n.isItemOverflowing(a,s)?(l=!0,n.hide(e),!0):l&&!o&&n.wouldItemCollide(e,a,c,s)?(n.hide(e),!0):(o||(o=e,i=a,n.lastVisibleItemIndex=r),n.show(e));}),l||n.props.overflowOpen?(t.style.position="absolute",n.setOverflowPosition(t,o,i,s,u),n.show(t)):(n.lastVisibleItemIndex=n.props.items.length-1,n.hide(t)),h()(n.props,"onOverflow",n.lastVisibleItemIndex+1);}}),Object(u.a)(Object(c.a)(n),"getOverflowItems",function(){return n.props.getOverflowItems?n.props.getOverflowItems(n.lastVisibleItemIndex+1):n.props.items.slice(n.lastVisibleItemIndex+1);}),Object(u.a)(Object(c.a)(n),"getVisibleItems",function(){var e=n.props.overflowOpen?n.lastVisibleItemIndex+1:n.props.items.length;return n.props.items.slice(0,e);}),Object(u.a)(Object(c.a)(n),"handleWindowResize",f()(function(e){n.hideOverflowItems(),n.props.overflowOpen&&h()(n.props,"onOverflowOpenChange",e,Object.assign({},n.props,{overflowOpen:!1}));},16)),n;}return Object(d.a)(t,e),Object(i.a)(t,[{key:"renderItems",value:function value(e,t){var n=this.handleItemOverrides(t);return _()(e,function(e){switch(v()(e,"kind","item")){case"divider":return N.a.create(e,{overrideProps:n});case"group":return G.a.create(e,{overrideProps:n});case"toggle":return L.a.create(e,{defaultProps:function defaultProps(){return{accessibility:C};},overrideProps:n});case"custom":return M.a.create(e,{overrideProps:n});default:return L.a.create(e,{overrideProps:n});}});}},{key:"hide",value:function value(e){if("hidden"!==e.style.visibility){e.style.visibility="hidden";var t=e.getAttribute(w.a);t&&e.setAttribute("data-was-focusable",t),e.setAttribute(w.a,"false");}}},{key:"show",value:function value(e){if("hidden"!==e.style.visibility)return!1;e.style.visibility=null;var t=e.getAttribute("data-was-focusable");return t?(e.setAttribute(w.a,t),e.removeAttribute("data-was-focusable")):e.removeAttribute(w.a),!0;}},{key:"isItemOverflowing",value:function value(e,t){return e.right>t.right||e.left<t.left;}},{key:"wouldItemCollide",value:function value(e,t,n,r){var o,i=this.context.target.defaultView;if(this.rtl){var a=parseFloat(i.getComputedStyle(e).marginLeft)||0;o=t.left-n.width-a<r.left;}else{var s=parseFloat(i.getComputedStyle(e).marginRight)||0;o=t.right+n.width+s>r.right;}return o;}},{key:"setOverflowPosition",value:function value(e,t,n,r,o){var i=this.context.target.defaultView;if(t){if(this.rtl){var a=parseFloat(i.getComputedStyle(t).marginLeft)||0;e.style.right="".concat(r.right-n.left+a+o.horizontal,"px");}else{var s=parseFloat(i.getComputedStyle(t).marginRight)||0;e.style.left="".concat(n.right-r.left+s+o.horizontal,"px");}}else this.lastVisibleItemIndex=-1,this.rtl?e.style.right="".concat(o.horizontal,"px"):e.style.left="".concat(o.horizontal,"px");}},{key:"componentDidMount",value:function value(){this.afterComponentRendered();}},{key:"componentDidUpdate",value:function value(){this.afterComponentRendered();}},{key:"componentWillUnmount",value:function value(){void 0!==this.animationFrameId&&(this.context.target.defaultView.cancelAnimationFrame(this.animationFrameId),this.animationFrameId=void 0);}},{key:"afterComponentRendered",value:function value(){var e=this,t=this.context.target.defaultView;void 0!==this.animationFrameId&&t.cancelAnimationFrame(this.animationFrameId),this.animationFrameId=t.requestAnimationFrame(function(){e.hideOverflowItems();});}},{key:"renderOverflowItem",value:function value(e){var t=this;return E.createElement(P.a,{innerRef:this.overflowItemRef},L.a.create(e,{defaultProps:function defaultProps(){return{icon:{name:"more",outline:!0}};},overrideProps:{menu:this.props.overflowOpen?this.getOverflowItems():[],menuOpen:this.props.overflowOpen,onMenuOpenChange:function onMenuOpenChange(e,n){var r=n.menuOpen;h()(t.props,"onOverflowOpenChange",e,Object.assign({},t.props,{overflowOpen:r}));}}}));}},{key:"renderComponent",value:function value(e){var t=e.accessibility,n=e.ElementType,o=e.classes,i=(e.styles,e.variables),a=e.unhandledProps,s=e.rtl;this.rtl=s;var c=this.props,d=c.children,u=c.items,l=c.overflow,f=c.overflowItem;return l?E.createElement(E.Fragment,null,E.createElement(n,Object(r.a)({className:o.root},t.attributes.root,a),E.createElement("div",{className:o.overflowContainer,ref:this.overflowContainerRef},Object(A.a)(d)?d:this.renderItems(this.getVisibleItems(),i),this.renderOverflowItem(f)),E.createElement("div",{className:o.offsetMeasure,ref:this.offsetMeasureRef})),E.createElement(I.a,{listener:this.handleWindowResize,target:this.context.target.defaultView,type:"resize"})):E.createElement(n,Object(r.a)({className:o.root},t.attributes.root,a),Object(A.a)(d)?d:this.renderItems(u,i));}}]),t;}(H.a);Object(u.a)(W,"create",void 0),Object(u.a)(W,"className","ui-toolbar"),Object(u.a)(W,"displayName","Toolbar"),Object(u.a)(W,"propTypes",Object.assign({},x.commonPropTypes.createCommon(),{items:T.e(["divider","item","group","toggle","custom"]),overflow:k.bool,overflowOpen:k.bool,overflowItem:T.o,onOverflow:k.func,onOverflowOpenChange:k.func,getOverflowItems:k.func})),Object(u.a)(W,"defaultProps",{accessibility:S,items:[],overflowItem:{}}),Object(u.a)(W,"CustomItem",M.a),Object(u.a)(W,"Divider",N.a),Object(u.a)(W,"Item",L.a),Object(u.a)(W,"Menu",U.a),Object(u.a)(W,"MenuDivider",F.a),Object(u.a)(W,"MenuItem",V.a),Object(u.a)(W,"MenuRadioGroup",B.a),Object(u.a)(W,"RadioGroup",G.a),W.create=Object(K.a)({Component:W,mappedProp:"content"});t.a=Object(D.a)(W);}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/56-aeacf2c40b4ac802d6e3.js.map