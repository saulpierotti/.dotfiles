function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function _typeof(obj){return typeof obj;};}else{_typeof=function _typeof(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};}return _typeof(obj);}(this.webpackJsonp=this.webpackJsonp||[]).push([[57],{1051:function _(e,t){},1052:function _(e,t){},2718:function _(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"DataSource",function(){return _t;});var i=n(0),a=n(183),o=n(2703),s=n(1255),c=n(1048);var u=function u(e){var t=e.mri,n={id:t,objectId:e.objectId,mri:t,displayName:e.displayName,givenName:e.givenName,surname:e.surname,type:e.type,jobTitle:e.jobTitle,userPrincipalName:e.userPrincipalName,email:e.email,tenantId:e.tenantId,sipProxyAddress:e.sipProxyAddress,mobile:e.mobile};if(e.featureSettings&&(n=Object(i.__assign)(Object(i.__assign)({},n),{featureSettings:e.featureSettings})),(function(e){return void 0!==e.userType;}(e)||function(e){var t=e;return t.type?t.type===c.b.botType:Object(s.d)(e.mri);}(e))&&(n=Object(i.__assign)(Object(i.__assign)({},n),{userType:e.userType,description:e.description,isUnified:e.isUnified,securityEnabled:e.securityEnabled,featureSettings:e.featureSettings,imageUri:e.imageUri})),function(e){var t=e;return void 0!==t.isFederated||void 0!==t.isAnonymousB2bUser;}(e)){var r=e.isFederated,a=e.fetchErrorCode,o=e.isAnonymousB2bUser;n=Object(i.__assign)(Object(i.__assign)({},n),{isFederated:r,fetchErrorCode:a,isAnonymousB2bUser:o});}return l(n);},l=function l(e){var t=e.mri;if(Object(o.b)(t)&&!e.displayName){var n=Object(o.a)(t);return Object(i.__assign)(Object(i.__assign)({},e),{displayName:n,givenName:n});}return e.displayName||(e.displayName="Unknown User"),e;},d=n(11);function p(e,t){return Object(i.__awaiter)(this,void 0,Promise,function(){var n,r,a,o;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return n=Object(d.uniqBy)(e,function(e){return e.id;}),r=Object(d.chunk)(n.map(function(e){return e.id;}),t.MAX_PEOPLE_MRI_LIMIT),[4,Promise.all(r.map(function(e){return t.getPeopleProfilesByMris(e);}))];case 1:return a=i.sent(),o=[],a.forEach(function(e){o=o.concat(Array.from(e.values(),u));}),[2,o];}});});}var g=n(134),m=n(724),h=n(54),v=n(1049),f=n(769),b=n(921);var y=function y(e){return e.threadProperties&&!!e.threadProperties[b.z.ParentSpaces];};var S=function S(e,t){return void 0===t&&(t=!1),e.type===b.e.Chat||e.type===b.e.PhoneChat||e.type===b.e.OneOnOne||!t&&O(e);},O=function O(e){return e.type===b.e.Meeting;};var C,_=function _(e){return!!e&&(Object(d.endsWith)(e,b.t)||Object(d.startsWith)(e,b.u));},M=function M(e){var t,n=e.threadProperties&&e.threadProperties[b.z.SpaceId];return((t=e).threadProperties&&t.threadProperties[b.z.ThreadType]===b.A.Team&&!y(t)?e.id:y(e)?function(e){if(e.parentId)return e.parentId;if(y(e))try{var t=JSON.parse(e.threadProperties[b.z.ParentSpaces]).linkedSpaceInfoItems[0].spaceThreadId;if(!Object(d.isEmpty)(t))return e.parentId=t,t;}catch(e){return;}}(e):n)||e.teamId;},I=function I(e){return!(!e.properties||!e.properties[b.d.Alerts])&&"true"!==e.properties[b.d.Alerts].toLowerCase();},w=function w(e){var t=e.currentUserId;return e.chatServiceEndpointProvider.createEndpoint("Agent,Presence2015,MessageProperties,CustomUserProperties,NotificationStream,SupportsSkipRosterFromThreads",t);},j=function j(e,t){return Object(i.__awaiter)(void 0,void 0,Promise,function(){return Object(i.__generator)(this,function(n){return[2,w({currentUserId:e,chatServiceEndpointProvider:t})];});});};function T(e,t,n,r){return Object(i.__asyncGenerator)(this,arguments,function(){var a,o,s,c,u;return Object(i.__generator)(this,function(l){switch(l.label){case 0:return l.trys.push([0,,12,14]),[4,Object(i.__await)(j(n,t))];case 1:a=l.sent(),l.label=2;case 2:l.trys.push([2,10,,11]),l.label=3;case 3:return[4,Object(i.__await)(N(e,t,a,r))];case 4:return o=l.sent(),s=o.eventMessages,c=o.next,s?[5,Object(i.__values)(Object(i.__asyncDelegator)(Object(i.__asyncValues)(s)))]:[3,7];case 5:return[4,i.__await.apply(void 0,[l.sent()])];case 6:l.sent(),l.label=7;case 7:a=c,l.label=8;case 8:return[3,3];case 9:return[3,11];case 10:throw u=l.sent(),Object(g.a)(h.d.LongPoll,h.c.PollRuntimeFailure,"longPollUntilError",{innerError:u});case 11:return[3,14];case 12:return[4,Object(i.__await)(t.deleteEndpoint())];case 13:return l.sent(),[7];case 14:return[2];}});});}!function(e){e[e.LOW=400]="LOW",e[e.HIGH=500]="HIGH";}(C||(C={}));var P=function P(e){var t=e.longPollUrl,n=e.chatService,r=e.addActiveTimeoutParamToHeader;return n.pollSubscription(t,r);},N=function N(e,t,n,r){return Object(i.__awaiter)(void 0,void 0,Promise,function(){var a;return Object(i.__generator)(this,function(i){return a=r&&t.isConnected,[2,P({longPollUrl:n,chatService:e,addActiveTimeoutParamToHeader:a})];});});},E=n(2706),A=n(216),D=n(289),k=n(767),R=2e3,L=12e4,U=12e4,B=new E.e(1e4);function F(e,t,n){return Object(i.__asyncGenerator)(this,arguments,function(){var r;return Object(i.__generator)(this,function(a){switch(a.label){case 0:return a.trys.push([0,8,,10]),[4,Object(i.__await)(n())];case 1:return r=a.sent(),[4,Object(i.__await)(z({chatService:e,chatServiceEndpointProvider:t,userId:r,delay:new E.c(R,2,L)}))];case 2:return[4,i.__await.apply(void 0,[a.sent()])];case 3:return[4,a.sent()];case 4:return a.sent(),[4,Object(i.__await)(Object(A.a)(U))];case 5:return a.sent(),[4,Object(i.__await)("")];case 6:return[4,a.sent()];case 7:return a.sent(),[3,10];case 8:return a.sent(),[4,Object(i.__await)(Object(A.a)(B.next()))];case 9:return a.sent(),[3,10];case 10:return[3,0];case 11:return[2];}});});}var x,H,z=Object(D.a)(function(e){var t=e.chatServiceEndpointProvider,n=e.userId;return Object(k.a)(t.postActiveEndpoint(n),3e4);},function(e,t){var n=t.delay;return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){if(e.context===h.d.RequireStatus&&((r=Object(g.c)(e,"status",0))!==h.g.THROTTLED&&r>=C.LOW&&r<C.HIGH||0===r)||e.context===h.d.Timed||e instanceof TypeError)throw e;return[2,Object(A.a)(n.next())];var r;});});}),G=n(1047),W=n(2702),V=n(1280);!function(e){e[e.Standard=0]="Standard",e[e.Important=2]="Important",e[e.Urgent=3]="Urgent";}(x||(x={})),function(e){e.Standard="",e.Important="high",e.Urgent="urgent";}(H||(H={}));var K=function K(e){return q(e)===a.a.MessageImportance.Important;},J=function J(e){return H[e]||H.Standard;},q=function q(e){switch(e){case H.Important:case x.Important:return a.a.MessageImportance.Important;case H.Urgent:case x.Urgent:return a.a.MessageImportance.Urgent;case H.Standard:case x.Standard:default:return a.a.MessageImportance.Standard;}},Q="http://schema.skype.com/Mention",Z=W.a,Y=new Map([["sms",a.a.EscalationModality.SMS],["email",a.a.EscalationModality.Email],["call",a.a.EscalationModality.Call],["teamscall",a.a.EscalationModality.TeamsCall],["etnp",a.a.EscalationModality.ETNP]]),X=new Set(["RichText/Media_CallRecording","Event/Call"]),$="preview-",ee=function ee(e){return e&&e.emotions?e.emotions.map(function(e){return{key:e.key,users:e.users.map(function(e){var t=e.mri,n=e.time,r=e.value;return{id:Z(t),time:n,value:r};})};}):null;},te=function te(e){return e&&e.escalations?JSON.parse(e.escalations).map(function(e){var t=e.key,n=e.users;return{key:Y.get(t),users:n.map(function(e){var t=e.mri,n=e.time,r=e.value;return{mri:Z(t),time:n,value:r};})};}):null;},ne=function ne(e,t){if(!e||!e.mentions)return null;var n="string"==typeof e.mentions?JSON.parse(e.mentions):e.mentions;return n?n.map(function(e){var n=e.itemid,r=e.mri,i=e.displayName,a=e.mentionType;return{id:t+"_"+n,userId:r,itemId:n,displayName:i,mentionType:a};}):null;},re=function re(e){if(!e||!e.files)return null;try{var t=JSON.parse(e.files);return Object(d.map)(t,function(e){return ie(e);});}catch(e){return null;}},ie=function ie(e){var t,n=["http","https"],r=e.filePreview,o=e.chicletBreadcrumbs,s=e.fileInfo,c=e.anchorFileId,u=e.progressComplete,l=e.isUploadError,d=e.fileChicletState,p=s.shareUrl,g=s.shareId,m=r||{},h=null===(t=d)||void 0===t?void 0:t.serviceName,v=ae(e,2),f=v.id,b=v.baseUrl,y=v.objectUrl,S=v.type,O=v.title,C=v.state,_="active"!==C&&"hidden"!==C;return Object(i.__assign)({id:f,chicletBreadcrumbs:o,baseUrl:Object(V.d)(b,n),objectUrl:Object(V.d)(y,n),shareId:g,shareUrl:p,type:S,title:O,fileId:f,isReferencedFile:_,anchorFileId:c,progressComplete:u&&parseInt(u,10)||null,serviceName:h&&a.a.FileViewServiceName[h],state:C&&a.a.FileChicletState[C],hasUploadFailed:l},m);},ae=function ae(e,t){var n,r,i=e.version,a=e.id,o=e.baseUrl,s=e.objectUrl,c=e.type,u=e.title,l=e.state;if(i!==t&&(a=e.itemid,u=e.fileName,c=e.fileType,s=(n=e.fileInfo).fileUrl,o=n.siteUrl,l=null===(r=e.fileChicletState)||void 0===r?void 0:r.state),"string"!=typeof a)throw Object(g.a)("ChatHelpers",h.c.Undefined,"toFiles",{id:a,version:i,type:c},"File id is missing");return{id:a,baseUrl:o,objectUrl:s,type:c,title:u,state:l};},oe=function oe(e){return JSON.stringify(Object(d.map)(e,function(e){var t=e.id,n=e.baseUrl,r=e.type,i=e.title,a=e.objectUrl,o=e.previewUrl,s=e.shareUrl,c=e.shareId,u=e.state,l=e.chicletBreadcrumbs,d=e.serviceName,p=e.previewHeight,g=e.previewWidth,m=e.progressComplete;return{itemid:t,fileName:i,fileType:r,fileInfo:{fileUrl:a,siteUrl:n,serverRelativeUrl:"",shareUrl:s,shareId:c},fileChicletState:{serviceName:d,state:u},"@type":"http://schema.skype.com/File",version:2,id:t,baseUrl:n,objectUrl:a,type:r,title:i,state:u,chicletBreadcrumbs:l,providerData:{code:null,type:0},botFileProperties:{},isUploadError:e.hasUploadFailed,progressComplete:m,filePreview:{previewUrl:o,previewHeight:p,previewWidth:g}};}));},se=function se(e){return e&&JSON.stringify(Object(d.map)(e,function(e){var t=e.content,n=Object(i.__rest)(e,["content"]);return Object(i.__assign)(Object(i.__assign)({},n),{content:JSON.parse(t)});}));},ce=function ce(e,t){if(!e||!e.links)return{urlPreview:null,embeddedLinks:null};try{var n=["http","https"],r=JSON.parse(e.links),i=[],a=[];return r.forEach(function(e){ue(e,i,n),le(e,a,n);}),{urlPreview:a.length>0?a[0]:null,embeddedLinks:i};}catch(e){return t.newLogger("Chat Helper").log("UnhandledException in message transformation: "+e),{urlPreview:null,embeddedLinks:null};}},ue=function ue(e,t,n){var r=e.url,i=e.fileShareUrlMeta,a=e.title,o=e.description,s=Object(V.d)(r,n);i&&t.push({objectUrl:s,title:a,description:o,fileShareUrlMeta:i});},le=function le(e,t,n){var r=e.url,i=e.preview,a=e.previewenabled,o=i||{},s=o.previewurl,c=o.previewmeta,u=o.title,l=o.description,d=Object(V.d)(r,n);t.push({url:d,thumbnail:Object(V.d)(s,n),title:u,description:l,previewEnabled:a,thumbnailMeta:c?{width:c.width,height:c.height}:null});},de=function de(e,t){if(!t||!t.cards)return null;try{return JSON.parse(t.cards).map(function(e){var t=e.appIcon,n=e.appId,r=e.appName,i=e.cardClientId,a=e.content,o=e.contentType,s=e.locale;return{appIcon:t,appId:n,appName:r,cardClientId:i,content:JSON.stringify(a),contentType:o,locale:s};});}catch(t){return e.newLogger("Chat Helper").log("UnhandledException in toCards: "+t),null;}},pe=function pe(e,t,n,r){var i=r&&r.policyViolation,a=r&&r.genericStreamMetadata;if(!i&&!a)return null;var o={};if("string"==typeof i)try{i=JSON.parse(i);}catch(n){e.newLogger("Chat Helper").log("Exception in parsing PolicyViolation in message: "+t+". Error: "+n);}i&&(o.policyViolation=i);var s=a&&a.policyTip;if("string"==typeof a)try{s=JSON.parse(a).policyTip;}catch(n){e.newLogger("Chat Helper").log("Exception in parsing policy tip in message: "+t+". Error: "+n);}return s&&(o.dlpData={id:t,content:n,policyTip:s}),o;},ge=function ge(e,t){if(!t||!t.meeting)return null;try{var n=JSON.parse(t.meeting);return{organizerId:n.organizerId,tenantId:n.tenantId,itemId:n.itemid,meetingTitle:n.meetingtitle};}catch(t){return e.newLogger("Chat Helper").log("UnhandledException in toMeeting: "+t),null;}},me=function me(e,t,n,r){var i=t||n;if(i)return i;if(r&&X.has(e)){var a=r.match(/<id type="callId"[^>]*?\svalue="([^"]+?)"/i);return a&&a[1]||null;}return null;},he=function he(e,t,n){var r=e.id,o=e.content,s=e.originalarrivaltime,c=e.imdisplayname,u=e.from,l=e.messagetype,d=e.properties,p=e.skypeguid,g=e.callId,m=e.clientmessageid;return r&&Object(i.__assign)(Object(i.__assign)({id:r,content:o,originalArrivalTime:s,imDisplayName:c,from:Z(u),messageType:l,isImportant:K(d&&d.importance),importance:q(d&&d.importance),interopDeliveryState:d&&d.deliveryState&&d.deliveryState.state,smsDeliveryReports:d&&d.smsDeliveryReports?d.smsDeliveryReports:null,emotions:ee(d),announcement:be(d),escalations:te(d),mentions:ne(d,r),cards:de(t,d),files:re(d)},ce(d,t)),{deleteTime:d&&d.deletetime,editTime:d&&d.edittime,status:n||a.a.MessageStatus.Delivered,dlpContext:pe(t,r,o,d),meeting:ge(t,d),callId:me(l,g,p||d&&d.skypeguid,o),clientMessageId:m})||void 0;},ve=function ve(e,t){var n=e.id,r=e.from,o=e.properties,s=Object(i.__rest)(e,["id","from","properties"]);if(!n)return null;try{return Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({id:n,from:r,isImportant:K(o&&o.importance),importance:q(o&&o.importance),interopDeliveryState:o&&o.deliveryState&&o.deliveryState.state,smsDeliveryReports:o&&o.smsDeliveryReports?o.smsDeliveryReports:null,emotions:ee(o),announcement:be(o),escalations:te(o),mentions:ne(o,n),cards:de(t,o),files:re(o)},ce(o,t)),{deleteTime:o&&o.deletetime,editTime:o&&o.edittime,status:a.a.MessageStatus.Delivered,dlpContext:pe(t,n,s.content,o),meeting:ge(t,o),callId:o&&o.skypeguid}),s);}catch(e){return t.newLogger("Chat Helper").log("UnhandledException in message transformation: "+e),Object(i.__assign)({id:n,from:r,isImportant:null,emotions:null,mentions:null,files:null,announcement:null,urlPreview:null,deleteTime:null,status:null},s);}},fe=function fe(e){var t=e.originalArrivalTime,n=e.timeStamp,r=e.clientMessageId;return{originalArrivalTime:new Date(t).toISOString(),timeStamp:new Date(n).toISOString(),clientMessageId:r};},be=function be(e){var t={title:"",originalImageUrl:null,croppedImageUrl:null,colorTheme:null};if(!e)return t;var n="string"==typeof e.cards?JSON.parse(e.cards):e.cards;if(!n||0===n.length)return t;var r=n.find(function(e){return"application/vnd.microsoft.teams.messaging-announcementBanner"===e.contentType;});if(!r)return t;var i=ye(r);return{title:e.title?e.title:"",originalImageUrl:i.originalImageUrl,croppedImageUrl:i.croppedImageUrl,colorTheme:i.colorTheme};},ye=function ye(e){var t=Object(d.get)(e,"content.imageData.origImage.src",null),n=Object(d.get)(e,"content.imageData.croppedImage.src",null),r=Object(d.get)(e,"content.imageData.colorTheme",null)||Object(d.get)(e,"content.colorTheme",null);return{originalImageUrl:t=void 0===t?null:t,croppedImageUrl:n=void 0===n?null:n,colorTheme:r=void 0===r?null:r};},Se=function Se(e,t){if(Object(d.isEmpty)(t))return null;var n=t.split(";"),r=n[0],a=n[1],o=n[2];return Object(i.__assign)({id:e},fe({originalArrivalTime:parseInt(r,10),timeStamp:parseInt(a,10),clientMessageId:o}));},Oe=function Oe(e){switch(e){case G.j.None:return a.a.MeetingType.Unknown;case G.j.Adhoc:return a.a.MeetingType.Adhoc;case G.j.Scheduled:return a.a.MeetingType.Scheduled;case G.j.Recurring:return a.a.MeetingType.Recurring;case G.j.Broadcast:return a.a.MeetingType.Broadcast;}},Ce=function Ce(e){return e&&e.map(function(e){return{id:e.id,originalArrivalTime:e.consumptionhorizon,messageVisibilityTime:e.messageVisibilityTime};})||null;};var _e=function _e(e,t,n){try{var r=e.members;return function(e,t,n){var r=e.id,a=e.lastMessage,o=e.properties,s=e.threadProperties,c=Se(r,o[b.d.ConsumptionHorizonBookmark]);return Object(i.__assign)(Object(i.__assign)({},e),{id:r,chatSubType:Te(s.threadType),chatType:Ne(s.threadType),consumptionHorizon:Se(r,o[b.d.ConsumptionHorizon]),consumptionHorizonBookmark:c,creator:s[b.z.Creator],isDisabled:ke(s.isDisabled),isLastMessageFromMe:s.isLastMessageFromMe,isMuted:I(e),isOneOnOne:De(s[b.z.P2PChatUniqueRosterThread]),isRead:s.isRead,lastMessage:a&&he(a,n),meetingInformation:Re(r,s[b.z.Meeting]),members:t,tenantId:s[b.z.TenantId],title:s.topic,type:null,userConsumptionHorizon:c,interopConversationStatus:Ae(o[b.d.InteropConversationStatus])});}(e,r&&r.length?r.map(function(e){return e.id in t?t[e.id]:function(e){return u(Object(i.__assign)(Object(i.__assign)({},e),{mri:e.id,objectId:"",type:"",userPrincipalName:"",isMuted:e.isReader}));}(e);}):[],n);}catch(t){return n.newLogger("Chat Helper").log("UnhandledException in toConversationSchemaFromSkypeConversationLocal transformation: "+t),Object(i.__assign)(Object(i.__assign)({},e),{id:e.id,members:[],type:null});}},Me=function Me(e,t){var n=e.id,r=e.members,o=e.consumptionHorizon,s=e.userConsumptionHorizon,c=e.lastMessage,l=e.creator,p=e.meetingInformation,g=e.isDisabled,m=e.isMuted,h=e.isLastMessageFromMe,v=e.isRead,f=e.isOneOnOne,b=e.chatType,y=(e.createdAt,e.interopConversationStatus),S=Object(i.__rest)(e,["id","members","consumptionHorizon","userConsumptionHorizon","lastMessage","creator","meetingInformation","isDisabled","isMuted","isLastMessageFromMe","isRead","isOneOnOne","chatType","createdAt","interopConversationStatus"]);try{var O=Object(d.map)(r,u),C=p&&{id:n,subject:p.subject,startTime:p.startTime,endTime:p.endTime,meetingType:p.meetingType?Oe(p.meetingType):a.a.MeetingType.Unknown};return Object(i.__assign)(Object(i.__assign)({},S),{id:n,consumptionHorizon:o&&Object(i.__assign)({id:n},fe(o)),consumptionHorizonBookmark:s&&Object(i.__assign)({id:n},fe(s)),userConsumptionHorizon:s&&Object(i.__assign)({id:n},fe(s)),lastMessage:c&&ve(c,t),members:O,creator:l,meetingInformation:C,isDisabled:!!g,isMuted:m,isLastMessageFromMe:!!h,isRead:v,isOneOnOne:!!f,chatType:Ne(b),interopConversationStatus:Ae(y)});}catch(e){return t.newLogger("Chat Helper").log("UnhandledException in conversation object transformation: "+e),Object(i.__assign)(Object(i.__assign)({},S),{id:n,consumptionHorizon:null,consumptionHorizonBookmark:null,userConsumptionHorizon:null,lastMessage:null,members:[],creator:null,meetingInformation:null,chatType:null});}},Ie=function Ie(e){var t=e.notificationCount,n=e.chatCount;return{notificationCount:t,chatCount:n.teamsChats+n.sfbGatewayChats+n.federatedChats};};function we(e){return JSON.stringify(Object(d.map)(e,function(e){var t=e.mentionType,n=e.displayName;return{"@type":Q,itemid:e.itemId,mri:e.userId,mentionType:t,displayName:n};}));}var je,Te=function Te(e){if(e)return"space"===e||"topic"===e?G.c.Channel:"meeting"===e?G.c.Meeting:G.c.None;},Pe=new Map([["chat",a.a.ChatType.Chat],["phonechat",a.a.ChatType.PhoneChat],["meeting",a.a.ChatType.Meeting],["sfbinteropchat",a.a.ChatType.SfBInteropChat]]),Ne=function Ne(e){var t=null;return null==e?t:(void 0===(t=Pe.get(e))&&(t=null),t);},Ee=new Map([["AcceptPending",a.a.InteropConversationStatus.AcceptPending],["Accepted",a.a.InteropConversationStatus.Accepted],["Blocked",a.a.InteropConversationStatus.Blocked]]),Ae=function Ae(e){return e&&Ee.get(e)||null;},De=function De(e){switch(_typeof(e)){case"string":e="true"===e.toLowerCase();case"boolean":return e;default:return!1;}},ke=function ke(e){return Object(d.isString)(e)?"true"===e.toLowerCase():e||!1;},Re=function Re(e,t){if(t){var n=JSON.parse(t);if(Object.keys(t).length)return Object(i.__assign)(Object(i.__assign)({id:e},n),{meetingType:n.meetingType?Oe(G.j[n.meetingType]):a.a.MeetingType.Unknown});}},Le=function Le(e,t,n){var r=ee(n.properties);return!!r&&r.some(function(n){return n.key===e&&!!n.users&&n.users.some(function(e){return e.id===t;});});},Ue=function Ue(e,t){if(e&&e.messagetype===b.c.MemberConsumptionHorizonUpdate){var n=e.conversationid||Object(W.a)(e.conversationLink),r=JSON.parse(e.content);return{__typename:"ConsumptionHorizonUpdate",convId:n,memberConsumptionHorizon:{id:r.user,originalArrivalTime:r.consumptionhorizon,messageVisibilityTime:r.messageVisibilityTime}};}return Object(i.__assign)({__typename:"NewMessage"},function(e,t){var n=he(e,t);if(!n)throw Object(g.a)("ChatHelpers",h.c.Undefined,"toNewMessageSchema",{resource:e},"Bad shaped NewMessage");var r=null;if(e&&e.conversationLink){var i=Object(s.c)(e);r=i===n.id?null:i;}return{convId:e.conversationid||Object(s.b)(e),replyChainId:r,threadType:e.threadtype,threadTopic:e.threadtopic,message:n};}(e,t));},Be=function Be(e,t){return Object(i.__awaiter)(void 0,void 0,Promise,function(){var n,r,a,o,c,u,l;return Object(i.__generator)(this,function(d){switch(d.label){case 0:return n=e.id||"",r=e.properties,a=Object(s.a)(e.members,r,[]).members,o=Re(n,r&&r.meeting),c={__typename:"ThreadUpdate"},u={id:n,title:r&&r.topic,isOneOnOne:r&&De(r.uniquerosterthread)},a?[4,t(a)]:[3,2];case 1:return l=d.sent(),[3,3];case 2:l=[],d.label=3;case 3:return[2,(c.conversation=i.__assign.apply(void 0,[(u.members=l,u),o&&{meetingInformation:Object(i.__assign)({id:n},o)}]),c)];}});});},Fe=function Fe(e,t,n){var r=e.resourceType,a=e.resource;return Object(i.__awaiter)(void 0,void 0,Promise,function(){var e,o,s,c,u,l,d,p,g,m,h,v,f;return Object(i.__generator)(this,function(i){switch(i.label){case 0:switch(i.trys.push([0,10,,11]),r){case"NewMessage":return[3,1];case"MessageUpdate":return[3,2];case"ThreadUpdate":return[3,3];case"ConversationUpdate":return[3,5];case"ResolveConversationLie":return[3,6];case"DiscardConversation":return[3,7];}return[3,8];case 1:return e=Ue(a,n),[3,9];case 2:return o=he(a,n),e={__typename:r,message:o},[3,9];case 3:return[4,Be(a,t)];case 4:return e=i.sent(),[3,9];case 5:return c=(s=a).lastMessage,u=s.properties,l=s.threadProperties,d=s.isRetentionHorizonSet,p=u&&u.consumptionhorizon||null,g=u&&(u.userConsumptionHorizon||u.consumptionHorizonBookmark)||null,m=u&&Ae(u.interopconversationstatus)||null,h=s.id,e={__typename:r,conversation:{id:h,isDisabled:ke(l&&l.isDisabled),title:l&&l.topic,consumptionHorizon:Se(h,p),consumptionHorizonBookmark:Se(h,g),userConsumptionHorizon:Se(h,g),chatType:l&&Ne(l.threadType),chatSubType:l&&Te(l.threadType),lastMessage:he(c,n),members:[],interopConversationStatus:m,isRetentionHorizonSet:d}},[3,9];case 6:return e={__typename:r,lieConvId:(v=a).id,realConvId:v.realConvId},[3,9];case 7:return e={__typename:r,convId:(v=a).id},[3,9];case 8:return[3,9];case 9:return[3,11];case 10:return f=i.sent(),n.newLogger("ChatHelpers").warn("Error processing chat service event: "+f),[3,11];case 11:return[2,e];}});});};!function(e){e.SfBGatewayChat="@sfb.unq.gbl.spaces",e.OnPremFederatedGatewayChat="@sfbonprem.unq.gbl.spaces",e.FederatedGatewayChatLie="@fed.unq.gbl.spaces";}(je||(je={}));var xe,He=function He(e){return!!e&&e.endsWith(je.SfBGatewayChat);},ze=function ze(e){return!!e&&(e.endsWith(je.FederatedGatewayChatLie)||e.endsWith(je.OnPremFederatedGatewayChat));},Ge=function Ge(e,t){return Object(d.filter)(e,Object(d.omit)(t,"__typename"));},We=function We(e){return!!e&&-1!==e.indexOf($);},Ve=n(775),Ke=n(419);!function(e){e[e.Value=0]="Value",e[e.Error=1]="Error";}(xe||(xe={}));var Je=100,qe=function(){function e(e){if(void 0===e&&(e=Je),e<0)throw new TypeError("BufferLimit has to be > 0");this._isComplete=!1,this._values=[],this._promiseResolutionFunctions=[],this._bufferLimit=e;}return e.prototype.next=function(e){this._push({type:xe.Value,value:e});},e.prototype.error=function(e){this._push({type:xe.Error,error:e});},e.prototype.complete=function(){for(this._isComplete=!0;this._promiseResolutionFunctions.length>0;){this._promiseResolutionFunctions.shift().resolve({done:!0});}},e.prototype.nextPromise=function(){var e=this;if(this._values.length>0){var t=this._values.shift(),n=t.type,r=t.value,i=t.error;return n===xe.Error?Promise.reject(i):Promise.resolve({done:!1,value:r});}return this._isComplete?Promise.resolve({done:!0}):new Promise(function(t,n){e._promiseResolutionFunctions.push({resolve:t,reject:n});});},e.prototype._push=function(e){if(this._promiseResolutionFunctions.length>0){var t=this._promiseResolutionFunctions.shift(),n=t.resolve,r=t.reject;e.type===xe.Error?r(e.error):n({done:!1,value:e.value});}else{if(this._values.length>this._bufferLimit-1)throw new Error("AsyncIterableObserver buffer is full, all future events will be dropped");this._values.push(e);}},e;}();function Qe(e,t){return Object(i.__asyncGenerator)(this,arguments,function(){var n,r,a;return Object(i.__generator)(this,function(o){switch(o.label){case 0:n=new qe(t),r=e.subscribe(n),o.label=1;case 1:return o.trys.push([1,,8,9]),[4,Object(i.__await)(n.nextPromise())];case 2:a=o.sent(),o.label=3;case 3:return!a||a.done?[3,7]:[4,Object(i.__await)(a.value)];case 4:return[4,o.sent()];case 5:return o.sent(),[4,Object(i.__await)(n.nextPromise())];case 6:return a=o.sent(),[3,3];case 7:return[3,9];case 8:return r.unsubscribe(),[7];case 9:return[2];}});});}var Ze=n(184),Ye=n(1283),Xe=n(2705),$e=n(2704),et=function et(e){return e=Object(Xe.a)(e,"__typename"),Object(d.map)(Object(d.compact)(e),function(e){return{"@type":$e.a.hyperLink,title:e.title,description:e.description,fileShareUrlMeta:e.fileShareUrlMeta,url:e.fileShareUrlMeta&&e.fileShareUrlMeta.shareUrl};});};var tt=function tt(e){return!!e.get(m.a.Sync).enableMultiWindowMessagingInWorker;},nt=function nt(e,t,n,r,a,o){return Object(i.__awaiter)(void 0,void 0,Promise,function(){return Object(i.__generator)(this,function(i){return[2,o&&tt(r)?rt(e,o,n,a):it(e,t,n)];});});};function rt(e,t,n,r){return Object(i.__awaiter)(this,void 0,Promise,function(){var a,o;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,t.getConversation(e)];case 1:return(a=i.sent())?[4,at([a],r)]:[2,{id:e,members:[]}];case 2:return o=i.sent(),[2,_e(a,o,n)];}});});}var it=function it(e,t,n){return Object(i.__awaiter)(void 0,void 0,Promise,function(){var r;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,t.getChat(e)];case 1:return r=i.sent(),[2,Me(r,n)];}});});},at=function at(e,t){return Object(i.__awaiter)(void 0,void 0,Promise,function(){var n,r,a;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return n=[],e.forEach(function(e){return e.members&&e.members.forEach(function(e){n.push(e);});}),[4,p(n,t)];case 1:return r=i.sent(),a={},r.forEach(function(e){a[e.id]=e;}),[2,a];}});});},ot=function ot(e,t,n,r){return Object(i.__awaiter)(void 0,void 0,Promise,function(){var a,o,s,c,u,l;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return a=e.event,"LongPollEventPublisher"!==(o=e.source)?[3,2]:(c=a).resource&&c.resource.messagetype===b.c.MemberConsumptionHorizonUpdate?[4,Fe(c,t,n)]:[2,void 0];case 1:return s=i.sent(),[3,4];case 2:return"ConversationManager"!==o?[3,4]:[4,at([u=a],r)];case 3:l=i.sent(),s={__typename:"ConversationUpdate",conversation:_e(u,l,n)},i.label=4;case 4:return[2,s];}});});},st=function st(e,t,n,r,a){return Object(i.__awaiter)(void 0,void 0,Promise,function(){var o,s,c,u,l,d,p,g;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,n.getChat(e)];case 1:if(o=i.sent(),s=o&&o.members,c=o&&o.isOneOnOne,u=r.newLogger("Chat Resolvers"),l=new f.a(a),!(c||s&&s.length<=l.maxRosterSizeInGroupChatChatServiceLimit))return[3,6];i.label=2;case 2:return i.trys.push([2,4,,5]),[4,t.getMembersConsumptionHorizon(e)];case 3:return d=i.sent(),[3,5];case 4:return p=i.sent(),u.error("fail to fetch consumption horizon data from server because: "+p),[3,5];case 5:return[3,7];case 6:u.log("chat "+e+" is not supported for read receipt."),i.label=7;case 7:return g=d&&d.consumptionhorizons,[2,Ce(g)];}});});},ct=function ct(e,t){return t&&Object(d.remove)(t,function(t){return t===e;}),t&&Object(i.__spreadArrays)([{id:e,role:"Admin"}],t.map(function(e){return{id:e,role:"Admin"};}));},ut=n(80),lt=function lt(e,t){var n=e.content,r=e.messageType,o=e.clientMessageId,s=e.files,c=e.importance,u=e.computed;void 0===t&&(t={});var l,p=void 0===u?{}:u,g=p.mentions,m=p.urlPreview,h=p.embeddedLinks,v=Object(d.map)(g,function(e){e.__typename;var t=e.userId,n=Object(i.__rest)(e,["__typename","userId"]);return Object(i.__assign)(Object(i.__assign)({},n),{userId:t,id:t});}),f=Object(d.map)(s,function(e){e.__typename;var t=e.chicletBreadcrumbs,n=Object(i.__rest)(e,["__typename","chicletBreadcrumbs"]);return Object(i.__assign)({previewUrl:"",previewWidth:null,previewHeight:null,chicletBreadcrumbs:t?{__typename:"ChicletBreadcrumbs",sourceChannelName:t.sourceChannelName||null,sourceTeamName:t.sourceTeamName||null}:null},n);}),b=function(e){return e?Object(i.__assign)(Object(i.__assign)({},e),{thumbnailMeta:e.thumbnailMeta?Object(i.__assign)(Object(i.__assign)({},e.thumbnailMeta),{__typename:"ImageMeta"}):null,__typename:"UrlPreview"}):null;}(m),y=(l=h)?l.map(function(e){var t=e.fileShareUrlMeta?Object(i.__assign)(Object(i.__assign)({},e.fileShareUrlMeta),{__typename:"FileShareUrlMeta"}):null;return Object(i.__assign)(Object(i.__assign)({},e),{__typename:"EmbeddedLink",fileShareUrlMeta:t});}):null;return Object(i.__assign)({content:n,contentType:"text",messageType:r,clientMessageId:o,isImportant:c===a.a.MessageImportance.Important,status:a.a.MessageStatus.Delivered,mentions:v,files:f,urlPreview:b,embeddedLinks:y,emotions:null},t);},dt="ChatResolvers",pt={status:207,statusCode:206,statusSubCode:40318};function gt(e){return Object(i.__awaiter)(this,void 0,void 0,function(){return Object(i.__generator)(this,function(t){switch(t.label){case 0:return[4,e.getUser()];case 1:return[2,t.sent().profile.oid];}});});}function mt(e,t,n,r,a){return Object(i.__awaiter)(this,void 0,Promise,function(){var o,s,c,u,l,d;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(o=[],s=a.newLogger("Chat Resolvers"),c=r.get(m.a.Messaging).enableInformationBarrierInMW,u=new f.a(n).enableInformationBarrier,!(c&&u)||e!==pt.status)return[2,o];i.label=1;case 1:return i.trys.push([1,3,,4]),[4,t.json()];case 2:return(l=i.sent())&&l.multipleStatus&&l.multipleStatus.forEach(function(e){e&&e.statusCode===pt.statusCode&&e.statusSubCode===pt.statusSubCode&&o.push({id:e.id});}),[2,o];case 3:return d=i.sent(),s.error("fail to check for IB rejected users: "+d),[2,o];case 4:return[2];}});});}function ht(e,t,n,r,a){return Object(i.__awaiter)(this,void 0,Promise,function(){var o;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,mt(e,t,n,r,a)];case 1:return[2,(o=i.sent())&&o.length>0];}});});}function vt(e,t,n,r){return void 0===r&&(r=""),Object(i.__awaiter)(this,void 0,Promise,function(){var a;return Object(i.__generator)(this,function(o){return a=t&&1===t.length?{uniquerosterthread:!0,fixedRoster:!0}:{},[2,e.createThread(n,r,Object(i.__assign)({threadType:"chat",chatFilesIndexId:2},a))];});});}function ft(e,t){return Object(i.__awaiter)(this,void 0,Promise,function(){var n,r,a;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return n=[],e.forEach(function(e){return n.push({id:e});}),r=2,[4,p(n,t)];case 1:return a=i.sent(),[2,{id:"19:"+$+Object(ut.v4)(),members:a,isDisabled:!1,isOneOnOne:e.length===r,isRead:!1,chatType:Ke.a.Chat,type:Ke.a.Chat}];}});});}var bt={Query:{chats:function chats(e,t,n){var r=t.first,a=t.after,o=n.csaService,s=n.conversationManager,c=n.peopleService,u=n.loggerFactory,l=n.coreSettings;return Object(i.__awaiter)(this,void 0,void 0,function(){var e,t,n,d,p,g,m,h,v;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return e=[],t=null,n=null,s&&tt(l)?[4,s.getConversations(function(e){return S(e);})]:[3,3];case 1:return d=i.sent(),[4,at(d,c)];case 2:return p=i.sent(),e=d.map(function(e){return function(e,t,n){return{node:_e(e,t,n),cursor:e.id};}(e,p,u);}),n=!1,[3,6];case 3:return i.trys.push([3,5,,6]),[4,o.getChats(r,a)];case 4:return g=i.sent(),m=g.items,h=g.continuationToken,t=h,e=m.map(function(e){return function(e,t){return{node:Me(e,t),cursor:e.createdAt||e.id};}(e,u);}),n=!!t,[3,6];case 5:return v=i.sent(),u.newLogger("Chats Resolver").error("Unable to resolve chats: ",v),[2,Promise.reject(v)];case 6:return[2,{edges:e,pageInfo:{endCursor:t,hasNextPage:n}}];}});});},messages:function messages(e,t,n){var r=t.convId,i=t.cursor,a=n.csaService,o=n.loggerFactory;return We(r)?{messages:[]}:a.getMessages(r,i).then(function(e){var t=e.messages,n=e.messageToken;return{messages:t.map(function(e){return ve(e,o);}).sort(function(e,t){var n=new Date(e.originalArrivalTime);return new Date(t.originalArrivalTime).valueOf()-n.valueOf();}),cursor:n,dataSource:"network"};});},message:function message(e,t,n){var r=t.convId,i=t.messageId,a=n.csaService,o=n.loggerFactory;return a.getMessage(r,i).then(function(e){return{message:ve(e,o)};});},chat:function chat(e,t,n){var r=t.convId,a=n.csaService,o=n.conversationManager,s=n.loggerFactory,c=n.peopleService,u=n.coreSettings;return Object(i.__awaiter)(this,void 0,void 0,function(){return Object(i.__generator)(this,function(e){return[2,nt(r,a,s,u,c,o)];});});},chatWithUser:function chatWithUser(e,t,n){var r=t.userId,a=t.createLieIfNotFound,o=n.csaService,s=n.discover,c=n.loggerFactory,u=n.coreSettings,l=n.peopleService;return Object(i.__awaiter)(this,void 0,void 0,function(){var e,t,n,d;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,s.skypeid()];case 1:e=i.sent(),t=Object(Ve.a)(e,r),n=null,i.label=2;case 2:return i.trys.push([2,4,,5]),[4,nt(t,o,c,u,l)];case 3:return n=i.sent(),[3,5];case 4:if(d=i.sent(),!Object(g.f)(d,h.d.RequireStatus,h.c.RemoteOperationFailed,{requiredStatus:h.g.OK,status:h.g.NOT_FOUND}))throw d;return[3,5];case 5:return n||!a?[3,7]:[4,ft([e,r],l)];case 6:n=i.sent(),i.label=7;case 7:return[2,n];}});});},chatsWithUsers:function chatsWithUsers(e,t,n){var r=t.userIds,a=t.filters,o=t.partialMatch,s=t.topicName,c=t.createLieIfNotFound,u=n.csaService,l=n.loggerFactory,d=n.peopleService;return Object(i.__awaiter)(this,void 0,void 0,function(){var e,t,n;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return e=[],[4,u.getChatsWithUsers(r,!!o)];case 1:return(t=i.sent())&&(e=Ge(t.map(function(e){return Me(e,l);}),a||{}),s&&(e=e.filter(function(e){return e.title===s;}))),0===e.length&&c?[4,ft(r,d)]:[3,3];case 2:n=i.sent(),e.push(n),i.label=3;case 3:return[2,e];}});});},unreadCounts:function unreadCounts(e,t,n){return n.csaService.getBadges().then(function(e){return e.map(Ie)[0];});},chatsByTitle:function chatsByTitle(e,t,n){var r=t.title,i=t.filters,a=n.csaService,o=n.loggerFactory;return a.getChatsByTitle(r).then(function(e){return e?Ge(e.map(function(e){return Me(e,o);}),i||{}):[];});},membersConsumptionHorizon:function membersConsumptionHorizon(e,t,n){var r=t.convId,a=n.chatService,o=n.csaService,s=n.loggerFactory,c=n.settingsService;return Object(i.__awaiter)(this,void 0,void 0,function(){return Object(i.__generator)(this,function(e){return[2,st(r,a,o,s,c)];});});},searchUsersByConversation:function searchUsersByConversation(e,t,n){var r=t.convId,a=t.searchQuery,o=n.csaService,s=n.loggerFactory,c=n.coreSettings,u=n.peopleService,l=n.conversationManager,p=n.discover;return Object(i.__awaiter)(this,void 0,Promise,function(){var e,t,n,g,m,h,v,f;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(!r)throw new Error("ConvId null not supported");return[4,nt(r,o,s,c,u,l)];case 1:if(!(e=i.sent()))throw new Error("Conversation could not be found, convId - "+r);return t=e.members,a&&(n=a.indexOf("@"),g=-1!==n,(m=a.substring(n).replace("Â "," ").replace(/^@/,""))&&(h=Object(d.escapeRegExp)(m),v=g?new RegExp("((?:^|\\b|\\.)"+h+")","i"):new RegExp("(?:^|\\W)"+h+"(?:$|\\W)","i"),t=Object(d.filter)(t,function(e){return!Object(d.isNil)(e)&&!Object(d.isNil)(e.displayName)&&v.test(e.displayName)||!Object(d.isNil)(e.email)&&v.test(e.email);}))),[4,p.skypeid()];case 2:return f=i.sent(),t=Object(d.filter)(t,function(e){return e.id!==f;}),5,[2,t=Object(d.take)(t,5)];}});});}},Mutation:{sendMessage:function sendMessage(e,t,n){var r=t.convId,a=t.message,o=t.action,s=n.chatService,c=n.authenticationService,u=n.discover,l=n.peopleService;return Object(i.__awaiter)(this,void 0,void 0,function(){var e,t,n,g,m,h,v,f,b,y,S,O,C,M,I,w,j,T;return Object(i.__generator)(this,function(P){switch(P.label){case 0:return[4,Promise.all([c.getUser(),u.skypeid()])];case 1:return e=P.sent(),t=e[0].profile.name,n=e[1],function(e){return He(e)||ze(e)||_(e);}(r)?[4,s.getThread(r)]:[3,5];case 2:return v=P.sent(),[4,u.skypeid()];case 3:return f=P.sent(),[4,p(v.members,l)];case 4:b=P.sent(),y=Object(d.find)(b,function(e){return e.mri===f;}),m=y&&y.sipProxyAddress,S=Object(d.find)(b,function(e){return e.mri!==f;}),h=S&&S.sipProxyAddress,g="receiverSfB",a.messageType="Text",P.label=5;case 5:switch(O=function(e,t,n){void 0===n&&(n={fromSipUri:void 0,toSipUri:void 0,interopType:void 0});var r,a,o=e.content,s=e.importance,c=e.subject,u=e.files,l=e.computed,d=void 0===l?{}:l,p=e.id,g=e.messageType,m=e.clientMessageId,h=d,v=h.urlPreview,f=h.mentions,b=h.cards,y=h.embeddedLinks;return{id:p,messagetype:g,contenttype:"text",content:o,imdisplayname:t,clientmessageid:m,amsreferences:d.amsReferences,fromSipUri:n&&n.fromSipUri||void 0,toSipUri:n&&n.toSipUri||void 0,properties:{importance:J(s),subject:c,cards:se(b),links:(r=v?[v]:[],a=y||[],JSON.stringify(Object(i.__spreadArrays)(Object(Ye.a)(r),et(a)))),mentions:we(f),files:oe(u),policyViolation:e.policyViolation,interopType:n&&n.interopType}};}(a,t,{fromSipUri:m,toSipUri:h,interopType:g}),o){case Ke.b.Create:return[3,6];case Ke.b.Update:return[3,8];}return[3,10];case 6:return[4,s.postMessageToConversation(r,O)];case 7:return M=P.sent(),j=M.id,I=M.originalarrivaltime,C=lt(a,{id:j,originalArrivalTime:new Date(I).toISOString(),from:n,imDisplayName:n}),[3,11];case 8:return[4,s.updateMessageInConversation(r,O)];case 9:return P.sent(),j=(w=a).id,T=w.originalArrivalTime,C=lt(a,{id:j,originalArrivalTime:T,editTime:new Date().toISOString(),from:n,imDisplayName:n}),[3,11];case 10:throw new RangeError("Invalid action type for sendMessage");case 11:return[2,C];}});});},sendMessageToUsers:function sendMessageToUsers(e,t,n,r){var a=t.userIds,o=t.message,s=t.topicName;return Object(i.__awaiter)(this,void 0,void 0,function(){var t,c,u,l,d,p,g,m,h,v,f,b,y,S,O,C;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return t=n.csaService,c=n.chatService,u=n.discover,l=n.loggerFactory,d=n.settingsService,p=n.coreSettings,g=n.peopleService,[4,u.skypeid()];case 1:return m=i.sent(),h=ct(m,a),[4,vt(c,a,h,s||"")];case 2:return v=i.sent(),f=v.threadId,b=v.status,y=v.responseBody,S=nt(f,t,l,p,g),O={convId:f,message:o,action:Ke.b.Create},[4,(0,bt.Mutation.sendMessage)(e,O,n,r)];case 3:return i.sent(),[4,ht(b,y,d,p,l)];case 4:return C=i.sent(),[4,S];case 5:return[2,{conversation:i.sent(),hasIBPolicyRejectedUsers:C}];}});});},sendMessageInNewChat:function sendMessageInNewChat(e,t,n,r){var a=t.userIds,o=t.message;return Object(i.__awaiter)(this,void 0,void 0,function(){var t,s,c,u,l,d,p,g,m,h,v,f;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return t=n.chatService,s=n.discover,c=n.settingsService,u=n.coreSettings,l=n.loggerFactory,[4,s.skypeid()];case 1:return d=i.sent(),p=ct(d,a),[4,vt(t,a,p)];case 2:return g=i.sent(),m=g.threadId,h=g.status,v=g.responseBody,[4,(0,bt.Mutation.sendMessage)(e,{convId:m,message:o,action:Ke.b.Create},n,r)];case 3:return i.sent(),[4,ht(h,v,c,u,l)];case 4:return f=i.sent(),[2,{convId:m,hasIBPolicyRejectedUsers:f}];}});});},createChat:function createChat(e,t,n){var r=t.userIds;return Object(i.__awaiter)(this,void 0,void 0,function(){var e,t,a,o,s,c,u;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return e=n.csaService,t=n.chatService,a=n.discover,o=n.loggerFactory,[4,a.skypeid()];case 1:return s=i.sent(),c=ct(s,r),[4,vt(t,r,c)];case 2:return u=i.sent().threadId,[2,it(u,e,o)];}});});},addMembersToConversation:function addMembersToConversation(e,t,n){var r=t.convId,a=t.members,o=t.shareHistoryTime,s=n.chatService,c=n.peopleService,u=n.settingsService,l=n.coreSettings,g=n.loggerFactory;return Object(i.__awaiter)(this,void 0,Promise,function(){var e,t,n;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[],e=!1,We(r)?[3,3]:(!Object(d.isNil)(o)&&o>0&&(864e5,o=Date.now()-864e5*o),[4,s.addMembersToThread(r,a,Object(d.isNil)(o)?void 0:o)]);case 1:return[4,mt((t=i.sent()).status,t.body,u,l,g)];case 2:n=i.sent(),e=n&&n.length>0,Object(d.pullAllBy)(a,n,"id"),i.label=3;case 3:return[4,p(a,c)];case 4:return[2,{users:i.sent(),hasIBPolicyRejectedUsers:e}];}});});},removeMemberFromConversation:function removeMemberFromConversation(e,t,n){var r=t.convId,i=t.userId;return n.chatService.removeMemberFromThread(r,i).then(function(){return i;});},updateMessageEmotion:function updateMessageEmotion(e,t,n){var r=t.convId,o=t.messageId,s=t.key,c=t.action,u=n.chatService,l=n.discover;return Object(i.__awaiter)(this,void 0,void 0,function(){var e;return Object(i.__generator)(this,function(t){switch(t.label){case 0:return[4,l.skypeid()];case 1:if(e=t.sent(),!s)return[2,c===a.a.EmotionAction.remove?{id:""}:{id:e}];switch(c){case a.a.EmotionAction.add:return[3,2];case a.a.EmotionAction.remove:return[3,4];}return[3,6];case 2:return[4,u.addMessageEmotion(r,o,s)];case 3:return t.sent(),[2,{id:e}];case 4:return[4,u.removeMessageEmotion(r,o,s)];case 5:return t.sent(),[2,{id:""}];case 6:throw Object(g.a)(dt,h.c.NotImplemented,"updateMessageEmotion",{action:c});}});});},saveMessage:function saveMessage(e,t,n){var r=t.convId,o=t.messageId,s=n.chatService,c=n.discover;return Object(i.__awaiter)(this,void 0,void 0,function(){var e,t,n,u,l,d,p,m,v;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return e=a.a.EmotionKey.star,[4,c.skypeid()];case 1:return t=i.sent(),[4,s.getConversationMessage(r,o)];case 2:if(n=i.sent(),Le(e,t,n))throw Object(g.a)(dt,h.c.AlreadyPresent,"saveMessage");return[4,s.addMessageEmotion(r,o,e)];case 3:i.sent(),i.label=4;case 4:return i.trys.push([4,6,,8]),u=function(e){var t=e.id,n=e.conversationid,r=e.imdisplayname,i=e.from,a=e.composetime;return t&&{"@type":"http://schema.skype.com/StarredMessage",mri:Z(i),imdisplayname:r,messageId:t,parentMessageId:t,threadId:n,isUnresolvedEmailUser:!1,originalComposeTime:a};}(n),l=n.messagetype,d=n.content,p=n.imdisplayname,m={messagetype:l,content:d,imdisplayname:p,properties:{starred:u}},[4,s.postMessageToConversation("48:starred",m)];case 5:return i.sent(),[3,8];case 6:return v=i.sent(),[4,s.removeMessageEmotion(r,o,e)];case 7:throw i.sent(),v;case 8:return[2,{id:t}];}});});},unsaveMessage:function unsaveMessage(e,t,n){var r=t.convId,o=t.messageId,s=n.chatService,c=n.csaService,u=n.discover;return Object(i.__awaiter)(this,void 0,void 0,function(){var e,t,n,l,d,p;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return e=a.a.EmotionKey.star,[4,u.skypeid()];case 1:return t=i.sent(),[4,s.getConversationMessage(r,o)];case 2:if(n=i.sent(),!Le(e,t,n))throw Object(g.a)(dt,h.c.NotPresent,"unsaveMessage");return[4,s.removeMessageEmotion(r,o,e)];case 3:i.sent(),i.label=4;case 4:return i.trys.push([4,8,,10]),[4,c.getMessages("48:starred")];case 5:return l=i.sent().messages,(d=function(e,t,n){var r=n.find(function(n){try{var r=JSON.parse((n.properties||{}).starred),i=r&&"http://schema.skype.com/StarredMessage"===r["@type"]&&r.threadId===t?r.messageId:void 0;return e===i;}catch(e){return!1;}});return r&&r.id;}(o,r,l))?[4,s.markStarredMessageAsDeleted(d)]:[3,7];case 6:i.sent(),i.label=7;case 7:return[3,10];case 8:return p=i.sent(),[4,s.addMessageEmotion(r,o,e)];case 9:throw i.sent(),p;case 10:return[2,null];}});});},deleteMessage:function deleteMessage(e,t,n){var r=t.convId,a=t.messageId,o=n.chatService;return Object(i.__awaiter)(this,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,o.deleteMessage(r,a)];case 1:return e.sent(),[2,{id:a}];}});});},undeleteMessage:function undeleteMessage(e,t,n){var r=t.convId,a=t.messageId,o=n.chatService;return Object(i.__awaiter)(this,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,o.undeleteMessage(r,a)];case 1:return e.sent(),[2,{id:a}];}});});},sendTypingIndicator:function sendTypingIndicator(e,t,n){var r=t.convId,a=n.chatService;return Object(i.__awaiter)(this,void 0,void 0,function(){var e,t,n,o;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return e={messagetype:"Control/Typing",contenttype:"Application/Message",content:""},[4,a.postMessageToConversation(r,e)];case 1:return t=i.sent(),n=t.id,o=t.originalarrivaltime,[2,{id:n,originalArrivalTime:new Date(o).toISOString(),content:e.content,contentType:e.contenttype,messageType:e.messagetype,isImportant:!1,clientMessageId:e.clientmessageid}];}});});},setConsumptionHorizon:function setConsumptionHorizon(e,t,n){var r=t.convId,a=t.message,o=a.originalArrivalTime,s=a.clientMessageId,c=n.chatService;return Object(i.__awaiter)(this,void 0,void 0,function(){var e,t,n;return Object(i.__generator)(this,function(i){switch(i.label){case 0:e=Date.now(),t=new Date(o||"").valueOf()+";"+e+";"+s,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,c.setConversationConsumptionHorizon(r,t)];case 2:return i.sent(),[3,4];case 3:return n=i.sent(),[2,Promise.reject(n)];case 4:return[2,{id:r,timeStamp:new Date(e).toISOString(),originalArrivalTime:o,clientMessageId:s}];}});});},setConsumptionHorizonBookmark:function setConsumptionHorizonBookmark(e,t,n){var r=t.convId,a=t.message,o=a.originalArrivalTime,s=a.clientMessageId,c=n.chatService;return Object(i.__awaiter)(this,void 0,void 0,function(){var e,t,n,a,u;return Object(i.__generator)(this,function(i){switch(i.label){case 0:e=Date.now(),t=new Date(o||""),n="0"===o?"0":""+(t.valueOf()-1),a=n+";"+e+";"+s,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,c.setConversationConsumptionHorizon(r,a,!0)];case 2:return i.sent(),[3,4];case 3:return u=i.sent(),[2,Promise.reject(u)];case 4:return[2,{id:r,timeStamp:new Date(e).toISOString(),originalArrivalTime:"0"===n?"0":new Date(t.valueOf()-1).toISOString(),clientMessageId:s}];}});});},updateMessageLinks:function updateMessageLinks(e,t,n){var r=t.convId,a=t.messageId,o=t.links,s=n.chatService;return Object(i.__awaiter)(this,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,s.updateMessageLinks(r,a,{links:o})];case 1:return e.sent(),[2,!0];}});});}},Subscription:{chatServiceEvent:{subscribe:function subscribe(e,t,n){var r=n.chatService,a=n.chatServiceEndpointProvider,o=n.conversationManager,s=n.peopleService,c=n.authenticationService,u=n.loggerFactory,l=n.coreSettings,d=n.longPollEventPublisher;return Object(i.__asyncGenerator)(this,arguments,function(){var e,t,n,m,v,f,b,y,S,O,C,_,M,I,w,j;return Object(i.__generator)(this,function(P){switch(P.label){case 0:if(e=function e(_e2){return p(_e2,s);},!(o&&d&&tt(l)))return[3,16];t=new Ze(function(e){o.subscribe(function(t){e.next({event:t,source:"ConversationManager"});}),d.observable.subscribe(function(t){e.next({event:t,source:"LongPollEventPublisher"});});}),P.label=1;case 1:P.trys.push([1,9,10,15]),n=Object(i.__asyncValues)(Qe(t)),P.label=2;case 2:return[4,Object(i.__await)(n.next())];case 3:return(m=P.sent()).done?[3,8]:(v=m.value,[4,Object(i.__await)(ot(v,e,u,s))]);case 4:return(C=P.sent())?[4,Object(i.__await)({chatServiceEvent:C})]:[3,7];case 5:return[4,P.sent()];case 6:P.sent(),P.label=7;case 7:return[3,2];case 8:return[3,15];case 9:return f=P.sent(),M={error:f},[3,15];case 10:return P.trys.push([10,,13,14]),m&&!m.done&&(I=n.return)?[4,Object(i.__await)(I.call(n))]:[3,12];case 11:P.sent(),P.label=12;case 12:return[3,14];case 13:if(M)throw M.error;return[7];case 14:return[7];case 15:return[3,32];case 16:if(!a)throw Object(g.a)(dt,h.c.NotPresent,"chatServiceEvent");return[4,Object(i.__await)(gt(c))];case 17:b=P.sent(),P.label=18;case 18:P.trys.push([18,26,27,32]),y=Object(i.__asyncValues)(T(r,a,b,!1)),P.label=19;case 19:return[4,Object(i.__await)(y.next())];case 20:return(S=P.sent()).done?[3,25]:(O=S.value,[4,Object(i.__await)(Fe(O,e,u))]);case 21:return(C=P.sent())?[4,Object(i.__await)({chatServiceEvent:C})]:[3,24];case 22:return[4,P.sent()];case 23:P.sent(),P.label=24;case 24:return[3,19];case 25:return[3,32];case 26:return _=P.sent(),w={error:_},[3,32];case 27:return P.trys.push([27,,30,31]),S&&!S.done&&(j=y.return)?[4,Object(i.__await)(j.call(y))]:[3,29];case 28:P.sent(),P.label=29;case 29:return[3,31];case 30:if(w)throw w.error;return[7];case 31:return[7];case 32:return[2];}});});}},chatServicePostActiveEvent:{subscribe:function subscribe(e,t,n){var r=n.chatService,a=n.chatServiceEndpointProvider,o=n.authenticationService;return Object(i.__asyncGenerator)(this,arguments,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[5,Object(i.__values)(Object(i.__asyncDelegator)(Object(i.__asyncValues)(F(r,a,function(){return gt(o);}))))];case 1:return[4,i.__await.apply(void 0,[e.sent()])];case 2:return e.sent(),[2];}});});}}}},yt=n(2722),St=n(2724),Ot=n(2719);function Ct(e,t,n,r,i,a,o,s,c,u){return{authenticationService:e,chatService:new yt.a(t.bind(o,m.b.Gtm.chatService),i),csaService:new St.a(e,u,i,o),peopleService:new Ot.a(t.bind(o,m.b.Gtm.middleTier)),discover:n,loggerFactory:a,settingsService:r,coreSettings:i,conversationManager:s,longPollEventPublisher:c};}var _t,Mt,It=n(1051);!function(e){e.inMemory="inMemory",e.indexedDB="indexedDB",e.network="network";}(_t||(_t={})),function(e){e[e.Sync=1]="Sync",e[e.LongPoll=2]="LongPoll",e[e.SfB=3]="SfB",e[e.SyncRelated=4]="SyncRelated",e[e.Local=5]="Local",e[e.CSAReplyChain=6]="CSAReplyChain",e[e.DeltaSync=7]="DeltaSync";}(Mt||(Mt={}));var wt,jt=function(){function e(t){this.id=t.id,this.conversationId=t.conversationId,this.parentMessageId=t.parentMessageId,this.clientMessageId=t.clientMessageId,this.version=t.version,this.type=t.type||"",this.contentType=t.contentType||"",this.activityType=t.activityType||"",this.messageType=t.messageType,this.clientArrivalTime=t.clientArrivalTime,this.originalArrivalTime=t.originalArrivalTime,this.imDisplayName=t.imDisplayName,this.creator=t.creator,this.skypeGuid=t.skypeGuid,this.properties=t.properties||{},this.source=t.source,this._content=t.content,this._isSanitized=t.isSanitized,this.translation=t.translation,this.searchKey=e.createSearchKey(t.conversationId,t.id),this.dedupeKey=t.dedupeKey||this.creator+"_"+(this.clientMessageId||this.id),this.originalNonLieMessage=t.originalNonLieMessage;}return e.createSearchKey=function(e,t){return e+"_"+t;},e.FromChatServiceMessage=function(t,n){var r=Object(i.__assign)(Object(i.__assign)({},t),{conversationId:e.getConversationId(t),parentMessageId:e.getParentMessageId(t),clientMessageId:t.clientmessageid||"",imDisplayName:t.imdisplayname||"",creator:Object(d.last)(Object(d.split)(t.from,"/"))||"",messageType:t.messagetype,contentType:t.contenttype||"",activityType:t.activitytype||"",skypeGuid:t.skypeguid,originalArrivalTime:e.getOriginalArrivaTimeUtc(t.originalarrivaltime),source:n,clientArrivalTime:Date.now(),dedupeKey:"",searchKey:e.createSearchKey(e.getConversationId(t),t.id),isSanitized:!1});return new e(r);},e.FromCSAMessage=function(t){var n=Object(i.__assign)(Object(i.__assign)({},t),{conversationId:t.containerId,originalArrivalTime:e.getOriginalArrivaTimeUtc(t.originalArrivalTime),parentMessageId:t.parentMessageId||t.id,source:Mt.CSAReplyChain,creator:t.from,version:t.version.toString(),clientArrivalTime:Date.now(),dedupeKey:"",searchKey:e.createSearchKey(t.containerId,t.id),isSanitized:!1});return new e(n);},e.isClientLieId=function(t){return t===e.ClientLieId||Object(d.startsWith)(t,e.ClientLiePrefix);},e.getParentMessageId=function(t){var n=Object(d.flow)(function(e){return Object(d.split)(e,"/");},function(e){return Object(d.last)(e);},function(e){return Object(d.split)(e,"=");},function(e){return Object(d.nth)(e,1);})(t.conversationLink);return n=n||t.id,e.isClientLieId(n)?e.ClientLieId:n;},e.getConversationId=function(e){return Object(d.flow)(function(e){return Object(d.split)(e,"/");},function(e){return Object(d.last)(e);},function(e){return Object(d.split)(e,";");},function(e){return Object(d.first)(e);})(e.conversationLink)||"";},e.getOriginalArrivaTimeUtc=function(e){return e?new Date(e).getTime():-1;},Object.defineProperty(e.prototype,"key",{get:function get(){return this.dedupeKey;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSanitized",{get:function get(){return this._isSanitized;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"content",{get:function get(){return this._content;},enumerable:!0,configurable:!0}),e.prototype.sanitizeContent=function(e){if(this.shouldSkipSanitization())this._isSanitized=!0;else{var t=this.content;this.messageType!==b.l.HTML||this.isGatewayChatMessage||(t="<div>"+t+"</div>"),t=(t=e.sanitizeHtml(t)).replace(/}}/g,"}<span>}</span>"),this._content=t,this._isSanitized=!0;}},Object.defineProperty(e.prototype,"isEdited",{get:function get(){return!!this.properties[b.k.EditTime];},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"editedTime",{get:function get(){return this.isEdited?Number(this.properties[b.k.EditTime]):void 0;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDeleted",{get:function get(){return!!this.properties[b.k.DeleteTime];},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"deletedTime",{get:function get(){return this.isDeleted?Number(this.properties[b.k.DeleteTime]):void 0;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isClientLie",{get:function get(){return this.id===e.ClientLieId;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEditClientLie",{get:function get(){return this.isEdited&&this.source===Mt.Local;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isGatewayChatMessage",{get:function get(){return e=this.conversationId,t=Object(d.endsWith)(e,b.g)||Object(d.endsWith)(e,b.f)||Object(d.startsWith)(e,b.n),n=e.endsWith(b.s),r=_(e),t||n||r;var e,t,n,r;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSystemMessage",{get:function get(){return Object(d.includes)(b.y,this.messageType);},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isRootMessage",{get:function get(){return this.id===this.parentMessageId;},enumerable:!0,configurable:!0}),e.prototype.isSentByUser=function(e){return this.creator===e;},e.prototype.toDBSchema=function(){return{id:this.id,dedupeKey:this.dedupeKey,conversationId:this.conversationId,parentMessageId:this.parentMessageId,clientMessageId:this.clientMessageId,version:this.version,searchKey:this.searchKey,type:this.type,contentType:this.contentType,activityType:this.activityType,messageType:this.messageType,clientArrivalTime:this.clientArrivalTime,originalArrivalTime:this.originalArrivalTime,imDisplayName:this.imDisplayName,creator:this.creator,content:this.content,source:this.source,properties:this.properties,skypeGuid:this.skypeGuid,translation:this.translation,isSanitized:this.isSanitized,originalNonLieMessage:this.originalNonLieMessage};},e.prototype.toLegacySchema=function(){var t=this.content,n=this.messageType,r=!1;this.isSanitized&&n===b.l.Text&&(t="<div>"+Object(d.escape)(t)+"</div>",n=b.l.HTML,r=!0);var i=e.isClientLieId(this.parentMessageId)?""+e.ClientLiePrefix+this.clientMessageId:this.parentMessageId,a="conversation/"+this.conversationId+";messageid="+i,o=this.source===Mt.DeltaSync?Mt.Sync:this.source;return{content:t,messagetype:n,contenttype:this.contentType,activitytype:this.activityType,clientmessageid:this.clientMessageId,imdisplayname:this.imDisplayName,properties:this.properties,id:this.id,type:this.type,composetime:new Date(this.originalArrivalTime).toISOString(),originalarrivaltime:new Date(this.originalArrivalTime).toISOString(),from:"worker/"+this.creator,conversationLink:a,version:this.version,threadtype:"",skypeguid:this.skypeGuid,clientArrivalTime:new Date(this.clientArrivalTime).toISOString(),source:o,isSanitized:this.isSanitized,isPlainTextConvertedToHtml:r};},e.prototype.revertEditLieToOriginalMessage=function(){return!!this.originalNonLieMessage&&(this._content=this.originalNonLieMessage.content,this.translation=this.originalNonLieMessage.translation,this.properties[b.k.EditTime]=this.originalNonLieMessage.editTimeProperty,!0);},e.prototype.resolveEditLieContent=function(){return this.originalNonLieMessage=void 0,!0;},e.prototype.copyExistingEditClientLie=function(e){this.originalNonLieMessage=e.originalNonLieMessage,this._content=e.content,this.translation=e.translation,this.properties[b.k.EditTime]=e.properties[b.k.EditTime];},e.prototype.shouldSkipSanitization=function(){return Object(d.isEmpty)(this.content)||this.isSanitized||this.isSystemMessage||this.messageType===b.l.Text||this.messageType===b.l.Call||this.messageType===b.l.CallRecording;},e.ClientLieId="-1",e.ClientLiePrefix="clientId_",e;}(),Tt=function(){function e(t){var n=this;if(this.latestDeliveryTime=0,this.messageMap={},this.messageSearchKeys=[],Object(d.isEmpty)(t))throw new Error("Empty Object - cannot create a replychain");if(e.isDBSchema(t))this.replyChainId=t.replyChainId,this.conversationId=t.conversationId,this.latestDeliveryTime=t.latestDeliveryTime,this.messageSearchKeys=t.messageSearchKeys,this.lastUpdatedBy=t.lastUpdatedBy,Object(d.forEach)(t.messageMap,function(e,t){n.messageMap[t]=new jt(e);});else{var r=t.messages;if(Object(d.isEmpty)(r))throw new Error("Must pass at least one message to build a reply chain");this.replyChainId=r[0].parentMessageId,this.conversationId=r[0].conversationId,r=Object(d.sortBy)(r,function(e){return e.originalArrivalTime;}),this.messageMap=Object(d.keyBy)(r,function(e){return e.key;}),this.lastUpdatedBy=t.source,this.updateSearchKeysAndLatestDeliveryTime();}}return e.isDBSchema=function(e){return"replyChainId"in e&&"conversationId"in e;},e.fromSkypeMessages=function(t,n){if(Object(d.isEmpty)(t))throw new Error("SkypeReplyChainCDL - fromSkypeMessages: Need at least one message to create a SkypeReplyChain");return Object(d.flow)(function(e){return Object(d.map)(e,function(e){return jt.FromChatServiceMessage(e,n);});},function(e){return Object(d.groupBy)(e,function(e){return e.parentMessageId;});},function(t){return Object(d.map)(t,function(t){return new e({messages:t,source:n});});})(t);},e.fromCSAReplyChain=function(t){if(Object(d.isEmpty)(t))throw new Error("SkypeReplyChainCDL - fromCSAReplyChain: CSA replychain is empty");var n=Mt.CSAReplyChain,r=Object(d.flow)(function(e){return Object(d.map)(e,function(e){return jt.FromCSAMessage(e);});},function(e){return Object(d.groupBy)(e,function(e){return e.parentMessageId;});},function(t){return Object(d.map)(t,function(t){return new e({messages:t,source:n});});})(t.messages);return Object(d.first)(r);},e.getClientLieDBKey=function(e){return[e,jt.ClientLieId];},e.getClientLieKey=function(t){return e.getClientLieDBKey(t).toString();},Object.defineProperty(e.prototype,"id",{get:function get(){return this.replyChainId;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function get(){return this.dbKey.toString();},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dbKey",{get:function get(){return[this.conversationId,this.replyChainId];},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isClientLieReplyChain",{get:function get(){return this.id===jt.ClientLieId;},enumerable:!0,configurable:!0}),e.prototype.sanitizeContent=function(e){Object(d.forEach)(this.messageMap,function(t){return t.sanitizeContent(e);});},Object.defineProperty(e.prototype,"messages",{get:function get(){return Object(d.values)(this.messageMap);},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSanitized",{get:function get(){return Object(d.every)(this.messages,function(e){return e.isSanitized;});},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"earliestMessage",{get:function get(){return this.hasMessages()?Object(d.minBy)(this.messages,function(e){return e.originalArrivalTime;}):void 0;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"latestMessage",{get:function get(){return this.hasMessages()?Object(d.maxBy)(this.messages,function(e){return e.originalArrivalTime;}):void 0;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parentMessage",{get:function get(){return this.hasMessages()?Object(d.find)(this.messages,function(e){return e.id===e.parentMessageId;}):void 0;},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"messageCount",{get:function get(){return Object(d.size)(this.messageMap);},enumerable:!0,configurable:!0}),e.prototype.hasMessage=function(e){return e in this.messageMap;},e.prototype.hasMessages=function(){return this.messageCount>0;},e.prototype.getMessage=function(e){return this.messageMap[e];},e.prototype.merge=function(e){var t=this;return Object(d.forEach)(e.messageMap,function(e,n){t.messageMap[n]=n in t.messageMap?t.mergeMessages(t.messageMap[n],e):e;}),this.updateSearchKeysAndLatestDeliveryTime(),this.lastUpdatedBy=e.lastUpdatedBy,this;},e.prototype.deleteMessages=function(e){var t=this,n=0;return Object(d.forEach)(Object(d.keys)(this.messageMap),function(r){e(t.messageMap[r])&&(delete t.messageMap[r],n++);}),n>0&&this.updateSearchKeysAndLatestDeliveryTime(),n;},e.prototype.toDBSchema=function(){var e={};return Object(d.forEach)(this.messageMap,function(t,n){e[n]=t.toDBSchema();}),{conversationId:this.conversationId,replyChainId:this.replyChainId,latestDeliveryTime:this.latestDeliveryTime,messageMap:e,messageSearchKeys:this.messageSearchKeys,lastUpdatedBy:this.lastUpdatedBy};},e.prototype.toLegacySchema=function(){var e=Object(d.map)(this.messages,function(e){return e.toLegacySchema();});return{conversationId:this.conversationId,replyChainId:this.replyChainId,latestDeliveryTime:this.latestDeliveryTime,messages:e};},e.prototype.tryResolveClientLie=function(e){if(!this.isClientLieReplyChain||!e.isRootMessage||!this.hasMessage(e.key))return!1;var t=Object(d.sortBy)(this.messages,function(e){return e.originalArrivalTime;}),n=Object(d.findIndex)(t,function(t){return t.key===e.key;});return Object(d.forEach)(t,function(t,r){Object(d.set)(t,"originalArrivalTime",e.originalArrivalTime+r-n);}),this.deleteMessages(function(t){return t.key===e.key;}),!0;},e.prototype.revertEditClientLie=function(e){var t=this.getMessage(e.key);return!(!t||!t.isEditClientLie)&&t.revertEditLieToOriginalMessage();},e.prototype.resolveEditClientLie=function(e){var t=this.getMessage(e.key);return!(!t||!t.isEditClientLie)&&t.resolveEditLieContent();},e.prototype.updateSearchKeysAndLatestDeliveryTime=function(){this.messageSearchKeys=Object(d.map)(this.messageMap,function(e){return e.searchKey;});var e=this.latestMessage,t=this.getLatestNonDeletedMessage();this.latestDeliveryTime=t?t.originalArrivalTime:e?e.originalArrivalTime:0;},e.prototype.getLatestNonDeletedMessage=function(){return this.hasMessages()?Object(d.maxBy)(Object(d.filter)(this.messageMap,function(e){return!e.isDeleted;}),function(e){return e.originalArrivalTime;}):void 0;},e.prototype.mergeMessages=function(e,t){return t.version<=e.version?e:(t.isDeleted||t.isEdited||(t.translation=e.translation),t.isEditClientLie&&e.isEditClientLie&&e.originalNonLieMessage?t.originalNonLieMessage=e.originalNonLieMessage:t.isEditClientLie?t.originalNonLieMessage={content:e.content,translation:e.translation,editTimeProperty:e.properties[b.k.EditTime]}:e.isEditClientLie&&e.originalNonLieMessage&&t.copyExistingEditClientLie(e),t);},e;}();!function(e){e.LoadAll="LOAD_ALL",e.LoadNone="LOAD_NONE",e.Custom="CUSTOM";}(wt||(wt={}));var Pt,Nt="replychains";!function(e){e.latestDeliveryTimeByConversationId="latestDeliveryTimeByConversationId",e.latestDeliveryTimeByConversationType="latestDeliveryTimeByConversationType",e.byMessageSearchKeys="byMessageSearchKeys";}(Pt||(Pt={}));wt.LoadNone,Pt.latestDeliveryTimeByConversationId,Pt.latestDeliveryTimeByConversationType,Pt.byMessageSearchKeys;var Et="conversations",At=(wt.LoadAll,"syncstates");wt.LoadAll;var Dt,kt=function(){function e(e){var t=this;this._subscriptionObservers=[],this.storeObservables={},e.forEach(function(e){t.storeObservables[e.name]={subscriptionObservers:[],observable:new Ze(function(n){t.storeObservables[e.name].subscriptionObservers.push(n),t.replayEventsForNewSubscriber(e.name,n);}),isDone:!1,lastError:void 0,nextStatesSeen:[],dependentOn:e.dependentOn};}),this._observable=new Ze(function(e){t._subscriptionObservers.push(e);});}return e.prototype.subscribe=function(e,t,n,r){return this.checkStoreName(e),this.storeObservables[e].observable.subscribe({next:t,error:n,complete:r});},e.prototype.changeState=function(e,t,n){this.checkStoreName(e);var r=this.storeObservables[e].subscriptionObservers;if(r&&r.length&&r.forEach(function(e){e.next(t);}),this.storeObservables[e].nextStatesSeen.push(t),t===n)this.complete(e);else{var i=!0;Object(d.forEach)(this.storeObservables,function(e){var n=Object(d.last)(e.nextStatesSeen);(void 0===n||n<t)&&(i=!1);}),i&&Object(d.forEach)(this._subscriptionObservers,function(e){return e.next(t);});}},e.prototype.getDependentStore=function(e){return this.storeObservables[e]&&this.storeObservables[e].dependentOn;},Object.defineProperty(e.prototype,"observable",{get:function get(){return this._observable;},enumerable:!0,configurable:!0}),e.prototype.error=function(e,t){if((r=t)&&void 0!==r.target&&void 0!==r.target.error){var n=t.target.error;t=Object(g.a)("transaction",h.c.WriteToStoreFailed,n&&n.message||"",void 0,JSON.stringify(n));}var r;this.checkStoreName(e);var i=this.storeObservables[e].subscriptionObservers;i&&i.length&&i.forEach(function(e){e.error(t);}),this.storeObservables[e].lastError=t,this.storeObservables[e].isDone=!0,Object(d.forEach)(this._subscriptionObservers,function(e){return e.error(t);});},e.convertObservableToPromise=function(e,t){return new Promise(function(n,r){e.subscribe({next:function next(e){e===t&&n();},error:function error(e){r(e);},complete:function complete(){n();}});});},e.prototype.replayEventsForNewSubscriber=function(e,t){Object(d.forEach)(this.storeObservables[e].nextStatesSeen,function(e){t.next(e);}),this.storeObservables[e].lastError&&t.error(this.storeObservables[e].lastError),this.storeObservables[e].isDone&&t.complete();},e.prototype.complete=function(e){this.storeObservables[e].isDone=!0;var t=this.storeObservables[e].subscriptionObservers;t&&t.length&&t.forEach(function(e){e.complete();});var n=!0;for(var r in this.storeObservables){this.storeObservables[r]&&(n=n&&this.storeObservables[r].isDone&&!this.storeObservables[r].lastError);}n&&Object(d.forEach)(this._subscriptionObservers,function(e){return e.complete();});},e.prototype.checkStoreName=function(e){if(!e||!this.storeObservables[e])throw TypeError("Store name not found in transactions. Name: "+e);},e;}();!function(e){e.MemoryCommitted="MEMORY_COMMITTED",e.DiskCommitted="DISK_COMMITTED";}(Dt||(Dt={}));var Rt,Lt,Ut;!function(e){e[e.inMemory=0]="inMemory",e[e.indexedDB=1]="indexedDB",e[e.Network=2]="Network";}(Rt||(Rt={})),function(e){e[e.InsideSyncWindow=0]="InsideSyncWindow",e[e.OutsideSyncWindow=1]="OutsideSyncWindow";}(Lt||(Lt={})),function(e){e[e.MessageId=1]="MessageId",e[e.ReplyChainId=2]="ReplyChainId",e[e.TimeRange=3]="TimeRange";}(Ut||(Ut={}));var Bt=function Bt(e){return e;},Ft={Query:{conversations:function conversations(e,t,n){var r=n.managers;return Object(i.__awaiter)(this,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,r.conversationManager.getConversations()];case 1:return[2,e.sent()];}});});},legacyMessages:function legacyMessages(e,t,n){var r=t.convId,a=t.count,o=t.cursor,c=t.deeplinkMessageId,u=t.correlationId,l=t.includeLatestData,p=n.managers;return Object(i.__awaiter)(this,void 0,void 0,function(){var e;return Object(i.__generator)(this,function(t){return e={conversationId:r,count:a,token:o,deeplinkMessageId:c,correlationId:u,includeLatestData:l},Object(s.e)(r)||p.conversationManager.markConversationAsActive(r),[2,p.replyChainManager.getReplyChains(e).then(function(e){var t=Object(d.flatMap)(e.replyChains,function(e){return Object(d.values)(e.messageMap);});return{legacyMessages:Object(d.map)(t,function(e){return e.toLegacySchema();}),cursor:e.token,dataSource:Ht(e.dataSource),deeplinkReplyChainId:e.deeplinkReplyChainId,isLatestDataPending:e.isLatestDataPending,errorCode:e.errorCode};})];});});},legacyMessagesByKeys:function legacyMessagesByKeys(e,t,n){var r=t.convId,a=t.keys,o=t.keyType,s=t.correlationId,c=t.includeLatestData,u=n.managers;return Object(i.__awaiter)(this,void 0,void 0,function(){var e;return Object(i.__generator)(this,function(t){return e={conversationId:r,keys:a,keyType:o,correlationId:s,includeLatestData:c||!1},[2,u.replyChainManager.getReplyChainsByKeys(e).then(function(e){var t=Object(d.flatMap)(e.replyChains,function(e){return Object(d.values)(e.messageMap);});return{legacyMessages:Object(d.map)(t,function(e){return e.toLegacySchema();}),dataSource:Ht(e.dataSource)};})];});});}},Mutation:{putConversations:function putConversations(e,t,n){var r=t.conversations,a=n.managers,o=n.workerBootstrapServices,s=n.loggingContext;return Object(i.__awaiter)(this,void 0,Promise,function(){var e;return Object(i.__generator)(this,function(t){return r&&r.length?(e=Object(d.forEach)(r,function(e){var t;e.source=v.a.ResolverPutConversation,t=e,Object(d.isEmpty)(t.teamId)&&(t.teamId=M(t));}),[2,a.conversationManager.putConversations(e).then(function(){return!0;}).catch(function(e){return xt("PutConversations - errored out while putting conversations in the manager "+(e&&e.message),s,o.logger);})]):[2,xt("PutConversations - conversations param not provided",s,o.logger)];});});},putLegacyMessages:function putLegacyMessages(e,t,n){var r=t.messages,a=n.managers,o=n.workerBootstrapServices,s=n.loggingContext;return Object(i.__awaiter)(this,void 0,void 0,function(){var e;return Object(i.__generator)(this,function(t){return e=Tt.fromSkypeMessages(r,v.c.Local),[2,a.replyChainManager.handleSyncedReplyChains(e).then(function(){return!0;}).catch(function(e){return xt("PutLegacyMessages - errored out while putting messages in the manager "+(e&&e.message),s,o.logger);})];});});},resolveEditClientLie:function resolveEditClientLie(e,t,n){var r=t.message,a=t.shouldResolve,o=n.managers,s=n.workerBootstrapServices,c=n.loggingContext;return Object(i.__awaiter)(this,void 0,void 0,function(){var e;return Object(i.__generator)(this,function(t){return e=Tt.fromSkypeMessages([r],v.c.Local)[0],[2,o.replyChainManager.resolveOrRevertEditClientLie(e,a).catch(function(e){return xt("resolveEditClientLie - errored out while trying to resolve client lie in the manager: "+(e&&e.message),c,s.logger);})];});});},removeConversations:function removeConversations(e,t,n){var r=t.conversationIds,a=n.managers,o=n.workerBootstrapServices,s=n.loggingContext;return Object(i.__awaiter)(this,void 0,Promise,function(){var e;return Object(i.__generator)(this,function(t){return r&&r.length?(e=Object(d.map)(r,function(e){return function(e,t,n){return Object(i.__awaiter)(this,void 0,Promise,function(){var r,a;return Object(i.__generator)(this,function(i){if(!e)throw new TypeError("SyncUtilities - missing conversationId to delete");return r=new kt([{name:Et,dependentOn:At},{name:At}]),a=kt.convertObservableToPromise(r.observable,Dt.MemoryCommitted),n.syncStateManager.deleteConversationSyncState(e,!1,r,t),n.conversationManager.removeConversations([e],r),[2,a];});});}(e,"chat-legacy-resolvers: removeConversations",{conversationManager:a.conversationManager,syncStateManager:a.syncStateManager});}),[2,Promise.all(e).then(function(){return!0;}).catch(function(e){return xt("RemoveConversations - errored out while removing conversations: "+(e&&e.message),s,o.logger);})]):[2,xt("removeConversations - conversationIds param not provided",s,o.logger)];});});}},Subscription:{conversationUpdateEvent:{subscribe:function subscribe(e,t,n){var r=n.managers;return Object(i.__asyncGenerator)(this,arguments,function(){var e,t,n,a,o,s,c,u;return Object(i.__generator)(this,function(l){switch(l.label){case 0:e=new Ze(function(e){r.conversationManager.subscribe(function(t){e.next(t);});}),l.label=1;case 1:l.trys.push([1,8,9,14]),t=Object(i.__asyncValues)(Qe(e,1e3)),l.label=2;case 2:return[4,Object(i.__await)(t.next())];case 3:return(n=l.sent()).done?[3,7]:(a=n.value,o={conversationUpdateEvent:a},[4,Object(i.__await)(o)]);case 4:return[4,l.sent()];case 5:l.sent(),l.label=6;case 6:return[3,2];case 7:return[3,14];case 8:return s=l.sent(),c={error:s},[3,14];case 9:return l.trys.push([9,,12,13]),n&&!n.done&&(u=t.return)?[4,Object(i.__await)(u.call(t))]:[3,11];case 10:l.sent(),l.label=11;case 11:return[3,13];case 12:if(c)throw c.error;return[7];case 13:return[7];case 14:return[2];}});});}},legacyReplyChainUpdateEvent:{subscribe:function subscribe(e,t,n){var r=n.managers;return Object(i.__asyncGenerator)(this,arguments,function(){var e,t,n,a,o,s,c,u;return Object(i.__generator)(this,function(l){switch(l.label){case 0:e=new Ze(function(e){r.replyChainManager.subscribe(function(t){e.next(t);});}),l.label=1;case 1:l.trys.push([1,8,9,14]),t=Object(i.__asyncValues)(Qe(e,1e3)),l.label=2;case 2:return[4,Object(i.__await)(t.next())];case 3:return(n=l.sent()).done?[3,7]:(a=n.value,o={legacyReplyChainUpdateEvent:a.toLegacySchema()},[4,Object(i.__await)(o)]);case 4:return[4,l.sent()];case 5:l.sent(),l.label=6;case 6:return[3,2];case 7:return[3,14];case 8:return s=l.sent(),c={error:s},[3,14];case 9:return l.trys.push([9,,12,13]),n&&!n.done&&(u=t.return)?[4,Object(i.__await)(u.call(t))]:[3,11];case 10:l.sent(),l.label=11;case 11:return[3,13];case 12:if(c)throw c.error;return[7];case 13:return[7];case 14:return[2];}});});}},legacyChatServiceEvent:{subscribe:function subscribe(e,t,n){var r=n.longPollEventPublisher;return Object(i.__asyncGenerator)(this,arguments,function(){var e,t,n,a,o,s,c,u;return Object(i.__generator)(this,function(l){switch(l.label){case 0:e=Qe(r.observable,1e3),l.label=1;case 1:l.trys.push([1,8,9,14]),t=Object(i.__asyncValues)(e),l.label=2;case 2:return[4,Object(i.__await)(t.next())];case 3:return(n=l.sent()).done?[3,7]:(a=n.value,(o=Object(i.__assign)({},a)).resource=JSON.stringify(o.resource),[4,Object(i.__await)({legacyChatServiceEvent:o})]);case 4:return[4,l.sent()];case 5:l.sent(),l.label=6;case 6:return[3,2];case 7:return[3,14];case 8:return s=l.sent(),c={error:s},[3,14];case 9:return l.trys.push([9,,12,13]),n&&!n.done&&(u=t.return)?[4,Object(i.__await)(u.call(t))]:[3,11];case 10:l.sent(),l.label=11;case 11:return[3,13];case 12:if(c)throw c.error;return[7];case 13:return[7];case 14:return[2];}});});}}}};function xt(e,t,n){return t.component="ChatLegacyResolvers",n.error(e,t,h.c.InvalidInput),Promise.reject(e);}function Ht(e){switch(e){case Rt.inMemory:return r.DataSource.inMemory;case Rt.indexedDB:return r.DataSource.indexedDB;case Rt.Network:return r.DataSource.network;default:return null;}}var zt=n(1052);n.d(t,"resolvers",function(){return bt;}),n.d(t,"context",function(){return Ct;}),n.d(t,"IContext",function(){return It.IContext;}),n.d(t,"chatLegacyResolvers",function(){return Ft;}),n.d(t,"legacyChatContext",function(){return Bt;}),n.d(t,"ILegacyChatContext",function(){return zt.IContext;});},419:function _(e,t,n){"use strict";var r,i,a,o,s,c,u,l,d,p,g,m,h,v,f,b,y,S,O,C,_,M,I,w,j,T,P,N,E,A,D,k,R,L,U,B,F,x,H,z,G,W,V,K,J,q,Q,Z,Y,X,$,ee,te,ne,re,ie,ae,oe,se,ce,ue,le,de,pe,ge,me,he,ve,fe,be,ye,Se,Oe,Ce,_e,Me,Ie,we,je,Te,Pe,Ne,Ee,Ae,De,ke,Re,Le,Ue,Be,Fe,xe,He,ze,Ge,We,Ve,Ke,Je,qe,Qe,Ze,Ye,Xe,$e,et,tt,nt,rt,it,at,ot,st,ct,ut,lt,dt,pt,gt,mt,ht,vt,ft,bt,yt,St,Ot,Ct,_t,Mt,It,wt;n.d(t,"a",function(){return U;}),n.d(t,"b",function(){return $e;}),function(e){e.Standard="Standard",e.Private="Private",e.Shared="Shared";}(r||(r={})),function(e){e.None="None",e.MutedTeamMember="MutedTeamMember",e.OnlyOwnersCanPost="OnlyOwnersCanPost";}(i||(i={})),function(e){e.Room="Room",e.Building="Building";}(a||(a={})),function(e){e.private="private",e.online="online",e.event="event",e.inPerson="inPerson",e.channel="channel",e.broadcast="broadcast";}(o||(o={})),function(e){e.Unestablished="Unestablished",e.Viewing="Viewing",e.BrowsingPrivately="BrowsingPrivately",e.Presenting="Presenting";}(s||(s={})),function(e){e.Unestablished="Unestablished",e.Viewing="Viewing",e.Presenting="Presenting";}(c||(c={})),function(e){e.Done="Done",e.InProcess="InProcess",e.UnknownError="UnknownError",e.ScoreTooLow="ScoreTooLow",e.TooManyCharacters="TooManyCharacters",e.NotStarted="NotStarted";}(u||(u={})),function(e){e.Standard="Standard",e.Important="Important",e.Urgent="Urgent";}(l||(l={})),function(e){e.Sent="Sent",e.sent="sent",e.Failed="Failed",e.failed="failed";}(d||(d={})),function(e){e.Email="Email",e.Call="Call",e.PSTN="PSTN",e.SMS="SMS",e.TeamsCall="TeamsCall",e.ETNP="ETNP";}(p||(p={})),function(e){e.Delivered="Delivered",e.Sending="Sending",e.Error="Error",e.Undeliverable="Undeliverable";}(g||(g={})),function(e){e.active="active",e.deleted="deleted",e.reference="reference",e.hidden="hidden";}(m||(m={})),function(e){e.p2p="p2p",e.customspo="customspo",e.aggregatefiles="aggregatefiles",e.downloads="downloads",e.teams="teams",e.recent="recent",e.personal="personal";}(h||(h={})),function(e){e.Video="Video",e.ScreenSharing="ScreenSharing";}(v||(v={})),function(e){e.None="None",e.HoloLens="HoloLens",e.Android="Android",e.iOS="iOS",e.Other="Other";}(f||(f={})),function(e){e.broadcastqna="broadcastqna",e.broadcasts="broadcasts",e.calls="calls",e.callscontent="callscontent",e.callsgallery="callsgallery",e.callsgalleryandcontent="callsgalleryandcontent",e.channels="channels",e.chats="chats",e.courses="courses",e.devicesettings="devicesettings",e.digitalsignageadmin="digitalsignageadmin",e.digitalsignageplayer="digitalsignageplayer",e.extensions="extensions",e.licenses="licenses",e.meetings="meetings",e.messages="messages",e.outlookmessages="outlookmessages",e.teamgallery="teamgallery",e.teams="teams",e.transcript="transcript",e.videobackgrounds="videobackgrounds";}(b||(b={})),function(e){e.view="view",e.list="list",e.create="create",e.join="join",e.error="error",e.roster="roster",e.info="info",e.notes="notes";}(y||(y={})),function(e){e.Standard="Standard",e.Private="Private",e.Shared="Shared";}(S||(S={})),function(e){e.Domains="Domains",e.Members="Members",e.Anyone="Anyone";}(O||(O={})),function(e){e.Undefined="Undefined",e.User="User",e.Admin="Admin",e.Guest="Guest";}(C||(C={})),function(e){e.AnyonePost="AnyonePost",e.AnyoneWithWarning="AnyoneWithWarning",e.OwnersPost="OwnersPost";}(_||(_={})),function(e){e.Strict="Strict",e.Moderate="Moderate",e.NoRestriction="NoRestriction";}(M||(M={})),function(e){e.Team="Team",e.Edu="Edu",e.Class="Class",e.Plc="Plc",e.Staff="Staff",e.HealthcareCareCoordination="HealthcareCareCoordination";}(I||(I={})),function(e){e.None="None",e.Home="Home",e.Mobile="Mobile";}(w||(w={})),function(e){e.NotJoined="NotJoined",e.Joining="Joining",e.Joined="Joined",e.Pending="Pending";}(j||(j={})),function(e){e.None="None",e.Private="Private",e.Secret="Secret",e.Public="Public";}(T||(T={})),function(e){e.E164="E164",e.INTERNATIONAL="INTERNATIONAL",e.NATIONAL="NATIONAL",e.RFC3966="RFC3966";}(P||(P={})),function(e){e.Email="Email",e.MeetingInvite="MeetingInvite";}(N||(N={})),function(e){e.Link="Link",e.Attachment="Attachment";}(E||(E={})),function(e){e.ups="ups",e.sfb="sfb";}(A||(A={})),function(e){e.PresenceUnknown="PresenceUnknown",e.Available="Available",e.AvailableIdle="AvailableIdle",e.Away="Away",e.Busy="Busy",e.BusyIdle="BusyIdle",e.DoNotDisturb="DoNotDisturb",e.BeRightBack="BeRightBack",e.Offline="Offline";}(D||(D={})),function(e){e.InACall="InACall",e.InAConferenceCall="InAConferenceCall",e.InAMeeting="InAMeeting",e.Presenting="Presenting",e.OffWork="OffWork",e.Available="Available",e.Inactive="Inactive",e.Busy="Busy",e.DoNotDisturb="DoNotDisturb",e.BeRightBack="BeRightBack",e.Away="Away",e.Offline="Offline",e.UrgentInterruptionsOnly="UrgentInterruptionsOnly",e.PresenceUnknown="PresenceUnknown",e.OutOfOffice="OutOfOffice";}(k||(k={})),function(e){e.None="None",e.OnShift="OnShift",e.OffShift="OffShift";}(R||(R={})),function(e){e.ChatDisabledDueToIB="ChatDisabledDueToIB",e.SmsChatDisabledDueToLicense="SmsChatDisabledDueToLicense",e.SmsChatDisabledDueToRNLError="SmsChatDisabledDueToRNLError",e.UnknownReason="UnknownReason";}(L||(L={})),function(e){e.Chat="Chat",e.PhoneChat="PhoneChat",e.Meeting="Meeting",e.SfBInteropChat="SfBInteropChat";}(U||(U={})),function(e){e.Unknown="Unknown",e.Adhoc="Adhoc",e.Scheduled="Scheduled",e.Recurring="Recurring",e.Broadcast="Broadcast";}(B||(B={})),function(e){e.AcceptPending="AcceptPending",e.Accepted="Accepted",e.Blocked="Blocked";}(F||(F={})),function(e){e.Single="Single",e.Occurrence="Occurrence",e.Exception="Exception",e.RecurringMaster="RecurringMaster";}(x||(x={})),function(e){e.None="None",e.Organizer="Organizer",e.Tentative="Tentative",e.Accepted="Accepted",e.Declined="Declined",e.NotResponded="NotResponded";}(H||(H={})),function(e){e.Required="Required",e.Optional="Optional",e.Resource="Resource",e.Organizer="Organizer",e.Room="Room";}(z||(z={})),function(e){e.StreamGroup="StreamGroup",e.SecurityGroup="SecurityGroup";}(G||(G={})),function(e){e.Free="Free",e.Tentative="Tentative",e.Busy="Busy",e.Oof="Oof",e.WorkingElsewhere="WorkingElsewhere",e.Unknown="Unknown";}(W||(W={})),function(e){e.ItemAttachment="ItemAttachment",e.FileAttachment="FileAttachment",e.ReferenceAttachment="ReferenceAttachment";}(V||(V={})),function(e){e.Anonymous="Anonymous",e.AllCompany="AllCompany",e.InvitationOnly="InvitationOnly";}(K||(K={})),function(e){e.Created="Created",e.Activated="Activated",e.Abandoned="Abandoned",e.Suspended="Suspended",e.Live="Live",e.Stopped="Stopped",e.Deleted="Deleted",e.Recreated="Recreated",e.Hidden="Hidden";}(J||(J={})),function(e){e.NotStarted="NotStarted",e.Pending="Pending",e.Available="Available",e.Deleted="Deleted";}(q||(q={})),function(e){e.AlwaysEnabled="AlwaysEnabled",e.AlwaysDisabled="AlwaysDisabled",e.UserOverride="UserOverride";}(Q||(Q={})),function(e){e.Camera="Camera",e.Microphone="Microphone",e.Speaker="Speaker";}(Z||(Z={})),function(e){e.Conversations="Conversations",e.File="File",e.Message="Message",e.Tab="Tab";}(Y||(Y={})),function(e){e.None="None",e.Text="Text",e.StartEvent="StartEvent",e.StopEvent="StopEvent",e.ParticipantJoined="ParticipantJoined",e.ParticipantLeft="ParticipantLeft";}(X||(X={})),function(e){e.Monitor="Monitor",e.Window="Window",e.Camera="Camera";}($||($={})),function(e){e.NotControlCapable="NotControlCapable",e.Disabled="Disabled",e.NotInControl="NotInControl",e.RequestSent="RequestSent",e.InControl="InControl";}(ee||(ee={})),function(e){e.NotStarted="NotStarted",e.Starting="Starting",e.Started="Started",e.Stopping="Stopping",e.Stopped="Stopped";}(te||(te={})),function(e){e.Offline="Offline",e.InitFailed="InitFailed",e.JoinFailed="JoinFailed",e.AcceptFailed="AcceptFailed";}(ne||(ne={})),function(e){e.admin="admin",e.boss="boss",e.endUser="endUser";}(re||(re={})),function(e){e.Caller="Caller",e.SecurityDesk="SecurityDesk";}(ie||(ie={})),function(e){e.ppt="ppt",e.invision_whiteboard="invision_whiteboard",e.whiteboard="whiteboard";}(ae||(ae={})),function(e){e.upload="upload",e.recent="recent",e.channel="channel",e.attachment="attachment",e.cortana="cortana";}(oe||(oe={})),function(e){e.BroadcastModalityDisconnected="BroadcastModalityDisconnected",e.BroadcastModalityNotReceived="BroadcastModalityNotReceived",e.BroadcastMutedProducerWarning="BroadcastMutedProducerWarning",e.BroadcastStopped="BroadcastStopped",e.ComplianceRecordingStarted="ComplianceRecordingStarted",e.ComplianceRecordingStopped="ComplianceRecordingStopped",e.ContentOnlyAlert="ContentOnlyAlert",e.ContentSharingFailed="ContentSharingFailed",e.CpuInsufficient="CpuInsufficient",e.DeviceAtCallStart="DeviceAtCallStart",e.DeviceCaptureMute="DeviceCaptureMute",e.DeviceCaptureNotFunctioning="DeviceCaptureNotFunctioning",e.DeviceCaptureNotFunctioningAudioSrvNotRunning="DeviceCaptureNotFunctioningAudioSrvNotRunning",e.DeviceCaptureNotMuteButSilent="DeviceCaptureNotMuteButSilent",e.DeviceClipping="DeviceClipping",e.DeviceHowling="DeviceHowling",e.DeviceLowSNR="DeviceLowSNR",e.DeviceMultipleEndpoints="DeviceMultipleEndpoints",e.DeviceNearEndToEchoRatio="DeviceNearEndToEchoRatio",e.DeviceRenderHowling="DeviceRenderHowling",e.DeviceRenderNotFunctioning="DeviceRenderNotFunctioning",e.DeviceRenderNotFunctioningAudioSrvNotRunning="DeviceRenderNotFunctioningAudioSrvNotRunning",e.DeviceRenderZeroVolume="DeviceRenderZeroVolume",e.DeviceSpeakWhileMuted="DeviceSpeakWhileMuted",e.ImageRenderingQualityAlert="ImageRenderingQualityAlert",e.InitiatorStartedRecording="InitiatorStartedRecording",e.InsufficientMeetingRole="InsufficientMeetingRole",e.InteropCallAlert="InteropCallAlert",e.InteropScreenshare="InteropScreenshare",e.JoinersOngoingRecording="JoinersOngoingRecording",e.LocalDeviceEcho="LocalDeviceEcho",e.MeetingRoleChanged="MeetingRoleChanged",e.MicMutedRemotely="MicMutedRemotely",e.NetworkQuality="NetworkQuality",e.NetworkReconnect="NetworkReconnect",e.NetworkRecvCatastrophicPstnAvailable="NetworkRecvCatastrophicPstnAvailable",e.NetworkRecvCatastrophicPstnNotAvailable="NetworkRecvCatastrophicPstnNotAvailable",e.NetworkSendCatastrophicPstnAvailable="NetworkSendCatastrophicPstnAvailable",e.NetworkSendCatastrophicPstnNotAvailable="NetworkSendCatastrophicPstnNotAvailable",e.NetworkRecvCatastrophicPoorTurnOffVideo="NetworkRecvCatastrophicPoorTurnOffVideo",e.NetworkSendCatastrophicPoorTurnOffVideo="NetworkSendCatastrophicPoorTurnOffVideo",e.NoAvailableMicrophone="NoAvailableMicrophone",e.NoAvailableSpeakers="NoAvailableSpeakers",e.ParticipantsRecordingStarted="ParticipantsRecordingStarted",e.PptPrivateViewingFailed="PptPrivateViewingFailed",e.PptSharingStolen="PptSharingStolen",e.PptUnsupportedUpload="PptUnsupportedUpload",e.RecordingDisabled="RecordingDisabled",e.RecordingFailed="RecordingFailed",e.RecordingPPT="RecordingPPT",e.RecordingStopped="RecordingStopped",e.RecordingWhiteboard="RecordingWhiteboard",e.RemoteDeviceEcho="RemoteDeviceEcho",e.RigelDisplayDisconnected="RigelDisplayDisconnected",e.RigelParticipantsInLobby="RigelParticipantsInLobby",e.ScreensharingCallEscalatedToAudio="ScreensharingCallEscalatedToAudio",e.ScreensharingCallEscalatedToAudioFailed="ScreensharingCallEscalatedToAudioFailed",e.ScreenSharingNotSupported="ScreenSharingNotSupported",e.ScreenSharingRenderingError="ScreenSharingRenderingError",e.ScreenSharingWindowMinimizedPopUpAlert="ScreenSharingWindowMinimizedPopUpAlert",e.SharedWindowMinimized="SharedWindowMinimized",e.SharingControlRequestDenied="SharingControlRequestDenied",e.SharingControlRequestRevoked="SharingControlRequestRevoked",e.SharingDropped="SharingDropped",e.SharingStolen="SharingStolen",e.ScreenshareRecordingDisabled="ScreenshareRecordingDisabled",e.SpeakerAndMicUnmuted="SpeakerAndMicUnmuted",e.SystemAudioDevicesNotMatch="SystemAudioDevicesNotMatch",e.SystemAudioNoDevice="SystemAudioNoDevice",e.SystemAudioUnsupportedSharing="SystemAudioUnsupportedSharing",e.TranscriptStarted="TranscriptStarted",e.TranscriptStartedByOthers="TranscriptStartedByOthers",e.TranscriptStartFailed="TranscriptStartFailed",e.TranscriptStopped="TranscriptStopped",e.TranscriptStopFailed="TranscriptStopFailed",e.VideoCaptureDeviceFreeze="VideoCaptureDeviceFreeze",e.VideoCaptureFreezeRecovered="VideoCaptureFreezeRecovered",e.VideoCapturePermissionDenied="VideoCapturePermissionDenied",e.VideoCapturerDeviceStartFailed="VideoCapturerDeviceStartFailed",e.VideoCapturerDeviceStartFailureLackSystemRes="VideoCapturerDeviceStartFailureLackSystemRes",e.VideoCapturerDeviceStartFailureMFResConflict="VideoCapturerDeviceStartFailureMFResConflict",e.VideoCapturerDeviceStartTimedOut="VideoCapturerDeviceStartTimedOut",e.VoiceCollectionStarted="VoiceCollectionStarted",e.VoiceCollectionStopped="VoiceCollectionStopped",e.VoiceCollectionFailed="VoiceCollectionFailed";}(se||(se={})),function(e){e.Info="Info",e.Warning="Warning",e.Error="Error";}(ce||(ce={})),function(e){e.BroadcastLearnMore="BroadcastLearnMore",e.BroadcastModalityReconnect="BroadcastModalityReconnect",e.DownloadApp="DownloadApp",e.MuteSpeakerAndMicAudio="MuteSpeakerAndMicAudio",e.OpenDeviceSettings="OpenDeviceSettings",e.OpenLearnMoreLink="OpenLearnMoreLink",e.OpenMeetingInfo="OpenMeetingInfo",e.OpenPrivacyPolicyLink="OpenPrivacyPolicyLink",e.OptOutFromVoiceCollection="OptOutFromVoiceCollection",e.PstnDialInManually="PstnDialInManually",e.PstnDialOutManually="PstnDialOutManually",e.RejoinAsGuest="RejoinAsGuest",e.ShowPstnDialog="ShowPstnDialog",e.StartChromeExtensionInstallation="StartChromeExtensionInstallation",e.StartScreenSharingOnCall="StartScreenSharingOnCall",e.SwitchMicrophone="SwitchMicrophone",e.TakePptSharingControl="TakePptSharingControl",e.UnmuteMicAudio="UnmuteMicAudio",e.UnmuteSpeakers="UnmuteSpeakers",e.StartMeeting="StartMeeting",e.EnableScreenshareRecording="EnableScreenshareRecording",e.DisableIncomingAndOutgoingVideo="DisableIncomingAndOutgoingVideo",e.Cancel="Cancel";}(ue||(ue={})),function(e){e.Quality="Quality",e.ShortDurationHangup="ShortDurationHangup",e.EffectiveMeeting="EffectiveMeeting";}(le||(le={})),function(e){e.Audio="Audio",e.AttendeeAudio="AttendeeAudio",e.Video="Video",e.ScreenSharing="ScreenSharing",e.Broadcast="Broadcast",e.ScreenshareFromChat="ScreenshareFromChat",e.AttendeeGeneral="AttendeeGeneral",e.AttendeeCaptions="AttendeeCaptions",e.CallClosedCaptions="CallClosedCaptions",e.EffectiveMeeting="EffectiveMeeting",e.Other="Other";}(de||(de={})),function(e){e.P2P="P2P",e.GroupCall="GroupCall",e.Meeting="Meeting",e.ScreenshareFromChat="ScreenshareFromChat",e.PSTN="PSTN",e.SfB="SfB";}(pe||(pe={})),function(e){e.Team="Team",e.SharedLine="SharedLine",e.ServerHold="ServerHold";}(ge||(ge={})),function(e){e.QuickStart="QuickStart",e.BYOE="BYOE",e.QuickStartPushToStream="QuickStartPushToStream";}(me||(me={})),function(e){e.Producer="Producer",e.Contributor="Contributor",e.Attendee="Attendee",e.None="None";}(he||(he={})),function(e){e.OngoingCall="OngoingCall",e.Meeting="Meeting",e.OneToOneCall="OneToOneCall",e.GroupCall="GroupCall";}(ve||(ve={})),function(e){e.Url="Url",e.Text="Text";}(fe||(fe={})),function(e){e.PROGRESS="PROGRESS",e.CANCELLED="CANCELLED",e.FAILED="FAILED",e.CONFLICT="CONFLICT",e.COMPLETE="COMPLETE";}(be||(be={})),function(e){e.TEAMS="TEAMS",e.SHAREPOINT="SHAREPOINT";}(ye||(ye={})),function(e){e.File="File",e.Folder="Folder";}(Se||(Se={})),function(e){e.Personal="Personal",e.Team="Team",e.GroupChat="GroupChat";}(Oe||(Oe={})),function(e){e.Tab="Tab",e.Bot="Bot",e.Messaging="Messaging",e.Connector="Connector";}(Ce||(Ce={})),function(e){e.NotInstalled="NotInstalled",e.Installed="Installed",e.InstalledAndFavorited="InstalledAndFavorited",e.InstalledAndHidden="InstalledAndHidden",e.InstalledAndPermanent="InstalledAndPermanent",e.InstalledAndDeprecated="InstalledAndDeprecated",e.Featured="Featured";}(_e||(_e={})),function(e){e.Compose="Compose",e.Commandbox="Commandbox",e.Message="Message";}(Me||(Me={})),function(e){e.Query="Query",e.Action="Action";}(Ie||(Ie={})),function(e){e.Text="Text",e.Textarea="Textarea",e.Number="Number",e.Date="Date",e.Time="Time",e.Toggle="Toggle",e.Choiceset="Choiceset";}(we||(we={})),function(e){e.pdf="pdf",e.xlsx="xlsx",e.docx="docx",e.pptx="pptx",e.vsdx="vsdx",e.one="one";}(je||(je={})),function(e){e.QueryByThread="QueryByThread",e.QueryByApp="QueryByApp";}(Te||(Te={})),function(e){e.None="None",e.Disabled="Disabled",e.Pending="Pending",e.Waiting="Waiting",e.Started="Started",e.Stopped="Stopped",e.Failed="Failed";}(Pe||(Pe={})),function(e){e.NotSupported="NotSupported",e.Unavailable="Unavailable",e.Available="Available";}(Ne||(Ne={})),function(e){e.Off="Off",e.BackgroundBlur="BackgroundBlur",e.WhiteboardZoom="WhiteboardZoom",e.WhiteboardCleanup="WhiteboardCleanup",e.WhiteboardZoomAndCleanup="WhiteboardZoomAndCleanup";}(Ee||(Ee={})),function(e){e.Unknown="Unknown",e.Available="Available",e.NotAvailable="NotAvailable";}(Ae||(Ae={})),function(e){e.MeetingsUserParticipatesIn="MeetingsUserParticipatesIn",e.MeetingsUserIsInvitedTo="MeetingsUserIsInvitedTo",e.MeetingsManuallyUnmuted="MeetingsManuallyUnmuted";}(De||(De={})),function(e){e.IN_PROGRESS="IN_PROGRESS",e.NONE="NONE",e.SUCCESS="SUCCESS",e.FAIL="FAIL";}(ke||(ke={})),function(e){e.list="list",e.grid="grid";}(Re||(Re={})),function(e){e.result="result",e.auth="auth",e.config="config",e.message="message",e.botMessagePreview="botMessagePreview";}(Le||(Le={})),function(e){e.message="message",e.compose="compose",e.commandBox="commandBox";}(Ue||(Ue={})),function(e){e.default="default",e.dark="dark",e.highContrast="highContrast";}(Be||(Be={})),function(e){e.normal="normal",e.high="high",e.urgent="urgent";}(Fe||(Fe={})),function(e){e.aadUser="aadUser",e.onPremiseAadUser="onPremiseAadUser",e.anonymousGuest="anonymousGuest",e.federatedUser="federatedUser";}(xe||(xe={})),function(e){e.aadApplication="aadApplication",e.bot="bot",e.tenantBot="tenantBot",e.office365Connector="office365Connector",e.webhook="webhook";}(He||(He={})),function(e){e.team="team",e.channel="channel";}(ze||(ze={})),function(e){e.html="html",e.text="text";}(Ge||(Ge={})),function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.sad="sad",e.angry="angry";}(We||(We={})),function(e){e.NotAvailable="NotAvailable",e.Green="Green",e.Amber="Amber",e.Red="Red";}(Ve||(Ve={})),function(e){e.Info="Info",e.Error="Error";}(Ke||(Ke={})),function(e){e.Single="Single",e.Occurrence="Occurrence",e.Exception="Exception",e.RecurringMaster="RecurringMaster";}(Je||(Je={})),function(e){e.show="show",e.hide="hide",e.toggle="toggle";}(qe||(qe={})),function(e){e.none="none",e.flush="flush",e.new="new";}(Qe||(Qe={})),function(e){e.Camera="Camera",e.Microphone="Microphone",e.Speaker="Speaker";}(Ze||(Ze={})),function(e){e.Excellent="Excellent",e.Good="Good",e.Fair="Fair",e.Poor="Poor",e.Unknown="Unknown";}(Ye||(Ye={})),function(e){e.AttendeeAvailabilityOnly="AttendeeAvailabilityOnly",e.SuggestedTimesOnly="SuggestedTimesOnly",e.Both="Both";}(Xe||(Xe={})),function(e){e.Create="Create",e.Update="Update";}($e||($e={})),function(e){e.like="like",e.star="star",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.sad="sad",e.angry="angry";}(et||(et={})),function(e){e.add="add",e.remove="remove";}(tt||(tt={})),function(e){e.Hold="Hold",e.Resume="Resume",e.Transfer="Transfer",e.ConsultativeTransfer="ConsultativeTransfer";}(nt||(nt={})),function(e){e.Chat="Chat",e.TeamsCall="TeamsCall";}(rt||(rt={})),function(e){e.Scheduled="Scheduled",e.Broadcast="Broadcast";}(it||(it={})),function(e){e.None="None",e.Gallery="Gallery",e.Content="Content",e.ContentWithGallery="ContentWithGallery";}(at||(at={})),function(e){e.edit="edit",e.send="send";}(ot||(ot={})),function(e){e.List="List",e.Table="Table";}(st||(st={})),function(e){e.Connected="Connected",e.Disconnected="Disconnected",e.NotFound="NotFound";}(ct||(ct={})),function(e){e.Col="Col",e.Row="Row";}(ut||(ut={})),function(e){e.Unknown="Unknown",e.Acquire="Acquire",e.Renew="Renew",e.Release="Release";}(lt||(lt={})),function(e){e.None="None",e.Bullets="Bullets",e.Numbers="Numbers",e.Checkboxes="Checkboxes";}(dt||(dt={})),function(e){e.Done="Done",e.Error="Error",e.ErrorTooManyCharacters="ErrorTooManyCharacters",e.InProcess="InProcess";}(pt||(pt={})),function(e){e.personalFileSite="personalFileSite",e.userPersonalSettings="userPersonalSettings",e.firstLoginInformation="firstLoginInformation",e.readReceiptsEnabled="readReceiptsEnabled";}(gt||(gt={})),function(e){e.IMAGE="IMAGE",e.DOCUMENT="DOCUMENT";}(mt||(mt={})),function(e){e.Pause="Pause",e.Resume="Resume",e.Goto="Goto",e.Cards="Cards";}(ht||(ht={})),function(e){e.Next="Next",e.Prev="Prev",e.GoTo="GoTo";}(vt||(vt={})),function(e){e.None="None",e.Pending="Pending",e.Recording="Recording",e.Paused="Paused",e.Stopping="Stopping",e.Failed="Failed",e.Disabled="Disabled";}(ft||(ft={})),function(e){e.None="None",e.Started="Started",e.Failed="Failed";}(bt||(bt={})),function(e){e.None="None",e.Started="Started",e.Stopped="Stopped",e.Pending="Pending",e.Failed="Failed";}(yt||(yt={})),function(e){e.Added="Added",e.Removed="Removed",e.Updated="Updated",e.Synced="Synced";}(St||(St={})),function(e){e.NoOne="NoOne",e.Me="Me",e.AnotherUser="AnotherUser";}(Ot||(Ot={})),function(e){e.None="None",e.Started="Started",e.Stopped="Stopped",e.Pending="Pending",e.Failed="Failed";}(Ct||(Ct={})),function(e){e.Undefined="Undefined",e.Success="Success",e.NoNgcEndpoint="NoNgcEndpoint",e.NetworkError="NetworkError",e.MediaDroppedError="MediaDroppedError",e.BadRequest="BadRequest",e.CallEstablishmentTimeout="CallEstablishmentTimeout",e.CallSetupError="CallSetupError",e.NoPermission="NoPermission",e.Missed="Missed",e.Declined="Declined",e.Busy="Busy",e.Cancelled="Cancelled",e.Dropped="Dropped",e.PstnInsufficientFunds="PstnInsufficientFunds",e.PstnSkypeoutAccountBlocked="PstnSkypeoutAccountBlocked",e.PstnCouldNotConnectToSkypeProxy="PstnCouldNotConnectToSkypeProxy",e.PstnBlockedByUs="PstnBlockedByUs",e.PstnBlockedRegulatoryIndia="PstnBlockedRegulatoryIndia",e.PstnInvalidNumber="PstnInvalidNumber",e.PstnNumberForbidden="PstnNumberForbidden",e.PstnCallTerminated="PstnCallTerminated",e.PstnNumberUnavailable="PstnNumberUnavailable",e.PstnEmergencyCallDenied="PstnEmergencyCallDenied",e.CallNotFound="CallNotFound",e.LocalError="LocalError",e.NotAcceptableHere="NotAcceptableHere",e.CallForwarded="CallForwarded",e.CallForwardedToVoicemail="CallForwardedToVoicemail",e.SkypeTokenError="SkypeTokenError",e.CallAccepted="CallAccepted",e.LocalHttpStackError="LocalHttpStackError",e.UnknownError="UnknownError",e.PstnNoSubscriptionCover="PstnNoSubscriptionCover",e.SessionNotFound="SessionNotFound",e.SessionTimedOut="SessionTimedOut",e.PstnCreditExpired="PstnCreditExpired",e.PstnCreditExpiredButEnough="PstnCreditExpiredButEnough",e.RetargetNotSupported="RetargetNotSupported",e.EnterprisePstnInternalError="EnterprisePstnInternalError",e.EnterprisePstnUnavailable="EnterprisePstnUnavailable",e.EnterprisePstnForbidden="EnterprisePstnForbidden",e.EnterprisePstnInvalidNumber="EnterprisePstnInvalidNumber",e.EnterprisePstnMiscError="EnterprisePstnMiscError",e.Kicked="Kicked",e.NetworkRequestTimeoutError="NetworkRequestTimeoutError",e.CallDoesNotExist="CallDoesNotExist",e.MediaSetupFailure="MediaSetupFailure",e.ServiceUnavailable="ServiceUnavailable",e.SignalingError="SignalingError",e.ConversationEstablishmentFailed="ConversationEstablishmentFailed",e.TemporarilyUnavailable="TemporarilyUnavailable",e.CannotConnectToNetworkError="CannotConnectToNetworkError",e.MediaRelayWhiteListingIssue="MediaRelayWhiteListingIssue",e.NoSignalingFromPeer="NoSignalingFromPeer",e.DeniedInLobby="DeniedInLobby",e.TimedOutInLobby="TimedOutInLobby",e.CallFailedConflict="CallFailedConflict",e.DevicePermissionDenied="DevicePermissionDenied",e.ConfParticipantCountLimitReached="ConfParticipantCountLimitReached",e.ActionNotAllowed="ActionNotAllowed",e.Abandoned="Abandoned",e.ForbiddenDueToPolicy="ForbiddenDueToPolicy",e.InsufficientCapabilitiesForCallee="InsufficientCapabilitiesForCallee",e.UserBlocked="UserBlocked",e.AccessDenied="AccessDenied",e.AnonymousJoinDisabledByPolicy="AnonymousJoinDisabledByPolicy",e.NoLobbyForBroadcastJoin="NoLobbyForBroadcastJoin",e.NotAllowedDueToInformationBarrier="NotAllowedDueToInformationBarrier",e.BroadcastLimitReached="BroadcastLimitReached",e.TeamParkPolicyDisabled="TeamParkPolicyDisabled",e.B2bJoinDisabledByPolicy="B2bJoinDisabledByPolicy",e.LocationBasedRoutingError="LocationBasedRoutingError",e.ConfLobbyParticipantCountLimitReached="ConfLobbyParticipantCountLimitReached";}(_t||(_t={})),function(e){e.Success="Success",e.Failed="Failed";}(Mt||(Mt={})),function(e){e.List="List",e.Grid="Grid",e.Object="Object";}(It||(It={})),function(e){e.organization="organization";}(wt||(wt={}));}}]);
//# sourceMappingURL=https://local.teams.office.com/sourcemaps/57-014e35d5b05d55ddd70a.js.map