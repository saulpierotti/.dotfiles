var Microsoft;!function(e){!function(e){!function(e){e[e.BT_STOP=0]="BT_STOP",e[e.BT_STOP_BASE=1]="BT_STOP_BASE",e[e.BT_BOOL=2]="BT_BOOL",e[e.BT_UINT8=3]="BT_UINT8",e[e.BT_UINT16=4]="BT_UINT16",e[e.BT_UINT32=5]="BT_UINT32",e[e.BT_UINT64=6]="BT_UINT64",e[e.BT_FLOAT=7]="BT_FLOAT",e[e.BT_DOUBLE=8]="BT_DOUBLE",e[e.BT_STRING=9]="BT_STRING",e[e.BT_STRUCT=10]="BT_STRUCT",e[e.BT_LIST=11]="BT_LIST",e[e.BT_SET=12]="BT_SET",e[e.BT_MAP=13]="BT_MAP",e[e.BT_INT8=14]="BT_INT8",e[e.BT_INT16=15]="BT_INT16",e[e.BT_INT32=16]="BT_INT32",e[e.BT_INT64=17]="BT_INT64",e[e.BT_WSTRING=18]="BT_WSTRING",e[e.BT_UNAVAILABLE=127]="BT_UNAVAILABLE"}(e.BondDataType||(e.BondDataType={}));!function(e){e[e.MARSHALED_PROTOCOL=0]="MARSHALED_PROTOCOL",e[e.MAFIA_PROTOCOL=17997]="MAFIA_PROTOCOL",e[e.COMPACT_PROTOCOL=16963]="COMPACT_PROTOCOL",e[e.JSON_PROTOCOL=21322]="JSON_PROTOCOL",e[e.PRETTY_JSON_PROTOCOL=20554]="PRETTY_JSON_PROTOCOL",e[e.SIMPLE_PROTOCOL=20563]="SIMPLE_PROTOCOL"}(e.ProtocolType||(e.ProtocolType={}))}(e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={}));var Microsoft;!function(e){!function(e){!function(e){var t=function(){function e(){this._buffer=[]}return e.prototype.Add=function(e){for(var t=0;t<this._buffer.length&&this._buffer[t]!=e;++t);t==this._buffer.length&&this._buffer.push(e)},e.prototype.Count=function(){return this._buffer.length},e.prototype.GetBuffer=function(){return this._buffer},e}();e.Set=t;var n=function(){function e(){this._buffer=[]}return e.prototype.Add=function(e,t){-1==this._getIndex(e)&&this._buffer.push({Key:e,Value:t})},e.prototype.AddOrReplace=function(e,t){var n=this._getIndex(e);n>=0?this._buffer[n]={Key:e,Value:t}:this._buffer.push({Key:e,Value:t})},e.prototype.Remove=function(e){var t=this._getIndex(e);t>=0&&this._buffer.splice(t,1)},e.prototype.Count=function(){return this._buffer.length},e.prototype.GetBuffer=function(){return this._buffer},e.prototype.ContainsKey=function(e){return this._getIndex(e)>=0},e.prototype.Get=function(e){var t=this._getIndex(e);return t>=0?this._buffer[t].Value:null},e.prototype._getIndex=function(e){for(var t=0,n=-1;t<this._buffer.length;++t)if(this._buffer[t].Key==e){n=t;break}return n},e}();e.Map=n}(e.Collections||(e.Collections={}))}(e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={}));var Microsoft;!function(e){!function(t){!function(e){var i=function(){function e(){}return e.GetBytes=function(e){for(var t=[],n=0;n<e.length;++n){var i=e.charCodeAt(n);i<128?t.push(i):i<2048?t.push(192|i>>6,128|63&i):i<55296||i>=57344?t.push(224|i>>12,128|i>>6&63,128|63&i):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++n)),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return t},e}();e.Utf8=i;var r=function(){function e(){}return e.GetString=function(e){var t,n,i,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=[],s=e.length%3;for(t=0,i=e.length-s;t<i;t+=3)n=(e[t]<<16)+(e[t+1]<<8)+e[t+2],o.push(function(e){return[r.charAt(e>>18&63),r.charAt(e>>12&63),r.charAt(e>>6&63),r.charAt(63&e)].join("")}(n));switch(s){case 1:n=e[e.length-1],o.push(r.charAt(n>>2)),o.push(r.charAt(n<<4&63)),o.push("==");break;case 2:n=(e[e.length-2]<<8)+e[e.length-1],o.push(r.charAt(n>>10)),o.push(r.charAt(n>>4&63)),o.push(r.charAt(n<<2&63)),o.push("=")}return o.join("")},e}();e.Base64=r;var o=function(){function e(){}return e.GetBytes=function(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7;return t.push(127&e),t},e}();e.Varint=o;var s=function(){function e(){}return e.GetBytes=function(e){for(var t=e.low,n=e.high,i=[];n||4294967168&t;)i.push(127&t|128),t=(127&n)<<25|t>>>7,n>>>=7;return i.push(127&t),i},e}();e.Varint64=s;var a=function(){function e(){}return e.GetBytes=function(e){if(t.BrowserChecker.IsDataViewSupport()){var i=new DataView(new ArrayBuffer(4));i.setFloat32(0,e,!0);for(var r=[],o=0;o<4;++o)r.push(i.getUint8(o));return r}return n.ConvertNumberToArray(e,!1)},e}();e.Float=a;var u=function(){function e(){}return e.GetBytes=function(e){if(t.BrowserChecker.IsDataViewSupport()){var i=new DataView(new ArrayBuffer(8));i.setFloat64(0,e,!0);for(var r=[],o=0;o<8;++o)r.push(i.getUint8(o));return r}return n.ConvertNumberToArray(e,!0)},e}();e.Double=u;var c=function(){function e(){}return e.EncodeZigzag16=function(e){return(e=t.Number.ToInt16(e))<<1^e>>15},e.EncodeZigzag32=function(e){return(e=t.Number.ToInt32(e))<<1^e>>31},e.EncodeZigzag64=function(e){var n=e.low,i=e.high,r=i<<1|n>>>31,o=n<<1;2147483648&i&&(r=~r,o=~o);var s=new t.UInt64("0");return s.low=o,s.high=r,s},e}();e.Zigzag=c}(t.Encoding||(t.Encoding={}));!function(i){var r=function(){function e(){}return e.GetString=function(e){for(var t=[],n=0;n<e.length;++n){var i=e[n];if(i<=191)t.push(String.fromCharCode(i));else if(i<=223){r=e[++n];t.push(String.fromCharCode((31&i)<<6|63&r))}else if(i<=239){var r=e[++n],o=e[++n];t.push(String.fromCharCode((15&i)<<12|(63&r)<<6|63&o))}else i=(7&i)<<18|(63&(r=e[++n]))<<12|(63&(o=e[++n]))<<6|63&e[++n],i-=65536,t.push(String.fromCharCode(55296|i>>10&1023)),t.push(String.fromCharCode(56320|1023&i))}return t.join("")},e}();i.Utf8=r;var o=function(){function e(){}return e.GetBytes=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[],i=0;i<e.length;++i){var r=t.indexOf(e.charAt(i++)),o=t.indexOf(e.charAt(i++)),s=t.indexOf(e.charAt(i++)),a=t.indexOf(e.charAt(i));n.push(r<<2|o>>4),s>=0&&(n.push(o<<4&240|s>>2),a>=0&&n.push(s<<6&192|a))}return n},e}();i.Base64=o;var s=function(){function t(){}return t.GetInt64=function(t){var n=new e.Bond.Int64("0"),i=this._Read(t);return n.low=i[0],i.length>1&&(n.high=i[1]),n},t.GetNumber=function(e){return this._Read(e)[0]},t._Read=function(e){for(var t=[],n=0,i=!0,r=0;i;){if(i=0!=(128&(o=e.shift())),o&=127,!(r<28)){n|=o<<r,t.push(n),n=o>>4,r=3;break}n|=o<<r,r+=7}for(;i;){var o=e.shift();if(i=0!=(128&o),o&=127,n|=o<<r,(r+=7)>=32)break}return t.push(n),t},t}();i.Varint=s;var a=function(){function e(){}return e.GetNumber=function(e){if(t.BrowserChecker.IsDataViewSupport()){for(var i=new DataView(new ArrayBuffer(4)),r=0;r<4;++r)i.setUint8(r,e[r]);return i.getFloat32(0,!0)}return n.ConvertArrayToNumber(e,!1)},e}();i.Float=a;var u=function(){function e(){}return e.GetNumber=function(e){if(t.BrowserChecker.IsDataViewSupport()){for(var i=new DataView(new ArrayBuffer(8)),r=0;r<8;++r)i.setUint8(r,e[r]);return i.getFloat64(0,!0)}return n.ConvertArrayToNumber(e,!0)},e}();i.Double=u;var c=function(){function t(){}return t.DecodeZigzag16=function(e){return((65535&e)>>>1^-(1&e))<<16>>16},t.DecodeZigzag32=function(e){return e>>>1^-(1&e)},t.DecodeZigzag64=function(t){var n=1&t.high,i=t.high>>>1,r=1&t.low,o=t.low>>>1;o|=n<<31,r&&(o^=4294967295,i^=4294967295);var s=new e.Bond.UInt64("0");return s.low=o,s.high=i,s},t}();i.Zigzag=c}(t.Decoding||(t.Decoding={}));var n=function(){function e(){}return e.ConvertNumberToArray=function(e,t){if(!e)return t?this._doubleZero:this._floatZero;var n=t?11:8,i=t?52:23,r=(1<<n-1)-1,o=1-r,s=r,a=e<0?1:0;e=Math.abs(e);for(var u=Math.floor(e),c=e-u,l=2*(r+2)+i,h=new Array(l),f=0;f<l;)h[f++]=0;for(f=r+2;f&&u;)h[--f]=u%2,u=Math.floor(u/2);for(f=r+1;f<l-1&&c>0;)(c*=2)>=1?(h[++f]=1,--c):h[++f]=0;for(var p=0;p<l&&!h[p];++p);var d=r+1-p,g=p+i;if(h[g+1]){for(f=g;f>p&&!(h[f]=1-h[f]);--f);f==p&&++d}if(d>s||u)return a?t?this._doubleNegInifinity:this._floatNegInifinity:t?this._doubleInifinity:this._floatInifinity;if(d<o)return t?this._doubleZero:this._floatZero;if(t){var _=0;for(f=0;f<20;++f)_=_<<1|h[++p];for(var v=0;f<52;++f)v=v<<1|h[++p];return y=[255&v,v>>8&255,v>>16&255,v>>>24,255&(_=a<<31|2147483647&(_|=d+r<<20)),_>>8&255,_>>16&255,_>>>24]}var m=0;for(f=0;f<23;++f)m=m<<1|h[++p];var y=[255&(m=a<<31|2147483647&(m|=d+r<<23)),m>>8&255,m>>16&255,m>>>24];return y},e.ConvertArrayToNumber=function(e,n){var i=(1<<(n?11:8)-1)-1,r=0!=(128&e[n?7:3]),o=n?(127&e[7])<<4|(240&e[6])>>4:(127&e[3])<<1|(128&e[2])>>7;if(255==o)throw new t.Exception("Not a valid float/double buffer.");var s=1,a=1;if(n){var u=(15&e[6])<<28|(255&e[5])<<20|(255&e[4])<<12,c=e[3]<<24|(255&e[2])<<16|(255&e[1])<<8|255&e[0];if(!o&&!u&&!c)return 0;for(h=0;h<20;++h)a/=2,u<0&&(s+=a),u<<=1;for(h=0;h<32;++h)a/=2,c<0&&(s+=a),c<<=1}else{var l=(127&e[2])<<25|(255&e[1])<<17|(255&e[0])<<9;if(!o&&!l)return 0;for(var h=0;h<23;++h)a/=2,l<0&&(s+=a),l<<=1}return s*=Math.pow(2,o-i),r?0-s:s},e._floatZero=[0,0,0,0],e._doubleZero=[0,0,0,0,0,0,0,0],e._floatInifinity=[0,0,128,127],e._floatNegInifinity=[0,0,128,255],e._doubleInifinity=[0,0,0,0,0,0,240,127],e._doubleNegInifinity=[0,0,0,0,0,0,240,255],e}()}(e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={}));var Microsoft;!function(e){!function(e){!function(t){var n=function(){function t(){this._buffer=[]}return t.prototype.WriteByte=function(t){this._buffer.push(e.Number.ToByte(t))},t.prototype.Write=function(e,t,n){for(;n--;)this.WriteByte(e[t++])},t.prototype.GetBuffer=function(){return this._buffer},t}();t.MemoryStream=n}(e.IO||(e.IO={}))}(e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={}));var Microsoft;!function(e){!function(e){var t=function(){return function(e,t){this.Type=e,this.Id=t}}();e.FieldTag=t;var n=function(){return function(e,t){this.ElementType=e,this.Size=t}}();e.ContainerTag=n;var i=function(){return function(e,t,n){this.KeyType=e,this.ValueType=t,this.Size=n}}();e.KeyValueContainerTag=i;var r=function(){return function(){}}();e.Bonded=r;var o=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e),this.low<0&&(this.high=-1)}return e.prototype.Equals=function(t){var n=new e(t);return this.low==n.low&&this.high==n.high},e}();e.Int64=o;var s=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e)}return e.prototype.Equals=function(t){var n=new e(t);return this.low==n.low&&this.high==n.high},e}();e.UInt64=s;var a=function(){function e(){}return e.ToByte=function(e){return this.ToUInt8(e)},e.ToInt8=function(e){return 127&e|(128&e)<<24>>24},e.ToInt16=function(e){return 32767&e|(32768&e)<<16>>16},e.ToInt32=function(e){return 2147483647&e|2147483648&e},e.ToUInt8=function(e){return 255&e},e.ToUInt16=function(e){return 65535&e},e.ToUInt32=function(e){return 4294967295&e},e}();e.Number=a;var u=function(){return function(e){this.Message=e}}();e.Exception=u;var c=function(){return function(){}}();e.KeyValuePair=c;var l=function(){function e(){}return e.IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},e}();e.BrowserChecker=l}(e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={})),function(e){!function(e){var t=function(){function t(e){this._stream=e}return t.prototype.WriteBlob=function(e){this._stream.Write(e,0,e.length)},t.prototype.WriteBool=function(e){this._stream.WriteByte(e?1:0)},t.prototype.WriteContainerBegin=function(e,t){this.WriteUInt8(t),this.WriteUInt32(e)},t.prototype.WriteMapContainerBegin=function(e,t,n){this.WriteUInt8(t),this.WriteUInt8(n),this.WriteUInt32(e)},t.prototype.WriteContainerEnd=function(){},t.prototype.WriteDouble=function(t){var n=e.Encoding.Double.GetBytes(t);this._stream.Write(n,0,n.length)},t.prototype.WriteFloat=function(t){var n=e.Encoding.Float.GetBytes(t);this._stream.Write(n,0,n.length)},t.prototype.WriteFieldBegin=function(e,t,n){t<=5?this._stream.WriteByte(e|t<<5):t<=255?(this._stream.WriteByte(192|e),this._stream.WriteByte(t)):(this._stream.WriteByte(224|e),this._stream.WriteByte(t),this._stream.WriteByte(t>>8))},t.prototype.WriteFieldEnd=function(){},t.prototype.WriteFieldOmitted=function(e,t,n){},t.prototype.WriteInt16=function(t){t=e.Encoding.Zigzag.EncodeZigzag16(t),this.WriteUInt16(t)},t.prototype.WriteInt32=function(t){t=e.Encoding.Zigzag.EncodeZigzag32(t),this.WriteUInt32(t)},t.prototype.WriteInt64=function(t){this.WriteUInt64(e.Encoding.Zigzag.EncodeZigzag64(t))},t.prototype.WriteInt8=function(t){this._stream.WriteByte(e.Number.ToInt8(t))},t.prototype.WriteString=function(t){if(""==t)this.WriteUInt32(0);else{var n=e.Encoding.Utf8.GetBytes(t);this.WriteUInt32(n.length),this._stream.Write(n,0,n.length)}},t.prototype.WriteStructBegin=function(e,t){},t.prototype.WriteStructEnd=function(t){this.WriteUInt8(t?e.BondDataType.BT_STOP_BASE:e.BondDataType.BT_STOP)},t.prototype.WriteUInt16=function(t){var n=e.Encoding.Varint.GetBytes(e.Number.ToUInt16(t));this._stream.Write(n,0,n.length)},t.prototype.WriteUInt32=function(t){var n=e.Encoding.Varint.GetBytes(e.Number.ToUInt32(t));this._stream.Write(n,0,n.length)},t.prototype.WriteUInt64=function(t){var n=e.Encoding.Varint64.GetBytes(t);this._stream.Write(n,0,n.length)},t.prototype.WriteUInt8=function(t){this._stream.WriteByte(e.Number.ToUInt8(t))},t.prototype.WriteWString=function(e){this.WriteUInt32(e.length);for(var t=0;t<e.length;++t){var n=e.charCodeAt(t);this._stream.WriteByte(n),this._stream.WriteByte(n>>>8)}},t}();e.CompactBinaryProtocolWriter=t;var n=function(){return function(){}}();e.CompactBinaryProtocolReader=n}(e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={}));var sct;!function(e){var t=function(){function e(){}return e.IsSafariOrFirefox=function(){return null===e._isSafariOrFirefox&&e._DetectBrowser(),e._isSafariOrFirefox},e.ajax=function(t){var n=e._createConnection();if(t.headers){var i="qsp=true";for(var r in t.headers)i+="&",i+=encodeURIComponent(r),i+="=",i+=encodeURIComponent(t.headers[r]);t.url.indexOf("?")<0?t.url+="?":t.url+="&",t.url+=i}n.open(t.type,t.url),t.complete&&(n.onload=function(){void 0===n.status&&(n.status=200),t.complete(n)},n.ontimeout=function(){void 0===n.status&&(n.status=500),t.complete(n)},n.onerror=function(){t.complete(n)}),n.send(t.data)},e.keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t},e.IsUsingXDomainRequest=function(){if(null==e._usingXDomainRequest){var t=new XMLHttpRequest;e._usingXDomainRequest=void 0===t.withCredentials&&"undefined"!=typeof XDomainRequest}return e._usingXDomainRequest},e._createConnection=function(){var t=new XMLHttpRequest;return e.IsUsingXDomainRequest()?new XDomainRequest:t},e._DetectBrowser=function(){var t=navigator.userAgent.toLowerCase();e._isSafariOrFirefox=(t.indexOf("safari")>=0||t.indexOf("firefox")>=0)&&t.indexOf("chrome")<0},e._isSafariOrFirefox=null,e._usingXDomainRequest=null,e}();e.Utils=t}(sct||(sct={}));var microsoft;!function(e){!function(e){!function(e){!function(t){var n=function(){function e(){}return e.GetGuid=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1,5)};return[e(),e(),"-",e(),"-",e(),"-",e(),"-",e(),e(),e()].join("")},e.GetTimeStamp=function(){var e=(new Date).getTime(),t=new Microsoft.Bond.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},e.GetTimeStampWithValue=function(e){var t=new Microsoft.Bond.Int64("0");return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},e}();t.utils=n;!function(e){e[e.NotSet=0]="NotSet",e[e.Event=1]="Event",e[e.PerformanceCounter=2]="PerformanceCounter",e[e.Anomaly=3]="Anomaly",e[e.Prediction=4]="Prediction",e[e.TraceLog=5]="TraceLog",e[e.EventSourceLog=6]="EventSourceLog",e[e.HttpLog=7]="HttpLog",e[e.PerformanceCounterAzure=8]="PerformanceCounterAzure",e[e.PerformanceCounterGfs=9]="PerformanceCounterGfs"}(t.RecordType||(t.RecordType={}));!function(e){e[e.NotSet=0]="NotSet",e[e.O365=1]="O365",e[e.SkypeBI=2]="SkypeBI",e[e.SkypeData=3]="SkypeData"}(t.PIIScrubber||(t.PIIScrubber={}));!function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"}(t.PIIKind||(t.PIIKind={}));var i=function(){function t(){this.ScrubType=e.datamodels.PIIScrubber.NotSet,this.Kind=e.datamodels.PIIKind.NotSet,this.RawContent=""}return t.prototype.Write=function(e){this.WriteImpl(e,!1)},t.prototype.WriteImpl=function(t,n){t.WriteStructBegin(null,n),this.ScrubType!=e.datamodels.PIIScrubber.NotSet?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,1,null),t.WriteInt32(this.ScrubType),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,1,null),this.Kind!=e.datamodels.PIIKind.NotSet?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,2,null),t.WriteInt32(this.Kind),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,2,null),""!=this.RawContent?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,3,null),t.WriteString(this.RawContent),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,3,null),t.WriteStructEnd(n)},t.prototype.Read=function(e){this.ReadImpl(e,!1)},t.prototype.ReadImpl=function(e,t){},t}();t.PII=i;var r=function(){function t(){this.Id=n.GetGuid(),this.Timestamp=n.GetTimeStamp(),this.Type="",this.EventType="",this.Extension=new Microsoft.Bond.Collections.Map,this.RecordType=e.datamodels.RecordType.NotSet,this.PIIExtensions=new Microsoft.Bond.Collections.Map}return t.prototype.AddOrReplacePII=function(t,n,i){var r=new e.datamodels.PII;r.RawContent=n,r.Kind=i,r.ScrubType=e.datamodels.PIIScrubber.O365,this.PIIExtensions.AddOrReplace(t,r)},t.prototype.Write=function(e){this.WriteImpl(e,!1)},t.prototype.WriteImpl=function(t,n){if(t.WriteStructBegin(null,n),""!=this.Id?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,1,null),t.WriteString(this.Id),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,1,null),this.Timestamp.Equals("0")?t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT64,3,null):(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT64,3,null),t.WriteInt64(this.Timestamp),t.WriteFieldEnd()),""!=this.Type?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,5,null),t.WriteString(this.Type),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,5,null),""!=this.EventType?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,6,null),t.WriteString(this.EventType),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,6,null),this.Extension.Count()){t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_MAP,13,null),t.WriteMapContainerBegin(this.Extension.Count(),Microsoft.Bond.BondDataType.BT_STRING,Microsoft.Bond.BondDataType.BT_STRING);for(var i=0;i<this.Extension.GetBuffer().length;++i)t.WriteString(this.Extension.GetBuffer()[i].Key),t.WriteString(this.Extension.GetBuffer()[i].Value);t.WriteContainerEnd(),t.WriteFieldEnd()}else t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_MAP,13,null);if(this.RecordType!=e.datamodels.RecordType.NotSet?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,24,null),t.WriteInt32(this.RecordType),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,24,null),this.PIIExtensions.Count()){t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_MAP,30,null),t.WriteMapContainerBegin(this.PIIExtensions.Count(),Microsoft.Bond.BondDataType.BT_STRING,Microsoft.Bond.BondDataType.BT_STRUCT);for(var r=0;r<this.PIIExtensions.GetBuffer().length;++r)t.WriteString(this.PIIExtensions.GetBuffer()[r].Key),this.PIIExtensions.GetBuffer()[r].Value.WriteImpl(t,!1);t.WriteContainerEnd(),t.WriteFieldEnd()}else t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_MAP,30,null);t.WriteStructEnd(n)},t.prototype.Read=function(e){this.ReadImpl(e,!1)},t.prototype.ReadImpl=function(e,t){},t}();t.Record=r;var o=function(){function e(){this.Source="",this.DataPackageId="",this.Timestamp=new Microsoft.Bond.Int64("0"),this.Records=[]}return e.prototype.Write=function(e){this.WriteImpl(e,!1)},e.prototype.WriteImpl=function(e,t){if(e.WriteStructBegin(null,t),""!=this.Source?(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,2,null),e.WriteString(this.Source),e.WriteFieldEnd()):e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,2,null),""!=this.DataPackageId?(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,5,null),e.WriteString(this.DataPackageId),e.WriteFieldEnd()):e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,5,null),this.Timestamp.Equals("0")?e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT64,6,null):(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT64,6,null),e.WriteInt64(this.Timestamp),e.WriteFieldEnd()),this.Records.length){e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_LIST,8,null),e.WriteContainerBegin(this.Records.length,Microsoft.Bond.BondDataType.BT_STRUCT);for(var n=0;n<this.Records.length;++n)this.Records[n].WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_LIST,8,null);e.WriteStructEnd(t)},e.prototype.Read=function(e){this.ReadImpl(e,!1)},e.prototype.ReadImpl=function(e,t){},e}();t.DataPackage=o;var s=function(){function e(){this.DataPackages=[],this.RequestRetryCount=0}return e.prototype.Write=function(e){this.WriteImpl(e,!1)},e.prototype.WriteImpl=function(e,t){if(e.WriteStructBegin(null,t),this.DataPackages.length){e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_LIST,1,null),e.WriteContainerBegin(this.DataPackages.length,Microsoft.Bond.BondDataType.BT_STRUCT);for(var n=0;n<this.DataPackages.length;++n)this.DataPackages[n].WriteImpl(e,!1);e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_LIST,1,null);0!=this.RequestRetryCount?(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,2,null),e.WriteInt32(this.RequestRetryCount),e.WriteFieldEnd()):e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,2,null),e.WriteStructEnd(t)},e.prototype.Read=function(e){this.ReadImpl(e,!1)},e.prototype.ReadImpl=function(e,t){},e}();t.ClientToCollectorRequest=s}(e.datamodels||(e.datamodels={}))}(e.telemetry||(e.telemetry={}))}(e.applications||(e.applications={}))}(microsoft||(microsoft={}));var microsoft;!function(e){!function(t){!function(t){!function(n){var i;!function(e){e[e.SENT=0]="SENT",e[e.SEND_FAILED=1]="SEND_FAILED"}(i=n.CallbackEventType||(n.CallbackEventType={}));var r;!function(e){e[e.DATARV_ERROR_OK=0]="DATARV_ERROR_OK",e[e.DATARV_ERROR_INVALID_EVENT=1]="DATARV_ERROR_INVALID_EVENT",e[e.DATARV_ERROR_INVALID_CONFIG=2]="DATARV_ERROR_INVALID_CONFIG",e[e.DATARV_ERROR_INVALID_DEPENDENCIES=3]="DATARV_ERROR_INVALID_DEPENDENCIES",e[e.DATARV_ERROR_INVALID_STATUS=4]="DATARV_ERROR_INVALID_STATUS",e[e.DATARV_ERROR_INVALID_ARG=5]="DATARV_ERROR_INVALID_ARG"}(r=n.DATARV_ERROR||(n.DATARV_ERROR={}));var o=function(){function e(e){this._errorCode=r.DATARV_ERROR_OK,this._errorCode=e}return e.prototype.ErrorCode=function(){return this._errorCode},e.prototype.toString=function(){switch(this._errorCode){case r.DATARV_ERROR_OK:return"DATARV_ERROR_OK";case r.DATARV_ERROR_INVALID_EVENT:return"Event is invalid. Either event.Id is empty, or event.Timestamp is empty, or event.EventType is empty.";case r.DATARV_ERROR_INVALID_CONFIG:return"Invalid configuration. CollectorUrl is missing.";case r.DATARV_ERROR_INVALID_DEPENDENCIES:return"DATARV_ERROR_INVALID_DEPENDENCIES";case r.DATARV_ERROR_INVALID_STATUS:return"Telemetry Manager is not initialized.";case r.DATARV_ERROR_INVALID_ARG:return"TenantToken is null or empty, or events is null.";default:return"Unknown error"}},e}();n.Exception=o;var s=function(){return function(){}}();n.TelemetryConfig=s;var a=function(){function e(){}return e.CreateTelemetryManager=function(){return new l},e}();n.TelemetryManagerFactory=a;var u,c=function(){function e(){}return e.MaxPackageSizeInBytes=3e6,e.TimeIntervalForNextSendInMS=15e3,e}();!function(e){e[e.Created=0]="Created",e[e.Initialized=1]="Initialized",e[e.Started=2]="Started"}(u||(u={}));var l=function(){function n(){this._MaxPackageSizeInBytes=c.MaxPackageSizeInBytes,this._listeners=[],this._status=u.Created,this._ecsClient=null,this._etag=null,this._ecsCallback=null,this._testServerResponseHook=null,this._isPaused=!1,this._testHookListeners=[]}return n.prototype.Initialize=function(i){if(this._status!=u.Created)throw new o(r.DATARV_ERROR_INVALID_STATUS);if(!i||!i.collectorUrl)throw new o(r.DATARV_ERROR_INVALID_CONFIG);if(this._config=i,this._Reset(),this._status=u.Initialized,i.ecsClient&&(this._Verbose("ECS object assigned. Do integration"),this._ecsClient=i.ecsClient),i.overwriteSendTimeInterval&&i.overwriteSendTimeInterval>=0&&(c.TimeIntervalForNextSendInMS=i.overwriteSendTimeInterval),i.enableTeamsStats){this.AddListener(function(i,r,o,s){if(!n.defaultLogger){var a=t.LogManager.getDefaultToken();a&&(n.defaultLogger=new e.applications.telemetry.Logger(a))}if(n.defaultLogger){for(var u=s.length,c=0,l=0;l<s.length;++l)"userbi"===s[l].EventType.toLowerCase()&&++c;var h=new t.EventProperties;h.name="scenario",h.setProperty("Scenario_Name","sdk_stats"),200===r?(h.setProperty("AriaStats_EventSentUserBi",c),h.setProperty("AriaStats_EventSent",u)):400===r&&(h.setProperty("AriaStats_EventDropUserBi",c),h.setProperty("AriaStats_EventDrop",u),h.setProperty("AriaStats_EventDropReason",r));var f=t.Logger.popEventReceivedCount();h.setProperty("AriaStats_EventRec",f);var p=t.Logger.popEventRejectCount();h.setProperty("AriaStats_EventReject",p);var d=t.Logger.popTryToSendCount();h.setProperty("AriaStats_TryToSend",d);var g=t.Logger.popEventPackageSize();h.setProperty("AriaStats_PackageSize",g),n.defaultLogger.logEvent(h)}})}this._Verbose("Initialize() done")},n.prototype.AddListener=function(e){if(this._status<u.Initialized)throw new o(r.DATARV_ERROR_INVALID_STATUS);this._Verbose(["AddListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return void this._Verbose("the listener has been added already, index: "+t);this._listeners.push(e),this._Verbose("AddListener() done, the new length: "+this._listeners.length)},n.prototype.RemoveListener=function(e){if(this._status<u.Initialized)throw new o(r.DATARV_ERROR_INVALID_STATUS);this._Verbose(["RemoveListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""));for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return 1==this._listeners.length?this._listeners=[]:t==this._listeners.length-1?this._listeners.pop():this._listeners[t]=this._listeners.pop(),void this._Verbose(["this listener has been found, index: ",t,"new length: ",this._listeners.length].join(""));this._Verbose("listener isn't been found, new length"+this._listeners.length)},n.prototype.Start=function(){if(this._status<u.Initialized)throw new o(r.DATARV_ERROR_INVALID_STATUS);this._Verbose(["Start(), status:",this._status,"tag:",n._tag].join(" ")),this._status>=u.Started&&this._Verbose("Start() already, ignore"),this._ecsClient&&(this._ecsCallback=this._CreateEcsCallback(),this._ecsClient.AddListener(this._ecsCallback),this._etag=this._ecsClient.GetETag()),++n._tag,this._status=u.Started,this._Verbose(["Start() done, status: ",this._status,"tag: ",n._tag].join(""))},n.prototype.Stop=function(){if(this._status<u.Initialized)throw new o(r.DATARV_ERROR_INVALID_STATUS);this._Verbose("Stop(), status: "+this._status),this._status!=u.Initialized?(this._Reset(),this._status=u.Initialized,this._Verbose("Stop() done, status: "+this._status)):this._Verbose("Stop() already, ignore")},n.prototype.Flush=function(e){this._eventsCache.IsEmpty()||this._WorkThread(e)},n.prototype.SendAsync=function(e,i){if(this._status<u.Initialized)throw new o(r.DATARV_ERROR_INVALID_STATUS);if(this._Verbose(["SendAsync(), status:",this._status,"tenantToken:",e,"count:",i.length].join(" ")),this._status<u.Started)return this._Info("SendAsync(), not started, ignore, return false"),!1;if(!e||!i)throw this._Error("SendAsync(), tenantToken or events is null or empty"),new o(r.DATARV_ERROR_INVALID_ARG);for(var s=0;s<i.length;++s)if(!i[s].Id||!n._eventTypeRegex.test(i[s].EventType)||i[s].Timestamp.Equals("0"))throw this._Error(["eventId:",i[s].Id,"eventType:",i[s].EventType,"timestamp high:",i[s].Timestamp.high,"timestamp low:",i[s].Timestamp.low].join("")),t.Logger.addEventRejectCount(i.length),new o(r.DATARV_ERROR_INVALID_EVENT);return this._eventsCache.AddEvents(e,i),this._Verbose(["SendAsync(), currentTimer: ",this._timer,"eventsCacheIsEmpty",this._eventsCache.IsEmpty()].join(" ")),this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1),this._Verbose("SendAsync() done"),!0},n.prototype.Pause=function(){this._isPaused||(this._CleanTimer(),this._isPaused=!0)},n.prototype.Resume=function(){this._isPaused&&(this._isPaused=!1,this._ScheduleTimer(!1))},n.prototype._WorkThread=function(e){var i=this;if(this._isPaused)this._CleanTimer();else try{var r=Date.now();if(this._Verbose("_WorkThread, status: "+this._status),this._status<u.Started)return void this._Verbose("_WorkThread, status is not started, return");var o=this._eventsCache.DequeuEvents();if(null==o)return this._Verbose("_WorkThread, No events found, return"),void this._CleanTimer();var s=o.events.length,a=this._PackEvents(o.tenantToken,o.events);this._eventsCache.AddEvents(o.tenantToken,a.remainedEvents);var c=a.remainedEvents.length;if(null==a.buffer||0==a.buffer.length)return void(this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1)));if(this._testHookListeners)for(var l=0;l<this._testHookListeners.length;++l)this._testHookListeners[l](a.sendEvents);var h=a.sendEvents,f=a.buffer.length;if(this._testServerResponseHook){var p=this._testServerResponseHook();return void setTimeout(this._SendCallback(g,o.tenantToken,h,f,p,null),100)}var d={type:"POST",url:this._config.collectorUrl,processData:!1,headers:{"content-type":"application/bond-compact-binary","client-id":"NO_AUTH","sdk-version":"ACT-Web-JS-"+clienttelemetry_build.version},complete:function(t){return i._SendCallback(g,o.tenantToken,h,f,t,e)}};this._config.useJsonTextStream?(d.data=a.buffer,d.headers["content-type"]="application/json"):sct.Utils.IsSafariOrFirefox()||"undefined"==typeof Uint8Array?(this._Verbose("Uint8Array is undefined, send with base64 encode."),d.data=Microsoft.Bond.Encoding.Base64.GetString(a.buffer),d.headers["content-encoding"]="base64"):(this._Verbose("Uint8Array is defined, send with binary format directly."),d.data=new Uint8Array(a.buffer)),o.tenantToken&&(d.headers["x-apikey"]=o.tenantToken);var g=n._tag;if(this._lastActiveTime=(new Date).getTime(),sct.Utils.ajax(d),this._config.enableTeamsStats){var _=s-c;t.Logger.addTryToSendCount(_),t.Logger.addEventPackageSize(a.buffer.length)}this._Verbose("_Workthread, send via jquery, tag: "+g),this._Info("Processing telemetry events took "+(Date.now()-r)+" ms for "+(s-c)+" events with total size of "+a.buffer.length+" bytes, remaining events - "+c)}catch(e){this._Error("_WorkThread, exception: "+e)}},n.prototype._PackEvents=function(e,n){this._Verbose("_PackageEvents, total Count: "+n.length);var i=new t.datamodels.ClientToCollectorRequest,r=new t.datamodels.DataPackage;r.Source="JS_default_source",r.DataPackageId=t.datamodels.utils.GetGuid(),r.Timestamp=t.datamodels.utils.GetTimeStamp();var o,s=n;if(n=[],s.length>200){var a=s.splice(0,200);n.push.apply(n,s),s=a}for(;;){if(r.Records=[],r.Records.push.apply(r.Records,s),i.DataPackages=[],i.DataPackages.push(r),o=this._Serialize(i),this._Verbose(["_PackageEvents, sendEvents.length:",s.length," buffer.length:",o.length," MaxPackageSize:",this._MaxPackageSizeInBytes].join("")),o.length<this._MaxPackageSizeInBytes)break;if(1==s.length){s=[],o=null;break}var u=s.splice(0,Math.floor(s.length/2));this._Verbose("_PackageEvents, too large, package again"),n.push.apply(n,s),s=u}return this._Verbose(["_PakcageEvents done, sendEventsCount:",s.length,"buffer.length:",null==o?0:o.length,"remained events:",n.length].join("")),{buffer:o,sendEvents:s,remainedEvents:n}},n.prototype._Serialize=function(e){if(this._config.useJsonTextStream){var n=new t.JsonTextWriter;return e.Write(n),JSON.stringify(n.data)}var i=new Microsoft.Bond.IO.MemoryStream,r=new Microsoft.Bond.CompactBinaryProtocolWriter(i);return e.Write(r),i.GetBuffer()},n.prototype._SendCallback=function(e,t,r,o,s,a){if(this._Verbose(["_SendCallback","tag:",e,"current tag:",n._tag,"tenantToken:",t,"events count:",r.length,"jqXHR:",s].join("")),null==a){var c=null!=s&&s.status>=200&&s.status<300;if(this._status<u.Started||e<n._tag)this._Verbose("_SendCallback, is not started, or tag is not the same, return");else{if(!(c||s&&400==s.status))return this._Verbose("retry statusCode: "+(s?s.status:0)),this._eventsCache.AddEvents(t,r),void this._ScheduleTimer(!0);for(var l=0;l<this._listeners.length;++l)this._listeners[l](c?i.SENT:i.SEND_FAILED,s?s.status:0,t,r,o);this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1))}}else a(s?s.status:0,t,r)},n.prototype._CleanTimer=function(){this._Verbose("_CleanTimer(), timer: "+this._timer),this._timer&&(clearTimeout(this._timer),this._timer=null)},n.prototype._ScheduleTimer=function(e){var t=this;if(this._Verbose("_ScheduleTimer: isRetry: "+e),this._CleanTimer(),e){this._Verbose("_ScheduleTimer, current factor: "+this._rescheduleFactor);n=Math.floor(5*this._rescheduleFactor*(1+Math.random()));this._timer=setTimeout(function(){return t._WorkThread(null)},1e3*n),this._Verbose("_ScheduleTimer, next try (s): "+n),this._rescheduleFactor<<=1,this._rescheduleFactor>64&&(this._rescheduleFactor=1)}else{var n=0,i=(new Date).getTime()-this._lastActiveTime;n=i>c.TimeIntervalForNextSendInMS?0:c.TimeIntervalForNextSendInMS-i,this._timer=setTimeout(function(){return t._WorkThread(null)},n),this._Verbose("_ScheduleTimer, next try: "+n),this._rescheduleFactor=1}},n.prototype._Verbose=function(e){this._config.log&&this._config.log.Verbose("[TelemetryManagerImpl]: "+e)},n.prototype._Info=function(e){this._config.log&&this._config.log.Info("[TelemetryManagerImpl]: "+e)},n.prototype._Error=function(e){this._config.log&&this._config.log.Error("[TelemetryManagerImpl]: "+e)},n.prototype._Reset=function(){this._Verbose("Reset()"),this._CleanTimer(),this._lastActiveTime=0,this._rescheduleFactor=1,this._sendingEvents=[],this._eventsCache=new h,this._ecsClient&&(this._ecsClient.RemoveListener(this._ecsCallback),this._ecsCallback=null)},n.prototype._CreateEcsCallback=function(){var e=this;return function(t){t==ecs.CallbackEventType.CONFIG_UPDATED&&(e._etag=e._ecsClient.GetETag())}},n.prototype.__AddTestHookListener=function(e){if(this._status<u.Initialized)throw new o(r.DATARV_ERROR_INVALID_STATUS);for(var t=0;t<this._testHookListeners.length;++t)if(this._testHookListeners[t]==e)return;this._testHookListeners.push(e)},n.prototype.__ClearTestHookListener=function(){this._testHookListeners=[]},n.prototype.__GetListenerArray=function(){return this._listeners},n.prototype.__GetTotalEventsCount=function(){return this._eventsCache.GetTotalEventsCount()},n.prototype.__IsScheduled=function(){return null!=this._timer},n.prototype.__ChageMaxPackageSizeInKB=function(e){this._MaxPackageSizeInBytes=1024*e},n.prototype.__SetTestServerResponseHook=function(e){this._testServerResponseHook=e},n.defaultLogger=void 0,n._eventTypeRegex=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,n._tag=0,n}();n.TelemetryManagerImpl=l;var h=function(){function e(){this._events={},this._tokens=[]}return e.prototype.AddEvents=function(e,t){t.length&&(t.length>1e4||(this._events[e]||(this._events[e]=[],this._tokens.push(e)),this._events[e].push.apply(this._events[e],t)))},e.prototype.IsEmpty=function(){return 0==this._tokens.length},e.prototype.DequeuEvents=function(){if(0==this._tokens.length)return null;var e=this._tokens.shift(),t=this._events[e];return delete this._events[e],{tenantToken:e,events:t}},e.prototype.GetTotalEventsCount=function(){var e=0;for(var t in this._events)e+=this._events[t].length;return e},e}()}(t._sender||(t._sender={}))}(t.telemetry||(t.telemetry={}))}(e.applications||(e.applications={}))}(microsoft||(microsoft={}));var clienttelemetry_build;!function(e){e.version="2.5.0"}(clienttelemetry_build||(clienttelemetry_build={}));var microsoft;!function(e){!function(e){!function(e){e.globalTelemetryManager=null;var t=function(){return function(){this.collectorUrl=null}}();e.LogConfiguration=t;var n=function(){function t(){this.key=null,this.value=null,this.pii=null}return t._isPii=function(t){if(t==e.datamodels.PIIKind.NotSet)return!1;var n=!1;for(var i in e.datamodels.PIIKind)isNaN(i)||i==t&&(n=!0);return n},t}();e.Property=n;var i=function(){function t(){this.name=null,this.timestamp=null,this.properties=[],this.eventType=null}return t.prototype.setProperty=function(n,i,s){if(!n||!this.properties[n]&&!t._propertyNameRegex.test(n))throw new o(r.INVALID_PROPERTY_NAME);this.properties[n]={key:n,value:i,pii:s!=e.datamodels.PIIKind.NotSet?s:null}},t.prototype.unsetProperty=function(e){if(!e)throw new o(r.INVALID_PROPERTY_NAME);void 0!==this.properties[e]&&(this.properties[e]=void 0,delete this.properties[e])},t._propertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_|.]){0,98}[a-zA-Z0-9])?$/,t}();e.EventProperties=i;var r;!function(e){e[e.INVALID_TENANT_TOKEN=1]="INVALID_TENANT_TOKEN",e[e.MISSING_EVENT_PROPERTIES_NAME=2]="MISSING_EVENT_PROPERTIES_NAME",e[e.INVALID_PROPERTY_NAME=3]="INVALID_PROPERTY_NAME",e[e.INVALID_COLLECTOR_URL=4]="INVALID_COLLECTOR_URL",e[e.MISSING_FAILURE_SIGNATURE=5]="MISSING_FAILURE_SIGNATURE",e[e.MISSING_FAILURE_DETAIL=6]="MISSING_FAILURE_DETAIL",e[e.MISSING_PAGEVIEW_ID=7]="MISSING_PAGEVIEW_ID",e[e.MISSING_PAGEVIEW_NAME=8]="MISSING_PAGEVIEW_NAME",e[e.INVALID_SESSION_STATE=9]="INVALID_SESSION_STATE"}(r=e.TelemetryError||(e.TelemetryError={}));var o=function(){function e(e){this.errorCode=null,this.errorCode=e}return e.prototype.ErrorCode=function(){return this.errorCode},e.prototype.toString=function(){switch(this.errorCode){case r.INVALID_TENANT_TOKEN:return"Invalid tenant token";case r.MISSING_EVENT_PROPERTIES_NAME:return"Eventproperties.name can not be null or empty";case r.INVALID_PROPERTY_NAME:return"Invalid Key. Key does not conform to regular expression ^[a-zA-Z0-9](([a-zA-Z0-9|_]){0,98}[a-zA-Z0-9])?$";case r.INVALID_COLLECTOR_URL:return"Collector url can't be null or empty.";case r.MISSING_FAILURE_SIGNATURE:return"Failure signature can't be null or empty.";case r.MISSING_FAILURE_DETAIL:return"Failure detail can't be null or empty.";case r.MISSING_PAGEVIEW_ID:return"Pageview id can't be null or empty.";case r.MISSING_PAGEVIEW_NAME:return"Pageview name can't be null or empty.";case r.INVALID_SESSION_STATE:return"Session state has to be a value from the SessionState enum.";default:return"Unknown error"}},e}();e.Exception=o;var s=function(){function t(t){this.contextMap=new Microsoft.Bond.Collections.Map,this.piiKind=e.datamodels.PIIKind.NotSet,this._allowDeviceInfoFields=!1,this._allowDeviceInfoFields=t}return t.prototype.setAppId=function(e){e&&this.contextMap.Add("AppInfo.Id",e)},t.prototype.setAppVersion=function(e){e&&this.contextMap.Add("AppInfo.Version",e)},t.prototype.setAppLanguage=function(e){e&&this.contextMap.Add("AppInfo.Language",e)},t.prototype.setDeviceId=function(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.Id",e)},t.prototype.setDeviceOsName=function(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.OsName",e)},t.prototype.setDeviceOsVersion=function(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.OsVersion",e)},t.prototype.setDeviceBrowserName=function(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.BrowserName",e)},t.prototype.setDeviceBrowserVersion=function(e){e&&this._allowDeviceInfoFields&&this.contextMap.Add("DeviceInfo.BrowserVersion",e)},t.prototype.setUserId=function(e,t){e&&this.contextMap.Add("UserInfo.Id",e),n._isPii(t)&&(this.piiKind=t)},t.prototype.setUserMsaId=function(e){e&&this.contextMap.Add("UserInfo.MsaId",e)},t.prototype.setUserANID=function(e){e&&this.contextMap.Add("UserInfo.ANID",e)},t.prototype.setUserAdvertisingId=function(e){e&&this.contextMap.Add("UserInfo.AdvertisingId",e)},t.prototype.setUserTimeZone=function(e){e&&this.contextMap.Add("UserInfo.TimeZone",e)},t.prototype.setUserLanguage=function(e){e&&this.contextMap.Add("UserInfo.Language",e)},t}();e.SemanticContext=s;var a,u=function(){function e(){}return e.initialize=function(t){e.documentInfo=t;var n=t.appLanguage;n&&e.semanticContext.setAppLanguage(n);var i=t.userLanguage;i&&e.semanticContext.setUserLanguage(i);var r=(new Date).getTimezoneOffset(),o=r%60,s=(r-o)/60,a="+";s>0&&(a="-"),o=Math.abs(o);var u=a+((s=Math.abs(s))<10?"0"+s:s.toString())+":"+(o<10?"0"+o:o.toString());e.semanticContext.setUserTimeZone(u),e.semanticContext.setDeviceBrowserName(e._getBrowserName()),e.semanticContext.setDeviceBrowserVersion(e._getBrowserVersion()),e.semanticContext.setDeviceOsName(e._getOsName()),e.semanticContext.setDeviceOsVersion(e._getOsVersion()),e.semanticContext.setDeviceId(t.deviceId),e.firstLaunchTime=t.firstLaunchTime},e.checkAndUpdateDeviceId=function(e){},e._setCookie=function(e,t){},e._getCookie=function(e){return""},e._getUserAgent=function(){return e.documentInfo.userAgent},e._userAgentContainsString=function(t){return e._getUserAgent().indexOf(t)>-1},e._isIe=function(){return e._userAgentContainsString("Trident")},e._isEdge=function(){return e._userAgentContainsString(e.BROWSERS.EDGE)},e._isEdgeAnaheim=function(){return e._userAgentContainsString("Edg/")},e._isOpera=function(){return e._userAgentContainsString("OPR/")},e._getBrowserName=function(){return e._isOpera()?e.BROWSERS.UNKNOWN:e._userAgentContainsString(e.BROWSERS.PHANTOMJS)?e.BROWSERS.PHANTOMJS:e._isEdge()?e.BROWSERS.EDGE:e._isEdgeAnaheim()?e.BROWSERS.EDGEANAHEIM:e._userAgentContainsString(e.BROWSERS.ELECTRON)?e.BROWSERS.ELECTRON:e._userAgentContainsString(e.BROWSERS.CHROME)?e.BROWSERS.CHROME:e._userAgentContainsString(e.BROWSERS.FIREFOX)?e.BROWSERS.FIREFOX:e._userAgentContainsString(e.BROWSERS.SAFARI)?e.BROWSERS.SAFARI:e._userAgentContainsString(e.BROWSERS.SKYPE_SHELL)?e.BROWSERS.SKYPE_SHELL:e._isIe()?e.BROWSERS.MSIE:e.BROWSERS.UNKNOWN},e._getBrowserVersion=function(){return e._isIe()?function(){var t,n=e._getUserAgent(),i=n.match(new RegExp(e.BROWSERS.MSIE+" "+e.REGEX_VERSION));return i?i[1]:(t=n.match(new RegExp("rv:"+e.REGEX_VERSION)))?t[1]:void 0}():function(t){var n;return t===e.BROWSERS.SAFARI?t="Version":t===e.BROWSERS.EDGEANAHEIM&&(t="Edg"),(n=e._getUserAgent().match(new RegExp(t+"/"+e.REGEX_VERSION)))?n[1]:e.UNKNOWN_VERSION}(e._getBrowserName())},e._getOsName=function(){var t=/(windows|win32)/i,n=/ arm;/i,i=/windows\sphone\s\d+\.\d+/i,r=/(macintosh|mac os x)/i,o=/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i,s=/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,a=/android/i;return e._getUserAgent().match(i)?e.OPERATING_SYSTEMS.WINDOWS_PHONE:e._getUserAgent().match(n)?e.OPERATING_SYSTEMS.WINDOWS_RT:e._getUserAgent().match(o)?e.OPERATING_SYSTEMS.IOS:e._getUserAgent().match(a)?e.OPERATING_SYSTEMS.ANDROID:e._getUserAgent().match(s)?e.OPERATING_SYSTEMS.LINUX:e._getUserAgent().match(r)?e.OPERATING_SYSTEMS.MACOSX:e._getUserAgent().match(t)?e.OPERATING_SYSTEMS.WINDOWS:e.OPERATING_SYSTEMS.UNKNOWN},e._getOsVersion=function(){function t(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null}return e._getOsName()===e.OPERATING_SYSTEMS.WINDOWS?function(){var t=e._getUserAgent().match(new RegExp("Windows NT "+e.REGEX_VERSION));return t&&e.VERSION_MAPPINGS[t[1]]?e.VERSION_MAPPINGS[t[1]]:e.UNKNOWN_VERSION}():e._getOsName()===e.OPERATING_SYSTEMS.MACOSX?function(){var n=e._getUserAgent().match(new RegExp(e.OPERATING_SYSTEMS.MACOSX+" "+e.REGEX_VERSION_MAC));if(n){var i=n[1].replace(/_/g,".");if(i){var r=t(i);return r?i.split(r)[0]:i}}return e.UNKNOWN_VERSION}():e.UNKNOWN_VERSION},e.semanticContext=new s(!0),e.firstLaunchTime=-1,e.BROWSERS={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",EDGEANAHEIM:"EdgeAnaheim",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",UNKNOWN:"Unknown"},e.OPERATING_SYSTEMS={WINDOWS:"Windows",MACOSX:"Mac OS X",WINDOWS_PHONE:"Windows Phone",WINDOWS_RT:"Windows RT",IOS:"iOS",ANDROID:"Android",LINUX:"Linux",UNKNOWN:"Unknown"},e.VERSION_MAPPINGS={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},e.REGEX_VERSION="([\\d,.]+)",e.REGEX_VERSION_MAC="([\\d,_,.]+)",e.UNKNOWN_VERSION="Unknown",e.DEVICE_ID_COOKIE="MicrosoftApplicationsTelemetryDeviceId",e.FIRST_LAUNCH_TIME_COOKIE="MicrosoftApplicationsTelemetryFirstLaunchTime",e}();!function(e){e[e.STARTED=0]="STARTED",e[e.ENDED=1]="ENDED"}(a=e.SessionState||(e.SessionState={}));var c=function(){function t(){}return t.initialize=function(n,i){if(!t._initialized){if(!i)throw new o(r.INVALID_TENANT_TOKEN);t._defaultToken=i,t._config.collectorUrl||(t._config.collectorUrl="https://browser.pipe.aria.microsoft.com/Collector/3.0/"),e.globalTelemetryManager||(e.globalTelemetryManager=e._sender.TelemetryManagerFactory.CreateTelemetryManager(),e.globalTelemetryManager.Initialize(t._config)),e.globalTelemetryManager.Start(),u.initialize(n),t._initialized=!0}},t.initializeWithConfiguration=function(e,n,i){if(!i.collectorUrl)throw new o(r.INVALID_COLLECTOR_URL);t._config.collectorUrl=i.collectorUrl,t.initialize(e,n)},t.flush=function(t){e.globalTelemetryManager.Flush(t)},t.addCallbackListener=function(n){t._initialized&&e.globalTelemetryManager.AddListener(n)},t.setContext=function(e,n,i){""!==n&&"null"!==n&&"undefined"!==n?t._contextProperties.setProperty(e,n,i):t._contextProperties.unsetProperty(e)},t.isInitialized=function(){return t._initialized},t.getDefaultToken=function(){return t._defaultToken},t.getSemanticContext=function(){return t._semanticContext},t.__addTestHookListener=function(n){t._initialized&&e.globalTelemetryManager.__AddTestHookListener(n)},t.__clearTestHookListener=function(){t._initialized&&e.globalTelemetryManager.__ClearTestHookListener()},t.__backToUninitialized=function(){t._config=new e._sender.TelemetryConfig,t._semanticContext=new s(!0),t._contextProperties=new i,e.globalTelemetryManager=e._sender.TelemetryManagerFactory.CreateTelemetryManager(),t._initialized=!1},t._initialized=!1,t._defaultToken=null,t._config=new e._sender.TelemetryConfig,t._contextProperties=new i,t._semanticContext=new s(!0),t}();e.LogManager=c;var l=function(){function t(t){this._initId=e.datamodels.utils.GetGuid(),this._sequence=0,this._tenantToken=null,this._contextProperties=new i,this._semanticContext=new s(!1),this._sessionStartTime=0,this._sessionId=null,this._tenantToken=t||c.getDefaultToken()}return t.popEventReceivedCount=function(){var e=t.eventReceivedCount;return t.eventReceivedCount=0,e},t.popEventRejectCount=function(){var e=t.eventRejectCount;return t.eventRejectCount=0,e},t.addEventRejectCount=function(e){t.eventRejectCount+=e},t.popTryToSendCount=function(){var e=t.eventPackageSize;return t.eventPackageSize=0,e},t.addTryToSendCount=function(e){t.eventTryToSendCount+=e},t.popEventPackageSize=function(){var e=t.eventPackageSize;return t.eventPackageSize=0,e},t.addEventPackageSize=function(e){t.eventPackageSize+=e},t.prototype.logEvent=function(e){if(!e.name)throw++t.eventRejectCount,new o(r.MISSING_EVENT_PROPERTIES_NAME);++t.eventReceivedCount;var n=this._createEventRecord(e.name,e.eventType);this._addCustomPropertiesToEvent(n,e),this._sendRecord(n)},t.prototype.logFailure=function(e,t,n,i,s){if(!e)throw new o(r.MISSING_FAILURE_SIGNATURE);if(!t)throw new o(r.MISSING_FAILURE_DETAIL);var a=this._createEventRecord("failure","failure");a.Extension.Add("Failure.Signature",e),a.Extension.Add("Failure.Detail",t),n&&a.Extension.Add("Failure.Category",n),i&&a.Extension.Add("Failure.Id",i),this._addCustomPropertiesToEvent(a,s),this._sendRecord(a)},t.prototype.logPageView=function(e,t,n,i,s,a){if(!e)throw new o(r.MISSING_PAGEVIEW_ID);if(!t)throw new o(r.MISSING_PAGEVIEW_NAME);var u=this._createEventRecord("pageview","pageview");u.Extension.Add("PageView.Id",e),u.Extension.Add("PageView.Name",t),n&&u.Extension.Add("PageView.Category",n),i&&u.Extension.Add("PageView.Uri",i),s&&u.Extension.Add("PageView.ReferrerUri",s),this._addCustomPropertiesToEvent(u,a),this._sendRecord(u)},t.prototype.logSession=function(t,n){if(t!==a.STARTED&&t!==a.ENDED)throw new o(r.INVALID_SESSION_STATE);var i=this._createEventRecord("session","session");if(t===a.STARTED){if(this._sessionStartTime>0)return;this._sessionStartTime=(new Date).getTime(),this._sessionId=e.datamodels.utils.GetGuid(),i.Extension.Add("Session.Id",this._sessionId),i.Extension.Add("Session.State","Started")}else if(t===a.ENDED){if(0==this._sessionStartTime)return;var s=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3);i.Extension.Add("Session.Duration",s.toString()),i.Extension.Add("Session.DurationBucket",this._getSessionDurationFromTime(s)),i.Extension.Add("Session.Id",this._sessionId),i.Extension.Add("Session.State","Ended"),this._sessionId=null,this._sessionStartTime=0}i.Extension.Add("Session.FirstLaunchTime",new Date(u.firstLaunchTime).toISOString()),this._addCustomPropertiesToEvent(i,n),this._sendRecord(i)},t.prototype.getSessionId=function(){return this._sessionId},t.prototype.setContext=function(e,t,n){this._contextProperties.setProperty(e,t,n)},t.prototype.getSemanticContext=function(){return this._semanticContext},t.prototype._getSessionDurationFromTime=function(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min"},t.prototype._createEventRecord=function(t,n){var i=new e.datamodels.Record;n||(n="custom"),i.EventType=t.toLowerCase(),i.Type=n.toLowerCase(),i.Extension.Add("EventInfo.Source","JS_default_source"),i.Extension.Add("EventInfo.InitId",this._initId),this._sequence++,i.Extension.Add("EventInfo.Sequence",this._sequence.toString()),i.Extension.Add("EventInfo.Name",t.toLowerCase());var r=new Date;return i.Timestamp=e.datamodels.utils.GetTimeStampWithValue(r.getTime()),i.Extension.Add("EventInfo.Time",r.toISOString()),i.Extension.Add("EventInfo.SdkVersion","ACT-Web-JS-"+clienttelemetry_build.version),i},t.prototype._addCustomPropertiesToEvent=function(e,t){this._addSemanticContext(e,u.semanticContext),this._addSemanticContext(e,c._semanticContext),this._addSemanticContext(e,this._semanticContext),this._sessionId&&e.Extension.Add("Session.Id",this._sessionId),this._addEventPropertiesToEvent(e,c._contextProperties),this._addEventPropertiesToEvent(e,this._contextProperties),this._addEventPropertiesToEvent(e,t)},t.prototype._addSemanticContext=function(t,n){if(n&&n.contextMap.Count()>0)for(var i=n.contextMap.GetBuffer(),r=0;r<i.length;r++)"UserInfo.Id"==i[r].Key&&n.piiKind!=e.datamodels.PIIKind.NotSet?t.AddOrReplacePII(i[r].Key,i[r].Value,n.piiKind):t.Extension.AddOrReplace(i[r].Key,i[r].Value)},t.prototype._addEventPropertiesToEvent=function(t,i){if(i){i.timestamp&&i.timestamp>=new Date("1/1/2000").getTime()&&(t.Timestamp=e.datamodels.utils.GetTimeStampWithValue(i.timestamp),t.Extension.AddOrReplace("EventInfo.Time",new Date(i.timestamp).toISOString())),i.name&&(t.EventType=i.name.toLowerCase(),t.Extension.AddOrReplace("EventInfo.Name",i.name.toLowerCase()));var r=i.properties;if(r)for(var o in r)r[o].key&&"string"==typeof r[o].key&&(r[o].value||0==r[o].value||0==r[o].value||""==r[o].value)&&(n._isPii(r[o].pii)?(t.AddOrReplacePII(r[o].key,r[o].value.toString(),r[o].pii),t.Extension.Remove(r[o].key)):(t.Extension.AddOrReplace(r[o].key,r[o].value.toString()),t.PIIExtensions.Remove(r[o].key)))}},t.prototype._sendRecord=function(t){c.isInitialized()&&e.globalTelemetryManager.SendAsync(this._tenantToken,[t])},t.eventReceivedCount=0,t.eventRejectCount=0,t.eventTryToSendCount=0,t.eventPackageSize=0,t}();e.Logger=l}(e.telemetry||(e.telemetry={}))}(e.applications||(e.applications={}))}(microsoft||(microsoft={}));var ecs;!function(e){var t;!function(e){e[e.ECS_ERROR_OK=0]="ECS_ERROR_OK",e[e.ECS_ERROR_INVALID_STATUS=1]="ECS_ERROR_INVALID_STATUS",e[e.ECS_ERROR_INVALID_RESPONSE=6]="ECS_ERROR_INVALID_RESPONSE",e[e.ECS_ERROR_INVALID_CONFIG=8]="ECS_ERROR_INVALID_CONFIG"}(t=e.ECS_ERROR||(e.ECS_ERROR={}));var n=function(){function e(e){this._errorCode=e}return e.prototype.ErrorCode=function(){return this._errorCode},e.prototype.toString=function(){switch(this._errorCode){case t.ECS_ERROR_OK:return"ECS_ERROR_OK";case t.ECS_ERROR_INVALID_STATUS:return"ECS_ERROR_INVALID_STATUS";case t.ECS_ERROR_INVALID_RESPONSE:return"ECS_ERROR_INVALID_RESPONSE";case t.ECS_ERROR_INVALID_CONFIG:return"ECS_ERROR_INVALID_CONFIG";default:return"Unknown error"}},e}();e.Exception=n;var i;!function(e){e[e.CONFIG_UPDATED=0]="CONFIG_UPDATED",e[e.TOKEN_IS_INVALID=1]="TOKEN_IS_INVALID"}(i=e.CallbackEventType||(e.CallbackEventType={}));var r=function(){function e(){}return e.prototype.Copy=function(e){if(this.uiVersion=e.uiVersion,this.log=e.log,this.servers=void 0,e.servers&&e.servers.length){this.servers=[];for(var t=0;t<e.servers.length;++t)this.servers.push(e.servers[t])}},e}();e.EcsClientConfig=r;var o=function(){function e(){}return e.CreateEcsClient=function(){return new u},e.__ChangeFailedRetryFactorInMS=function(e){a.FailedRetryFactorInMS=e},e}();e.EcsClientFactory=o;var s,a=function(){function e(){}return e.Servers=["https://config.teams.microsoft.com/config/v1/Skype/"],e.RefreshIntervalInMS=36e5,e.FailedRetryFactorInMS=1e4,e.MaxRetryIntervalForFailedInMS=36e5,e}();!function(e){e[e.Created=0]="Created",e[e.Initialized=1]="Initialized",e[e.Started=2]="Started",e[e.Loading=3]="Loading"}(s||(s={}));var u=function(){function e(){this._tag=0,this._status=s.Created,this._listeners=[],this._failedTimes={},this._skypeToken=null,this._pendingToken=[],this._queryParams={}}return e.prototype.Initialize=function(e){if(this._status!=s.Created)throw new n(t.ECS_ERROR_INVALID_STATUS);if(!e||!e.uiVersion)throw new n(t.ECS_ERROR_INVALID_CONFIG);this._config=new r,this._config.Copy(e),this._config.uiVersion=this._config.uiVersion.replace("/","_");var i=[];if(this._config.servers&&this._config.servers.length)i=this._config.servers;else for(var o=0;o<a.Servers.length;++o)i.push(a.Servers[o]);for(var u=[];i.length;){var c=Math.floor(Math.random()*i.length);u.push(i[c]),c==i.length-1?i.pop():i[c]=i.pop()}this._config.servers=u,this._Info("servers: "+this._config.servers.join(",")),this._status=s.Initialized,this._Verbose("Initialize() done")},e.prototype.AddListener=function(e){this._Verbose("AddListener()"),this._CheckStatus(s.Initialized);for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return void this._Verbose("the listener has been added already, index: "+t);this._listeners.push(e)},e.prototype.RemoveListener=function(e){this._Verbose("RemoveListener()"),this._CheckStatus(s.Initialized);for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return void(t==this._listeners.length-1?this._listeners.pop():this._listeners[t]=this._listeners.pop())},e.prototype.Start=function(){this._Verbose("Start()"),this._CheckStatus(s.Initialized),this._status>=s.Started?this._Verbose("Start() already, ignore"):(++this._tag,this._status=s.Started,this.ConfigReloadAsync())},e.prototype.Stop=function(){this._Verbose("Stop()"),this._CheckStatus(s.Initialized),this._status!=s.Initialized?(this._CleanTimer(),this._ecsConfig=null,this._etag=null,this._expireTime=null,this._failedTimes={},this._status=s.Initialized):this._Verbose("Stop() already, ignore")},e.prototype.GetETag=function(){return this._CheckStatus(s.Started),this._etag},e.prototype.SetSkypeToken=function(e){this._Verbose("SetToken()"),this._CheckStatus(s.Started),e=e||null,this._status==s.Loading?(this._Verbose("A request is ongoing, postpone."),this._pendingToken.push(e)):(this._skypeToken=e,this.ConfigReloadAsync())},e.prototype.ConfigReloadAsync=function(){var e=this;if(this._Verbose("ConfigReloadAsync()"),this._CheckStatus(s.Started),this._status!=s.Loading){this._CleanTimer();var t=this._tag,n=this._config.servers[0]+this._config.uiVersion,i={};for(var r in this._queryParams){i[r]={};for(var o in this._queryParams[r])i[r][o]=this._queryParams[r][o]}i.Headers={},!sct.Utils.IsUsingXDomainRequest()&&this._etag&&(i.Headers["If-None-Match"]=this._etag),this._skypeToken&&(i.Headers.SkypeToken=this._skypeToken),0==sct.Utils.keys(i.Headers).length&&delete i.Headers,sct.Utils.ajax({type:"POST",url:n,data:JSON.stringify(i),complete:function(n){return e._HttpCallback(t,n)}}),this._status=s.Loading}else this._Verbose("ConfigReloadAsync() is loading, ignore")},e.prototype.AddQueryParameter=function(e,t,n){if(t&&n){e||(e="global");var i=e.toLowerCase();if("headers"==i)return;i in this._queryParams||(this._queryParams[i]={}),this._queryParams[i][t.toLowerCase()]=n.toLowerCase()}},e.prototype.RemoveQueryParameter=function(e,t){var n="global";e&&(n=e.toLowerCase()),t&&(t=t.toLowerCase(),n in this._queryParams&&t in this._queryParams[n]&&(delete this._queryParams[n][t],0==sct.Utils.keys(this._queryParams[n]).length&&delete this._queryParams[n]))},e.prototype.RemoveQueryParameterByNamespace=function(e){e=e?e.toLowerCase():"global",delete this._queryParams[e]},e.prototype.GetSetting=function(e,t,n){return this._CheckStatus(s.Started),e?this._GetSettingAsDefault(e,t,n,JSON.stringify):this._ecsConfig?JSON.stringify(this._ecsConfig):""},e.prototype.GetSettingAsString=function(e,t,n){return this._CheckStatus(s.Started),this._GetSettingAsDefault(e,t,n,function(e){return""+e})},e.prototype.GetSettingAsInt=function(e,t,n){return this._CheckStatus(s.Started),this._GetSettingAsDefault(e,t,n,parseInt)},e.prototype.GetSettingAsBool=function(e,t,n){return this._CheckStatus(s.Started),this._GetSettingAsDefault(e,t,n,function(e){return!!e})},e.prototype.GetSettingAsReal=function(e,t,n){return this._CheckStatus(s.Started),this._GetSettingAsDefault(e,t,n,parseFloat)},e.prototype.GetSettingAsList=function(e,t){return this._CheckStatus(s.Started),this._GetSettingAsList(e,t,function(e){return""+e})},e.prototype.GetSettingAsListOfInts=function(e,t){return this._CheckStatus(s.Started),this._GetSettingAsList(e,t,parseInt)},e.prototype.GetSettingAsListOfReal=function(e,t){return this._CheckStatus(s.Started),this._GetSettingAsList(e,t,parseFloat)},e.prototype.GetKeys=function(e,t){if(this._CheckStatus(s.Started),!e)return this.GetAgents();var n=this._NormalizePath(e,t);return n?this._GetObjectKeys(this._GetObject(n)):[]},e.prototype.GetAgents=function(){return this._CheckStatus(s.Started),this._GetObjectKeys(this._ecsConfig)},e.prototype._HttpCallback=function(e,r){if(this._Verbose("_HttpCallback"),this._status==s.Loading&&e==this._tag){var o=!0,a=!1;try{if(null==r)throw this._Error("jqXHR is null. exception"),new n(t.ECS_ERROR_INVALID_RESPONSE);var u=this._ParseResponse(r),c=u.statuscode;if(this._Info("status of HttpCallback: "+c),c>=200&&c<=299){var l=u.etag;if(this._Verbose("etag: "+l),!l)throw new n(t.ECS_ERROR_INVALID_RESPONSE);u.expires;this._Verbose("2xx: JSON.parse() success."),this._etag=l,this._ecsConfig=u.data,this._expireTime=u.expires,this._Notify(i.CONFIG_UPDATED)}else switch(c){case 304:this._Verbose("Config is not changed. Update expire time only."),this._expireTime=u.expires;break;case 401:this._Warning("token is invalid"),o=!1,this._Notify(i.TOKEN_IS_INVALID);break;case-1:o=!1;break;default:throw new n(t.ECS_ERROR_INVALID_RESPONSE)}}catch(e){this._Error("exception: "+e),a=!0}o&&this._ScheduleTimer(a),this._status=s.Started}else this._Verbose("_status != loading || tag != _tag, ignore")},e.prototype._Notify=function(e){for(var t=0;t<this._listeners.length;++t)this._listeners[t](e)},e.prototype._ScheduleTimer=function(e){var t=this;if(this._CleanTimer(),e){var n=this._config.servers.shift();this._failedTimes[n]?++this._failedTimes[n]:this._failedTimes[n]=1,this._config.servers.push(n);var i=this._failedTimes[this._config.servers[0]]||0,r=0;i&&(r=Math.pow(2,i-1)*a.FailedRetryFactorInMS)>a.MaxRetryIntervalForFailedInMS&&(r=a.MaxRetryIntervalForFailedInMS),this._timer=setTimeout(function(){return t.ConfigReloadAsync()},r)}else{this._failedTimes[this._config.servers[0]]=0;var o=!1;if(this._pendingToken.length){this._Verbose("Pending token found.");var s=this._pendingToken.pop();this._pendingToken.splice(0,this._pendingToken.length),s!=this._skypeToken&&(this._Verbose("Trigger new request immediately."),this._skypeToken=s,o=!0)}r=0;o||(r=a.RefreshIntervalInMS,this._expireTime&&(r=this._expireTime-(new Date).getTime())<0&&(r=0)),this._timer=setTimeout(function(){return t.ConfigReloadAsync()},r)}},e.prototype._CleanTimer=function(){this._timer&&(clearTimeout(this._timer),this._timer=null)},e.prototype._GetSettingAsDefault=function(e,t,n,i){if(!e)return n;var r=this._NormalizePath(e,t);if(!r)return n;var o=this._GetObject(r);if(null==o)return n;try{return i(o)}catch(e){return n}},e.prototype._GetSettingAsList=function(e,t,n){if(!e)return[];var i=this._NormalizePath(e,t);if(!i)return[];var r=this._GetObject(i);if(null==r)return[];try{for(var o=[],s=0;s<r.length;++s)o.push(n(r[s]));return o}catch(e){return[]}},e.prototype._CheckStatus=function(e){if(this._status<e)throw this._Error(["status is error, current status:",this._status,"minimalStatus:",e].join(" ")),new n(t.ECS_ERROR_INVALID_STATUS)},e.prototype._GetObjectKeys=function(e){var t=[];if(null!=e)for(var n in e)t.push(n);return t},e.prototype._GetObject=function(e){for(var t=e.split("/"),n=this._ecsConfig,i=0;i<t.length&&n;++i)n=n[t[i]];return n},e.prototype._NormalizePath=function(e,t){return null!=t&&t.length&&"/"==t[0]&&(t=t.substr(1)),null!=t&&t.length&&"/"==t[t.length-1]&&(t=t.substr(0,t.length-1)),t?e?e+"/"+t:t:e},e.prototype._Verbose=function(e){this._config&&this._config.log&&this._config.log.Verbose("[EcsClient]: "+e)},e.prototype._Info=function(e){this._config&&this._config.log&&this._config.log.Info("[EcsClient]: "+e)},e.prototype._Warning=function(e){this._config&&this._config.log&&this._config.log.Warning("[EcsClient]: "+e)},e.prototype._Error=function(e){this._config&&this._config.log&&this._config.log.Error("[EcsClient]: "+e)},e.prototype._ParseResponse=function(e){var t={};if(e&&void 0!==e.status)if(304==e.status){r=e.getResponseHeader("Expires");this._Verbose("expires: "+r),t.expires=r?Date.parse(r):null,t.etag=e.getResponseHeader("ETag"),t.statuscode=e.status}else if(e.status>=500)t.statuscode=e.status;else if(0==e.status)this._Verbose("Blocked by same-origin policy."),t.statuscode=-1;else try{t.statuscode=e.status;var n=JSON.parse(e.responseText),i=this._GetHeader(n);if(i){this._Verbose("Header found in body.");var r=i.expires;t.expires=r?Date.parse(r):null,t.statuscode=parseInt(i.statuscode),t.etag=i.etag}else this._Error("Header missing in response body.");t.data=n}catch(e){this._Error("Failed when parsing")}else this._Verbose("IE8/IE9 general error handler."),t.statuscode=-1;return this._Verbose("Return code = "+t.statuscode),t},e.prototype._GetHeader=function(e){var t=null;for(var n in e)if("headers"==n.toLowerCase()){t={};for(var i in e[n])t[i.toLowerCase()]=e[n][i];break}return t},e.prototype.__GetListenerArray=function(){return this._listeners},e.prototype.__UpdateServers=function(e){this._config.servers=e},e.prototype.__GetQueryParameters=function(){return this._queryParams},e}()}(ecs||(ecs={}));var microsoft;!function(e){!function(e){!function(e){var t=function(){function e(){this.data=[]}return e.prototype.WriteBlob=function(e){var t={type:"blob",value:e};this.data.push(t)},e.prototype.WriteBool=function(e){var t={type:"boolean",value:e};this.data.push(t)},e.prototype.WriteContainerBegin=function(e,t){var n={type:"containerBegin",size:e,elementType:t};this.data.push(n)},e.prototype.WriteMapContainerBegin=function(e,t,n){var i={type:"mapContainerBegin",size:e,keyType:t,valueType:n};this.data.push(i)},e.prototype.WriteContainerEnd=function(){var e={type:"containerEnd"};this.data.push(e)},e.prototype.WriteDouble=function(e){var t={type:"number",value:e};this.data.push(t)},e.prototype.WriteFloat=function(e){var t={type:"number",value:e};this.data.push(t)},e.prototype.WriteFieldBegin=function(e,t,n){var i={type:"fieldBegin",id:t};this.data.push(i)},e.prototype.WriteFieldEnd=function(){var e={type:"fieldEnd"};this.data.push(e)},e.prototype.WriteFieldOmitted=function(e,t,n){var i={type:"fieldOmitted",id:t};this.data.push(i)},e.prototype.WriteInt16=function(e){var t={type:"number",value:e};this.data.push(t)},e.prototype.WriteInt32=function(e){var t={type:"number",value:e};this.data.push(t)},e.prototype.WriteInt64=function(e){var t={type:"number",value:4294967296*e.high+e.low};this.data.push(t)},e.prototype.WriteInt8=function(e){var t={type:"number",value:e};this.data.push(t)},e.prototype.WriteString=function(e){var t={type:"string",value:e};this.data.push(t)},e.prototype.WriteStructBegin=function(e,t){var n={type:"structBegin",isBase:t};this.data.push(n)},e.prototype.WriteStructEnd=function(e){var t={type:"structEnd",isBase:e};this.data.push(t)},e.prototype.WriteUInt16=function(e){var t={type:"number",value:e};this.data.push(t)},e.prototype.WriteUInt32=function(e){var t={type:"number",value:e};this.data.push(t)},e.prototype.WriteUInt64=function(e){var t={type:"number",value:e};this.data.push(t)},e.prototype.WriteUInt8=function(e){var t={type:"number",value:e};this.data.push(t)},e.prototype.WriteWString=function(e){var t={type:"string",value:e};this.data.push(t)},e}();e.JsonTextWriter=t}(e.telemetry||(e.telemetry={}))}(e.applications||(e.applications={}))}(microsoft||(microsoft={})),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define("webpack",["exports"],t):t(e.oneDS=e.oneDS||{})}(this,function(e){"use strict";function t(e,t){function n(){this.constructor=e}ie(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function n(e){return typeof e===se}function i(){return!("undefined"==typeof document||!document)}function r(e){return!(b(e)||""===e)}function o(e){return O(e,"string")}function s(e){return O(e,"number")}function a(e){return O(e,"boolean")}function u(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return""}function c(){return null===xe&&(xe=Q(X())&&Boolean(X().sendBeacon)),xe}function l(e){return!!(e&&s(e)&&e>=1&&e<=3)}function h(e,t,n){if(!o(e)||b(t)||""===t)return null;if(o(t)||s(t)||a(t)||d(t))t={value:t};else if("object"!=typeof t||t.hasOwnProperty("value")){if(b(t.value)||""===t.value||!o(t.value)&&!s(t.value)&&!a(t.value)&&!d(t.value))return null}else t={value:n?JSON.stringify(t):t};if(d(t.value)&&!A(t.value))return null;if(D(t.kind)){if(d(t.value)||!C(t.kind))return null;t.value=t.value.toString()}return t}function f(){var e=X();return!(!Q(e)||!e.product)&&"ReactNative"===e.product}function p(){if(D(XMLHttpRequest)){var e=new XMLHttpRequest;return Boolean(N(e.withCredentials)&&D(XDomainRequest))}}function d(e){return e instanceof Array}function g(e,t,n){var i=-1;return N(e)?i:(t&&t>0&&(32===t?i=E(1):t<=13&&(i=T(t))),D(n)&&R(n)?(-1===i&&(i=0),i|n):(d(e)&&(e=e[0]),-1!==i?i|I(e):s(e)?Ie.Double:i))}function _(){return we}function v(e,t,n){if(we){var i=new Date;i.setTime(i.getTime()+24*n*60*60*1e3);var r="; expires="+i.toUTCString();window.document.cookie=e+"="+t+r+"; path=/;"}}function m(e){v(e,"",-1)}function y(e){if(we){e+="=";for(var t=decodeURIComponent(document.cookie).split(";"),n=0;n<t.length;n++){for(var i=t[n],r=0;" "===i.charAt(r);)r++;if(0===(i=i.substring(r)).indexOf(e))return i.substring(e.length,i.length)}}return""}function S(){return De&&window.performance?window.performance.now():(new Date).getTime()}function I(e){return N(e)?-1:s(e)?Ie.Double:o(e)?Ie.String:a(e)?Ie.Bool:-1}function T(e){return e<<5}function E(e){return e<<13}function C(e){return!!(e&&s(e)&&(e>=0&&e<=13||32===e))}function R(e){return!!(s(e)&&e>=0&&e<=9)}function A(e){return e.length>0}function x(e){var t=P("beforeunload",e);return t=P("unload",e)||t,t=P("pagehide",e)||t}function w(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=S()}function O(e,t){return typeof e===t}function N(e){return void 0===e||O(e,Ae)}function b(e){return N(e)||null===e}function D(e){return!N(e)}function P(e,t){var n=!1;if(De){var i=window;n=Le.Attach(i,e,t),n=Le.Attach(i.body,e,t)||n}return be&&(n=Le.Attach(document,e,t)||n),n}function M(e,t,n,i){void 0===i&&(i=!1);var r=!1;if(!b(e))try{b(e[Be])?b(e[ke])||(e[ke](Me+t,n),r=!0):(e[Be](t,n,i),r=!0)}catch(e){}return r}function k(e,t){void 0===t&&(t=We);var n=null;if(e)for(var i=e.split(","),r=0;r<i.length;r++)B(i[r],t)&&(n?n+=","+i[r]:n=i[r]);return n}function B(e,t){if(void 0===t&&(t=We),!e||e.length<4)return!1;for(var n=!1,i=e.substring(0,3).toString().toUpperCase(),r=0;r<t.length;r++)if(t[r]+":"===i&&e.length<=256){n=!0;break}return n}function L(e,t,n,i){var r="",o="";De&&(i&&(r=";domain="+i),window.document.location&&"https:"===window.document.location.protocol&&(o=";secure"),_()&&(window.document.cookie=t+"="+n+r+";path=/"+o))}function W(){for(var e="",t=1073741824*Math.random();t>0;)e+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(t%64),t=Math.floor(t/64);return e}function V(){return void 0===Ue&&(Ue=!!F(de.LocalStorage)),Ue}function U(){return V()?F(de.LocalStorage):null}function F(e){var t,n,i=null;try{if("undefined"==typeof window)return null;n=new Date,(i=e===de.LocalStorage?window.localStorage:window.sessionStorage).setItem(n,n),t=i.getItem(n)!=n,i.removeItem(n),t&&(i=null)}catch(e){i=null}return i}function z(e,t,n){var i=U();if(null!==i)try{return i.setItem(t,n),!0}catch(t){Ue=!1,e.throwInternal(te.CRITICAL,Ce.BrowserCannotWriteLocalStorage,"Browser failed write to local storage. "+t)}return!1}function G(e,t){var n=U();if(null!==n)try{return n.getItem(t)}catch(t){Ue=!1,e.throwInternal(te.CRITICAL,Ce.BrowserCannotReadLocalStorage,"Browser failed read of local storage. "+t)}return null}function q(){return 4294967296*Math.random()|0}function H(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],n="",i=0;i<4;i++)n+=t[15&(e=q())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var r=t[8+4*Math.random()|0];return n.substr(0,8)+n.substr(9,4)+"4"+n.substr(13,3)+r+n.substr(16,3)+n.substr(19,12)}function K(e,t){var i=[];if(e&&e.length>0)for(var r=null,o=0;o<e.length;o++){var s=e[o];if(s&&n(s.processTelemetry)){var a=new yt(s,t);i.push(a),r&&r.setNext(a),r=a}}return i.length>0?i[0]:null}function j(e,t,n){var i=[],r=!n;if(e)for(;e;){var o=e.getPlugin();(r||o===n)&&(r=!0,i.push(o)),e=e.getNext()}return r||i.push(n),K(i,t)}function Q(e){return!(!D(e)||!e)}function X(){return navigator}function J(e,t){if(e)for(var n=0;n<t.length;n++){var i=t[n];b(e[i])&&(e[i]={}),e=e[i]}return e}function Z(e,t,n){if(e&&t){var i=t.split("."),r=i[i.length-1];i.length>1&&(e=J(e,i.splice(-1,1))),b(n)?N(e[r])||delete e[r]:e[r]=n}}function Y(e,t){if(t)for(var n=ae.objKeys(t),i=0;i<n.length;i++){var r=n[i];ae.hasOwnProperty(e,r)||(e[r]=t[r])}}function $(e){return e.pause&&e.teardown&&e.flush}function ee(e,t){var n=null;if(t){t.endpointUrl&&(n=t.endpointUrl);var i=(t.extensions||{})[e]||{};i.overrideEndpointUrl&&(n=i.overrideEndpointUrl)}return n}var te,ne={Unknown:0,NonRetryableStatus:1,InvalidEvent:2,SizeLimitExceeded:3,KillSwitch:4,QueueFull:5},ie=function(e,t){return(ie=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},re=function(){return(re=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++){t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e}).apply(this,arguments)},oe="prototype",se="function",ae=function(){function e(){}return e.isNullOrUndefined=function(e){return null===e||void 0===e},e.isDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)},e.disableCookies=function(){e._canUseCookies=!1},e.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(ue,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},e.toISOString=function(t){if(e.isDate(t)){var n=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return t.getUTCFullYear()+"-"+n(t.getUTCMonth()+1)+"-"+n(t.getUTCDate())+"T"+n(t.getUTCHours())+":"+n(t.getUTCMinutes())+":"+n(t.getUTCSeconds())+"."+String((t.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}},e.arrForEach=function(e,t,n){for(var i=e.length,r=0;r<i;++r)r in e&&t.call(n||e,e[r],r,e)},e.arrIndexOf=function(e,t,n){for(var i=e.length,r=n||0,o=Math.max(r>=0?r:i-Math.abs(r),0);o<i;o++)if(o in e&&e[o]===t)return o;return-1},e.arrMap=function(e,t,n){for(var i=e.length,r=n||e,o=new Array(i),s=0;s<i;s++)s in e&&(o[s]=t.call(r,e[s],e));return o},e.arrReduce=function(e,t,n){var i,r=e.length,o=0;if(arguments.length>=3)i=arguments[2];else{for(;o<r&&!(o in e);)o++;i=e[o++]}for(;o<r;)o in e&&(i=t(i,e[o],o,e)),o++;return i},e.objCreate=function(e){function t(){}if(null==e)return{};var n=typeof e;if("object"!==n&&"function"!==n)throw new TypeError("Object prototype may only be an Object: "+e);return t.prototype=e,new t},e.objKeys=function(e){var t=Object.prototype.hasOwnProperty,n=!{toString:null}.propertyIsEnumerable("toString"),i=typeof e;if("function"!==i&&("object"!==i||null===e))throw new TypeError("objKeys called on non-object");var r=[];for(var o in e)t.call(e,o)&&r.push(o);if(n)for(var s=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],a=s.length,u=0;u<a;u++)t.call(e,s[u])&&r.push(s[u]);return r},e.objDefineAccessors=function(e,t,n,i){var r=Object.defineProperty;if(r)try{var o={enumerable:!0,configurable:!0};return n&&(o.get=n),i&&(o.set=i),r(e,t,o),!0}catch(e){}return!1},e}(),ue=/[xy]/g,ce=500,le=function(){function e(){this.identifier="ChannelControllerPlugin",this.priority=ce}return e.prototype.processTelemetry=function(e){ae.arrForEach(this.channelQueue,function(t){t.length>0&&t[0].processTelemetry(e)})},e.prototype.getChannelControls=function(){return this.channelQueue},e.prototype.initialize=function(e,t,n){var i=this;if(e.isCookieUseDisabled&&ae.disableCookies(),this.channelQueue=new Array,e.channels){var r;ae.arrForEach(e.channels,function(o){if(o&&o.length>0){o=o.sort(function(e,t){return e.priority-t.priority});for(var s=1;s<o.length;s++)o[s-1].setNextPlugin(o[s]);if(ae.arrForEach(o,function(i){i.priority<ce&&(r=i.identifier),i.initialize(e,t,n)}),r)throw Error("Channel has invalid priority"+r);i.channelQueue.push(o)}})}for(var o=new Array,s=0;s<n.length;s++){var a=n[s];a.priority>ce&&o.push(a)}if(o.length>0){o=o.sort(function(e,t){return e.priority-t.priority});for(s=1;s<o.length;s++)o[s-1].setNextPlugin(o[s]);ae.arrForEach(o,function(i){return i.initialize(e,t,n)}),this.channelQueue.push(o)}},e._staticInit=void ae.objDefineAccessors(e.prototype,"ChannelControls",e.prototype.getChannelControls),e}(),he="Extensions must provide callback to initialize",fe=function(){function e(){this._isInitialized=!1,this._extensions=new Array,this._channelController=new le}return e.prototype.initialize=function(e,t,n,i){var r=this;if(this._isInitialized)throw Error("Core should not be initialized more than once");if(!e||ae.isNullOrUndefined(e.instrumentationKey))throw Error("Please provide instrumentation key");this.config=e,this._notificationManager=i,this._notificationManager||(this._notificationManager=ae.objCreate({addNotificationListener:function(e){},removeNotificationListener:function(e){},eventsSent:function(e){},eventsDiscarded:function(e,t){}})),this.config.extensions=ae.isNullOrUndefined(this.config.extensions)?[]:this.config.extensions,this.config.extensionConfig=ae.isNullOrUndefined(this.config.extensionConfig)?{}:this.config.extensionConfig,this._notificationManager&&(this.config.extensionConfig.NotificationManager=this._notificationManager),this.logger=n,this.logger||(this.logger=ae.objCreate({throwInternal:function(e,t,n,i,r){void 0===r&&(r=!1)},warnToConsole:function(e){},resetInternalMessageCount:function(){}})),(c=this._extensions).push.apply(c,t.concat(this.config.extensions)),ae.arrForEach(this._extensions,function(e){var t=!0;if((ae.isNullOrUndefined(e)||ae.isNullOrUndefined(e.initialize))&&(t=!1),!t)throw Error(he)}),this._extensions.push(this._channelController),this._extensions=this._extensions.sort(function(e,t){var n=e,i=t,r=typeof n.processTelemetry,o=typeof i.processTelemetry;return"function"===r&&"function"===o?n.priority-i.priority:"function"===r&&"function"!==o?1:"function"!==r&&"function"===o?-1:void 0});var o={};ae.arrForEach(this._extensions,function(e){var t=e;t&&t.priority&&(ae.isNullOrUndefined(o[t.priority])?o[t.priority]=t.identifier:r.logger&&r.logger.warnToConsole("Two extensions have same priority"+o[t.priority]+", "+t.identifier))});for(var s=-1,a=0;a<this._extensions.length-1;a++){var u=this._extensions[a];if(!u||"function"==typeof u.processTelemetry){if(u.priority===this._channelController.priority){s=a+1;break}this._extensions[a].setNextPlugin(this._extensions[a+1])}}if(this._channelController.initialize(this.config,this,this._extensions),ae.arrForEach(this._extensions,function(e){var t=e;t&&t.priority<r._channelController.priority&&e.initialize(r.config,r,r._extensions)}),s<this._extensions.length&&this._extensions.splice(s),0===this.getTransmissionControls().length)throw new Error("No channels available");this._isInitialized=!0;var c},e.prototype.getTransmissionControls=function(){return this._channelController.getChannelControls()},e.prototype.track=function(e){e.iKey||(e.iKey=this.config.instrumentationKey),e.time||(e.time=ae.toISOString(new Date)),ae.isNullOrUndefined(e.ver)&&(e.ver="4.0"),0===this._extensions.length&&this._channelController.processTelemetry(e);for(var t=0;t<this._extensions.length;){if(this._extensions[t].processTelemetry){this._extensions[t].processTelemetry(e);break}t++}},e.prototype.getProcessTelContext=function(){var e=this,t=e._extensions,n=t;return t&&0!==t.length||(n=[e._channelController]),new St(n,e.config,e)},e}(),pe=function(){function e(){this.listeners=[]}return e.prototype.addNotificationListener=function(e){this.listeners.push(e)},e.prototype.removeNotificationListener=function(e){for(var t=ae.arrIndexOf(this.listeners,e);t>-1;)this.listeners.splice(t,1),t=ae.arrIndexOf(this.listeners,e)},e.prototype.eventsSent=function(e){for(var t=this,n=this,i=0;i<this.listeners.length;++i)!function(i){n.listeners[i].eventsSent&&setTimeout(function(){return t.listeners[i].eventsSent(e)},0)}(i)},e.prototype.eventsDiscarded=function(e,t){for(var n=this,i=this,r=0;r<this.listeners.length;++r)!function(r){i.listeners[r].eventsDiscarded&&setTimeout(function(){return n.listeners[r].eventsDiscarded(e,t)},0)}(r)},e}();!function(e){e[e.CRITICAL=1]="CRITICAL",e[e.WARNING=2]="WARNING"}(e.LoggingSeverity||(e.LoggingSeverity={}));var de,ge={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72},_e=function(){function e(t,n,i,r){void 0===i&&(i=!1),this.messageId=t,this.message=(i?e.AiUserActionablePrefix:e.AiNonUserActionablePrefix)+t;var o=(n?" message:"+e.sanitizeDiagnosticText(n):"")+(r?" props:"+e.sanitizeDiagnosticText(JSON.stringify(r)):"");this.message+=o}return e.sanitizeDiagnosticText=function(e){return'"'+e.replace(/\"/g,"")+'"'},e.dataType="MessageData",e.AiNonUserActionablePrefix="AI (Internal): ",e.AiUserActionablePrefix="AI: ",e}(),ve=function(){function t(e){this.queue=[],this.AIInternalMessagePrefix="AITR_",this._messageCount=0,this._messageLogged={},this.enableDebugExceptions=function(){return!1},this.consoleLoggingLevel=function(){return 0},this.telemetryLoggingLevel=function(){return 1},this.maxInternalMessageLimit=function(){return 25},ae.isNullOrUndefined(e)||(ae.isNullOrUndefined(e.loggingLevelConsole)||(this.consoleLoggingLevel=function(){return e.loggingLevelConsole}),ae.isNullOrUndefined(e.loggingLevelTelemetry)||(this.telemetryLoggingLevel=function(){return e.loggingLevelTelemetry}),ae.isNullOrUndefined(e.maxMessageLimit)||(this.maxInternalMessageLimit=function(){return e.maxMessageLimit}),ae.isNullOrUndefined(e.enableDebugExceptions)||(this.enableDebugExceptions=function(){return e.enableDebugExceptions}))}return t.prototype.throwInternal=function(t,n,i,r,o){void 0===o&&(o=!1);var s=new _e(n,i,o,r);if(this.enableDebugExceptions())throw s;if(void 0!==s&&s&&void 0!==s.message){if(o){var a=+s.messageId;(!this._messageLogged[a]||this.consoleLoggingLevel()>=e.LoggingSeverity.WARNING)&&(this.warnToConsole(s.message),this._messageLogged[a]=!0)}else this.consoleLoggingLevel()>=e.LoggingSeverity.WARNING&&this.warnToConsole(s.message);this.logInternalMessage(t,s)}},t.prototype.warnToConsole=function(e){"undefined"!=typeof console&&console&&("function"==typeof console.warn?console.warn(e):"function"==typeof console.log&&console.log(e))},t.prototype.resetInternalMessageCount=function(){this._messageCount=0,this._messageLogged={}},t.prototype.logInternalMessage=function(e,t){if(!this._areInternalMessagesThrottled()){var n=!0,i=this.AIInternalMessagePrefix+t.messageId;if(this._messageLogged[i]?n=!1:this._messageLogged[i]=!0,n&&(e<=this.telemetryLoggingLevel()&&(this.queue.push(t),this._messageCount++),this._messageCount===this.maxInternalMessageLimit())){var r="Internal events throttle limit per PageView reached for this app.",o=new _e(ge.MessageLimitPerPVExceeded,r,!1);this.queue.push(o),this.warnToConsole(r)}}},t.prototype._areInternalMessagesThrottled=function(){return this._messageCount>=this.maxInternalMessageLimit()},t}(),me=function(e){function n(){return e.call(this)||this}return t(n,e),n.prototype.initialize=function(t,n){this._notificationManager=new pe,this.logger=new ve(t),this.config=t,e.prototype.initialize.call(this,t,n,this.logger,this._notificationManager)},n.prototype.getTransmissionControls=function(){return e.prototype.getTransmissionControls.call(this)},n.prototype.track=function(t){if(null===t)throw this._notifyInvalidEvent(t),Error("Invalid telemetry item");this._validateTelemetryItem(t),e.prototype.track.call(this,t)},n.prototype.addNotificationListener=function(e){this._notificationManager&&this._notificationManager.addNotificationListener(e)},n.prototype.removeNotificationListener=function(e){this._notificationManager&&this._notificationManager.removeNotificationListener(e)},n.prototype.pollInternalLogs=function(e){var t=this,n=this.config.diagnosticLogInterval;return n>0||(n=1e4),setInterval(function(){var n=t.logger?t.logger.queue:[];ae.arrForEach(n,function(n){var i={name:e||"InternalMessageId: "+n.messageId,iKey:t.config.instrumentationKey,time:ae.toISOString(new Date),baseType:_e.dataType,baseData:{message:n.message}};t.track(i)}),n.length=0},n)},n.prototype._validateTelemetryItem=function(e){if(ae.isNullOrUndefined(e.name))throw this._notifyInvalidEvent(e),Error("telemetry name required")},n.prototype._notifyInvalidEvent=function(e){this._notificationManager&&this._notificationManager.eventsDiscarded([e],ne.InvalidEvent)},n}(fe),ye={NotSet:0,Pii_DistinguishedName:1,Pii_GenericData:2,Pii_IPV4Address:3,Pii_IPv6Address:4,Pii_MailSubject:5,Pii_PhoneNumber:6,Pii_QueryString:7,Pii_SipAddress:8,Pii_SmtpAddress:9,Pii_Identity:10,Pii_Uri:11,Pii_Fqdn:12,Pii_IPV4AddressLegacy:13,CustomerContent_GenericContent:32},Se={Normal:1,CostDeferred:2,RealTime:3},Ie={Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9},Te={Normal:1,Critical:2},Ee={NONE:0,ERROR:1,WARNING:2,INFORMATION:3},Ce=re({},ge,{AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517}),Re="1DS-Web-JS-2.2.0",Ae="undefined",xe=null,we=i()||Boolean(Q(X())&&X().cookieEnabled),Oe=ae.arrForEach,Ne=ae.objKeys,be=i(),De=!("undefined"==typeof window||!window),Pe=ae.objDefineAccessors,Me="on",ke="attachEvent",Be="addEventListener",Le=function(){function e(){}return e.Attach=M,e}(),me=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.pluginVersionStringArr=[],t.pluginVersionString="",t}return t(n,e),n.prototype.initialize=function(t,n){if(t){t.endpointUrl||(t.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var i=t.propertyStorageOverride;if(i&&(!i.getProperty||!i.setProperty))throw"Invalid property storage override passed.";if(t.channels)for(s=0;s<t.channels.length;s++)if(t.channels[s])for(var r=0;r<t.channels[s].length;r++){var o=t.channels[s][r];if(o.identifier&&o.version){u=o.identifier+"="+o.version;this.pluginVersionStringArr.push(u)}}}if(this.getWParam=function(){return"undefined"!=typeof document?0:-1},n)for(var s=0;s<n.length;s++){var a=n[s];if(a.identifier&&a.version){var u=a.identifier+"="+a.version;this.pluginVersionStringArr.push(u)}}this.pluginVersionString=this.pluginVersionStringArr.join(";");try{e.prototype.initialize.call(this,t,n)}catch(e){this.logger.throwInternal(te.CRITICAL,Ce.ErrorProvidedChannels,"Channels must be provided through config.channels only")}this.pollInternalLogs("InternalLog")},n.prototype.track=function(t){var n=t;if(n){n.timings=n.timings||{},n.timings.trackStart=S(),l(n.latency)||(n.latency=Se.Normal);var i=n.ext=n.ext||{};i.sdk=i.sdk||{},i.sdk.ver=Re;var r=n.baseData=n.baseData||{};r[Wt]||(r[Wt]={});var o=r[Wt];o[Lt]||(o[Lt]=""),""!=this.pluginVersionString&&(o[Lt]=this.pluginVersionString)}e.prototype.track.call(this,n)},n}(me),fe=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.initialize=function(t,n){t&&(t.endpointUrl||(t.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/")),this.getWParam=function(){return"undefined"!=typeof document?0:-1};try{e.prototype.initialize.call(this,t,n)}catch(e){this.logger.throwInternal(te.CRITICAL,Ce.ErrorProvidedChannels,"Channels must be provided through config.channels only")}},n.prototype.track=function(t){var n=t;n&&(n.ext=n.ext||{},n.ext.sdk=n.ext.sdk||{},n.ext.sdk.ver=Re),e.prototype.track.call(this,n)},n.prototype.getProcessTelContext=function(){var e=this,t=e._extensions,n=t;return t&&0!==t.length||(n=[e._channelController]),new St(n,e.config,e)},n}(fe),We=["AX","EX","SF","CS","CF","CT","CU","DC","DF","H5","HL","WS","WP"],Ve=function(){function e(e){if(this.appExpId=null,this.flightIdNameSpaces=We.slice(0),this.expIdCookieName="Treatments",this._propertiesConfig=e,"undefined"!=typeof document){var t=document.documentElement;t&&(this.locale=t.lang)}this.env=e.env?e.env:this._getMetaDataFromDOM("awa-").env}return e.prototype.getExpId=function(){return this._propertiesConfig.expId?this._readExpIdFromCoreData(this._propertiesConfig.expId):this._readExpIdFromCookie()},e.prototype._getMetaDataFromDOM=function(e){var t,n={};t="undefined"!=typeof document&&document.querySelectorAll("meta");for(var i=0;i<t.length;i++){var r=t[i];r.name&&0===r.name.toLowerCase().indexOf(e)&&(n[r.name.replace(e,"")]=r.content)}return n},e.prototype._setAppExpId=function(e){e!==this.appExpId&&(this.appExpId=k(e,this.flightIdNameSpaces))},e.prototype._getAppExpId=function(){return this.appExpId},e.prototype._readExpIdFromCookie=function(){return this._setAppExpId(y(this.expIdCookieName)),this._getAppExpId()},e.prototype._readExpIdFromCoreData=function(e){return this._setAppExpId(e),this._getAppExpId()},e.validateAppExpId=k,e._staticInit=void ae.objDefineAccessors(e.prototype,"expId",e.prototype.getExpId),e}(),Ue=void 0;!function(e){e[e.LocalStorage=0]="LocalStorage",e[e.SessionStorage=1]="SessionStorage"}(de||(de={}));var Fe=function(){function e(){}return e.Now="undefined"==typeof window?function(){return(new Date).getTime()}:window.performance&&window.performance.now&&window.performance.timing?function(){return window.performance.now()+window.performance.timing.navigationStart}:function(){return(new Date).getTime()},e.GetDuration=function(e,t){var n=null;return 0===e||0===t||ae.isNullOrUndefined(e)||ae.isNullOrUndefined(t)||(n=t-e),n},e}(),ze=ae.toISOString,Ge=function(){function e(t,n,i){if(this._logger=i,!t.disableCookiesUsage&&_()){var r=y("MUID");if(r&&this.setLocalId("t:"+r),n.enableApplicationInsightsUser){var o=y(e.userCookieName);if(o){var s=o.split(e.cookieSeparator);s.length>0&&(this.id=s[0])}if(!this.id){this.id=W();var a=new Date,u=ze(a);this.accountAcquisitionDate=u,a.setTime(a.getTime()+31536e6);var c=[this.id,u],l=n.cookieDomain?n.cookieDomain:void 0;L(this._logger,e.userCookieName,c.join(e.cookieSeparator)+";expires="+a.toUTCString(),l)}}}if("undefined"!=typeof navigator){var h=navigator;this.locale=h.userLanguage||h.language}}return e.prototype.getLocalId=function(){if(this._customLocalId)return this._customLocalId;var e=y("MUID");e&&this.setLocalId("t:"+e)},e.prototype.setLocalId=function(e){this._customLocalId=e},e.cookieSeparator="|",e.userCookieName="ai_user",e._staticInit=void ae.objDefineAccessors(e.prototype,"localId",e.prototype.getLocalId,e.prototype.setLocalId),e}(),qe={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",OPERA:"Opera"},He=function(){function e(e){if(this._propertiesConfig=e,"undefined"!=typeof window){var t=window.location;if(t){var n=t.hostname;n&&(this.domain="file:"===t.protocol?"local":n)}}var i="undefined"!=typeof navigator?navigator.userAgent:"";if(e.userAgent&&(i=e.userAgent),e.populateBrowserInfo){if(i){var r=this._getBrowserName(i);this.browser=r,this.browserVer=this._getBrowserVersion(i,r)}var o=this._getScreenResolution();this.screenRes=o.w+"X"+o.h}}return e.prototype.getUserConsent=function(){return this._propertiesConfig.userConsented||!!y(this._propertiesConfig.userConsentCookieName)},e.prototype._getBrowserName=function(e){return this._userAgentContainsString("OPR/",e)?qe.OPERA:this._userAgentContainsString(qe.PHANTOMJS,e)?qe.PHANTOMJS:this._userAgentContainsString(qe.EDGE,e)?qe.EDGE:this._userAgentContainsString(qe.ELECTRON,e)?qe.ELECTRON:this._userAgentContainsString(qe.CHROME,e)?qe.CHROME:this._userAgentContainsString("Trident",e)?qe.MSIE:this._userAgentContainsString(qe.FIREFOX,e)?qe.FIREFOX:this._userAgentContainsString(qe.SAFARI,e)?qe.SAFARI:this._userAgentContainsString(qe.SKYPE_SHELL,e)?qe.SKYPE_SHELL:"Unknown"},e.prototype._userAgentContainsString=function(e,t){return t.indexOf(e)>-1},e.prototype._getBrowserVersion=function(e,t){return t===qe.MSIE?this._getIeVersion(e):this._getOtherVersion(t,e)},e.prototype._getIeVersion=function(e){var t=e.match(new RegExp(qe.MSIE+" ([\\d,.]+)"));if(t)return t[1];var n=e.match(new RegExp("rv:([\\d,.]+)"));return n?n[1]:void 0},e.prototype._getOtherVersion=function(e,t){e===qe.SAFARI&&(e="Version");var n=t.match(new RegExp(e+"/([\\d,.]+)"));return n?n[1]:"Unknown"},e.prototype._getScreenResolution=function(){var e={h:0,w:0};return window.screen&&(e.h=screen.height,e.w=screen.width),e},e._staticInit=void ae.objDefineAccessors(e.prototype,"userConsent",e.prototype.getUserConsent),e}(),Ke={WINDOWS:"Windows",MACOSX:"Mac OS X",ANDROID:"Android"},je={WIN:/(windows|win32)/i,WINRT:/ arm;/i,WINPHONE:/windows\sphone\s\d+\.\d+/i,OSX:/(macintosh|mac os x)/i,IOS:/(ipad|iphone|ipod)(?=.*like mac os x)/i,LINUX:/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i,ANDROID:/android/i,CROS:/CrOS/i},Qe={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},Xe=function(){function e(e){var t="undefined"!=typeof navigator?navigator.userAgent:"";if(e.userAgent&&(t=e.userAgent),t&&e.populateOperatingSystemInfo){var n=this._getOsName(t.toLowerCase());this.name=n,this.ver=this._getOsVersion(t,n)}}return e.prototype._getOsName=function(e){return e.match(je.WINPHONE)?"Windows Phone":e.match(je.WINRT)?"Windows RT":e.match(je.WIN)?Ke.WINDOWS:e.match(je.IOS)?"iOS":e.match(je.ANDROID)?Ke.ANDROID:e.match(je.LINUX)?"Linux":-1!==e.indexOf("x11")?"Unix":-1!==e.indexOf("blackberry")?"BlackBerry":-1!==e.indexOf("symbian")?"Symbian":-1!==e.indexOf("nokia")?"Nokia":e.match(je.OSX)?Ke.MACOSX:e.match(je.CROS)?"Chrome OS":"Unknown"},e.prototype._getOsVersion=function(e,t){return t===Ke.WINDOWS?this._getGenericOsVersion(e,"Windows NT"):t===Ke.ANDROID?this._getGenericOsVersion(e,t):t===Ke.MACOSX?this._getMacOsxVersion(e):"Unknown"},e.prototype._getGenericOsVersion=function(e,t){var n=e.match(new RegExp(t+" ([\\d,.]+)"));return n?Qe[n[1]]?Qe[n[1]]:n[1]:"Unknown"},e.prototype._getMacOsxVersion=function(e){var t=e.match(new RegExp(Ke.MACOSX+" ([\\d,_,.]+)"));if(t){var n=t[1].replace(/_/g,".");if(n){var i=this._getDelimiter(n);return i?n.split(i)[0]:n}}return"Unknown"},e.prototype._getDelimiter=function(e){return e.indexOf(".")>-1?".":e.indexOf("_")>-1?"_":null},e}(),Je=function(){function e(e){this.serviceName=e.serviceName?e.serviceName:""}return e.prototype.getMsfpc=function(){return y("MSFPC")},e.prototype.getAnid=function(){return y("ANON").slice(0,34)},e._staticInit=(ae.objDefineAccessors(e.prototype,"msfpc",e.prototype.getMsfpc),void ae.objDefineAccessors(e.prototype,"anid",e.prototype.getAnid)),e}(),Ze=function(){return function(){this.popSample=100}}(),Ye=function(){return function(){var e=(new Date).getTimezoneOffset(),t=e%60,n=(e-t)/60,i="+";n>0&&(i="-"),n=Math.abs(n),t=Math.abs(t),this.tz=i+(n<10?"0"+n:n.toString())+":"+(t<10?"0"+t:t.toString())}}(),$e=function(){return function(){}}(),et=function(){function e(){}return e.prototype.setId=function(e){this.customId=e},e.prototype.getId=function(){return o(this.customId)?this.customId:this.automaticId},e._staticInit=void ae.objDefineAccessors(e.prototype,"id",e.prototype.getId,e.prototype.setId),e}(),tt=function(){return function(e,t,n,i){e.enableApplicationInsightsTrace&&(this.traceId=t||H(),this.parentId=n,this.name=i,De&&window.location&&window.location.pathname&&(this.name=window.location.pathname))}}(),nt=function(){function e(){}return e.id="id",e.ver="ver",e.appName="name",e.locale="locale",e.expId="expId",e.env="env",e}(),it=function(){function e(){}return e.domain="domain",e.browser="browser",e.browserVer="browserVer",e.screenRes="screenRes",e.userConsent="userConsent",e}(),rt=function(){function e(){}return e.locale="locale",e.localId="localId",e.id="id",e}(),ot=function(){function e(){}return e.osName="name",e.ver="ver",e}(),st=function(){function e(){}return e.ver="ver",e.seq="seq",e.installId="installId",e.epoch="epoch",e}(),at=function(){function e(){}return e.msfpc="msfpc",e.anid="anid",e.serviceName="serviceName",e}(),ut=function(){function e(){}return e.popSample="popSample",e}(),ct=function(){function e(){}return e.tz="tz",e}(),lt=function(){function e(){}return e.sessionId="sesId",e}(),ht=function(){function e(){}return e.localId="localId",e.deviceClass="deviceClass",e.make="make",e.model="model",e}(),ft=function(){function e(){}return e.traceId="traceID",e.traceName="name",e.parentId="parentID",e}(),pt=function(){function e(){}return e.UserExt="user",e.DeviceExt="device",e.TraceExt="trace",e.WebExt="web",e.AppExt="app",e.OSExt="os",e.SdkExt="sdk",e.IntWebExt="intweb",e.UtcExt="utc",e.LocExt="loc",e}(),dt="MicrosoftApplicationsTelemetryDeviceId",gt=function(){function e(e){if(this._sequenceId=0,this._propertyStorage=e.propertyStorageOverride,this.seq=this._sequenceId,this.epoch=(new Date).getTime().toString(),!e.disableCookiesUsage&&_()||this._propertyStorage){var t=this._getData(dt);t||(t=ae.newGuid()),this._saveData(dt,t),this.installId=t}else m(dt)}return e.prototype.getSequenceId=function(){return++this._sequenceId},e.prototype._saveData=function(e,t){var n=this._propertyStorage;n?n.setProperty(e,t):v(e,t,365)},e.prototype._getData=function(e){return this._propertyStorage?this._propertyStorage.getProperty(e)||"":y(e)},e}(),_t=function(){function e(t,n){var i=this,r=this.getDefaultConfig(t);ae.isNullOrUndefined(n)?this._logger=new ve:this._logger=n,"function"!=typeof t.sessionExpirationMs&&(r.sessionExpirationMs=function(){return e.acquisitionSpan}),"function"!=typeof t.sessionRenewalMs&&(r.sessionRenewalMs=function(){return e.renewalSpan}),this.config=r,this._storageNamePrefix=function(){return i.config.namePrefix&&i.config.namePrefix()?e.cookieNameConst+i.config.namePrefix():e.cookieNameConst},this.automaticSession=new et}return e.prototype.update=function(){this.automaticSession.getId()||this.initializeAutomaticSession();var t=this.automaticSession,n=this.config,i=Fe.Now(),r=i-t.acquisitionDate>n.sessionExpirationMs(),o=i-t.renewalDate>n.sessionRenewalMs();if(r||o)this.renew();else{var s=this.cookieUpdatedTimestamp;(!s||i-s>e.cookieUpdateInterval)&&(t.renewalDate=i,this.setCookie(t.getId(),t.acquisitionDate,t.renewalDate))}},e.prototype.getDefaultConfig=function(e){return{sessionRenewalMs:e.sessionRenewalMs&&function(){return e.sessionRenewalMs},sessionExpirationMs:e.sessionExpirationMs&&function(){return e.sessionExpirationMs},cookieDomain:e.cookieDomain&&function(){return e.cookieDomain},namePrefix:e.namePrefix&&function(){return e.namePrefix}}},e.prototype.backup=function(){this.setStorage(this.automaticSession.getId(),this.automaticSession.acquisitionDate,this.automaticSession.renewalDate)},e.prototype.initializeAutomaticSession=function(){var e=y(this._storageNamePrefix());if(e&&"function"==typeof e.split)this.initializeAutomaticSessionWithData(e);else{var t=G(this._logger,this._storageNamePrefix());t&&this.initializeAutomaticSessionWithData(t)}this.automaticSession.getId()||this.renew()},e.prototype.initializeAutomaticSessionWithData=function(e){var t=e.split("|");t.length>0&&this.automaticSession.setId(t[0]);try{if(t.length>1){var n=+t[1];this.automaticSession.acquisitionDate=+new Date(n),this.automaticSession.acquisitionDate=this.automaticSession.acquisitionDate>0?this.automaticSession.acquisitionDate:0}if(t.length>2){var i=+t[2];this.automaticSession.renewalDate=+new Date(i),this.automaticSession.renewalDate=this.automaticSession.renewalDate>0?this.automaticSession.renewalDate:0}}catch(e){this._logger.throwInternal(te.CRITICAL,Ce.ErrorParsingAISessionCookie,"Error parsing ai_session cookie, session will be reset: "+e)}0==this.automaticSession.renewalDate&&this._logger.throwInternal(te.WARNING,Ce.SessionRenewalDateIsZero,"AI session renewal date is 0, session will be reset.")},e.prototype.renew=function(){var e=Fe.Now();this.automaticSession.setId(W()),this.automaticSession.acquisitionDate=e,this.automaticSession.renewalDate=e,this.setCookie(this.automaticSession.getId(),this.automaticSession.acquisitionDate,this.automaticSession.renewalDate),V()||this._logger.throwInternal(te.WARNING,Ce.BrowserDoesNotSupportLocalStorage,"Browser does not support local storage. Session durations will be inaccurate.")},e.prototype.setCookie=function(e,t,n){var i=t+this.config.sessionExpirationMs(),r=n+this.config.sessionRenewalMs(),o=new Date,s=[e,t,n];i<r?o.setTime(i):o.setTime(r);var a=this.config.cookieDomain?this.config.cookieDomain():null;L(this._logger,this._storageNamePrefix(),s.join("|")+";expires="+o.toUTCString(),a),this.cookieUpdatedTimestamp=Fe.Now()},e.prototype.setStorage=function(e,t,n){z(this._logger,this._storageNamePrefix(),[e,t,n].join("|"))},e.acquisitionSpan=864e5,e.renewalSpan=18e5,e.cookieUpdateInterval=6e4,e.cookieNameConst="ai_session",e}(),vt=function(){function e(e,t,n){this.app=new Ve(t),this.user=new Ge(e,t,n&&n.logger),this.os=new Xe(t),this.web=new He(t),this.sdk=new gt(e),this.intWeb=new Je(t),this.utc=new Ze,this.loc=new Ye,this.device=new $e,this.telemetryTrace=new tt(t),this.sessionManager=new _t(t,n&&n.logger),this.session=new et}return e.prototype.getSessionId=function(){var e=this.session;if(e&&o(e.customId))return e.customId;var t=this.sessionManager;t.update();var n=t.automaticSession;if(n){var i=n.getId();i&&o(i)&&(e.automaticId=i)}return e.automaticId},e.prototype.applyApplicationContext=function(e){var t=this.app;o(t.id)&&(e.ext[pt.AppExt][nt.id]=t.id),o(t.ver)&&(e.ext[pt.AppExt][nt.ver]=t.ver),o(t.name)&&(e.ext[pt.AppExt][nt.appName]=t.name),o(t.locale)&&(e.ext[pt.AppExt][nt.locale]=t.locale);var n=t.getExpId();o(n)&&(e.ext[pt.AppExt][nt.expId]=n),o(t.env)&&(e.ext[pt.AppExt][nt.env]=t.env)},e.prototype.applyUserContext=function(e){var t=this.user,n=t.getLocalId();o(n)&&(e.ext[pt.UserExt][rt.localId]=n),o(t.locale)&&(e.ext[pt.UserExt][rt.locale]=t.locale),o(t.id)&&(e.ext[pt.UserExt][rt.id]=t.id)},e.prototype.applyWebContext=function(e){var t=this.web;o(t.domain)&&(e.ext[pt.WebExt][it.domain]=t.domain),o(t.browser)&&(e.ext[pt.WebExt][it.browser]=t.browser),o(t.browserVer)&&(e.ext[pt.WebExt][it.browserVer]=t.browserVer),o(t.screenRes)&&(e.ext[pt.WebExt][it.screenRes]=t.screenRes),e.ext[pt.WebExt][it.userConsent]=t.getUserConsent()},e.prototype.applyOsContext=function(e){var t=this.os;o(t.name)&&(e.ext[pt.OSExt][ot.osName]=t.name),o(t.ver)&&(e.ext[pt.OSExt][ot.ver]=t.ver)},e.prototype.applySdkContext=function(e){var t=this.sdk;e.ext[pt.SdkExt][st.seq]=t.getSequenceId(),e.ext[pt.SdkExt][st.epoch]=t.epoch,o(t.installId)&&(e.ext[pt.SdkExt][st.installId]=t.installId)},e.prototype.applyIntWebContext=function(e){var t=this.intWeb,n=t.getMsfpc();o(n)&&(e.ext[pt.IntWebExt][at.msfpc]=n);var i=t.getAnid();o(i)&&(e.ext[pt.IntWebExt][at.anid]=i),o(t.serviceName)&&(e.ext[pt.IntWebExt][at.serviceName]=t.serviceName)},e.prototype.applyUtcContext=function(e){e.ext[pt.UtcExt][ut.popSample]=this.utc.popSample},e.prototype.applyLocContext=function(e){e.ext[pt.LocExt][ct.tz]=this.loc.tz},e.prototype.applySessionContext=function(e){e.ext[pt.AppExt][lt.sessionId]=this.getSessionId()},e.prototype.applyDeviceContext=function(e){var t=this.device;o(t.localId)&&(e.ext[pt.DeviceExt][ht.localId]=t.localId),o(t.make)&&(e.ext[pt.DeviceExt][ht.make]=t.make),o(t.model)&&(e.ext[pt.DeviceExt][ht.model]=t.model),o(t.deviceClass)&&(e.ext[pt.DeviceExt][ht.deviceClass]=t.deviceClass)},e.prototype.applyAITraceContext=function(e){var t=this.telemetryTrace;o(t.traceId)&&(e.ext[pt.TraceExt][ft.traceId]=t.traceId),o(t.name)&&(e.ext[pt.TraceExt][ft.traceName]=t.name),o(t.parentId)&&(e.ext[pt.TraceExt][ft.parentId]=t.parentId)},e}(),mt="getPlugin",yt=function(){return function(e,t){var i=this,r=null,o=n(e.processTelemetry),s=n(e.setNextPlugin);i._hasRun=!1,i.getPlugin=function(){return e},i.getNext=function(){return r},i.setNext=function(e){r=e},i.processTelemetry=function(n,a){if(a||(a=t),e&&o){i._hasRun=!0;try{a.setNext(r),s&&e.setNextPlugin(r),r&&(r._hasRun=!1),e.processTelemetry(n,a)}catch(t){var u=r&&r._hasRun;r&&u||a.diagLog().throwInternal(te.CRITICAL,ge.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+t),r&&!u&&r.processTelemetry(n,a)}}else r&&(i._hasRun=!0,r.processTelemetry(n,a))}}}(),St=function(){function e(t,i,r,o){var s=this,a=null;null!==o&&(t&&n(t.getPlugin)?a=j(t,s,o||t.getPlugin()):o?a=_copyPluginChain(t,s,o):N(o)&&(a=K(t,s))),s.core=function(){return r},s.diagLog=function(){var e=(r||{}).logger;return e||(e=new ve(i||{})),e},s.getCfg=function(){return i},s.getExtCfg=function(e,t){void 0===t&&(t={});var n;if(i){var r=i.extensionConfig;r&&e&&(n=r[e])}return n||t},s.getConfig=function(e,t,n){void 0===n&&(n=!1);var r,o=s.getExtCfg(e,null);return o&&!b(o[t])?r=o[t]:i&&!b(i[t])&&(r=i[t]),b(r)?n:r},s.hasNext=function(){return null!=a},s.getNext=function(){return a},s.setNext=function(e){a=e},s.processNext=function(e){var t=a;t&&(a=t.getNext(),t.processTelemetry(e,s))},s.createNew=function(t,n){return void 0===t&&(t=null),new e(t||a,i,r,n)}}return e}(),he="Extensions must provide callback to initialize",It=ae.arrForEach,fe=function(){function e(){var e=!1,t=this;t._extensions=new Array,t._channelController=new le,t.isInitialized=function(){return e},t._setInit=function(t){e=t},t._eventQueue=[]}return e.prototype.initialize=function(e,t,n,i){var r=this;if(r.isInitialized())throw Error("Core should not be initialized more than once");if(!e||b(e.instrumentationKey))throw Error("Please provide instrumentation key");r.config=e;var o=r._channelController;i||(i=ae.objCreate({addNotificationListener:function(e){},removeNotificationListener:function(e){},eventsSent:function(e){},eventsDiscarded:function(e,t){}})),r._notificationManager=i,e.extensions=b(e.extensions)?[]:e.extensions,(e.extensionConfig=b(e.extensionConfig)?{}:e.extensionConfig).NotificationManager=i,n||(n=ae.objCreate({throwInternal:function(e,t,n,i,r){void 0===r&&(r=!1)},warnToConsole:function(e){},resetInternalMessageCount:function(){}})),r.logger=n;var s=[];s.push.apply(s,t.concat(e.extensions)),s=sortPlugins(s);var a=[],u={};if(It(s,function(e){if(b(e)||b(e.initialize))throw Error(he);var t=e.priority,i=e.identifier;e&&t&&(b(u[t])?u[t]=i:n.warnToConsole("Two extensions have same priority #"+t+" - "+u[t]+", "+i)),(!t||t<o.priority)&&a.push(e)}),s.push(o),a.push(o),s=sortPlugins(s),r._extensions=s,initializePlugins(new St([o],e,r),s),initializePlugins(new St(a,e,r),s),r._extensions=a,0===r.getTransmissionControls().length)throw new Error("No channels available");r._setInit(!0)},e.prototype.getTransmissionControls=function(){return this._channelController.getChannelControls()},e.prototype.track=function(e){var t=this;e.iKey||(e.iKey=t.config.instrumentationKey),e.time||(e.time=ae.toISOString(new Date)),b(e.ver)&&(e.ver="4.0"),t.isInitialized()?(t._eventQueue.length>0&&(It(t._eventQueue,function(e){t.getProcessTelContext().processNext(e)}),t._eventQueue=[]),t.getProcessTelContext().processNext(e)):t._eventQueue.push(e)},e.prototype.getProcessTelContext=function(){var e=this,t=e._extensions,n=t;return t&&0!==t.length||(n=[e._channelController]),new St(n,e.config,e)},e}(),Tt=function(){function e(){var e=this,t=!1,i=null,r=null;e.core=null,e.diagLog=function(t){return e._getTelCtx(t).diagLog()},e.isInitialized=function(){return t},e.setInitialized=function(e){t=e},e.setNextPlugin=function(e){r=e},e.processNext=function(e,t){t?t.processNext(e):r&&n(r.processTelemetry)&&r.processTelemetry(e,null)},e._getTelCtx=function(t){void 0===t&&(t=null);var n=t;if(!n){var o=i||new St(null,{},e.core);n=r&&r[mt]?o.createNew(null,r[mt]):o.createNew(null,r)}return n},e._baseTelInit=function(n,o,s,a){n&&(n.extensionConfig=n.extensionConfig||[]),!a&&o&&(a=o.getProcessTelContext().getNext());var u=r;r&&r[mt]&&(u=r[mt]()),e.core=o,i=new St(a,n,o,u),t=!0}}return e.prototype.initialize=function(e,t,n,i){this._baseTelInit(e,t,n,i)},e}(),Et=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.identifier="SystemPropertiesCollector",t.priority=3,t.version="2.2.0",t._properties={},t}return t(n,e),n.prototype.initialize=function(t,n,i){e.prototype.initialize.call(this,t,n,i),this.context=new vt(t,this._getTelCtx().getExtCfg(this.identifier),n)},n.prototype.processTelemetry=function(e,t){w(e,this.identifier),t=this._getTelCtx(t);var n=e.ext=e.ext?e.ext:{};e.data=e.data?e.data:{},n[pt.AppExt]=n[pt.AppExt]||{},n[pt.UserExt]=n[pt.UserExt]||{},n[pt.WebExt]=n[pt.WebExt]||{},n[pt.OSExt]=n[pt.OSExt]||{},n[pt.SdkExt]=n[pt.SdkExt]||{},n[pt.IntWebExt]=n[pt.IntWebExt]||{},n[pt.UtcExt]=n[pt.UtcExt]||{},n[pt.LocExt]=n[pt.LocExt]||{},n[pt.DeviceExt]=n[pt.DeviceExt]||{},n[pt.TraceExt]=n[pt.TraceExt]||{};var i=this.context;i.applyApplicationContext(e),i.applyUserContext(e),i.applyWebContext(e),i.applyOsContext(e),i.applySdkContext(e),i.applyIntWebContext(e),i.applyUtcContext(e),i.applyLocContext(e),i.applySessionContext(e),i.applyDeviceContext(e),i.applyAITraceContext(e),Bt.arrForEach(Bt.objKeys(n),function(e){0===Bt.objKeys(n[e]).length&&delete n[e]}),this._addPropertiesIfAbsent(this._properties,e.data),this.processNext(e,t)},n.prototype.getPropertiesContext=function(){return this.context},n.prototype.setProperty=function(e,t){this._properties[e]=t},n.prototype._addPropertiesIfAbsent=function(e,t){if(e)for(var n in e)e.hasOwnProperty(n)&&(t[n]||(t[n]=e[n]))},n}(Tt),Ct="REAL_TIME",Rt=function(){function e(){}return e.getPayloadBlob=function(e,t){var n="",i={};for(var r in e)if(e.hasOwnProperty(r))for(var o=0;o<e[r].length;++o){n&&(n+="\n");var s=n.length;if((n+=this.getEventBlob(e[r][o])).length-s>2e6&&(t&&t.eventsDiscarded([e[r][o]],ne.SizeLimitExceeded),delete e[r][o],n=n.substring(0,s)),n.length>3984588){i={};var a=e[r];e[r]=a.splice(0,o),i[r]=a;break}}return{payloadBlob:n,remainingRequest:i}},e.getEventBlob=function(e){var t={};if(t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+u(e.iKey),e.ext){t.ext={};for(var n in e.ext)if(e.ext.hasOwnProperty(n)){t.ext[n]={};for(var i in e.ext[n])e.ext[n].hasOwnProperty(i)&&e.ext[n][i]&&(t.ext[n][i]=h(i,e.ext[n][i]).value)}}if(t.data={},t.data.baseData={},t.data.baseType=e.baseType,e.baseData)for(var n in e.baseData)if(e.baseData.hasOwnProperty(n)){r=h(n,e.baseData[n]);this._addJSONProperty(t.data.baseData,n,r),this._addJSONPropertyMetaData(t.ext,"baseData."+n,r)}if(e.data)for(var n in e.data)if(e.data.hasOwnProperty(n)){var r=h(n,e.data[n]);this._addJSONProperty(t.data,n,r),this._addJSONPropertyMetaData(t.ext,n,r)}return JSON.stringify(t)},e._addJSONProperty=function(e,t,n){if(n){for(var i=e,r=t.split("."),o=0;o<r.length-1;++o)i[r[o]]||(i[r[o]]={}),i=i[r[o]];i[r[r.length-1]]=n.value}},e._addJSONPropertyMetaData=function(e,t,n){if(n){var i=g(n.value,n.kind,n.propertyType);if(i>-1){var r=e;r.metadata||(r.metadata={f:{}}),r=r.metadata.f;for(var o=t.split("."),s=0;s<o.length-1;++s)r[o[s]]||(r[o[s]]={f:{}}),r=r[o[s]].f;d(n.value)?r[o[o.length-1]]={a:{t:i}}:r[o[o.length-1]]={t:i}}}},e}(),At=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!==e&&429!==e||501===e||505===e)},e.getMillisToBackoffForRetry=function(e){var t=0,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)},e}(),xt=function(){function e(){this._killedTokenDictionary={}}return e.prototype.setKillSwitchTenants=function(e,t){if(e&&t)try{var n=e.split(",");if("this-request-only"===t)return n;for(var i=1e3*parseInt(t,10),r=0;r<n.length;++r)this._killedTokenDictionary[n[r]]=Date.now()+i}catch(e){return[]}return[]},e.prototype.isTenantKilled=function(e){var t=this._killedTokenDictionary;return void 0!==t[e]&&t[e]>Date.now()||(delete t[e],!1)},e}(),wt=function(){function e(){this._allowRequestSending=!0,this._shouldAddClockSkewHeaders=!0,this._isFirstRequest=!0,this._clockSkewHeaderValue="use-collector-delta",this._clockSkewSet=!1}return e.prototype.allowRequestSending=function(){var e=this;return e._isFirstRequest&&!e._clockSkewSet?(e._isFirstRequest=!1,e._allowRequestSending=!1,!0):e._allowRequestSending},e.prototype.shouldAddClockSkewHeaders=function(){return this._shouldAddClockSkewHeaders},e.prototype.getClockSkewHeaderValue=function(){return this._clockSkewHeaderValue},e.prototype.setClockSkew=function(e){var t=this;t._clockSkewSet||(e?t._clockSkewHeaderValue=e:t._shouldAddClockSkewHeaders=!1,t._clockSkewSet=!0,t._allowRequestSending=!0)},e}(),Ot=ae.arrIndexOf,Nt=ae.arrReduce,ze=ae.toISOString,bt=function(){function e(e){this._requestQueue=e,this._urlString="?cors=true&content-type=application/x-json-stream&client-id=NO_AUTH&client-version="+Re,this._killSwitch=new xt,this._paused=!1,this._clockSkewManager=new wt,this._useBeacons=!1,this._activeConnections=0,this._customHttpInterface=!0,this._queryStringParameters=[]}return e.prototype.initialize=function(e,t,n,i){var r=this;this._urlString="?"==this._urlString[0]?e+this._urlString:this._urlString,this._core=t,this._postManager=n,this._httpInterface=i,this._httpInterface||(this._customHttpInterface=!1,this._useBeacons=!f(),this._httpInterface={sendPOST:function(e,t,n){if(p()){var i=new XDomainRequest;i.open("POST",e.urlString),i.onload=function(){t(200,{},i.responseText),r._handleCollectorResponse(i.responseText)},i.onerror=function(){t(400,{})},i.ontimeout=function(){t(500,{})},i.send(e.data)}else if(f())try{fetch(e.urlString,(s={body:e.data,method:"POST",credentials:"include"},s.Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,s.headers=e.headers,s)).then(function(e){var n={},i="";e.headers&&e.headers.forEach(function(e,t){n[t]=e}),e.body&&e.text().then(function(e){i=e}),t(e.status,n,i),r._handleCollectorResponse(i)}).catch(function(e){t(0,{})})}catch(e){t(0,{})}else if("undefined"!=typeof XMLHttpRequest){var o=new XMLHttpRequest;o.Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,o.withCredentials=!0,o.open("POST",e.urlString,!n),Ne(e.headers).forEach(function(t){o.setRequestHeader(t,e.headers[t])}),o.onload=function(){t(o.status,r._convertAllHeadersToMap(o.getAllResponseHeaders()),o.responseText),r._handleCollectorResponse(o.responseText)},o.onerror=function(){t(o.status,r._convertAllHeadersToMap(o.getAllResponseHeaders()))},o.ontimeout=function(){t(o.status,r._convertAllHeadersToMap(o.getAllResponseHeaders()))},o.send(e.data)}var s}})},e.prototype.addQueryStringParameter=function(e,t){for(var n=0;n<this._queryStringParameters.length;n++)if(this._queryStringParameters[n].name===e)return void(this._queryStringParameters[n].value=t);this._queryStringParameters.push({name:e,value:t})},e.prototype.hasIdleConnection=function(){return this._activeConnections<2},e.prototype.sendQueuedRequests=function(){for(;this.hasIdleConnection()&&!this._paused&&this._requestQueue.length>0&&this._clockSkewManager.allowRequestSending();)this._activeConnections++,this._sendRequest(this._requestQueue.shift(),0,!1);this.hasIdleConnection()&&this._postManager._scheduleTimer()},e.prototype.isCompletelyIdle=function(){return 0===this._activeConnections},e.prototype.teardown=function(){for(;this._requestQueue.length>0;)this._sendRequest(this._requestQueue.shift(),0,!0)},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1,this.sendQueuedRequests()},e.prototype.removeQueuedRequests=function(){this._requestQueue.length=0},e.prototype.sendSynchronousRequest=function(e){this._activeConnections++,this._sendRequest(e,0,!1,!0)},e.prototype._sendRequest=function(e,t,n,i){var o=this;if(void 0===i&&(i=!1),e){if(this._paused)return this._activeConnections--,void this._postManager._addBackRequest(e);var s=0,a="";for(var u in e)e.hasOwnProperty(u)&&(this._killSwitch.isTenantKilled(u)?(this._postManager._notificationManager&&this._postManager._notificationManager.eventsDiscarded(e[u],ne.KillSwitch),delete e[u]):(a.length>0&&(a+=","),a+=u,s++));if(s>0){var l=S(),h=Rt.getPayloadBlob(e,this._postManager._notificationManager),f=S();h.remainingRequest&&this._requestQueue.push(h.remainingRequest);var p=this._urlString+"&apikey="+a+"&upload-time="+Date.now().toString(),d=this._getMsfpc(e);r(d)&&(p=p+"&ext.intweb.msfpc="+d),this._clockSkewManager.shouldAddClockSkewHeaders()&&(p=p+"&time-delta-to-apply-millis="+this._clockSkewManager.getClockSkewHeaderValue()),this._core.getWParam&&(p=p+"&w="+this._core.getWParam());for(_=0;_<this._queryStringParameters.length;_++)p=p+"&"+this._queryStringParameters[_].name+"="+this._queryStringParameters[_].value;var g=S();for(var u in e)if(e.hasOwnProperty(u))for(var _=0;_<e[u].length;++_){var v=e[u][_];v.timings=v.timings||{},v.timings.sendEventStart=v.timings.sendEventStart||{},v.timings.serializationStart=v.timings.serializationStart||{},v.timings.serializationCompleted=v.timings.serializationCompleted||{},v.timings.sendEventStart[this._postManager.identifier]=g,v.timings.serializationStart[this._postManager.identifier]=l,v.timings.serializationCompleted[this._postManager.identifier]=f,v.sendAttempt>0?v.sendAttempt++:v.sendAttempt=1}if(!this._customHttpInterface&&this._useBeacons&&c()&&n)return void this._sendUsingBeacons(p,h.payloadBlob,e);if(this._httpInterface){var m={data:h.payloadBlob,urlString:p,headers:{}},y=function(r){o._httpInterface.sendPOST(r,function(r,u){o._retryRequestIfNeeded(r,u,e,s,a,t,n,i)},n||i)};this.sendHook?this.sendHook(m,y):y(m)}}else n||this._handleRequestFinished(null,{},n,i)}},e.prototype._sendUsingBeacons=function(e,t,n){if(navigator.sendBeacon(e,t))this._handleRequestFinished(!0,n,!0,!0);else for(var i in n)if(n.hasOwnProperty(i))for(var r=0;r<n[i].length;++r){if(!navigator.sendBeacon(e,Rt.getEventBlob(n[i][r])))return;this._notifyEventCompleted(!0,[n[i][r]])}},e.prototype._addEventCompletedTimings=function(e){for(var t=S(),n=0;n<e.length;++n)e[n].timings=e[n].timings||{},e[n].timings.sendEventCompleted=e[n].timings.sendEventCompleted||{},e[n].timings.sendEventCompleted[this._postManager.identifier]=t},e.prototype._retryRequestIfNeeded=function(e,t,n,i,r,o,s,a){var u=this,c=!0;if(void 0!==e){if(t){var l=this._killSwitch.setKillSwitchTenants(t["kill-tokens"],t["kill-duration-seconds"]);this._clockSkewManager.setClockSkew(t["time-delta-millis"]);for(var h=0;h<l.length;++h)this._postManager._notificationManager&&this._postManager._notificationManager.eventsDiscarded(n[l[h]],ne.KillSwitch),delete n[l[h]],i--}else this._clockSkewManager.setClockSkew("");if(200===e)return void this._handleRequestFinished(!0,n,s,a);(!At.shouldRetryForStatus(e)||i<=0)&&(c=!1)}c?a?(this._activeConnections--,this._postManager._addBackRequest(n)):o<1?this._postManager._setTimeoutOverride(function(){return u._sendRequest(n,o+1,!1)},At.getMillisToBackoffForRetry(o)):(this._activeConnections--,this._postManager._backOffTransmission(),this._postManager._addBackRequest(n)):this._handleRequestFinished(!1,n,s,a)},e.prototype._handleRequestFinished=function(e,t,n,i){e&&this._postManager._clearBackOff();for(var r in t)t.hasOwnProperty(r)&&this._notifyEventCompleted(e,t[r],ne.NonRetryableStatus);this._activeConnections--,i||n||this.sendQueuedRequests()},e.prototype._notifyEventCompleted=function(e,t,n){this._addEventCompletedTimings(t),this._postManager._notificationManager&&(e?this._postManager._notificationManager.eventsSent(t):this._postManager._notificationManager.eventsDiscarded(t,n))},e.prototype._convertAllHeadersToMap=function(e){var t={};if(o(e))for(var n=e.split("\n"),i=0;i<n.length;++i){var r=n[i].split(": ");t[r[0]]=r[1]}return t},e.prototype._getMsfpc=function(e){for(var t in e)if(e.hasOwnProperty(t))for(var n=0;n<e[t].length;++n)if(e[t][n].ext&&e[t][n].ext.intweb&&r(e[t][n].ext.intweb.msfpc))return encodeURIComponent(e[t][n].ext.intweb.msfpc);return""},e.prototype._handleCollectorResponse=function(e){try{var t=JSON.parse(e);r(t.webResult)&&r(t.webResult.msfpc)&&v("MSFPC",t.webResult.msfpc,365)}catch(e){}},e}(),Dt=function(){function e(e,t){this._outboundQueue=e,this._maxNumberOfEvents=t,this._currentBatch={},this._currentNumEventsInBatch=0}return e.prototype.addEventToBatch=function(e){var t=this,n=e.iKey;if(n){if(e.sync){var i={};return i[n]=[e],i}t._currentNumEventsInBatch>=t._maxNumberOfEvents&&t.flushBatch();var r=t._currentBatch;void 0===r[n]&&(r[n]=[]),r[n].push(e),t._currentNumEventsInBatch++}return null},e.prototype.flushBatch=function(){var e=this;e._currentNumEventsInBatch>0&&(e._outboundQueue.push(e._currentBatch),e._currentBatch={},e._currentNumEventsInBatch=0)},e.prototype.hasBatch=function(){return this._currentNumEventsInBatch>0},e}(),Pt=500,Mt=De?window:void 0,kt=function(e){function n(){var t=e.call(this)||this;return t.identifier="PostChannel",t.priority=1011,t.version="2.2.0",t._isTeardownCalled=!1,t._isCurrentlyFlushingNow=!1,t._flushQueue=[],t._databaseAdded=!1,t._paused=!1,t._queueSize=0,t._queueSizeLimit=1e4,t._profiles={},t._currentProfile=Ct,t._timeout=null,t._currentBackoffCount=0,t._timerCount=0,t._flushCallback=-1,t._flushOutboundQueue=[],t._outboundQueue=[],t._inboundQueues={},t._inboundQueues[Se.RealTime]=[],t._inboundQueues[Se.CostDeferred]=[],t._inboundQueues[Se.Normal]=[],t._initializeProfiles(),t._addEmptyQueues(),t._batcher=new Dt(t._outboundQueue,Pt),t._syncFlushBatcher=new Dt(t._flushOutboundQueue,Pt),t._httpManager=new bt(t._outboundQueue),t}return t(n,e),n.prototype.initialize=function(t,n,i){var o=this;e.prototype.initialize.call(this,t,n,i),this.setInitialized(!1);var s=this._getTelCtx();t.extensionConfig[this.identifier]=t.extensionConfig[this.identifier]||{},this._config=s.getExtCfg(this.identifier),this._setTimeoutOverride=this._config.setTimeoutOverride?this._config.setTimeoutOverride:setTimeout.bind(Mt),this._clearTimeoutOverride=this._config.clearTimeoutOverride?this._config.clearTimeoutOverride:clearTimeout.bind(Mt),this._config.eventsLimitInMem>0&&(this._queueSizeLimit=this._config.eventsLimitInMem),this._config.httpXHROverride&&this._config.httpXHROverride.sendPOST&&(this._xhrOverride=this._config.httpXHROverride),r(t.anonCookieName)&&this._httpManager.addQueryStringParameter("anoncknm",t.anonCookieName),this._httpManager.sendHook=this._config.payloadPreprocessor;var a=this._config.overrideEndpointUrl?this._config.overrideEndpointUrl:t.endpointUrl;this._notificationManager=t.extensionConfig.NotificationManager,this._httpManager.initialize(a,this.core,this,this._xhrOverride);for(var u=0;u<i.length;++u)i[u].identifier&&"LocalStorage"===i[u].identifier&&(this._databaseAdded=!0);x(function(){o.releaseAllQueuesUsingBeacons()}),this.setInitialized(!0)},n.prototype.processTelemetry=function(e,t){w(e,this.identifier);var n=(t=this._getTelCtx(t)).getExtCfg(this.identifier),i=!1;ae.isNullOrUndefined(this._config.disableTelemetry)&&(i=this._config.disableTelemetry),n&&ae.isNullOrUndefined(n.disableTelemetry)&&(i=n.disableTelemetry);var r=e;if(!i&&!this._isTeardownCalled){if(this._config.overrideInstrumentationKey&&(r.iKey=this._config.overrideInstrumentationKey),n&&n.overrideInstrumentationKey&&(r.iKey=n.overrideInstrumentationKey),r.sendAttempt||(r.sendAttempt=0),r.latency||(r.latency=Se.Normal),r.ext&&r.ext.trace&&delete r.ext.trace,r.ext&&r.ext.user&&r.ext.user.id&&delete r.ext.user.id,r.sync)if(this._currentBackoffCount>0||this._paused)r.latency=Se.RealTime,r.sync=!1;else if(this._httpManager)return void this._httpManager.sendSynchronousRequest(this._batcher.addEventToBatch(r));this._queueSize<this._queueSizeLimit?this._addEventToProperQueue(r):this._dropEventWithLatencyOrLess(r.latency)?this._addEventToProperQueue(r):this._notificationManager&&this._notificationManager.eventsDiscarded([r],ne.QueueFull),this._scheduleTimer()}this.processNext(r,t)},n.prototype.teardown=function(){this.releaseAllQueuesUsingBeacons(),this._isTeardownCalled=!0},n.prototype.pause=function(){this._clearTimeout(),this._paused=!0,this._httpManager.pause(),this._databaseAdded&&(this._queueSize-=this._inboundQueues[Se.RealTime][0].length+this._inboundQueues[Se.CostDeferred][0].length+this._inboundQueues[Se.Normal][0].length,this._inboundQueues[Se.RealTime][0]=[],this._inboundQueues[Se.CostDeferred][0]=[],this._inboundQueues[Se.Normal][0]=[],this._httpManager.removeQueuedRequests())},n.prototype.resume=function(){this._paused=!1,this._httpManager.resume(),this._scheduleTimer()},n.prototype._loadTransmitProfiles=function(e){this._resetTransmitProfiles();for(var t in e)if(e.hasOwnProperty(t)){if(e[t].length<2)continue;if(e[t].splice(0,e[t].length-2),e[t][1]<0&&(e[t][0]=-1),e[t][1]>0&&e[t][0]>0){var n=e[t][0]/e[t][1];e[t][0]=Math.ceil(n)*e[t][1]}this._profiles[t]=e[t]}},n.prototype.flush=function(e,t){var n=this;if(void 0===e&&(e=!0),!this._paused)if(this._clearTimeout(),e)this._addEmptyQueues(),this._isCurrentlyFlushingNow?this._flushQueue.push(t):(this._isCurrentlyFlushingNow=!0,this._setTimeoutOverride(function(){return n._flushImpl(t)},0));else{this._batchEvents(Se.Normal,this._syncFlushBatcher);for(var i=0;i<this._flushOutboundQueue.length;i++)this._httpManager.sendSynchronousRequest(this._flushOutboundQueue[i]);null!==t&&void 0!==t&&t()}},n.prototype.setMsaAuthTicket=function(e){this._httpManager.addQueryStringParameter("AuthMsaDeviceTicket",e)},n.prototype._setTransmitProfile=function(e){this._currentProfile!==e&&void 0!==this._profiles[e]&&(this._clearTimeout(),this._currentProfile=e,this._scheduleTimer())},n.prototype._sendEventsForLatencyAndAbove=function(e){this._batchEvents(e),this._httpManager.sendQueuedRequests()},n.prototype._hasEvents=function(){return(this._inboundQueues[Se.RealTime][0].length>0||this._inboundQueues[Se.CostDeferred][0].length>0||this._inboundQueues[Se.Normal][0].length>0||this._batcher.hasBatch())&&this._httpManager.hasIdleConnection()},n.prototype._addBackRequest=function(e){if(!this._paused||!this._databaseAdded)for(var t in e)if(e.hasOwnProperty(t)){1===e[t].length&&e[t][0].sync&&(e[t][0].latency=Se.RealTime,e[t][0].sync=!1);for(var n=0;n<e[t].length;++n)e[t][n].sendAttempt<6?this.processTelemetry(e[t][n]):this._notificationManager&&this._notificationManager.eventsDiscarded([e[t][n]],ne.NonRetryableStatus)}},n.prototype._scheduleTimer=function(){var e=this,t=this._profiles[this._currentProfile][1];if(!this._timeout&&t>=0&&!this._paused)if(this._hasEvents()){0===t&&this._currentBackoffCount>0&&(t=1);var n=1e3;this._currentBackoffCount>0&&(n=At.getMillisToBackoffForRetry(this._currentBackoffCount-1)),this._timeout=this._setTimeoutOverride(function(){return e._batchAndSendEvents()},t*n)}else this._timerCount=0},n.prototype._backOffTransmission=function(){this._currentBackoffCount<4&&(this._currentBackoffCount++,this._clearTimeout(),this._scheduleTimer())},n.prototype._clearBackOff=function(){this._currentBackoffCount>0&&(this._currentBackoffCount=0,this._clearTimeout(),this._scheduleTimer())},n.prototype._clearTimeout=function(){this._timeout&&(this._clearTimeoutOverride(this._timeout),this._timeout=null,this._timerCount=0)},n.prototype._batchAndSendEvents=function(){var e=Se.RealTime;2===++this._timerCount&&(e=Se.Normal,this._timerCount=0),this._sendEventsForLatencyAndAbove(e),this._timeout=null,this._scheduleTimer()},n.prototype.releaseAllQueuesUsingBeacons=function(){this._clearTimeout(),this._flushCallback>0&&this._clearTimeoutOverride(this._flushCallback),this._paused||this._databaseAdded||(this._mergeQueues(),this._batchEvents(Se.Normal),this._httpManager.teardown())},n.prototype._removeFirstQueues=function(){this._inboundQueues[Se.RealTime].shift(),this._inboundQueues[Se.CostDeferred].shift(),this._inboundQueues[Se.Normal].shift()},n.prototype._addEmptyQueues=function(){this._inboundQueues[Se.RealTime].push([]),this._inboundQueues[Se.CostDeferred].push([]),this._inboundQueues[Se.Normal].push([])},n.prototype._mergeQueues=function(){for(var e=Se.Normal;e<=Se.RealTime;e++)for(var t=1;t<this._inboundQueues[e].length;t++)for(;this._inboundQueues[e][t].length>0;)this._inboundQueues[e][0].push(this._inboundQueues[e][t].pop())},n.prototype._addEventToProperQueue=function(e){this._paused&&this._databaseAdded||(this._queueSize++,this._inboundQueues[e.latency][this._inboundQueues[e.latency].length-1].push(e))},n.prototype._dropEventWithLatencyOrLess=function(e){for(var t=Se.Normal;t<=e;){if(this._inboundQueues[t][this._inboundQueues[t].length-1].length>0){var n=this._inboundQueues[t][this._inboundQueues[t].length-1].splice(0,20);return this._notificationManager&&this._notificationManager.eventsDiscarded(n,ne.QueueFull),!0}t++}return!1},n.prototype._batchEvents=function(e,t){void 0===t&&(t=this._batcher);for(var n=Se.RealTime;n>=e;){for(;this._inboundQueues[n][0].length>0;){var i=this._inboundQueues[n][0].pop();this._queueSize--,t.addEventToBatch(i)}n--}t.flushBatch()},n.prototype._flushImpl=function(e){var t=this;this._hasEvents()&&this._sendEventsForLatencyAndAbove(Se.Normal),this._checkOutboundQueueEmptyAndSent(function(){t._removeFirstQueues(),null!==e&&void 0!==e&&e(),t._flushQueue.length>0?t._flushCallback=t._setTimeoutOverride(function(){return t._flushImpl(t._flushQueue.shift())},0):(t._isCurrentlyFlushingNow=!1,t._hasEvents()&&t._scheduleTimer())})},n.prototype._checkOutboundQueueEmptyAndSent=function(e){var t=this;this._httpManager.isCompletelyIdle()?e():this._flushCallback=this._setTimeoutOverride(function(){return t._checkOutboundQueueEmptyAndSent(e)},250)},n.prototype._resetTransmitProfiles=function(){this._clearTimeout(),this._initializeProfiles(),this._currentProfile=Ct,this._scheduleTimer()},n.prototype._initializeProfiles=function(){this._profiles={},this._profiles[Ct]=[2,1],this._profiles.NEAR_REAL_TIME=[6,3],this._profiles.BEST_EFFORT=[18,9]},n}(Tt),oe="prototype",Bt=Object.freeze({Version:"2.2.0",FullVersionString:Re,Undefined:Ae,arrForEach:Oe,arrIndexOf:Ot,arrReduce:Nt,objKeys:Ne,toISOString:ze,isDocumentObjectAvailable:be,isWindowObjectAvailable:De,isValueAssigned:r,isString:o,isNumber:s,isBoolean:a,getTenantId:u,isBeaconsSupported:c,isLatency:l,sanitizeProperty:h,isReactNative:f,useXDomainRequest:p,isArray:d,getCommonSchemaMetaData:g,cookieAvailable:_,setCookie:v,deleteCookie:m,getCookie:y,getTime:S,objDefineAccessors:Pe,addPageUnloadEventListener:x,setProcessTelemetryTimings:w,addEventHandler:P,EventHelper:Le}),Lt="version",Wt="properties",Vt=function(){return function(e){this._setOverride=function(t,n){e.setOverride(t,n)},this._getOverride=function(t){return e.getOverride(t)}}}(),Ut=function(e){function n(t,n){var i=e.call(this,t)||this,r=i;return r.setId=function(e){r._setOverride(nt.id,e)},r.getId=function(){return r._getOverride(nt.id)},r.setVer=function(e){r._setOverride(nt.ver,e)},r.getVer=function(){return r._getOverride(nt.ver)},r.setName=function(e){r._setOverride(nt.appName,e)},r.getName=function(){return r._getOverride(nt.appName)},r.setLocale=function(e){r._setOverride(nt.locale,e)},r.getLocale=function(){return r._getOverride(nt.locale)},r.setEnv=function(e){r._setOverride(nt.env,e)},r.getEnv=function(){return r._getOverride(nt.env)},r.setExpId=function(e){r._setOverride(nt.expId,Ve.validateAppExpId(e))},r.getExpId=function(){return r._getOverride(nt.expId)},n&&(N(n.env)||r.setEnv(n.env),ae.isNullOrUndefined(n.expId)||r.setExpId(n.expId)),i}return t(n,e),n}(Vt),Ft=function(e){function n(t){var n=e.call(this,t)||this,i=n;return i.setProperty=function(e,t){i._setOverride(e,t)},i.getProperty=function(e){return i._getOverride(e)},n}return t(n,e),n}(Vt),zt=function(e){function n(t){var n=e.call(this,t)||this,i=n;return i.setLocalId=function(e){i._setOverride(ht.localId,e)},i.getLocalId=function(){return i._getOverride(ht.localId)},i.setDeviceClass=function(e){i._setOverride(ht.deviceClass,e)},i.getDeviceClass=function(){return i._getOverride(ht.deviceClass)},i.setMake=function(e){i._setOverride(ht.make,e)},i.getMake=function(){return i._getOverride(ht.make)},i.setModel=function(e){i._setOverride(ht.model,e)},i.getModel=function(){return i._getOverride(ht.model)},n}return t(n,e),n}(Vt),Gt=function(e){function n(t,n){var i=e.call(this,t)||this,r=i;if(r.setOsName=function(e){r._setOverride(ot.osName,e)},r.getOsName=function(){return r._getOverride(ot.osName)},r.setVer=function(e){r._setOverride(ot.ver,e)},r.getVer=function(){return r._getOverride(ot.ver)},n&&n.userAgent&&n.populateOperatingSystemInfo){var o=new Xe(n);r.setOsName(o.name),r.setVer(o.ver)}return i}return t(n,e),n}(Vt),b=ae.isNullOrUndefined,Oe=ae.arrForEach,qt=function(){return function(e){var t=this,n=[];t.setOverride=function(e,t){e&&n.push({key:e,value:t})},t.hasOverride=function(e){var t=!1;return Oe(n,function(n){n.key===e&&(t=!0)}),t},t.getOverride=function(e){var t;return Oe(n,function(n){n.key===e&&(t=n.value)}),t},t.applyOverrides=function(t,i){if(n.length>0)try{var r=J(t,e);Oe(n,function(e){Z(r,e.key,e.value)})}catch(e){}}}}(),Ht=function(e){function n(t){var n=e.call(this,t)||this,i=n;return i.setLocalId=function(e){i._setOverride(rt.localId,e)},i.getLocalId=function(){return i._getOverride(rt.localId)},i.setLocale=function(e){i._setOverride(rt.locale,e)},i.getLocale=function(){return i._getOverride(rt.locale)},i.setId=function(e){i._setOverride(rt.id,e)},i.getId=function(){return i._getOverride(rt.id)},n}return t(n,e),n}(Vt),Kt=function(e){function n(t,n){var i=e.call(this,t)||this,r=i;return r.setDomain=function(e){r._setOverride(it.domain,e)},r.getDomain=function(){return r._getOverride(it.domain)},r.setBrowser=function(e){r._setOverride(it.browser,e)},r.getBrowser=function(){return r._getOverride(it.browser)},r.setBrowserVer=function(e){r._setOverride(it.browserVer,e)},r.getBrowserVer=function(){return r._getOverride(it.browserVer)},r.setScreenRes=function(e){r._setOverride(it.screenRes,e)},r.getScreenRes=function(){return r._getOverride(it.screenRes)},r.setUserConsent=function(e){r._setOverride(it.userConsent,e)},r.getUserContext=function(){return r._getOverride(it.userConsent)},n&&(N(n.userConsented)||r.setUserConsent(n.userConsented)),i}return t(n,e),n}(Vt),jt="ext",Qt="data",Xt=function(){return function(e,t,n){function i(e){for(var t="",n=0;n<e.length;n++)t&&(t+="_"),t+=e[n];return N(o[t])&&(o[t]=new qt(e)),t?o[t]:null}var r=this,o={};r.data=new Ft(i([Qt])),r.app=new Ut(i([jt,pt.AppExt]),t),r.user=new Ht(i([jt,pt.UserExt])),r.os=new Gt(i([jt,pt.OSExt]),t),r.web=new Kt(i([jt,pt.WebExt]),t),r.device=new zt(i([jt,pt.DeviceExt])),r.applyOverrides=function(e,t){var n=Ne(o);n&&n.length>0&&Bt.arrForEach(n,function(n){o[n].applyOverrides(e,t)})}}}(),Jt=function(e){function n(){var t=e.call(this)||this;t.identifier="OverridePropertiesPlugin",t.priority=4,t.version="1.0.0";var n=t,i=null;return n._baseInit=function(e,n,r){i=new Xt(e,t._getTelCtx().getExtCfg(t.identifier),n)},n.setProperty=function(e,t){i&&i.data.setProperty(e,t)},n.getOverrideContext=function(){return i},t}return t(n,e),n.prototype.initialize=function(t,n,i){e.prototype.initialize.call(this,t,n,i),this._baseInit(t,n,i)},n.prototype.processTelemetry=function(e,t){w(e,this.identifier),t=this._getTelCtx(t);var n=this.getOverrideContext();n&&n.applyOverrides(e,t),this.processNext(e,t)},n}(Tt),Zt=function(){return function(){function e(e,t){if(void 0===t&&(t=null),e){($(e)?_:g).push(e);var n=e.identifier;f.extensionConfig[n]=f.extensionConfig[n]||{},Y(f.extensionConfig[n],t)}return e}function t(){var t=f.channels||[[]],n=new kt,i=n.identifier,r=!1;u=null,c=null,ae.arrForEach(t,function(t){ae.arrForEach(t,function(t){e(t),t.identifier===i&&(r=!0,u=t)})}),r||(t[0].push(n),u=e(n,f.channelConfiguration)),f.channels=t}function n(t){p=[],a=e(new Et,f.propertyConfiguration),p.push(a),f.extensions&&ae.arrForEach(f.extensions,function(t){e(t)}),t&&(ae.arrForEach(t,function(t){e(t)}),p=p.concat(t))}function i(e){var t=[[]];if(f.channels)for(var n in f.channels)t[n]=t[n]||[],t[n]=t[n].concat(f.channels[n]);if(e&&e.channels)for(var n in e.channels)t[n]=t[n]||[],t[n]=t[n].concat(e.channels[n]);return t}function r(e){var t=[];f.extensions&&f.extensions.length>0&&(t=t.concat(f.extensions)),e&&e.extensions&&e.extensions.length>0&&(t=t.concat(e.extensions)),t.length>0&&(e.extensions=t),e.extensionConfig=e.extensionConfig||{},Y(e.extensionConfig,f.extensionConfig)}function o(e,t){var n={};return n.instrumentationKey=e,n.channels=i(t),r(n),Y(n,t),Y(n,f),n}function s(e){var t=[];return p&&p.length>0&&(t=t.concat(p)),e&&e.length>0&&(t=t.concat(e)),t}var a,u,c,l,h=this,f={},p=[],d=null,g=[],_=[],v={};h.diagLog=function(){return l||(l=new ve(f)),l},h.create=function(e,i){f=e||{},t(),n(i)},h.getInst=function(e){return v[e]},h.newInst=function(e,t,n){var i=h.getInst(e);if(i)return h.diagLog().throwInternal(te.WARNING,Ce.FailedToInitializeSDK,"Instance already exists for ["+e+"]"),i;if(!d){var r=o(e,{});(d=new Yt(h)).initialize(r,p),u&&(c=ee(u.identifier,r))}var a=o(e,t);if(u){var l=ee(u.identifier,a);c&&l&&c!=l&&h.diagLog().throwInternal(te.WARNING,Ce.ErrorProvidedChannels,"The endpointUrl mismatch, shared Url ["+c+"] is different from configured ["+l+"] shared will be used!")}return i=new Yt(h),v[e]=i,i.initialize(a,s(n)),i},h.getSharedPlugin=function(e){var t=null;return ae.arrForEach(g,function(n){e==n.identifier&&(t=n)}),t||ae.arrForEach(_,function(n){e==n.identifier&&(t=n)}),t},h.getPropertyManager=function(){return a},h.getPostChannel=function(){return u}}}(),Yt=function(e){function n(t){var n=e.call(this)||this,i=n,r=t;return i.getSharedPropertyManager=function(){return r.getPropertyManager()},i.getSharedPostChannel=function(){return r.getPostChannel()},i.getOverridePropertyManager=function(){return n._overrideProperties},n}return t(n,e),n.prototype.initialize=function(t,n){this._overrideProperties=new Jt;var i=[this._overrideProperties];n&&(i=i.concat(n)),t.extensionConfig=t.extensionConfig||[];var r=t.propertyConfiguration||{};t.propertyConfiguration&&delete t.propertyConfiguration,t.extensionConfig[this._overrideProperties.identifier]=r;try{e.prototype.initialize.call(this,t,i)}catch(e){this.logger.throwInternal(te.CRITICAL,Ce.FailedToInitializeSDK,"Failed to initialize SDK."+e)}},n}(me);e.ValueKind=ye,e.EventLatency=Se,e.EventPersistence=Te,e.TraceLevel=Ee,e.MinChannelPriorty=100,e.NotificationManager=pe,e.EventsDiscardedReason=ne,e.CoreUtils=ae,e.DiagnosticLogger=ve,e.isValueAssigned=r,e.isArray=d,e.isBeaconsSupported=c,e.isBoolean=a,e.isLatency=l,e.isNumber=s,e.isReactNative=f,e.isString=o,e.cookieAvailable=_,e.PropertiesPlugin=Et,e.Extensions=pt,e.AppExtensionKeys=nt,e.WebExtensionKeys=it,e.UserExtensionKeys=rt,e.OSExtKeys=ot,e.DeviceExtKeys=ht,e.OperatingSystem=Xe,e.Application=Ve,e.Device=$e,e.Session=et,e.defaultFlightIdNameSpaces=We,e.TelemetryContext=vt,e.PostChannel=kt,e.Serializer=Rt,e.BE_PROFILE="BEST_EFFORT",e.NRT_PROFILE="NEAR_REAL_TIME",e.RT_PROFILE=Ct,e.ApplicationInsightsManager=Zt,e.ApplicationInsights=Yt,e.OverridePropertiesPlugin=Jt,e.BaseTelemetryPlugin=Tt,e.ProcessTelemetryContext=St,e.EventsDiscardedReason=ne,e.DiagnosticLogger=ve,e.LoggingSeverity=te,e.ValueKind=ye,e.Utils=Bt,e.AppInsightsCore=me,e.BaseCore=fe,e._ExtendedInternalMessageId=Ce,e.EventPropertyType=Ie,e.isValueAssigned=r,e.isArray=d,e.isLatency=l,e.isNumber=s,e.getTenantId=u,e.sanitizeProperty=h,e.Version="2.2.0",e.FullVersionString=Re,e.Undefined=Ae,e.getCommonSchemaMetaData=g,e.getCookie=y,e.setCookie=v,e.deleteCookie=m,e.useXDomainRequest=p,e.isDocumentObjectAvailable=be,e.isWindowObjectAvailable=De,e.objDefineAccessors=Pe,e.addPageUnloadEventListener=x,e.EventHelper=Le,e.addEventHandler=P,e.setProcessTelemetryTimings=w,e.getTime=S,e.objKeys=Ne,e.PostChannel=kt,e.Serializer=Rt,e.BE_PROFILE="BEST_EFFORT",e.NRT_PROFILE="NEAR_REAL_TIME",e.RT_PROFILE=Ct,e.HttpManager=bt,e.RecordBatcher=Dt,e.RetryPolicy=At,e.ClockSkewManager=wt,e.KillSwitch=xt,e.PropertiesPlugin=Et,e.Extensions=pt,e.AppExtensionKeys=nt,e.WebExtensionKeys=it,e.UserExtensionKeys=rt,e.OSExtKeys=ot,e.DeviceExtKeys=ht,e.OperatingSystem=Xe,e.Application=Ve,e.Device=$e,e.Session=et,e.defaultFlightIdNameSpaces=We,e.MinChannelPriorty=100,e.EventsDiscardedReason=ne,e.AppInsightsCore=me,e.CoreUtils=ae,e.NotificationManager=pe,e.DiagnosticLogger=ve,e._InternalLogMessage=_e,e._InternalMessageId=ge,Object.defineProperty(e,"__esModule",{value:!0})});var PerfDetectWebWorker=function(){function e(){}return e.prototype.initialize=function(e){e.registerEventListener("runBenchMarkPerformanceDetectStrategy",function(){for(var t=Date.now(),n=1e5;n>0;)n--;var i={name:"handleBenchMarkPerformanceDetectStrategy",params:{elapse:Date.now()-t}};e.postMessageToUiThread(i)})},e}(),recCount=0,OldAriaTransporter=function(){function e(){this.telemetry=new microsoft.applications.telemetry._sender.TelemetryManagerImpl,this.ariaLoggers={},this.enableHideAria=!1,microsoft.applications.telemetry.globalTelemetryManager=this.telemetry}return e.prototype.initialize=function(e){this.enableHideAria=e.enableHideAria,this.telemetry.Initialize(e.config);var t=e.config.onEventsSent;t&&this.telemetry.AddListener(function(e,n,i,r,o){return t({dataSizeInEvents:r&&r.length||0,dataSizeInBytes:o})}),microsoft.applications.telemetry.LogManager.initialize(e.documentInfo,e.appToken)},e.prototype.start=function(){this.telemetry.Start()},e.prototype.stop=function(){this.telemetry.Stop()},e.prototype.pause=function(){this.telemetry.Pause()},e.prototype.resume=function(){this.telemetry.Resume()},e.prototype.flush=function(e){var t=this,n=8,i=function(){var r=t.telemetry._eventsCache.IsEmpty(),o=0==--n;r||o?e.postMessageToUiThread({name:"flushed"}):t.telemetry.Flush(i)};i()},e.prototype.createNewLogger=function(e,t){this.ariaLoggers[e]=new microsoft.applications.telemetry.Logger(t)},e.prototype.logEvent=function(e,t){if(e&&t){var n;if(this.enableHideAria){(n=new microsoft.applications.telemetry.EventProperties).name=t.name,n.eventType=t.eventType,n.timestamp=t.timestamp;var i=t.properties;for(var r in i){var o=i[r],s=o.pii;n.setProperty(o.name,o.value,s)}}else n=t;this.ariaLoggers[e].logEvent(n)}},e.prototype.logSession=function(e,t){var n=this.ariaLoggers[t.name],i=t.state;n.logSession(i,t.properties),e.postMessageToUiThread({name:"sessionId",params:{name:t.name,sessionId:n.getSessionId()}})},e.prototype.setContext=function(e){var t=e.pii;microsoft.applications.telemetry.LogManager.setContext(e.key,e.value,t)},e.prototype.setUserId=function(e){microsoft.applications.telemetry.LogManager.getSemanticContext().setUserId(e)},e.prototype.changeMaxPackageSizeInKB=function(e){},e.prototype.disableTestHook=function(){microsoft.applications.telemetry.LogManager.__clearTestHookListener()},e.prototype.enableTestHook=function(e,t){microsoft.applications.telemetry.LogManager.__addTestHookListener(function(n){n.forEach(function(n){if(t&&t.eventTypes&&t.eventTypes.indexOf(n.EventType)>-1){var i={};n.Extension._buffer.forEach(function(e){i[e.Key]=e.Value}),i.EventType=n.EventType,i.Type=n.Type,e.postMessageToUiThread({name:"telemetryTestHook",params:{event:i}})}})})},e}(),OneDsTransporter=function(){function e(){this.oneDsLoggers={}}return e.prototype.initialize=function(e){this.initParams=e;var t={instrumentationKey:e.appToken,endpointUrl:this.initParams.oneDsCollectorUrl,extensions:[],extensionConfig:[]};this.oneDsManager=new oneDS.ApplicationInsightsManager,this.oneDsManager.create(t),this.createNewLogger("default",e.appToken)},e.prototype.start=function(){this.resume()},e.prototype.stop=function(){this.pause()},e.prototype.pause=function(){this.oneDsManager.getPostChannel().pause()},e.prototype.resume=function(){this.oneDsManager.getPostChannel().resume()},e.prototype.flush=function(e){var t=Object.values(this.oneDsLoggers).length,n=0;this.oneDsManager.getPostChannel().flush(!0,function(){++n==t&&e.postMessageToUiThread({name:"flushed"})})},e.prototype.createNewLogger=function(e,t){var n,i=this.oneDsManager.newInst(t);this.oneDsManager.getPostChannel()._loadTransmitProfiles((n={},n.MSTeamsFix15SecondsProfile=[this.initParams.normalPrioritySendTimeInSecs,this.initParams.highPrioritySendTimeInSecs],n)),this.oneDsManager.getPostChannel()._setTransmitProfile("MSTeamsFix15SecondsProfile");var r=this.initParams.config.onEventsSent;r&&i.addNotificationListener({eventsSent:function(e){var t=JSON.stringify(e);r({dataSizeInEvents:e.length,dataSizeInBytes:t.length})}}),this.oneDsLoggers[e]=i},e.prototype.logEvent=function(e,t){if(e&&t){var n=this.oneDsLoggers[e];if(n){var i=t.properties,r={};for(var o in i){var s=i[o],a={value:s.value,kind:s.pii};r[o]=a}var u=new Date(t.timestamp).toISOString(),c={name:t.name,baseType:t.eventType,time:u,data:r};n.track(c)}}},e.prototype.logSession=function(e,t){if(this.oneDsLoggers.default&&e){var n="";if(this.initParams.enableOneDsCustomSessionId)n=microsoft.applications.telemetry.datamodels.utils.GetGuid(),this.oneDsManager.getPropertyManager().getPropertiesContext().session.setId(n),this.setContext({value:n,key:"Session.Id"});else{var i=this.oneDsManager.getPropertyManager().getPropertiesContext(),r=i&&i.session;n=r&&r.getId()}this.initParams.appToken2||e.postMessageToUiThread({name:"sessionId",params:{name:t.name,sessionId:n}})}},e.prototype.setContext=function(e){var t={value:e.value,kind:e.pii};this.oneDsManager.getPropertyManager().setProperty(e.key,t)},e.prototype.setUserId=function(e){this.oneDsManager.getPropertyManager().getPropertiesContext().user.localId="a:"+e},e.prototype.changeMaxPackageSizeInKB=function(e){},e.prototype.disableTestHook=function(){},e.prototype.enableTestHook=function(e,t){Object.values(this.oneDsLoggers).forEach(function(n){n.addNotificationListener({eventsSent:function(n){n.forEach(function(n){if(t&&t.eventTypes&&t.eventTypes.indexOf(n.name)>-1){var i=n.data,r={};for(var o in i){var s=i[o];r[o]=s.value}r.EventType=n.name,r.Type=n.baseType,r["UserInfo.Id"]=n.ext.user.localId,e&&e.postMessageToUiThread({name:"telemetryTestHook",params:{event:r}})}})}})})},e}(),AriaAndOneDsTransporter=function(){function e(e){this.initParams=e,this.transports=[],this.testTransporterIndex=0,this.productionTransporterIndex=1,this.transports.push(new OneDsTransporter),this.transports.push(new OldAriaTransporter)}return e.prototype.initialize=function(e){var t=e.appToken;e.appToken=e.appToken2,this.transports[this.testTransporterIndex].initialize(e),e.appToken=t,this.transports[this.productionTransporterIndex].initialize(e)},e.prototype.start=function(){for(var e=0;e<this.transports.length;++e)this.transports[e].start()},e.prototype.stop=function(){for(var e=0;e<this.transports.length;++e)this.transports[e].stop()},e.prototype.pause=function(){for(var e=0;e<this.transports.length;++e)this.transports[e].pause()},e.prototype.resume=function(){for(var e=0;e<this.transports.length;++e)this.transports[e].resume()},e.prototype.flush=function(e){for(var t=0;t<this.transports.length;++t)this.transports[t].flush(e)},e.prototype.createNewLogger=function(e,t){this.transports[this.testTransporterIndex].createNewLogger(e,this.initParams.appToken2),this.transports[this.productionTransporterIndex].createNewLogger(e,t)},e.prototype.logEvent=function(e,t){var n=microsoft.applications.telemetry.datamodels.utils.GetGuid();t.properties.sdkCompareId={name:"sdkCompareId",value:n};for(var i=0;i<this.transports.length;++i)this.transports[i].logEvent(e,t)},e.prototype.logSession=function(e,t){for(var n=0;n<this.transports.length;++n)this.transports[n].logSession(e,t)},e.prototype.setContext=function(e){for(var t=0;t<this.transports.length;++t)this.transports[t].setContext(e)},e.prototype.setUserId=function(e){for(var t=0;t<this.transports.length;++t)this.transports[t].setUserId(e)},e.prototype.changeMaxPackageSizeInKB=function(e){for(var t=0;t<this.transports.length;++t)this.transports[t].changeMaxPackageSizeInKB(e)},e.prototype.disableTestHook=function(){for(var e=0;e<this.transports.length;++e)this.transports[e].disableTestHook()},e.prototype.enableTestHook=function(e,t){for(var n=0;n<this.transports.length;++n)this.transports[n].enableTestHook(e,t)},e}(),TelemetryWebWorker=function(){function e(){}return e.prototype.initialize=function(e){var t=this;this.workerManager=e,e.registerEventListener("initialize",function(n){n.config&&(n.config.log=t),n.appToken2&&n.enableOneDsSdk&&n.enableHideAria?t.telemetryTransport=new AriaAndOneDsTransporter(n):n.enableOneDsSdk&&n.enableHideAria?t.telemetryTransport=new OneDsTransporter:t.telemetryTransport=new OldAriaTransporter,n.config.onEventsSent=function(t){e.postMessageToUiThread({name:"eventsSent",params:t})},t.telemetryTransport.initialize(n)}),e.registerEventListener("start",function(e){t.telemetryTransport.start()}),e.registerEventListener("stop",function(e){t.telemetryTransport.stop()}),e.registerEventListener("flush",function(n){t.telemetryTransport.flush(e)}),e.registerEventListener("pause",function(e){t.telemetryTransport.pause()}),e.registerEventListener("resume",function(e){t.telemetryTransport.resume()}),e.registerEventListener("newLogger",function(e){t.telemetryTransport.createNewLogger(e.name,e.token)}),e.registerEventListener("changeMaxPackageSizeInKB",function(e){t.telemetryTransport.changeMaxPackageSizeInKB(e.size)}),e.registerEventListener("logEvent",function(e){++recCount,t.telemetryTransport.logEvent(e.name,e.eventProperties)}),e.registerEventListener("logSession",function(e){t.telemetryTransport.logSession(t.workerManager,e)}),e.registerEventListener("setContext",function(e){t.telemetryTransport.setContext(e)}),e.registerEventListener("setUserId",function(e){t.telemetryTransport.setUserId(e.id)}),e.registerEventListener("disableTestHook",function(e){t.telemetryTransport.disableTestHook()}),e.registerEventListener("enableTestHook",function(n){t.telemetryTransport.enableTestHook(e,n)})},e.prototype.Verbose=function(e){},e.prototype.Info=function(e){this.workerManager&&this.workerManager.logInfo(e)},e.prototype.Error=function(e){this.workerManager&&this.workerManager.logError(e)},e}(),WebWorkerManager=function(){function e(){var e=this;this.messageHandlers={},this.worker=self,this.worker.addEventListener("message",function(t){if(t&&t.data&&t.data.name){var n=e.messageHandlers[t.data.name];n?n(t.data.params):e.logError("Unhandled webworker message - "+JSON.stringify(t.data))}})}return e.prototype.setupRegistrations=function(e){for(var t=0,n=e;t<n.length;t++)n[t].initialize(this)},e.prototype.registerEventListener=function(e,t){this.messageHandlers[e]?this.logError("Detected duplicate event listener registered to the same key: "+e+"!"):this.messageHandlers[e]=t},e.prototype.postMessageToUiThread=function(e){this.worker.postMessage(e)},e.prototype.logInfo=function(e){this.worker.postMessage({name:"info",params:{msg:e}})},e.prototype.logError=function(e){this.worker.postMessage({name:"error",params:{msg:e}})},e}(),webWorkerManager1=new WebWorkerManager;webWorkerManager1.setupRegistrations([new TelemetryWebWorker,new PerfDetectWebWorker]);
//# sourceMappingURL=https://statics.teams.cdn.office.net/hashedjs/webworker.js-46628f36.map