(window.webPackBridgeJsonp=window.webPackBridgeJsonp||[]).push([[22],{"348426a60b7cb4dbeb31":function(e,t,i){"use strict";i.d(t,"a",function(){return o});var n=i("11e808f62b4fe6e70870"),a=i("d200c08d057f868315fd"),r=i("5f0dbee501b8046e840c"),s=function(){function e(){var e=this;this.initialized=!1,this.eventDecoratorCallbacks=[],this.flush=function(){return e.telemetryProvider.flush()},this.telemetryProvider=Object(n.b)(),Object(a.a)(function(){e.initialized=!1,e.eventDecoratorCallbacks=[]})}return e.prototype.initialize=function(e,t,i){this.initialized||(this.consoleLogger=t,this.consoleLogger.debug("TelemetrySender initialized."),this.telemetryProvider.initialize(e,this.consoleLogger,i),this._tablePostfix=e.documentInfo.tablePostfix||"",this.initialized=!0)},e.getInstance=function(){return this.telemetrySender||(this.telemetrySender=new e),this.telemetrySender},e.prototype.registerEventDecorator=function(e){this.eventDecoratorCallbacks.push(e)},e.prototype.sendTelemetry=function(e,t,i,a){if(void 0===i&&(i={}),"start"!==i.step&&this.initialized){t=t.replace(/\-/g,"_").toLowerCase(),this.decorateEvent(t,i);var s=(""+r.a[e]+this._tablePostfix).toLowerCase(),o=this.telemetryProvider.createEvent(s,t,i,a),c=e===r.a.UserBI?n.a.userBi:n.a.default;this.telemetryProvider.logEvent(c,o)}},e.prototype.decorateEvent=function(e,t){this.eventDecoratorCallbacks.forEach(function(i){return i(e,t)})},e}();function o(e,t,i,n){s.getInstance().sendTelemetry(e,t,i,n)}},"5f0dbee501b8046e840c":function(e,t,i){"use strict";var n;i.d(t,"a",function(){return n}),function(e){e[e.Perf=0]="Perf",e[e.Scenario=1]="Scenario",e[e.Logging=2]="Logging",e[e.Tracking=3]="Tracking",e[e.Heartbeat=4]="Heartbeat",e[e.Http=5]="Http",e[e.UserBI=6]="UserBI"}(n||(n={}))},"9c02356a8a4ea0c6b9d5":function(e,t,i){"use strict";var n=i("98bae3dbabd51089d613"),a=12e4,r={},s=i("f9a6412761c79a080418"),o=i("348426a60b7cb4dbeb31"),c=i("e4015b2ea28f962ed7da"),p=i("5f0dbee501b8046e840c"),u=i("94a755535d135f12850c"),h=function(){function e(e,t,i,n,a,r,s,o,p,u,h){var m=this;if(this.scenarioId=e,this.scenarioName=t,this.scenarioEventData=i,this.scenarioFactory=n,this.logger=a,this.scenarioTimeoutMs=r,this.callback=o,this.memoryAnalyzer=p,this.enableDiagnostics=u,this.reportActivity=h,this._sequence=0,this.getTotalPauseDuration=function(){return m.pauseInfo&&m.pauseInfo.totalTime||0},this._id=this.scenarioId,this._name=this.scenarioName,this._currentStep=c.b.Unknown,this._eventData=this.scenarioEventData,this.timeout=this.scenarioTimeoutMs,this._timestamps=[],this.active=!0,this.absoluteStartTime=Date.now(),this.intervalTimestamp=this.relativeTimestamp=this.scenarioFactory.timestamp(),this.markStepsInTrace=!!s&&s.getBoolean("showScenarioStepsInPerfTrace"),this.showAllConsoleLogs=!!s&&s.getBoolean("showAllConsoleLogs"),this.memoryAnalyzer){var l=this.memoryAnalyzer.snapshotMemoryUsage();l&&(this.workingSetInitial=l.workingSetKb,this.privateBytesInitial=l.privateBytesKb)}}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delta",{get:function(){return this.scenarioFactory.timestamp()-this.relativeTimestamp},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeoutMs",{get:function(){return this.timeout},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventData",{get:function(){return this._eventData},set:function(e){this._eventData=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timestamps",{get:function(){return this._timestamps},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPaused",{get:function(){return!!this.pauseInfo&&!!this.pauseInfo.startTime},enumerable:!0,configurable:!0}),e.prototype.appendEventData=function(e){this.eventData=Object(n.__assign)(Object(n.__assign)({},this.eventData),e)},e.prototype.markAggregateStart=function(e){this.active?(this.aggregateStepStartTime||(this.aggregateStepStartTime={}),this.aggregateStepStartTime[e]||(this.aggregateStepStartTime[e]=performance.now())):this.logger.debug("Scenario {0} set to inactive",this.name)},e.prototype.markAggregateStop=function(e){this.active&&this.aggregateStepStartTime[e]&&(this.aggregateStepTotalTime||(this.aggregateStepTotalTime={}),this.aggregateStepTotalTime[e]||(this.aggregateStepTotalTime[e]=0),this.aggregateStepTotalTime[e]+=performance.now()-this.aggregateStepStartTime[e],this.aggregateStepStartTime[e]=void 0)},e.prototype.pause=function(e,t){if(this.active&&!this.isPaused){this._currentStep!==c.b.Unknown&&this.mark(this._currentStep);var i=e.reason,a=Object(n.__rest)(e,["reason"]);this.mark(c.b.Pause,Object(n.__assign)({pauseReason:i},a),void 0,t),this.pauseInfo=Object(n.__assign)(Object(n.__assign)({},this.pauseInfo),{reason:i,startTime:Date.now()})}},e.prototype.resume=function(e,t){if(this.active&&this.isPaused){var i=Date.now()-this.pauseInfo.startTime;this.mark(c.b.Resume,Object(n.__assign)(Object(n.__assign)({},e),{pauseDelta:i,pauseReason:this.pauseInfo&&this.pauseInfo.reason}),void 0,t),this.pauseInfo.totalTime=(this.pauseInfo.totalTime||0)+i,delete this.pauseInfo.reason,delete this.pauseInfo.startTime}},e.prototype.stop=function(e,t,i){var n=this;void 0===t&&(t="success"),this._currentStep!==c.b.Unknown&&this.mark(this._currentStep,void 0,t,i),this.aggregateStepTotalTime&&(Object(u.each)(Object.keys(this.aggregateStepTotalTime),function(e){var t=parseInt(n.aggregateStepTotalTime[e].toString(),10);n.mark(c.b[e],{stepDelta:t},void 0,i)}),this.aggregateStepTotalTime=null,this.aggregateStepStartTime=null),this.createMark(c.b.Stop,e,t,!0,i).then(function(){n.active&&(n.active=!1,n.pauseInfo=void 0),n.callback&&n.callback(t),n.scenarioFactory.clearScenario(n)})},e.prototype.fail=function(e,t){this.stop(e,"failure",t)},e.prototype.cancel=function(e,t){this.stop(e,"abandoned",t)},e.prototype.incomplete=function(e,t){this.stop(e,"incomplete",t)},e.prototype.mark=function(e,t,i,n){void 0===i&&(i="success"),this.createMark(e,t,i,!1,n),this._currentStep===e&&(this._currentStep=c.b.Unknown)},e.prototype.startStep=function(e){this._currentStep!==c.b.Unknown&&e!==this._currentStep&&this.mark(this._currentStep),this._currentStep=e},e.prototype.prepareAndSendTelemetry=function(e,t){this.eventData&&this.eventData!==e&&(e=Object(n.__assign)(Object(n.__assign)({},this.eventData),e)),this.updateEventDataMemory(e),e=this.getEventDataWithComutedValues(e),this.enableDiagnostics&&Object(s.a)().pushTelemetryEvent(p.a[p.a.Scenario],e),Object(o.a)(p.a.Scenario,this.name,e,t),this.logScenarioPerf(e)},e.prototype.logScenarioPerf=function(e){if(this.showAllConsoleLogs){var t=e["Scenario.Step"],i="start"===t?t:"stop"===t?"[step]("+this._sequence+")"+t+" ("+e.stepDelta+"ms/"+e.delta+"ms)":"[step]("+this._sequence+")"+t+" ("+e.stepDelta+"ms)";this.logger&&this.logger.log("[Scenario]"+this.name+" "+i)}},e.prototype.updateEventDataMemory=function(e){if(this.memoryAnalyzer){var t=this.memoryAnalyzer.snapshotMemoryUsage();t&&(e.workingSet=t.workingSetKb,e.privateBytes=t.privateBytesKb,e.workingSetDelta=this.workingSetInitial?this.workingSetInitial-t.workingSetKb:void 0,e.privateBytesDelta=this.privateBytesInitial?this.privateBytesInitial-t.privateBytesKb:void 0)}},e.prototype.getEventDataWithComutedValues=function(e){var t,i=this.intervalTimestamp;Object(u.isNumber)(e.overrideTimestamp)?(t=this.relativeTimestamp+e.overrideTimestamp-this.absoluteStartTime,delete e.overrideTimestamp):(t=this.scenarioFactory.timestamp(),this._timestamps.push(t)),this.intervalTimestamp=t;var a=Object(u.isNumber)(e.stepDelta)?e.stepDelta:t-i,r=Object(u.isNumber)(e.delta)?e.delta:t-this.relativeTimestamp,s=Object(u.isNumber)(e.elapsed)?e.elapsed:t,o=Object(u.isNumber)(e.elapsedSinceCoreInit)?e.elapsedSinceCoreInit:this.scenarioFactory.timestamp({isFromCoreInit:!0}),p=!!this.scenarioFactory.findScenario(c.a.WindowLaunchTime);return Object(n.__assign)(Object(n.__assign)({},e),{isInEst:p,stepDelta:a,delta:r,elapsed:s,elapsedSinceCoreInit:o})},e.prototype.getMonitoringDataOverride=function(e){var t=e;return this.name===c.a.WindowLaunchTime&&(t=e?Object(u.cloneDeep)(e):{scenarioPriority:"P0",data:[]}).data.push({key:"App",value:this.eventData.contentSlotApp}),t},e.prototype.createMark=function(e,t,i,a,s){return void 0===t&&(t={}),Object(n.__awaiter)(this,void 0,void 0,function(){var o,c,p;return Object(n.__generator)(this,function(n){return e&&this.active?(t["Scenario.Status"]=i,t["Scenario.Step"]=e,t["Scenario.Name"]=this.name,o=this.getMonitoringDataOverride(s),performance&&performance.mark&&performance.measure&&!r.hasOwnProperty(t["Scenario.Name"])&&(c=t["Scenario.Step"]+" "+t["Scenario.Name"]+"-"+this.id,performance.mark(c),"stop"===t["Scenario.Step"]&&(p="start "+t["Scenario.Name"]+"-"+this.id,0===(performance.getEntriesByName(p,"mark")||[]).length&&(p="navigationStart"),performance.measure(t["Scenario.Name"],p,c)),this.markStepsInTrace&&(this.previousMark&&performance.measure(t["Scenario.Name"]+" ["+this.previousMark+" <=> "+t["Scenario.Step"]+"]",this.previousMark+" "+t["Scenario.Name"]+"-"+this.id,t["Scenario.Step"]+" "+t["Scenario.Name"]+"-"+this.id),this.previousMark=t["Scenario.Step"])),this.prepareAndSendTelemetry(t,o),this.active=this.active&&!a,this.reportActivity&&this.reportActivity(t),this._sequence+=1,[2]):[2]})})},e}(),m=i("3e9c7e5351d86134f5f6"),l=function(){function e(e){this._name=e}return Object.defineProperty(e.prototype,"id",{get:function(){return"noop"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"delta",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timeoutMs",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"eventData",{get:function(){return{}},set:function(e){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timestamps",{get:function(){return[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPaused",{get:function(){return!1},enumerable:!0,configurable:!0}),e.prototype.appendEventData=function(e){},e.prototype.pause=function(e){},e.prototype.resume=function(e){},e.prototype.cancel=function(e){},e.prototype.mark=function(e,t,i){},e.prototype.startStep=function(e){},e.prototype.stop=function(e,t){},e.prototype.fail=function(e){},e.prototype.incomplete=function(e){},e.prototype.markAggregateStart=function(e){},e.prototype.markAggregateStop=function(e){},e.prototype.getTotalPauseDuration=function(){return 0},e}(),g=3e4,f=function(){return function(e,t){var i=this;this.isScenarioMemorySnapshotEnabled=e,this.globalWindow=t,this.cachedMemory=void 0,this.snapshotMemoryUsage=function(){if(i.isScenarioMemorySnapshotEnabled){if(i.cachedMemory)return i.cachedMemory;var e=i.globalWindow.envPerformance.getProcessMemoryInfo();return i.cachedMemory=e?{workingSetKb:e.workingSetSize,privateBytesKb:e.privateBytes}:void 0,i.globalWindow.setTimeout(function(){i.cachedMemory=void 0},g),i.cachedMemory||{}}return{}}}}(),d=i("4044e44e608d1baef794");i.d(t,"a",function(){return v});var v=function(){function e(e){var t=this;this.settingsService=e,this.activeScenarios=[],this.scenarioTimeoutMs=a,this.enableDiagnostics=!1,this.markStep=function(e,i,n){var a=t.findScenario(e);a&&a.mark(i,n&&n.eventData,n&&n.status,n&&n.monitoringData)},this.startStep=function(e,i){var n=t.findScenario(e);n&&n.startStep(i)},this.timestamp=function(){return Date.now()-(t.appStartTimestamp||0)}}return e.prototype.initialize=function(e,t,i,n,a,r){var s="desktop"===a.clientType;this.appStartTimestamp||(this.appStartTimestamp=e),this.logger=t,this.enableDiagnostics=r,this.memoryAnalyzer=s?new f(a.isScenarioMemorySnapshotEnabled,Object(d.a)()):void 0,this.setTimeoutCallback=i,this.clearTimeoutCallback=n,this.logger.debug("Initialized ScenarioFactory")},e.prototype.newScenario=function(e,t){var i=this.createScenarioWithoutStarting(e,t);return i.mark("start",void 0,void 0,t&&t.monitoringData),i},e.prototype.createScenarioWithoutStarting=function(e,t){if(void 0===t&&(t={}),Object(u.isUndefined)(this.appStartTimestamp))return new l(e);var i=void 0===t.captureMemoryUsage||t.captureMemoryUsage,n=Object(m.v4)(),a=new h(n,e,{},this,this.logger,t.timeoutMs||this.scenarioTimeoutMs,this.settingsService,t.callback,i?this.memoryAnalyzer:void 0,this.enableDiagnostics);void 0===t.startTime||isNaN(t.startTime)||(a.absoluteStartTime=t.startTime);var r=this.setupScenarioTimeout(a);return this.activeScenarios.push({scenario:a,timeoutId:r}),a},e.prototype.cancelExistingAndCreateScenario=function(e,t,i,n,a){var r=this.findScenario(e);if(r){var s=[{reason:t}];r.cancel({errors:JSON.stringify(s)})}return r=this.newScenario(e,{timeoutMs:i,callback:n,monitoringData:a})},e.prototype.stopScenarioIfActive=function(e,t,i,n){var a=this.findScenario(e);a&&a.stop(t,i,n)},e.prototype.findScenario=function(e){if(!e)return null;var t=Object(u.findLast)(this.activeScenarios,function(t){return t&&t.scenario.name===e||t.scenario.clientId===e})||null;return t?t.scenario:null},e.prototype.findScenarioByNameAndId=function(e,t){var i=Object(u.findLast)(this.activeScenarios,function(i){return i.scenario.name===e&&i.scenario.clientId===t})||null;return i?i.scenario:null},e.prototype.clearScenario=function(e){var t=Object(u.findIndex)(this.activeScenarios,function(t){return t.scenario===e});if(t>-1){var i=this.activeScenarios.splice(t,1)[0];this.clearTimeoutCallback(i.timeoutId)}},e.prototype.setContext=function(){},e.prototype.setupScenarioTimeout=function(e,t){var i=e.timeoutMs;return this.setTimeoutCallback(function(){e.stop(e.eventData,"timeout",t)},i)},e}()},f9a6412761c79a080418:function(e,t,i){"use strict";var n,a=i("98bae3dbabd51089d613"),r=i("e88a8106e72c3f2e7fd4"),s=i("2a5dd11255f151c25fd3"),o=i("e4015b2ea28f962ed7da"),c=function(){function e(t){this.maxQueueLength=t,this.diagnosticEvents=[],this.queueCapacity=this.maxQueueLength?this.maxQueueLength:e.QUEUE_CAPACITY}return e.prototype.getEvents=function(){return this.diagnosticEvents},e.prototype.enqueueEvent=function(e){this.diagnosticEvents.length<this.queueCapacity?this.diagnosticEvents.push(e):(this.dequeueEvent(),this.diagnosticEvents.push(e))},e.prototype.enqueueEvents=function(e){var t=this;e&&e.length>0&&e.forEach(function(e){t.enqueueEvent(e)})},e.prototype.flush=function(){this.diagnosticEvents=[]},e.prototype.dequeueEvent=function(){return this.diagnosticEvents.shift()},e.QUEUE_CAPACITY=1e3,e}(),p=i("4044e44e608d1baef794");i.d(t,"a",function(){return h});var u=function(){function e(e){this.diagnosticsInstances=new Map,this.telemetryEvents=new Map,this.diagnosticsEvents=new c,this.scriptStepWhiteList=new Set([o.b.DownloadScripts,o.b.DownloadMainJs]),this.eventWhiteList=new Set([o.a.SyncChatData,o.a.AppStart,o.a.RenderProviders,o.a.ChatSendMessage,o.a.ExperienceStartTime,o.a.RenderBaseApp,o.a.RenderChatPane,o.a.RenderChatList,o.a.RenderComposeChat,o.a.RenderShareForm,o.a.SubmitShareForm]),this.environmentDependencies=e,this.storageKey="persistedDiagnostics",this.loadPersistedDiagnostics(!0)}return e.prototype.pushTelemetryEvent=function(t,i){if(this.eventWhiteList.has(i.name)){var n=i&&i.step||"",a=i&&i.elapsed||0;if(this.scriptStepWhiteList.has(n)){var r=e.extractTimeValue(i.stepDelta);this.telemetryEvents.set(n,{delta:r,name:n,telemetryType:t,step:n,elapsed:a})}else{r=e.extractTimeValue(i&&i.delta);this.telemetryEvents.set(i.name,{delta:r,name:i.name,step:n,telemetryType:t,elapsed:a})}}},e.prototype.getTelemetryEvents=function(){return Array.from(this.telemetryEvents.values())},e.prototype.pushDiagnosticsEvent=function(t,i){i.length>e.MAX_MESSAGE_SIZE&&(i=i.substring(0,e.MAX_MESSAGE_SIZE)+e.longMessageEndingPattern);var n={message:i,level:t,levelName:r.d[t],timeStamp:new Date};this.diagnosticsEvents.enqueueEvent(n)},e.prototype.getDiagnosticsEvents=function(){var e=[];try{e=this.getDiagnosticsInstancesEvents()||[]}catch(e){this.pushDiagnosticsEvent(r.d.Error,"Failed to fetch logs from diagnostic instances: "+e)}var t=[];try{t=this.diagnosticsEvents.getEvents()||[]}catch(e){this.pushDiagnosticsEvent(r.d.Error,"Failed to fetch diagnostic logs: "+e)}return Object(a.__spreadArrays)(t,e)},e.prototype.flush=function(){this.diagnosticsEvents.flush()},e.prototype.persistDiagnostics=function(){this.pushDiagnosticsEvent(r.d.Warn,"Persisting diagnostic events for next load"),this.environmentDependencies.localStorage.setItem(this.storageKey,JSON.stringify(this.getDiagnosticsEvents()))},e.prototype.loadPersistedDiagnostics=function(e){void 0===e&&(e=!0);var t=this.environmentDependencies.localStorage,i=t.getItem(this.storageKey);if(i){var n=void 0;try{n=JSON.parse(i),Array.isArray(n)&&n.length>0&&this.diagnosticsEvents.enqueueEvents(n),e&&t.removeItem(this.storageKey)}catch(e){this.pushDiagnosticsEvent(r.d.Error,"Failed to load persisted logs from store with error: "+e),t.removeItem(this.storageKey)}}},e.prototype.registerDiagnosticsInstance=function(e,t){this.diagnosticsInstances.set(e,t)},e.prototype.unregisterDiagnosticsInstance=function(e){this.diagnosticsInstances.delete(e)},e.prototype.getDiagnosticsInstancesEvents=function(){var e,t=this,i=Array.from(this.diagnosticsInstances.keys());return!i||i.length<1?[]:i.reduce(function(i,n){if(!(e=t.diagnosticsInstances.get(n)))return i;try{var s=e.getDiagnosticsEvents()||[];return Object(a.__spreadArrays)(i,s)}catch(e){return t.pushDiagnosticsEvent(r.d.Error,"Error in collecting diagnostics events from "+n+": "+e),i}},[])},e.extractTimeValue=function(e){return Math.round(parseFloat(e||"0"))},e.MAX_MESSAGE_SIZE=512,e.longMessageEndingPattern="...",e}(),h=function(){if(!n){var e=void 0;try{e=Object(p.a)()}catch(i){e={getHostedWindowContext:function(){return{hostedContext:s.a.worker,startReason:s.c.userInitiated}},localStorage:{getItem:function(e){var i=t.get(e);return void 0===i?null:i},clear:function(){return t.clear()},key:function(e){return Array.from(t.keys())[e]},length:(t=new Map).size,removeItem:function(e){return t.delete(e)},setItem:function(e,i){return t.set(e,i)}}}}n=new u(e)}var t;return n}}}]);
//# sourceMappingURL=precompiled-default~calendar-app~calendar-dialog~channel-files.min.0675b0ad9719d6805843.js.map